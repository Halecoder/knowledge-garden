/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __objRest = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MetadataMenu
});
module.exports = __toCommonJS(main_exports);
var import_obsidian32 = require("obsidian");

// src/settings/MetadataMenuSettingTab.ts
var import_obsidian19 = require("obsidian");

// src/settings/FieldSettingsModal.ts
var import_obsidian17 = require("obsidian");

// src/fields/FieldManager.ts
var import_obsidian2 = require("obsidian");

// src/commands/replaceValues.ts
var import_obsidian = require("obsidian");

// src/utils/parser.ts
var fieldComponents = ["inList", "startStyle", "attribute", "endStyle", "beforeSeparatorSpacer", "afterSeparatorSpacer", "values"];
var genericFieldRegex = "(?<inList>- )?(?<startStyle>[_\\*~`]*)(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*)(?<endStyle>[_\\*~`]*)(?<beforeSeparatorSpacer>\\s*)";
var inlineFieldRegex = (attribute) => `(?<inList>- )?(?<startStyle>[_\\*~\`]*)(?<attribute>${attribute})(?<endStyle>[_\\*~\`]*)(?<beforeSeparatorSpacer>\\s*)::(?<afterSeparatorSpacer>\\s*)(?<values>[^\\]]*)`;
var fullLineRegex = new RegExp(`^${genericFieldRegex}::s*(?<values>.*)?`, "u");
var inSentenceRegexBrackets = new RegExp(`\\[${genericFieldRegex}::s*(?<values>[^\\]]+)?\\]`, "gu");
var inSentenceRegexPar = new RegExp(`\\(${genericFieldRegex}::s*(?<values>[^\\]]+)?\\)`, "gu");
var encodeLink = (value) => {
  return value ? value.replace(/\[\[/g, "\u{1F527}\u{1F400}").replace(/\]\]/g, "\u{1F413}\u{1F54C}") : value;
};
var decodeLink = (value) => {
  return value ? value.replace(/🔧🐀/gu, "[[").replace(/🐓🕌/gu, "]]") : value;
};
var getLineFields = (line) => {
  const fields = [];
  const fR = line.match(fullLineRegex);
  if (fR == null ? void 0 : fR.groups) {
    const { attribute, values } = fR == null ? void 0 : fR.groups;
    fields.push({ attribute, values, index: 0, length: line.length });
  } else {
    const sRBk = encodeLink(line).matchAll(inSentenceRegexBrackets);
    let next = sRBk.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBk.next();
    }
    const sRBc = encodeLink(line).matchAll(inSentenceRegexPar);
    next = sRBc.next();
    while (!next.done) {
      if (next.value.groups) {
        const { attribute, values } = next.value.groups;
        fields.push({ attribute, values: decodeLink(values), index: next.value.index || 0, length: next.value[0].length });
      }
      next = sRBc.next();
    }
  }
  fields.sort((a, b) => {
    if (a.index < b.index)
      return -1;
    if (a.index > b.index)
      return 1;
    return 0;
  });
  return fields;
};

// src/commands/replaceValues.ts
var LocationWrapper = {
  "fullLine": { start: "", end: "" },
  "brackets": { start: "[", end: "]" },
  "parenthesis": { start: "(", end: ")" }
};
var matchInlineFields = (regex, line, attribute, input, location = "fullLine") => {
  const sR = line.matchAll(regex);
  let next = sR.next();
  const newFields = [];
  while (!next.done) {
    const match = next.value;
    if (match.groups && Object.keys(match.groups).every((j) => fieldComponents.includes(j))) {
      const { inList, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = match.groups;
      const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
      const newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
      const start2 = LocationWrapper[location].start;
      const end2 = LocationWrapper[location].end;
      newFields.push({
        oldField: match[0],
        newField: `${start2}${inList || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${newValue}${end2}`
      });
    }
    next = sR.next();
  }
  return newFields;
};
function replaceValues(app2, fileOrFilePath, attribute, input) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrFilePath instanceof import_obsidian.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = app2.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield app2.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = this.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const newContent = content.map((line, i) => {
      if (frontmatter && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`${attribute}:`, "u");
        const r = line.match(regex);
        if (r && r.length > 0) {
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `[${inputArray.join(", ")}]`;
          return `${attribute}: ${newValue}`;
        } else {
          return line;
        }
      } else {
        const encodedInput = encodeLink(input);
        let encodedLine = encodeLink(line);
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}`, "u");
        const fR = encodedLine.match(fullLineRegex2);
        if ((fR == null ? void 0 : fR.groups) && Object.keys(fR.groups).every((j) => fieldComponents.includes(j))) {
          const { inList, startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = fR.groups;
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
          return `${inList || ""}${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${newValue}`;
        } else {
          const newFields = [];
          const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}\\]`, "gu");
          const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}\\)`, "gu");
          newFields.push(...matchInlineFields(inSentenceRegexBrackets2, encodedLine, attribute, encodedInput, "brackets" /* brackets */));
          newFields.push(...matchInlineFields(inSentenceRegexPar2, encodedLine, attribute, encodedInput, "parenthesis" /* parenthesis */));
          newFields.forEach((field) => {
            const fieldRegex = new RegExp(field.oldField.replace(/[.*+?^${}()|[\]\\]/g, "\\$&"), "u");
            encodedLine = encodedLine.replace(fieldRegex, field.newField);
          });
          return decodeLink(encodedLine);
        }
      }
    });
    app2.vault.modify(file, newContent.join("\n"));
  });
}

// src/fields/FieldManager.ts
var FieldManager2 = class {
  constructor(field, type) {
    if (field.type !== type)
      throw Error(`This field is not of type ${type}`);
    this.field = field;
  }
  validateName(textInput, insertAfter) {
    let error = false;
    if (/^[#>-]/.test(this.field.name)) {
      FieldSettingsModal.setValidationError(textInput, insertAfter, "Field name cannot start with #, >, -");
      error = true;
    }
    ;
    if (this.field.name == "") {
      FieldSettingsModal.setValidationError(textInput, insertAfter, "Field name can not be Empty");
      error = true;
    }
    ;
    return !error;
  }
  validateValue(value) {
    return __async(this, null, function* () {
      return true;
    });
  }
  static replaceValues(app2, path, fieldName, value) {
    const file = app2.vault.getAbstractFileByPath(path);
    if (file instanceof import_obsidian2.TFile && file.extension == "md") {
      replaceValues(app2, file, fieldName, value);
    }
  }
  static isMenu(category) {
    return category.addItem !== void 0;
  }
  static isSelect(category) {
    return category.modals !== void 0;
  }
  static createDefault(name) {
    const field = Field_default.createDefault(name);
    return new FieldManager[field.type](field);
  }
};

// src/optionModals/valueTextInputModal.ts
var import_obsidian4 = require("obsidian");

// src/commands/insertValues.ts
var import_obsidian3 = require("obsidian");
function insertValues(app2, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, top2) {
  return __async(this, null, function* () {
    let file;
    if (fileOrFilePath instanceof import_obsidian3.TFile) {
      file = fileOrFilePath;
    } else {
      const _file = app2.vault.getAbstractFileByPath(fileOrFilePath);
      if (_file instanceof import_obsidian3.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const result = yield app2.vault.read(file);
    let newContent = [];
    if (top2) {
      newContent.push(`${fieldName}${inFrontmatter ? ":" : "::"} ${value}`);
      result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
    } else {
      result.split("\n").forEach((line, _lineNumber) => {
        newContent.push(line);
        if (_lineNumber == lineNumber) {
          newContent.push(`${fieldName}${inFrontmatter ? ":" : "::"} ${value}`);
        }
        ;
      });
    }
    ;
    app2.vault.modify(file, newContent.join("\n"));
  });
}

// src/optionModals/valueTextInputModal.ts
var valueTextInputModal = class extends import_obsidian4.Modal {
  constructor(app2, file, field, value, lineNumber = -1, inFrontMatter = false, top2 = false) {
    super(app2);
    this.parseDate = false;
    this.app = app2;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top2;
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
    this.buildInputEl(inputDiv);
  }
  buildDateParseToggler(container) {
    const nldates = app.plugins.plugins["nldates-obsidian"];
    const dateParserLabel = container.createDiv({
      cls: "metadata-menu-date-parser-label"
    });
    dateParserLabel.setText("\u{1F4C6}");
    const dateParserToggler = new import_obsidian4.ToggleComponent(container);
    dateParserToggler.setValue(this.parseDate);
    dateParserToggler.onChange((value) => {
      this.parseDate = value;
    });
    dateParserLabel.onclick = () => dateParserToggler.setValue(!this.parseDate);
  }
  buildInputEl(inputDiv) {
    if (app.plugins.plugins.hasOwnProperty("nldates-obsidian") && this.field.type === "Input" /* Input */) {
      this.buildDateParseToggler(inputDiv);
    }
    ;
    const form = inputDiv.createEl("form");
    form.type = "submit";
    const inputEl = new import_obsidian4.TextComponent(form);
    inputEl.inputEl.focus();
    inputEl.setValue(this.value);
    inputEl.inputEl.addClass("metadata-menu-prompt-input");
    form.onsubmit = (e) => __async(this, null, function* () {
      e.preventDefault();
      let inputValue = inputEl.getValue();
      if (app.plugins.plugins.hasOwnProperty("nldates-obsidian") && this.parseDate && this.field.type === "Input" /* Input */) {
        const nldates = app.plugins.plugins["nldates-obsidian"];
        const format2 = nldates.settings.format;
        let textStart = "";
        let textEnd = "";
        let date = "";
        const selectionStart = inputEl.inputEl.selectionStart;
        const selectionEnd = inputEl.inputEl.selectionEnd;
        if (selectionEnd == selectionStart) {
          date = nldates.parseDate(inputEl.getValue()).moment.format(format2);
        } else {
          textStart = inputEl.getValue().slice(0, selectionStart);
          date = nldates.parseDate(inputEl.getValue().slice(selectionStart, selectionEnd)).moment.format(format2);
          textEnd = inputEl.getValue().slice(selectionEnd);
        }
        ;
        inputValue = textStart + "[[" + date + "]]" + textEnd;
      }
      if (this.lineNumber == -1) {
        replaceValues(this.app, this.file, this.field.name, inputValue);
      } else {
        insertValues(this.app, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.top);
      }
      ;
      this.close();
    });
  }
};

// src/fields/fieldManagers/InputField.ts
var InputField = class extends FieldManager2 {
  constructor(field) {
    super(field, "Input" /* Input */);
  }
  getOptionsStr() {
    return "";
  }
  addMenuOption(name, value, app2, file, category) {
    const modal = new valueTextInputModal(app2, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    if (InputField.isMenu(category)) {
      category.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon("pencil");
        item.onClick(() => modal.open());
        item.setSection("target-metadata");
      });
    } else if (InputField.isSelect(category)) {
      category.addOption(`update_${name}`, `Update <${name}>`);
      category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
  createSettingContainer(parentContainer, plugin) {
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(app2, file, selectedFieldName, lineNumber, inFrontmatter, top2) {
    const fieldModal = new valueTextInputModal(app2, file, this.field, "", lineNumber, inFrontmatter, top2);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(plugin, dv, p, fieldContainer, attrs) {
    return __async(this, null, function* () {
      const fieldValue = dv.el("span", p[this.field.name], attrs);
      const inputContainer = document.createElement("div");
      const input = document.createElement("input");
      input.setAttr("class", "metadata-menu-dv-input");
      inputContainer.appendChild(input);
      input.value = p[this.field.name];
      const spacer = document.createElement("div");
      spacer.setAttr("class", "metadata-menu-dv-field-spacer");
      const button = document.createElement("button");
      button.setText("\u{1F58D}");
      button.setAttr("class", "metadata-menu-dv-field-button");
      button.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        button.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        button.hide();
        spacer.show();
      };
      const validateIcon = document.createElement("button");
      validateIcon.textContent = "\u2705";
      validateIcon.setAttr("class", "metadata-menu-dv-field-button");
      validateIcon.onclick = (e) => {
        InputField.replaceValues(plugin.app, p["file"]["path"], this.field.name, input.value);
        fieldContainer.removeChild(inputContainer);
      };
      inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
      const cancelIcon = document.createElement("button");
      cancelIcon.setAttr("class", "metadata-menu-dv-field-button");
      cancelIcon.textContent = "\u274C";
      cancelIcon.onclick = (e) => {
        fieldContainer.removeChild(inputContainer);
        fieldContainer.appendChild(button);
        fieldContainer.appendChild(fieldValue);
        fieldContainer.appendChild(spacer);
      };
      inputContainer.appendChild(cancelIcon);
      input.focus();
      input.onkeydown = (e) => {
        if (e.key === "Enter") {
          InputField.replaceValues(plugin.app, p["file"]["path"], this.field.name, input.value);
          fieldContainer.removeChild(inputContainer);
        }
        if (e.key === "Escape") {
          fieldContainer.removeChild(inputContainer);
          fieldContainer.appendChild(button);
          fieldContainer.appendChild(fieldValue);
          fieldContainer.appendChild(spacer);
        }
      };
      button.onclick = (e) => {
        fieldContainer.removeChild(fieldValue);
        fieldContainer.removeChild(button);
        fieldContainer.removeChild(spacer);
        fieldContainer.appendChild(inputContainer);
        input.focus();
      };
      fieldContainer.appendChild(button);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(spacer);
    });
  }
};

// src/optionModals/valueToggleModal.ts
var import_obsidian5 = require("obsidian");
var valueToggleModal = class extends import_obsidian5.Modal {
  constructor(app2, file, field, value, lineNumber = -1, inFrontMatter = false, top2 = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top2;
    this.field = field;
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv({
      cls: "metadata-menu-toggler"
    });
    this.buildToggleEl(inputDiv);
  }
  buildToggleEl(inputDiv) {
    const toggleEl = new import_obsidian5.ToggleComponent(inputDiv);
    toggleEl.setValue(this.value);
    toggleEl.onChange((value) => {
      this.value = value;
    });
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    const saveButton = new import_obsidian5.ButtonComponent(footer);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      const value = this.value.toString();
      if (this.lineNumber == -1) {
        replaceValues(this.app, this.file, this.field.name, value);
      } else {
        insertValues(this.app, this.file, this.field.name, value, this.lineNumber, this.inFrontmatter, this.top);
      }
      ;
      this.close();
    }));
  }
};

// src/fields/fieldManagers/BooleanField.ts
var BooleanField = class extends FieldManager2 {
  constructor(field) {
    super(field, "Boolean" /* Boolean */);
  }
  stringToBoolean(value) {
    let toBooleanValue = false;
    if (isBoolean(value)) {
      toBooleanValue = value;
    } else if (/true/i.test(value)) {
      toBooleanValue = true;
    } else if (/false/i.test(value)) {
      toBooleanValue = false;
    } else {
      throw Error("this value is not a boolean");
    }
    ;
    return toBooleanValue;
  }
  addMenuOption(name, value, app2, file, category) {
    const bValue = this.stringToBoolean(value);
    if (BooleanField.isMenu(category)) {
      category.addItem((item) => {
        item.setTitle(`<${name}> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
        item.setIcon("checkmark");
        item.onClick(() => replaceValues(app2, file, name, (!bValue).toString()));
        item.setSection("target-metadata");
      });
    } else if (BooleanField.isSelect(category)) {
      category.addOption(`update_${name}`, `<${name}> ${bValue ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
      category.modals[`update_${name}`] = () => replaceValues(app2, file, name, (!bValue).toString());
    }
    ;
  }
  getOptionsStr() {
    return "";
  }
  createSettingContainer(parentContainer, plugin) {
  }
  validateValue(value) {
    return __async(this, null, function* () {
      try {
        const bValue = this.stringToBoolean(value);
        return isBoolean(bValue);
      } catch (error) {
        return false;
      }
    });
  }
  validateOptions() {
    return true;
  }
  createAndOpenFieldModal(app2, file, selectedFieldName, lineNumber, inFrontmatter, top2) {
    const fieldModal = new valueToggleModal(app2, file, this.field, false, lineNumber, inFrontmatter, top2);
    fieldModal.titleEl.setText(`Set value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(plugin, dv, p, fieldContainer, attrs) {
    return __async(this, null, function* () {
      const checkbox = dv.el("input", "", __spreadProps(__spreadValues({}, attrs), { "type": "checkbox" }));
      checkbox.checked = p[this.field.name];
      fieldContainer.appendChild(checkbox);
      checkbox.onchange = (value) => {
        BooleanField.replaceValues(plugin.app, p["file"]["path"], this.field.name, checkbox.checked.toString());
      };
    });
  }
};

// src/optionModals/numberModal.ts
var import_obsidian6 = require("obsidian");
var numbertModal = class extends import_obsidian6.Modal {
  constructor(app2, file, field, value, lineNumber = -1, inFrontMatter = false, top2 = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.field = field;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top2;
    this.fieldManager = new FieldManager[this.field.type](this.field);
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv();
    this.buildInputEl(inputDiv);
  }
  decrement(inputEl) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      inputEl.setValue((parseFloat(inputEl.getValue()) - fStep).toString());
    } else {
      inputEl.setValue((parseFloat(inputEl.getValue()) - 1).toString());
    }
  }
  increment(inputEl) {
    const { step } = this.field.options;
    const fStep = parseFloat(step);
    if (!isNaN(fStep)) {
      inputEl.setValue((parseFloat(inputEl.getValue()) + fStep).toString());
    } else {
      inputEl.setValue((parseFloat(inputEl.getValue()) + 1).toString());
    }
  }
  toggleButtonsState(minusBtn, plusBtn, inputEl) {
    minusBtn.setDisabled(!this.fieldManager.canDecrement(inputEl.getValue()));
    plusBtn.setDisabled(!this.fieldManager.canIncrement(inputEl.getValue()));
    if (this.fieldManager.canDecrement(inputEl.getValue())) {
      minusBtn.setCta();
    } else {
      minusBtn.removeCta();
    }
    if (this.fieldManager.canIncrement(inputEl.getValue())) {
      plusBtn.setCta();
    } else {
      plusBtn.removeCta();
    }
  }
  validateValue(value) {
    const { min: min2, max: max2 } = this.field.options;
    const fMin = parseFloat(min2);
    const fMax = parseFloat(max2);
    const fValue = parseFloat(value);
    return !isNaN(fValue) && (isNaN(fMin) || fValue >= fMin) && (isNaN(fMax) || fValue <= fMax);
  }
  buildInputEl(inputDiv) {
    const { step } = this.field.options;
    const form = inputDiv.createEl("form");
    form.type = "submit";
    const fieldContainer = form.createEl("div", { cls: "metadata-menu-modal-value-with-btn" });
    const inputEl = new import_obsidian6.TextComponent(fieldContainer);
    inputEl.inputEl.focus();
    inputEl.setValue(this.value);
    const minusBtn = new import_obsidian6.ButtonComponent(fieldContainer);
    minusBtn.setButtonText(`- ${!!step ? step : 1}`);
    const plusBtn = new import_obsidian6.ButtonComponent(fieldContainer);
    plusBtn.setButtonText(`+ ${!!step ? step : 1}`);
    plusBtn.setDisabled(!this.fieldManager.canIncrement(inputEl.getValue()));
    const errorField = form.createEl("div", { cls: "metadata-menu-modal-value-with-btn-error-field" });
    errorField.hide();
    const footer = form.createEl("div", { cls: "metadata-menu-value-grid-footer" });
    const validateBtn = new import_obsidian6.ButtonComponent(footer);
    validateBtn.setIcon("checkmark");
    const cancelBtn = new import_obsidian6.ButtonComponent(footer);
    cancelBtn.setIcon("cross");
    this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    inputEl.onChange(() => {
      inputEl.inputEl.removeClass("is-invalid");
      errorField.hide();
      errorField.setText("");
      this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    });
    plusBtn.onClick((e) => {
      e.preventDefault();
      this.increment(inputEl);
      this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    });
    minusBtn.onClick((e) => {
      e.preventDefault();
      this.decrement(inputEl);
      this.toggleButtonsState(minusBtn, plusBtn, inputEl);
    });
    cancelBtn.onClick((e) => {
      e.preventDefault();
      this.close();
    });
    form.onsubmit = (e) => __async(this, null, function* () {
      e.preventDefault();
      let inputValue = inputEl.getValue();
      if (!this.fieldManager.validateValue(inputValue)) {
        const { min: min2, max: max2 } = this.field.options;
        errorField.show();
        errorField.setText(`value must be numeric${min2 ? " and >= " + min2 : ""} ${max2 ? " and <= " + max2 : ""}`);
        inputEl.inputEl.setAttr("class", "is-invalid");
        return;
      }
      if (this.lineNumber == -1) {
        replaceValues(this.app, this.file, this.field.name, inputValue);
      } else {
        insertValues(this.app, this.file, this.field.name, inputValue, this.lineNumber, this.inFrontmatter, this.top);
      }
      ;
      this.close();
    });
  }
};

// src/fields/fieldManagers/NumberField.ts
var import_obsidian7 = require("obsidian");
var NumberField = class extends FieldManager2 {
  constructor(field) {
    super(field, "Number" /* Number */);
  }
  getOptionsStr() {
    const options = [];
    Object.keys(this.field.options).forEach((k) => {
      if (this.field.options[k])
        options.push(`${k}: ${this.field.options[k]}`);
    });
    return options.join(" | ");
  }
  canDecrement(value) {
    const { step, min: min2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMin = parseFloat(min2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMin) && (!isNaN(fStep) && (parseFloat(value) - fStep < fMin || parseFloat(value) - 1 < fMin)));
  }
  canIncrement(value) {
    const { step, max: max2 } = this.field.options;
    const fStep = parseFloat(step);
    const fMax = parseFloat(max2);
    return !(isNaN(parseFloat(value)) || !isNaN(fMax) && (!isNaN(fStep) && (parseFloat(value) + fStep > fMax || parseFloat(value) + 1 > fMax)));
  }
  validateValue(value) {
    return __async(this, null, function* () {
      const { min: min2, max: max2 } = this.field.options;
      const fMin = parseFloat(min2);
      const fMax = parseFloat(max2);
      const fValue = parseFloat(value);
      return !isNaN(fValue) && (isNaN(fMin) || fValue >= fMin) && (isNaN(fMax) || fValue <= fMax);
    });
  }
  addMenuOption(name, value, app2, file, category) {
    const modal = new numbertModal(app2, file, this.field, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    if (NumberField.isMenu(category)) {
      category.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon("pencil");
        item.onClick(() => modal.open());
        item.setSection("target-metadata");
      });
      const { min: min2, max: max2, step } = this.field.options;
      const fMin = parseFloat(min2);
      const fMax = parseFloat(max2);
      const fStep = parseFloat(step);
      const fValue = parseFloat(value);
      if (fStep) {
        if (isNaN(fMin) || fMin && fValue - fStep > fMin)
          category.addItem((item) => {
            item.setIcon("pencil");
            item.setTitle(`<${name}> \u27A1\uFE0F ${fValue - fStep}`);
            item.onClick(() => replaceValues(app2, file, name, (fValue - fStep).toString()));
            item.setSection("target-metadata");
          });
        if (isNaN(fMax) || fMax && fValue + fStep < fMax)
          category.addItem((item) => {
            item.setIcon("pencil");
            item.setTitle(`<${name}> \u27A1\uFE0F ${fValue + fStep}`);
            item.onClick(() => replaceValues(app2, file, name, (fValue + fStep).toString()));
            item.setSection("target-metadata");
          });
      }
    } else if (NumberField.isSelect(category)) {
      category.addOption(`update_${name}`, `Update <${name}>`);
      category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
  createNumberContainer(parentContainer) {
    const numberStepValueContainer = parentContainer.createDiv();
    numberStepValueContainer.createEl("span", { text: "Step (optional)", cls: "metadata-menu-field-option" });
    this.numberStepValue = new import_obsidian7.TextComponent(numberStepValueContainer);
    this.numberStepValue.setValue(this.field.options.step || "");
    const numberMinValueContainer = parentContainer.createDiv();
    numberMinValueContainer.createEl("span", { text: "Min value (optional)", cls: "metadata-menu-field-option" });
    this.numberMinValue = new import_obsidian7.TextComponent(numberMinValueContainer);
    this.numberMinValue.setValue(this.field.options.min || "");
    const numberMaxValueContainer = parentContainer.createDiv();
    numberMaxValueContainer.createEl("span", { text: "Max value (optional)", cls: "metadata-menu-field-option" });
    this.numberMaxValue = new import_obsidian7.TextComponent(numberMaxValueContainer);
    this.numberMaxValue.setValue(this.field.options.max || "");
    this.numberStepValue.onChange((value) => {
      this.field.options.step = value;
      FieldSettingsModal.removeValidationError(this.numberStepValue);
    });
    this.numberMinValue.onChange((value) => {
      this.field.options.min = value;
      FieldSettingsModal.removeValidationError(this.numberMinValue);
    });
    this.numberMaxValue.onChange((value) => {
      this.field.options.max = value;
      FieldSettingsModal.removeValidationError(this.numberMaxValue);
    });
  }
  createSettingContainer(parentContainer, plugin) {
    this.numberValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createNumberContainer(this.numberValidatorField);
    this.numberValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  validateOptions() {
    let error = false;
    if (this.field.options.step && isNaN(parseFloat(this.field.options.step))) {
      FieldSettingsModal.setValidationError(this.numberStepValue, this.numberStepValue.inputEl, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.min && isNaN(parseFloat(this.field.options.min))) {
      FieldSettingsModal.setValidationError(this.numberMinValue, this.numberMinValue.inputEl, "Values must be numeric.");
      error = true;
    }
    if (this.field.options.max && isNaN(parseFloat(this.field.options.max))) {
      FieldSettingsModal.setValidationError(this.numberMaxValue, this.numberMaxValue.inputEl, "Values must be numeric.");
      error = true;
    }
    return !error;
  }
  createAndOpenFieldModal(app2, file, selectedFieldName, lineNumber, inFrontmatter, top2) {
    const fieldModal = new numbertModal(app2, file, this.field, "", lineNumber, inFrontmatter, top2);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  toggleDvButtons(decrementBtn, incrementBtn, value) {
    if (this.canDecrement(value)) {
      decrementBtn.removeClass("disabled");
    } else {
      decrementBtn.addClass("disabled");
    }
    if (this.canIncrement(value)) {
      incrementBtn.removeClass("disabled");
    } else {
      incrementBtn.addClass("disabled");
      ;
    }
  }
  createDvField(plugin, dv, p, fieldContainer, attrs) {
    return __async(this, null, function* () {
      const fieldValue = dv.el("span", p[this.field.name], attrs);
      const inputContainer = document.createElement("div");
      const input = document.createElement("input");
      input.setAttr("class", "metadata-menu-dv-input");
      inputContainer.appendChild(input);
      input.value = p[this.field.name];
      const tripleSpacer = document.createElement("div");
      tripleSpacer.setAttr("class", "metadata-menu-dv-field-triple-spacer");
      const editButton = document.createElement("button");
      editButton.setText("\u{1F58D}");
      editButton.setAttr("class", "metadata-menu-dv-field-button");
      editButton.hide();
      const decrementButton = document.createElement("button");
      decrementButton.setText("\u25C0\uFE0F");
      decrementButton.setAttr("class", "metadata-menu-dv-field-button");
      decrementButton.hide();
      const incrementButton = document.createElement("button");
      incrementButton.setText("\u25B6\uFE0F");
      incrementButton.setAttr("class", "metadata-menu-dv-field-button");
      incrementButton.hide();
      tripleSpacer.show();
      fieldContainer.onmouseover = () => {
        editButton.show();
        decrementButton.show();
        incrementButton.show();
        tripleSpacer.hide();
      };
      fieldContainer.onmouseout = () => {
        editButton.hide();
        decrementButton.hide();
        incrementButton.hide();
        tripleSpacer.show();
      };
      const validateIcon = document.createElement("a");
      validateIcon.textContent = "\u2705";
      validateIcon.setAttr("class", "metadata-menu-dv-field-button");
      validateIcon.onclick = () => __async(this, null, function* () {
        if (yield this.validateValue(input.value)) {
          const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
          if (file instanceof import_obsidian7.TFile && file.extension == "md") {
            yield replaceValues(plugin.app, file, this.field.name, input.value);
            this.toggleDvButtons(decrementButton, incrementButton, input.value);
          }
          fieldContainer.removeChild(inputContainer);
        }
      });
      inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
      const cancelIcon = document.createElement("a");
      cancelIcon.setAttr("class", "metadata-menu-dv-field-button");
      cancelIcon.textContent = "\u274C";
      cancelIcon.onclick = (e) => {
        fieldContainer.removeChild(inputContainer);
        fieldContainer.appendChild(decrementButton);
        fieldContainer.appendChild(fieldValue);
        fieldContainer.appendChild(editButton);
        fieldContainer.appendChild(incrementButton);
        fieldContainer.appendChild(tripleSpacer);
      };
      inputContainer.appendChild(cancelIcon);
      input.focus();
      input.onkeyup = (e) => {
        if (!this.validateValue(input.value)) {
          input.addClass("is-invalid");
          validateIcon.addClass("disabled");
        } else {
          input.removeClass("is-invalid");
          validateIcon.removeClass("disabled");
        }
      };
      input.onkeydown = (e) => __async(this, null, function* () {
        if (e.key === "Enter") {
          if (yield this.validateValue(input.value)) {
            const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
            if (file instanceof import_obsidian7.TFile && file.extension == "md") {
              yield replaceValues(plugin.app, file, this.field.name, input.value);
              this.toggleDvButtons(decrementButton, incrementButton, input.value);
            }
            fieldContainer.removeChild(inputContainer);
          }
        }
        if (e.key === "Escape") {
          fieldContainer.removeChild(inputContainer);
          fieldContainer.appendChild(decrementButton);
          fieldContainer.appendChild(fieldValue);
          fieldContainer.appendChild(editButton);
          fieldContainer.appendChild(incrementButton);
          fieldContainer.appendChild(tripleSpacer);
        }
      });
      editButton.onclick = () => {
        fieldContainer.removeChild(fieldValue);
        fieldContainer.removeChild(editButton);
        fieldContainer.removeChild(decrementButton);
        fieldContainer.removeChild(incrementButton);
        fieldContainer.removeChild(tripleSpacer);
        fieldContainer.appendChild(inputContainer);
        input.focus();
      };
      decrementButton.onclick = () => __async(this, null, function* () {
        if (this.canDecrement(p[this.field.name])) {
          const { step } = this.field.options;
          const fStep = parseFloat(step);
          const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
          if (file instanceof import_obsidian7.TFile && file.extension == "md") {
            const newValue = (!!fStep ? p[this.field.name] - fStep : p[this.field.name] - 1).toString();
            yield replaceValues(plugin.app, file, this.field.name, newValue);
            this.toggleDvButtons(decrementButton, incrementButton, newValue);
          }
        }
      });
      incrementButton.onclick = () => {
        if (this.canIncrement(p[this.field.name])) {
          const { step } = this.field.options;
          const fStep = parseFloat(step);
          const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
          if (file instanceof import_obsidian7.TFile && file.extension == "md") {
            const newValue = (!!fStep ? p[this.field.name] + fStep : p[this.field.name] + 1).toString();
            replaceValues(plugin.app, file, this.field.name, newValue);
            this.toggleDvButtons(decrementButton, incrementButton, newValue);
          }
        }
      };
      fieldContainer.appendChild(decrementButton);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(editButton);
      fieldContainer.appendChild(incrementButton);
      fieldContainer.appendChild(tripleSpacer);
      this.toggleDvButtons(decrementButton, incrementButton, p[this.field.name]);
    });
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var import_obsidian12 = require("obsidian");

// src/settings/FieldSetting.ts
var import_obsidian8 = require("obsidian");
var FieldSetting = class extends import_obsidian8.Setting {
  constructor(containerEl, property, app2, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.field = property;
    this.app = app2;
    this.plugin = plugin;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
  }
  setTextContentWithname() {
    const manager = new FieldManager[this.field.type](this.field);
    this.infoEl.textContent = "";
    this.infoEl.addClass("metadata-menu-setting-item");
    this.fieldNameContainer = this.infoEl.createEl("div", "metadata-menu-setting-item-name");
    this.fieldNameContainer.setText(this.field.name);
    this.typeContainer = this.infoEl.createEl("div");
    this.typeContainer.setAttr("class", `metadata-menu-setting-item-info-type ${FieldTypeTagClass[this.field.type]}`);
    this.typeContainer.setText(this.field.type);
    this.fieldOptionsContainer = this.infoEl.createEl("div");
    this.fieldOptionsContainer.setText(`${manager.getOptionsStr()}`);
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FieldSettingsModal(this.app, this.plugin, this.containerEl, this, this.field);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingProperty = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
        if (currentExistingProperty) {
          this.plugin.initialProperties.remove(currentExistingProperty);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  static getValuesListFromNote(notePath, app2) {
    return __async(this, null, function* () {
      let values = [];
      const file = app2.vault.getAbstractFileByPath(notePath);
      if (file instanceof import_obsidian8.TFile && file.extension == "md") {
        const result = yield app2.vault.read(file);
        result.split("\n").forEach((line) => {
          if (/^(.*)$/.test(line)) {
            values.push(line.trim());
          }
          ;
        });
        return values;
      } else {
        return [];
      }
      ;
    });
  }
};

// src/suggester/FileSuggester.ts
var import_obsidian11 = require("obsidian");

// src/suggester/suggest.ts
var import_obsidian9 = require("obsidian");

// node_modules/@popperjs/core/lib/enums.js
var top = "top";
var bottom = "bottom";
var right = "right";
var left = "left";
var auto = "auto";
var basePlacements = [top, bottom, right, left];
var start = "start";
var end = "end";
var clippingParents = "clippingParents";
var viewport = "viewport";
var popper = "popper";
var reference = "reference";
var variationPlacements = /* @__PURE__ */ basePlacements.reduce(function(acc, placement) {
  return acc.concat([placement + "-" + start, placement + "-" + end]);
}, []);
var placements = /* @__PURE__ */ [].concat(basePlacements, [auto]).reduce(function(acc, placement) {
  return acc.concat([placement, placement + "-" + start, placement + "-" + end]);
}, []);
var beforeRead = "beforeRead";
var read = "read";
var afterRead = "afterRead";
var beforeMain = "beforeMain";
var main = "main";
var afterMain = "afterMain";
var beforeWrite = "beforeWrite";
var write = "write";
var afterWrite = "afterWrite";
var modifierPhases = [beforeRead, read, afterRead, beforeMain, main, afterMain, beforeWrite, write, afterWrite];

// node_modules/@popperjs/core/lib/dom-utils/getNodeName.js
function getNodeName(element) {
  return element ? (element.nodeName || "").toLowerCase() : null;
}

// node_modules/@popperjs/core/lib/dom-utils/getWindow.js
function getWindow(node) {
  if (node == null) {
    return window;
  }
  if (node.toString() !== "[object Window]") {
    var ownerDocument = node.ownerDocument;
    return ownerDocument ? ownerDocument.defaultView || window : window;
  }
  return node;
}

// node_modules/@popperjs/core/lib/dom-utils/instanceOf.js
function isElement(node) {
  var OwnElement = getWindow(node).Element;
  return node instanceof OwnElement || node instanceof Element;
}
function isHTMLElement(node) {
  var OwnElement = getWindow(node).HTMLElement;
  return node instanceof OwnElement || node instanceof HTMLElement;
}
function isShadowRoot(node) {
  if (typeof ShadowRoot === "undefined") {
    return false;
  }
  var OwnElement = getWindow(node).ShadowRoot;
  return node instanceof OwnElement || node instanceof ShadowRoot;
}

// node_modules/@popperjs/core/lib/modifiers/applyStyles.js
function applyStyles(_ref) {
  var state = _ref.state;
  Object.keys(state.elements).forEach(function(name) {
    var style = state.styles[name] || {};
    var attributes = state.attributes[name] || {};
    var element = state.elements[name];
    if (!isHTMLElement(element) || !getNodeName(element)) {
      return;
    }
    Object.assign(element.style, style);
    Object.keys(attributes).forEach(function(name2) {
      var value = attributes[name2];
      if (value === false) {
        element.removeAttribute(name2);
      } else {
        element.setAttribute(name2, value === true ? "" : value);
      }
    });
  });
}
function effect(_ref2) {
  var state = _ref2.state;
  var initialStyles = {
    popper: {
      position: state.options.strategy,
      left: "0",
      top: "0",
      margin: "0"
    },
    arrow: {
      position: "absolute"
    },
    reference: {}
  };
  Object.assign(state.elements.popper.style, initialStyles.popper);
  state.styles = initialStyles;
  if (state.elements.arrow) {
    Object.assign(state.elements.arrow.style, initialStyles.arrow);
  }
  return function() {
    Object.keys(state.elements).forEach(function(name) {
      var element = state.elements[name];
      var attributes = state.attributes[name] || {};
      var styleProperties = Object.keys(state.styles.hasOwnProperty(name) ? state.styles[name] : initialStyles[name]);
      var style = styleProperties.reduce(function(style2, property) {
        style2[property] = "";
        return style2;
      }, {});
      if (!isHTMLElement(element) || !getNodeName(element)) {
        return;
      }
      Object.assign(element.style, style);
      Object.keys(attributes).forEach(function(attribute) {
        element.removeAttribute(attribute);
      });
    });
  };
}
var applyStyles_default = {
  name: "applyStyles",
  enabled: true,
  phase: "write",
  fn: applyStyles,
  effect,
  requires: ["computeStyles"]
};

// node_modules/@popperjs/core/lib/utils/getBasePlacement.js
function getBasePlacement(placement) {
  return placement.split("-")[0];
}

// node_modules/@popperjs/core/lib/utils/math.js
var max = Math.max;
var min = Math.min;
var round = Math.round;

// node_modules/@popperjs/core/lib/dom-utils/getBoundingClientRect.js
function getBoundingClientRect(element, includeScale) {
  if (includeScale === void 0) {
    includeScale = false;
  }
  var rect = element.getBoundingClientRect();
  var scaleX = 1;
  var scaleY = 1;
  if (isHTMLElement(element) && includeScale) {
    var offsetHeight = element.offsetHeight;
    var offsetWidth = element.offsetWidth;
    if (offsetWidth > 0) {
      scaleX = round(rect.width) / offsetWidth || 1;
    }
    if (offsetHeight > 0) {
      scaleY = round(rect.height) / offsetHeight || 1;
    }
  }
  return {
    width: rect.width / scaleX,
    height: rect.height / scaleY,
    top: rect.top / scaleY,
    right: rect.right / scaleX,
    bottom: rect.bottom / scaleY,
    left: rect.left / scaleX,
    x: rect.left / scaleX,
    y: rect.top / scaleY
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getLayoutRect.js
function getLayoutRect(element) {
  var clientRect = getBoundingClientRect(element);
  var width = element.offsetWidth;
  var height = element.offsetHeight;
  if (Math.abs(clientRect.width - width) <= 1) {
    width = clientRect.width;
  }
  if (Math.abs(clientRect.height - height) <= 1) {
    height = clientRect.height;
  }
  return {
    x: element.offsetLeft,
    y: element.offsetTop,
    width,
    height
  };
}

// node_modules/@popperjs/core/lib/dom-utils/contains.js
function contains(parent, child) {
  var rootNode = child.getRootNode && child.getRootNode();
  if (parent.contains(child)) {
    return true;
  } else if (rootNode && isShadowRoot(rootNode)) {
    var next = child;
    do {
      if (next && parent.isSameNode(next)) {
        return true;
      }
      next = next.parentNode || next.host;
    } while (next);
  }
  return false;
}

// node_modules/@popperjs/core/lib/dom-utils/getComputedStyle.js
function getComputedStyle(element) {
  return getWindow(element).getComputedStyle(element);
}

// node_modules/@popperjs/core/lib/dom-utils/isTableElement.js
function isTableElement(element) {
  return ["table", "td", "th"].indexOf(getNodeName(element)) >= 0;
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentElement.js
function getDocumentElement(element) {
  return ((isElement(element) ? element.ownerDocument : element.document) || window.document).documentElement;
}

// node_modules/@popperjs/core/lib/dom-utils/getParentNode.js
function getParentNode(element) {
  if (getNodeName(element) === "html") {
    return element;
  }
  return element.assignedSlot || element.parentNode || (isShadowRoot(element) ? element.host : null) || getDocumentElement(element);
}

// node_modules/@popperjs/core/lib/dom-utils/getOffsetParent.js
function getTrueOffsetParent(element) {
  if (!isHTMLElement(element) || getComputedStyle(element).position === "fixed") {
    return null;
  }
  return element.offsetParent;
}
function getContainingBlock(element) {
  var isFirefox = navigator.userAgent.toLowerCase().indexOf("firefox") !== -1;
  var isIE = navigator.userAgent.indexOf("Trident") !== -1;
  if (isIE && isHTMLElement(element)) {
    var elementCss = getComputedStyle(element);
    if (elementCss.position === "fixed") {
      return null;
    }
  }
  var currentNode = getParentNode(element);
  if (isShadowRoot(currentNode)) {
    currentNode = currentNode.host;
  }
  while (isHTMLElement(currentNode) && ["html", "body"].indexOf(getNodeName(currentNode)) < 0) {
    var css = getComputedStyle(currentNode);
    if (css.transform !== "none" || css.perspective !== "none" || css.contain === "paint" || ["transform", "perspective"].indexOf(css.willChange) !== -1 || isFirefox && css.willChange === "filter" || isFirefox && css.filter && css.filter !== "none") {
      return currentNode;
    } else {
      currentNode = currentNode.parentNode;
    }
  }
  return null;
}
function getOffsetParent(element) {
  var window2 = getWindow(element);
  var offsetParent = getTrueOffsetParent(element);
  while (offsetParent && isTableElement(offsetParent) && getComputedStyle(offsetParent).position === "static") {
    offsetParent = getTrueOffsetParent(offsetParent);
  }
  if (offsetParent && (getNodeName(offsetParent) === "html" || getNodeName(offsetParent) === "body" && getComputedStyle(offsetParent).position === "static")) {
    return window2;
  }
  return offsetParent || getContainingBlock(element) || window2;
}

// node_modules/@popperjs/core/lib/utils/getMainAxisFromPlacement.js
function getMainAxisFromPlacement(placement) {
  return ["top", "bottom"].indexOf(placement) >= 0 ? "x" : "y";
}

// node_modules/@popperjs/core/lib/utils/within.js
function within(min2, value, max2) {
  return max(min2, min(value, max2));
}
function withinMaxClamp(min2, value, max2) {
  var v = within(min2, value, max2);
  return v > max2 ? max2 : v;
}

// node_modules/@popperjs/core/lib/utils/getFreshSideObject.js
function getFreshSideObject() {
  return {
    top: 0,
    right: 0,
    bottom: 0,
    left: 0
  };
}

// node_modules/@popperjs/core/lib/utils/mergePaddingObject.js
function mergePaddingObject(paddingObject) {
  return Object.assign({}, getFreshSideObject(), paddingObject);
}

// node_modules/@popperjs/core/lib/utils/expandToHashMap.js
function expandToHashMap(value, keys) {
  return keys.reduce(function(hashMap, key) {
    hashMap[key] = value;
    return hashMap;
  }, {});
}

// node_modules/@popperjs/core/lib/modifiers/arrow.js
var toPaddingObject = function toPaddingObject2(padding, state) {
  padding = typeof padding === "function" ? padding(Object.assign({}, state.rects, {
    placement: state.placement
  })) : padding;
  return mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
};
function arrow(_ref) {
  var _state$modifiersData$;
  var state = _ref.state, name = _ref.name, options = _ref.options;
  var arrowElement = state.elements.arrow;
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var basePlacement = getBasePlacement(state.placement);
  var axis = getMainAxisFromPlacement(basePlacement);
  var isVertical = [left, right].indexOf(basePlacement) >= 0;
  var len = isVertical ? "height" : "width";
  if (!arrowElement || !popperOffsets2) {
    return;
  }
  var paddingObject = toPaddingObject(options.padding, state);
  var arrowRect = getLayoutRect(arrowElement);
  var minProp = axis === "y" ? top : left;
  var maxProp = axis === "y" ? bottom : right;
  var endDiff = state.rects.reference[len] + state.rects.reference[axis] - popperOffsets2[axis] - state.rects.popper[len];
  var startDiff = popperOffsets2[axis] - state.rects.reference[axis];
  var arrowOffsetParent = getOffsetParent(arrowElement);
  var clientSize = arrowOffsetParent ? axis === "y" ? arrowOffsetParent.clientHeight || 0 : arrowOffsetParent.clientWidth || 0 : 0;
  var centerToReference = endDiff / 2 - startDiff / 2;
  var min2 = paddingObject[minProp];
  var max2 = clientSize - arrowRect[len] - paddingObject[maxProp];
  var center = clientSize / 2 - arrowRect[len] / 2 + centerToReference;
  var offset2 = within(min2, center, max2);
  var axisProp = axis;
  state.modifiersData[name] = (_state$modifiersData$ = {}, _state$modifiersData$[axisProp] = offset2, _state$modifiersData$.centerOffset = offset2 - center, _state$modifiersData$);
}
function effect2(_ref2) {
  var state = _ref2.state, options = _ref2.options;
  var _options$element = options.element, arrowElement = _options$element === void 0 ? "[data-popper-arrow]" : _options$element;
  if (arrowElement == null) {
    return;
  }
  if (typeof arrowElement === "string") {
    arrowElement = state.elements.popper.querySelector(arrowElement);
    if (!arrowElement) {
      return;
    }
  }
  if (true) {
    if (!isHTMLElement(arrowElement)) {
      console.error(['Popper: "arrow" element must be an HTMLElement (not an SVGElement).', "To use an SVG arrow, wrap it in an HTMLElement that will be used as", "the arrow."].join(" "));
    }
  }
  if (!contains(state.elements.popper, arrowElement)) {
    if (true) {
      console.error(['Popper: "arrow" modifier\'s `element` must be a child of the popper', "element."].join(" "));
    }
    return;
  }
  state.elements.arrow = arrowElement;
}
var arrow_default = {
  name: "arrow",
  enabled: true,
  phase: "main",
  fn: arrow,
  effect: effect2,
  requires: ["popperOffsets"],
  requiresIfExists: ["preventOverflow"]
};

// node_modules/@popperjs/core/lib/utils/getVariation.js
function getVariation(placement) {
  return placement.split("-")[1];
}

// node_modules/@popperjs/core/lib/modifiers/computeStyles.js
var unsetSides = {
  top: "auto",
  right: "auto",
  bottom: "auto",
  left: "auto"
};
function roundOffsetsByDPR(_ref) {
  var x = _ref.x, y = _ref.y;
  var win = window;
  var dpr = win.devicePixelRatio || 1;
  return {
    x: round(x * dpr) / dpr || 0,
    y: round(y * dpr) / dpr || 0
  };
}
function mapToStyles(_ref2) {
  var _Object$assign2;
  var popper2 = _ref2.popper, popperRect = _ref2.popperRect, placement = _ref2.placement, variation = _ref2.variation, offsets = _ref2.offsets, position = _ref2.position, gpuAcceleration = _ref2.gpuAcceleration, adaptive = _ref2.adaptive, roundOffsets = _ref2.roundOffsets, isFixed = _ref2.isFixed;
  var _offsets$x = offsets.x, x = _offsets$x === void 0 ? 0 : _offsets$x, _offsets$y = offsets.y, y = _offsets$y === void 0 ? 0 : _offsets$y;
  var _ref3 = typeof roundOffsets === "function" ? roundOffsets({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref3.x;
  y = _ref3.y;
  var hasX = offsets.hasOwnProperty("x");
  var hasY = offsets.hasOwnProperty("y");
  var sideX = left;
  var sideY = top;
  var win = window;
  if (adaptive) {
    var offsetParent = getOffsetParent(popper2);
    var heightProp = "clientHeight";
    var widthProp = "clientWidth";
    if (offsetParent === getWindow(popper2)) {
      offsetParent = getDocumentElement(popper2);
      if (getComputedStyle(offsetParent).position !== "static" && position === "absolute") {
        heightProp = "scrollHeight";
        widthProp = "scrollWidth";
      }
    }
    offsetParent = offsetParent;
    if (placement === top || (placement === left || placement === right) && variation === end) {
      sideY = bottom;
      var offsetY = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.height : offsetParent[heightProp];
      y -= offsetY - popperRect.height;
      y *= gpuAcceleration ? 1 : -1;
    }
    if (placement === left || (placement === top || placement === bottom) && variation === end) {
      sideX = right;
      var offsetX = isFixed && offsetParent === win && win.visualViewport ? win.visualViewport.width : offsetParent[widthProp];
      x -= offsetX - popperRect.width;
      x *= gpuAcceleration ? 1 : -1;
    }
  }
  var commonStyles = Object.assign({
    position
  }, adaptive && unsetSides);
  var _ref4 = roundOffsets === true ? roundOffsetsByDPR({
    x,
    y
  }) : {
    x,
    y
  };
  x = _ref4.x;
  y = _ref4.y;
  if (gpuAcceleration) {
    var _Object$assign;
    return Object.assign({}, commonStyles, (_Object$assign = {}, _Object$assign[sideY] = hasY ? "0" : "", _Object$assign[sideX] = hasX ? "0" : "", _Object$assign.transform = (win.devicePixelRatio || 1) <= 1 ? "translate(" + x + "px, " + y + "px)" : "translate3d(" + x + "px, " + y + "px, 0)", _Object$assign));
  }
  return Object.assign({}, commonStyles, (_Object$assign2 = {}, _Object$assign2[sideY] = hasY ? y + "px" : "", _Object$assign2[sideX] = hasX ? x + "px" : "", _Object$assign2.transform = "", _Object$assign2));
}
function computeStyles(_ref5) {
  var state = _ref5.state, options = _ref5.options;
  var _options$gpuAccelerat = options.gpuAcceleration, gpuAcceleration = _options$gpuAccelerat === void 0 ? true : _options$gpuAccelerat, _options$adaptive = options.adaptive, adaptive = _options$adaptive === void 0 ? true : _options$adaptive, _options$roundOffsets = options.roundOffsets, roundOffsets = _options$roundOffsets === void 0 ? true : _options$roundOffsets;
  if (true) {
    var transitionProperty = getComputedStyle(state.elements.popper).transitionProperty || "";
    if (adaptive && ["transform", "top", "right", "bottom", "left"].some(function(property) {
      return transitionProperty.indexOf(property) >= 0;
    })) {
      console.warn(["Popper: Detected CSS transitions on at least one of the following", 'CSS properties: "transform", "top", "right", "bottom", "left".', "\n\n", 'Disable the "computeStyles" modifier\'s `adaptive` option to allow', "for smooth transitions, or remove these properties from the CSS", "transition declaration on the popper element if only transitioning", "opacity or background-color for example.", "\n\n", "We recommend using the popper element as a wrapper around an inner", "element that can have any CSS property transitioned for animations."].join(" "));
    }
  }
  var commonStyles = {
    placement: getBasePlacement(state.placement),
    variation: getVariation(state.placement),
    popper: state.elements.popper,
    popperRect: state.rects.popper,
    gpuAcceleration,
    isFixed: state.options.strategy === "fixed"
  };
  if (state.modifiersData.popperOffsets != null) {
    state.styles.popper = Object.assign({}, state.styles.popper, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.popperOffsets,
      position: state.options.strategy,
      adaptive,
      roundOffsets
    })));
  }
  if (state.modifiersData.arrow != null) {
    state.styles.arrow = Object.assign({}, state.styles.arrow, mapToStyles(Object.assign({}, commonStyles, {
      offsets: state.modifiersData.arrow,
      position: "absolute",
      adaptive: false,
      roundOffsets
    })));
  }
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-placement": state.placement
  });
}
var computeStyles_default = {
  name: "computeStyles",
  enabled: true,
  phase: "beforeWrite",
  fn: computeStyles,
  data: {}
};

// node_modules/@popperjs/core/lib/modifiers/eventListeners.js
var passive = {
  passive: true
};
function effect3(_ref) {
  var state = _ref.state, instance = _ref.instance, options = _ref.options;
  var _options$scroll = options.scroll, scroll = _options$scroll === void 0 ? true : _options$scroll, _options$resize = options.resize, resize = _options$resize === void 0 ? true : _options$resize;
  var window2 = getWindow(state.elements.popper);
  var scrollParents = [].concat(state.scrollParents.reference, state.scrollParents.popper);
  if (scroll) {
    scrollParents.forEach(function(scrollParent) {
      scrollParent.addEventListener("scroll", instance.update, passive);
    });
  }
  if (resize) {
    window2.addEventListener("resize", instance.update, passive);
  }
  return function() {
    if (scroll) {
      scrollParents.forEach(function(scrollParent) {
        scrollParent.removeEventListener("scroll", instance.update, passive);
      });
    }
    if (resize) {
      window2.removeEventListener("resize", instance.update, passive);
    }
  };
}
var eventListeners_default = {
  name: "eventListeners",
  enabled: true,
  phase: "write",
  fn: function fn() {
  },
  effect: effect3,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getOppositePlacement.js
var hash = {
  left: "right",
  right: "left",
  bottom: "top",
  top: "bottom"
};
function getOppositePlacement(placement) {
  return placement.replace(/left|right|bottom|top/g, function(matched) {
    return hash[matched];
  });
}

// node_modules/@popperjs/core/lib/utils/getOppositeVariationPlacement.js
var hash2 = {
  start: "end",
  end: "start"
};
function getOppositeVariationPlacement(placement) {
  return placement.replace(/start|end/g, function(matched) {
    return hash2[matched];
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScroll.js
function getWindowScroll(node) {
  var win = getWindow(node);
  var scrollLeft = win.pageXOffset;
  var scrollTop = win.pageYOffset;
  return {
    scrollLeft,
    scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getWindowScrollBarX.js
function getWindowScrollBarX(element) {
  return getBoundingClientRect(getDocumentElement(element)).left + getWindowScroll(element).scrollLeft;
}

// node_modules/@popperjs/core/lib/dom-utils/getViewportRect.js
function getViewportRect(element) {
  var win = getWindow(element);
  var html = getDocumentElement(element);
  var visualViewport = win.visualViewport;
  var width = html.clientWidth;
  var height = html.clientHeight;
  var x = 0;
  var y = 0;
  if (visualViewport) {
    width = visualViewport.width;
    height = visualViewport.height;
    if (!/^((?!chrome|android).)*safari/i.test(navigator.userAgent)) {
      x = visualViewport.offsetLeft;
      y = visualViewport.offsetTop;
    }
  }
  return {
    width,
    height,
    x: x + getWindowScrollBarX(element),
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getDocumentRect.js
function getDocumentRect(element) {
  var _element$ownerDocumen;
  var html = getDocumentElement(element);
  var winScroll = getWindowScroll(element);
  var body = (_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body;
  var width = max(html.scrollWidth, html.clientWidth, body ? body.scrollWidth : 0, body ? body.clientWidth : 0);
  var height = max(html.scrollHeight, html.clientHeight, body ? body.scrollHeight : 0, body ? body.clientHeight : 0);
  var x = -winScroll.scrollLeft + getWindowScrollBarX(element);
  var y = -winScroll.scrollTop;
  if (getComputedStyle(body || html).direction === "rtl") {
    x += max(html.clientWidth, body ? body.clientWidth : 0) - width;
  }
  return {
    width,
    height,
    x,
    y
  };
}

// node_modules/@popperjs/core/lib/dom-utils/isScrollParent.js
function isScrollParent(element) {
  var _getComputedStyle = getComputedStyle(element), overflow = _getComputedStyle.overflow, overflowX = _getComputedStyle.overflowX, overflowY = _getComputedStyle.overflowY;
  return /auto|scroll|overlay|hidden/.test(overflow + overflowY + overflowX);
}

// node_modules/@popperjs/core/lib/dom-utils/getScrollParent.js
function getScrollParent(node) {
  if (["html", "body", "#document"].indexOf(getNodeName(node)) >= 0) {
    return node.ownerDocument.body;
  }
  if (isHTMLElement(node) && isScrollParent(node)) {
    return node;
  }
  return getScrollParent(getParentNode(node));
}

// node_modules/@popperjs/core/lib/dom-utils/listScrollParents.js
function listScrollParents(element, list) {
  var _element$ownerDocumen;
  if (list === void 0) {
    list = [];
  }
  var scrollParent = getScrollParent(element);
  var isBody = scrollParent === ((_element$ownerDocumen = element.ownerDocument) == null ? void 0 : _element$ownerDocumen.body);
  var win = getWindow(scrollParent);
  var target = isBody ? [win].concat(win.visualViewport || [], isScrollParent(scrollParent) ? scrollParent : []) : scrollParent;
  var updatedList = list.concat(target);
  return isBody ? updatedList : updatedList.concat(listScrollParents(getParentNode(target)));
}

// node_modules/@popperjs/core/lib/utils/rectToClientRect.js
function rectToClientRect(rect) {
  return Object.assign({}, rect, {
    left: rect.x,
    top: rect.y,
    right: rect.x + rect.width,
    bottom: rect.y + rect.height
  });
}

// node_modules/@popperjs/core/lib/dom-utils/getClippingRect.js
function getInnerBoundingClientRect(element) {
  var rect = getBoundingClientRect(element);
  rect.top = rect.top + element.clientTop;
  rect.left = rect.left + element.clientLeft;
  rect.bottom = rect.top + element.clientHeight;
  rect.right = rect.left + element.clientWidth;
  rect.width = element.clientWidth;
  rect.height = element.clientHeight;
  rect.x = rect.left;
  rect.y = rect.top;
  return rect;
}
function getClientRectFromMixedType(element, clippingParent) {
  return clippingParent === viewport ? rectToClientRect(getViewportRect(element)) : isElement(clippingParent) ? getInnerBoundingClientRect(clippingParent) : rectToClientRect(getDocumentRect(getDocumentElement(element)));
}
function getClippingParents(element) {
  var clippingParents2 = listScrollParents(getParentNode(element));
  var canEscapeClipping = ["absolute", "fixed"].indexOf(getComputedStyle(element).position) >= 0;
  var clipperElement = canEscapeClipping && isHTMLElement(element) ? getOffsetParent(element) : element;
  if (!isElement(clipperElement)) {
    return [];
  }
  return clippingParents2.filter(function(clippingParent) {
    return isElement(clippingParent) && contains(clippingParent, clipperElement) && getNodeName(clippingParent) !== "body";
  });
}
function getClippingRect(element, boundary, rootBoundary) {
  var mainClippingParents = boundary === "clippingParents" ? getClippingParents(element) : [].concat(boundary);
  var clippingParents2 = [].concat(mainClippingParents, [rootBoundary]);
  var firstClippingParent = clippingParents2[0];
  var clippingRect = clippingParents2.reduce(function(accRect, clippingParent) {
    var rect = getClientRectFromMixedType(element, clippingParent);
    accRect.top = max(rect.top, accRect.top);
    accRect.right = min(rect.right, accRect.right);
    accRect.bottom = min(rect.bottom, accRect.bottom);
    accRect.left = max(rect.left, accRect.left);
    return accRect;
  }, getClientRectFromMixedType(element, firstClippingParent));
  clippingRect.width = clippingRect.right - clippingRect.left;
  clippingRect.height = clippingRect.bottom - clippingRect.top;
  clippingRect.x = clippingRect.left;
  clippingRect.y = clippingRect.top;
  return clippingRect;
}

// node_modules/@popperjs/core/lib/utils/computeOffsets.js
function computeOffsets(_ref) {
  var reference2 = _ref.reference, element = _ref.element, placement = _ref.placement;
  var basePlacement = placement ? getBasePlacement(placement) : null;
  var variation = placement ? getVariation(placement) : null;
  var commonX = reference2.x + reference2.width / 2 - element.width / 2;
  var commonY = reference2.y + reference2.height / 2 - element.height / 2;
  var offsets;
  switch (basePlacement) {
    case top:
      offsets = {
        x: commonX,
        y: reference2.y - element.height
      };
      break;
    case bottom:
      offsets = {
        x: commonX,
        y: reference2.y + reference2.height
      };
      break;
    case right:
      offsets = {
        x: reference2.x + reference2.width,
        y: commonY
      };
      break;
    case left:
      offsets = {
        x: reference2.x - element.width,
        y: commonY
      };
      break;
    default:
      offsets = {
        x: reference2.x,
        y: reference2.y
      };
  }
  var mainAxis = basePlacement ? getMainAxisFromPlacement(basePlacement) : null;
  if (mainAxis != null) {
    var len = mainAxis === "y" ? "height" : "width";
    switch (variation) {
      case start:
        offsets[mainAxis] = offsets[mainAxis] - (reference2[len] / 2 - element[len] / 2);
        break;
      case end:
        offsets[mainAxis] = offsets[mainAxis] + (reference2[len] / 2 - element[len] / 2);
        break;
      default:
    }
  }
  return offsets;
}

// node_modules/@popperjs/core/lib/utils/detectOverflow.js
function detectOverflow(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, _options$placement = _options.placement, placement = _options$placement === void 0 ? state.placement : _options$placement, _options$boundary = _options.boundary, boundary = _options$boundary === void 0 ? clippingParents : _options$boundary, _options$rootBoundary = _options.rootBoundary, rootBoundary = _options$rootBoundary === void 0 ? viewport : _options$rootBoundary, _options$elementConte = _options.elementContext, elementContext = _options$elementConte === void 0 ? popper : _options$elementConte, _options$altBoundary = _options.altBoundary, altBoundary = _options$altBoundary === void 0 ? false : _options$altBoundary, _options$padding = _options.padding, padding = _options$padding === void 0 ? 0 : _options$padding;
  var paddingObject = mergePaddingObject(typeof padding !== "number" ? padding : expandToHashMap(padding, basePlacements));
  var altContext = elementContext === popper ? reference : popper;
  var popperRect = state.rects.popper;
  var element = state.elements[altBoundary ? altContext : elementContext];
  var clippingClientRect = getClippingRect(isElement(element) ? element : element.contextElement || getDocumentElement(state.elements.popper), boundary, rootBoundary);
  var referenceClientRect = getBoundingClientRect(state.elements.reference);
  var popperOffsets2 = computeOffsets({
    reference: referenceClientRect,
    element: popperRect,
    strategy: "absolute",
    placement
  });
  var popperClientRect = rectToClientRect(Object.assign({}, popperRect, popperOffsets2));
  var elementClientRect = elementContext === popper ? popperClientRect : referenceClientRect;
  var overflowOffsets = {
    top: clippingClientRect.top - elementClientRect.top + paddingObject.top,
    bottom: elementClientRect.bottom - clippingClientRect.bottom + paddingObject.bottom,
    left: clippingClientRect.left - elementClientRect.left + paddingObject.left,
    right: elementClientRect.right - clippingClientRect.right + paddingObject.right
  };
  var offsetData = state.modifiersData.offset;
  if (elementContext === popper && offsetData) {
    var offset2 = offsetData[placement];
    Object.keys(overflowOffsets).forEach(function(key) {
      var multiply = [right, bottom].indexOf(key) >= 0 ? 1 : -1;
      var axis = [top, bottom].indexOf(key) >= 0 ? "y" : "x";
      overflowOffsets[key] += offset2[axis] * multiply;
    });
  }
  return overflowOffsets;
}

// node_modules/@popperjs/core/lib/utils/computeAutoPlacement.js
function computeAutoPlacement(state, options) {
  if (options === void 0) {
    options = {};
  }
  var _options = options, placement = _options.placement, boundary = _options.boundary, rootBoundary = _options.rootBoundary, padding = _options.padding, flipVariations = _options.flipVariations, _options$allowedAutoP = _options.allowedAutoPlacements, allowedAutoPlacements = _options$allowedAutoP === void 0 ? placements : _options$allowedAutoP;
  var variation = getVariation(placement);
  var placements2 = variation ? flipVariations ? variationPlacements : variationPlacements.filter(function(placement2) {
    return getVariation(placement2) === variation;
  }) : basePlacements;
  var allowedPlacements = placements2.filter(function(placement2) {
    return allowedAutoPlacements.indexOf(placement2) >= 0;
  });
  if (allowedPlacements.length === 0) {
    allowedPlacements = placements2;
    if (true) {
      console.error(["Popper: The `allowedAutoPlacements` option did not allow any", "placements. Ensure the `placement` option matches the variation", "of the allowed placements.", 'For example, "auto" cannot be used to allow "bottom-start".', 'Use "auto-start" instead.'].join(" "));
    }
  }
  var overflows = allowedPlacements.reduce(function(acc, placement2) {
    acc[placement2] = detectOverflow(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding
    })[getBasePlacement(placement2)];
    return acc;
  }, {});
  return Object.keys(overflows).sort(function(a, b) {
    return overflows[a] - overflows[b];
  });
}

// node_modules/@popperjs/core/lib/modifiers/flip.js
function getExpandedFallbackPlacements(placement) {
  if (getBasePlacement(placement) === auto) {
    return [];
  }
  var oppositePlacement = getOppositePlacement(placement);
  return [getOppositeVariationPlacement(placement), oppositePlacement, getOppositeVariationPlacement(oppositePlacement)];
}
function flip(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  if (state.modifiersData[name]._skip) {
    return;
  }
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? true : _options$altAxis, specifiedFallbackPlacements = options.fallbackPlacements, padding = options.padding, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, _options$flipVariatio = options.flipVariations, flipVariations = _options$flipVariatio === void 0 ? true : _options$flipVariatio, allowedAutoPlacements = options.allowedAutoPlacements;
  var preferredPlacement = state.options.placement;
  var basePlacement = getBasePlacement(preferredPlacement);
  var isBasePlacement = basePlacement === preferredPlacement;
  var fallbackPlacements = specifiedFallbackPlacements || (isBasePlacement || !flipVariations ? [getOppositePlacement(preferredPlacement)] : getExpandedFallbackPlacements(preferredPlacement));
  var placements2 = [preferredPlacement].concat(fallbackPlacements).reduce(function(acc, placement2) {
    return acc.concat(getBasePlacement(placement2) === auto ? computeAutoPlacement(state, {
      placement: placement2,
      boundary,
      rootBoundary,
      padding,
      flipVariations,
      allowedAutoPlacements
    }) : placement2);
  }, []);
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var checksMap = /* @__PURE__ */ new Map();
  var makeFallbackChecks = true;
  var firstFittingPlacement = placements2[0];
  for (var i = 0; i < placements2.length; i++) {
    var placement = placements2[i];
    var _basePlacement = getBasePlacement(placement);
    var isStartVariation = getVariation(placement) === start;
    var isVertical = [top, bottom].indexOf(_basePlacement) >= 0;
    var len = isVertical ? "width" : "height";
    var overflow = detectOverflow(state, {
      placement,
      boundary,
      rootBoundary,
      altBoundary,
      padding
    });
    var mainVariationSide = isVertical ? isStartVariation ? right : left : isStartVariation ? bottom : top;
    if (referenceRect[len] > popperRect[len]) {
      mainVariationSide = getOppositePlacement(mainVariationSide);
    }
    var altVariationSide = getOppositePlacement(mainVariationSide);
    var checks = [];
    if (checkMainAxis) {
      checks.push(overflow[_basePlacement] <= 0);
    }
    if (checkAltAxis) {
      checks.push(overflow[mainVariationSide] <= 0, overflow[altVariationSide] <= 0);
    }
    if (checks.every(function(check) {
      return check;
    })) {
      firstFittingPlacement = placement;
      makeFallbackChecks = false;
      break;
    }
    checksMap.set(placement, checks);
  }
  if (makeFallbackChecks) {
    var numberOfChecks = flipVariations ? 3 : 1;
    var _loop = function _loop2(_i2) {
      var fittingPlacement = placements2.find(function(placement2) {
        var checks2 = checksMap.get(placement2);
        if (checks2) {
          return checks2.slice(0, _i2).every(function(check) {
            return check;
          });
        }
      });
      if (fittingPlacement) {
        firstFittingPlacement = fittingPlacement;
        return "break";
      }
    };
    for (var _i = numberOfChecks; _i > 0; _i--) {
      var _ret = _loop(_i);
      if (_ret === "break")
        break;
    }
  }
  if (state.placement !== firstFittingPlacement) {
    state.modifiersData[name]._skip = true;
    state.placement = firstFittingPlacement;
    state.reset = true;
  }
}
var flip_default = {
  name: "flip",
  enabled: true,
  phase: "main",
  fn: flip,
  requiresIfExists: ["offset"],
  data: {
    _skip: false
  }
};

// node_modules/@popperjs/core/lib/modifiers/hide.js
function getSideOffsets(overflow, rect, preventedOffsets) {
  if (preventedOffsets === void 0) {
    preventedOffsets = {
      x: 0,
      y: 0
    };
  }
  return {
    top: overflow.top - rect.height - preventedOffsets.y,
    right: overflow.right - rect.width + preventedOffsets.x,
    bottom: overflow.bottom - rect.height + preventedOffsets.y,
    left: overflow.left - rect.width - preventedOffsets.x
  };
}
function isAnySideFullyClipped(overflow) {
  return [top, right, bottom, left].some(function(side) {
    return overflow[side] >= 0;
  });
}
function hide(_ref) {
  var state = _ref.state, name = _ref.name;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var preventedOffsets = state.modifiersData.preventOverflow;
  var referenceOverflow = detectOverflow(state, {
    elementContext: "reference"
  });
  var popperAltOverflow = detectOverflow(state, {
    altBoundary: true
  });
  var referenceClippingOffsets = getSideOffsets(referenceOverflow, referenceRect);
  var popperEscapeOffsets = getSideOffsets(popperAltOverflow, popperRect, preventedOffsets);
  var isReferenceHidden = isAnySideFullyClipped(referenceClippingOffsets);
  var hasPopperEscaped = isAnySideFullyClipped(popperEscapeOffsets);
  state.modifiersData[name] = {
    referenceClippingOffsets,
    popperEscapeOffsets,
    isReferenceHidden,
    hasPopperEscaped
  };
  state.attributes.popper = Object.assign({}, state.attributes.popper, {
    "data-popper-reference-hidden": isReferenceHidden,
    "data-popper-escaped": hasPopperEscaped
  });
}
var hide_default = {
  name: "hide",
  enabled: true,
  phase: "main",
  requiresIfExists: ["preventOverflow"],
  fn: hide
};

// node_modules/@popperjs/core/lib/modifiers/offset.js
function distanceAndSkiddingToXY(placement, rects, offset2) {
  var basePlacement = getBasePlacement(placement);
  var invertDistance = [left, top].indexOf(basePlacement) >= 0 ? -1 : 1;
  var _ref = typeof offset2 === "function" ? offset2(Object.assign({}, rects, {
    placement
  })) : offset2, skidding = _ref[0], distance = _ref[1];
  skidding = skidding || 0;
  distance = (distance || 0) * invertDistance;
  return [left, right].indexOf(basePlacement) >= 0 ? {
    x: distance,
    y: skidding
  } : {
    x: skidding,
    y: distance
  };
}
function offset(_ref2) {
  var state = _ref2.state, options = _ref2.options, name = _ref2.name;
  var _options$offset = options.offset, offset2 = _options$offset === void 0 ? [0, 0] : _options$offset;
  var data = placements.reduce(function(acc, placement) {
    acc[placement] = distanceAndSkiddingToXY(placement, state.rects, offset2);
    return acc;
  }, {});
  var _data$state$placement = data[state.placement], x = _data$state$placement.x, y = _data$state$placement.y;
  if (state.modifiersData.popperOffsets != null) {
    state.modifiersData.popperOffsets.x += x;
    state.modifiersData.popperOffsets.y += y;
  }
  state.modifiersData[name] = data;
}
var offset_default = {
  name: "offset",
  enabled: true,
  phase: "main",
  requires: ["popperOffsets"],
  fn: offset
};

// node_modules/@popperjs/core/lib/modifiers/popperOffsets.js
function popperOffsets(_ref) {
  var state = _ref.state, name = _ref.name;
  state.modifiersData[name] = computeOffsets({
    reference: state.rects.reference,
    element: state.rects.popper,
    strategy: "absolute",
    placement: state.placement
  });
}
var popperOffsets_default = {
  name: "popperOffsets",
  enabled: true,
  phase: "read",
  fn: popperOffsets,
  data: {}
};

// node_modules/@popperjs/core/lib/utils/getAltAxis.js
function getAltAxis(axis) {
  return axis === "x" ? "y" : "x";
}

// node_modules/@popperjs/core/lib/modifiers/preventOverflow.js
function preventOverflow(_ref) {
  var state = _ref.state, options = _ref.options, name = _ref.name;
  var _options$mainAxis = options.mainAxis, checkMainAxis = _options$mainAxis === void 0 ? true : _options$mainAxis, _options$altAxis = options.altAxis, checkAltAxis = _options$altAxis === void 0 ? false : _options$altAxis, boundary = options.boundary, rootBoundary = options.rootBoundary, altBoundary = options.altBoundary, padding = options.padding, _options$tether = options.tether, tether = _options$tether === void 0 ? true : _options$tether, _options$tetherOffset = options.tetherOffset, tetherOffset = _options$tetherOffset === void 0 ? 0 : _options$tetherOffset;
  var overflow = detectOverflow(state, {
    boundary,
    rootBoundary,
    padding,
    altBoundary
  });
  var basePlacement = getBasePlacement(state.placement);
  var variation = getVariation(state.placement);
  var isBasePlacement = !variation;
  var mainAxis = getMainAxisFromPlacement(basePlacement);
  var altAxis = getAltAxis(mainAxis);
  var popperOffsets2 = state.modifiersData.popperOffsets;
  var referenceRect = state.rects.reference;
  var popperRect = state.rects.popper;
  var tetherOffsetValue = typeof tetherOffset === "function" ? tetherOffset(Object.assign({}, state.rects, {
    placement: state.placement
  })) : tetherOffset;
  var normalizedTetherOffsetValue = typeof tetherOffsetValue === "number" ? {
    mainAxis: tetherOffsetValue,
    altAxis: tetherOffsetValue
  } : Object.assign({
    mainAxis: 0,
    altAxis: 0
  }, tetherOffsetValue);
  var offsetModifierState = state.modifiersData.offset ? state.modifiersData.offset[state.placement] : null;
  var data = {
    x: 0,
    y: 0
  };
  if (!popperOffsets2) {
    return;
  }
  if (checkMainAxis) {
    var _offsetModifierState$;
    var mainSide = mainAxis === "y" ? top : left;
    var altSide = mainAxis === "y" ? bottom : right;
    var len = mainAxis === "y" ? "height" : "width";
    var offset2 = popperOffsets2[mainAxis];
    var min2 = offset2 + overflow[mainSide];
    var max2 = offset2 - overflow[altSide];
    var additive = tether ? -popperRect[len] / 2 : 0;
    var minLen = variation === start ? referenceRect[len] : popperRect[len];
    var maxLen = variation === start ? -popperRect[len] : -referenceRect[len];
    var arrowElement = state.elements.arrow;
    var arrowRect = tether && arrowElement ? getLayoutRect(arrowElement) : {
      width: 0,
      height: 0
    };
    var arrowPaddingObject = state.modifiersData["arrow#persistent"] ? state.modifiersData["arrow#persistent"].padding : getFreshSideObject();
    var arrowPaddingMin = arrowPaddingObject[mainSide];
    var arrowPaddingMax = arrowPaddingObject[altSide];
    var arrowLen = within(0, referenceRect[len], arrowRect[len]);
    var minOffset = isBasePlacement ? referenceRect[len] / 2 - additive - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis : minLen - arrowLen - arrowPaddingMin - normalizedTetherOffsetValue.mainAxis;
    var maxOffset = isBasePlacement ? -referenceRect[len] / 2 + additive + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis : maxLen + arrowLen + arrowPaddingMax + normalizedTetherOffsetValue.mainAxis;
    var arrowOffsetParent = state.elements.arrow && getOffsetParent(state.elements.arrow);
    var clientOffset = arrowOffsetParent ? mainAxis === "y" ? arrowOffsetParent.clientTop || 0 : arrowOffsetParent.clientLeft || 0 : 0;
    var offsetModifierValue = (_offsetModifierState$ = offsetModifierState == null ? void 0 : offsetModifierState[mainAxis]) != null ? _offsetModifierState$ : 0;
    var tetherMin = offset2 + minOffset - offsetModifierValue - clientOffset;
    var tetherMax = offset2 + maxOffset - offsetModifierValue;
    var preventedOffset = within(tether ? min(min2, tetherMin) : min2, offset2, tether ? max(max2, tetherMax) : max2);
    popperOffsets2[mainAxis] = preventedOffset;
    data[mainAxis] = preventedOffset - offset2;
  }
  if (checkAltAxis) {
    var _offsetModifierState$2;
    var _mainSide = mainAxis === "x" ? top : left;
    var _altSide = mainAxis === "x" ? bottom : right;
    var _offset = popperOffsets2[altAxis];
    var _len = altAxis === "y" ? "height" : "width";
    var _min = _offset + overflow[_mainSide];
    var _max = _offset - overflow[_altSide];
    var isOriginSide = [top, left].indexOf(basePlacement) !== -1;
    var _offsetModifierValue = (_offsetModifierState$2 = offsetModifierState == null ? void 0 : offsetModifierState[altAxis]) != null ? _offsetModifierState$2 : 0;
    var _tetherMin = isOriginSide ? _min : _offset - referenceRect[_len] - popperRect[_len] - _offsetModifierValue + normalizedTetherOffsetValue.altAxis;
    var _tetherMax = isOriginSide ? _offset + referenceRect[_len] + popperRect[_len] - _offsetModifierValue - normalizedTetherOffsetValue.altAxis : _max;
    var _preventedOffset = tether && isOriginSide ? withinMaxClamp(_tetherMin, _offset, _tetherMax) : within(tether ? _tetherMin : _min, _offset, tether ? _tetherMax : _max);
    popperOffsets2[altAxis] = _preventedOffset;
    data[altAxis] = _preventedOffset - _offset;
  }
  state.modifiersData[name] = data;
}
var preventOverflow_default = {
  name: "preventOverflow",
  enabled: true,
  phase: "main",
  fn: preventOverflow,
  requiresIfExists: ["offset"]
};

// node_modules/@popperjs/core/lib/dom-utils/getHTMLElementScroll.js
function getHTMLElementScroll(element) {
  return {
    scrollLeft: element.scrollLeft,
    scrollTop: element.scrollTop
  };
}

// node_modules/@popperjs/core/lib/dom-utils/getNodeScroll.js
function getNodeScroll(node) {
  if (node === getWindow(node) || !isHTMLElement(node)) {
    return getWindowScroll(node);
  } else {
    return getHTMLElementScroll(node);
  }
}

// node_modules/@popperjs/core/lib/dom-utils/getCompositeRect.js
function isElementScaled(element) {
  var rect = element.getBoundingClientRect();
  var scaleX = round(rect.width) / element.offsetWidth || 1;
  var scaleY = round(rect.height) / element.offsetHeight || 1;
  return scaleX !== 1 || scaleY !== 1;
}
function getCompositeRect(elementOrVirtualElement, offsetParent, isFixed) {
  if (isFixed === void 0) {
    isFixed = false;
  }
  var isOffsetParentAnElement = isHTMLElement(offsetParent);
  var offsetParentIsScaled = isHTMLElement(offsetParent) && isElementScaled(offsetParent);
  var documentElement = getDocumentElement(offsetParent);
  var rect = getBoundingClientRect(elementOrVirtualElement, offsetParentIsScaled);
  var scroll = {
    scrollLeft: 0,
    scrollTop: 0
  };
  var offsets = {
    x: 0,
    y: 0
  };
  if (isOffsetParentAnElement || !isOffsetParentAnElement && !isFixed) {
    if (getNodeName(offsetParent) !== "body" || isScrollParent(documentElement)) {
      scroll = getNodeScroll(offsetParent);
    }
    if (isHTMLElement(offsetParent)) {
      offsets = getBoundingClientRect(offsetParent, true);
      offsets.x += offsetParent.clientLeft;
      offsets.y += offsetParent.clientTop;
    } else if (documentElement) {
      offsets.x = getWindowScrollBarX(documentElement);
    }
  }
  return {
    x: rect.left + scroll.scrollLeft - offsets.x,
    y: rect.top + scroll.scrollTop - offsets.y,
    width: rect.width,
    height: rect.height
  };
}

// node_modules/@popperjs/core/lib/utils/orderModifiers.js
function order(modifiers) {
  var map = /* @__PURE__ */ new Map();
  var visited = /* @__PURE__ */ new Set();
  var result = [];
  modifiers.forEach(function(modifier) {
    map.set(modifier.name, modifier);
  });
  function sort(modifier) {
    visited.add(modifier.name);
    var requires = [].concat(modifier.requires || [], modifier.requiresIfExists || []);
    requires.forEach(function(dep) {
      if (!visited.has(dep)) {
        var depModifier = map.get(dep);
        if (depModifier) {
          sort(depModifier);
        }
      }
    });
    result.push(modifier);
  }
  modifiers.forEach(function(modifier) {
    if (!visited.has(modifier.name)) {
      sort(modifier);
    }
  });
  return result;
}
function orderModifiers(modifiers) {
  var orderedModifiers = order(modifiers);
  return modifierPhases.reduce(function(acc, phase) {
    return acc.concat(orderedModifiers.filter(function(modifier) {
      return modifier.phase === phase;
    }));
  }, []);
}

// node_modules/@popperjs/core/lib/utils/debounce.js
function debounce(fn2) {
  var pending;
  return function() {
    if (!pending) {
      pending = new Promise(function(resolve) {
        Promise.resolve().then(function() {
          pending = void 0;
          resolve(fn2());
        });
      });
    }
    return pending;
  };
}

// node_modules/@popperjs/core/lib/utils/format.js
function format(str) {
  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
    args[_key - 1] = arguments[_key];
  }
  return [].concat(args).reduce(function(p, c) {
    return p.replace(/%s/, c);
  }, str);
}

// node_modules/@popperjs/core/lib/utils/validateModifiers.js
var INVALID_MODIFIER_ERROR = 'Popper: modifier "%s" provided an invalid %s property, expected %s but got %s';
var MISSING_DEPENDENCY_ERROR = 'Popper: modifier "%s" requires "%s", but "%s" modifier is not available';
var VALID_PROPERTIES = ["name", "enabled", "phase", "fn", "effect", "requires", "options"];
function validateModifiers(modifiers) {
  modifiers.forEach(function(modifier) {
    [].concat(Object.keys(modifier), VALID_PROPERTIES).filter(function(value, index, self) {
      return self.indexOf(value) === index;
    }).forEach(function(key) {
      switch (key) {
        case "name":
          if (typeof modifier.name !== "string") {
            console.error(format(INVALID_MODIFIER_ERROR, String(modifier.name), '"name"', '"string"', '"' + String(modifier.name) + '"'));
          }
          break;
        case "enabled":
          if (typeof modifier.enabled !== "boolean") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"enabled"', '"boolean"', '"' + String(modifier.enabled) + '"'));
          }
          break;
        case "phase":
          if (modifierPhases.indexOf(modifier.phase) < 0) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"phase"', "either " + modifierPhases.join(", "), '"' + String(modifier.phase) + '"'));
          }
          break;
        case "fn":
          if (typeof modifier.fn !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"fn"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "effect":
          if (modifier.effect != null && typeof modifier.effect !== "function") {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"effect"', '"function"', '"' + String(modifier.fn) + '"'));
          }
          break;
        case "requires":
          if (modifier.requires != null && !Array.isArray(modifier.requires)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requires"', '"array"', '"' + String(modifier.requires) + '"'));
          }
          break;
        case "requiresIfExists":
          if (!Array.isArray(modifier.requiresIfExists)) {
            console.error(format(INVALID_MODIFIER_ERROR, modifier.name, '"requiresIfExists"', '"array"', '"' + String(modifier.requiresIfExists) + '"'));
          }
          break;
        case "options":
        case "data":
          break;
        default:
          console.error('PopperJS: an invalid property has been provided to the "' + modifier.name + '" modifier, valid properties are ' + VALID_PROPERTIES.map(function(s) {
            return '"' + s + '"';
          }).join(", ") + '; but "' + key + '" was provided.');
      }
      modifier.requires && modifier.requires.forEach(function(requirement) {
        if (modifiers.find(function(mod) {
          return mod.name === requirement;
        }) == null) {
          console.error(format(MISSING_DEPENDENCY_ERROR, String(modifier.name), requirement, requirement));
        }
      });
    });
  });
}

// node_modules/@popperjs/core/lib/utils/uniqueBy.js
function uniqueBy(arr, fn2) {
  var identifiers = /* @__PURE__ */ new Set();
  return arr.filter(function(item) {
    var identifier = fn2(item);
    if (!identifiers.has(identifier)) {
      identifiers.add(identifier);
      return true;
    }
  });
}

// node_modules/@popperjs/core/lib/utils/mergeByName.js
function mergeByName(modifiers) {
  var merged = modifiers.reduce(function(merged2, current) {
    var existing = merged2[current.name];
    merged2[current.name] = existing ? Object.assign({}, existing, current, {
      options: Object.assign({}, existing.options, current.options),
      data: Object.assign({}, existing.data, current.data)
    }) : current;
    return merged2;
  }, {});
  return Object.keys(merged).map(function(key) {
    return merged[key];
  });
}

// node_modules/@popperjs/core/lib/createPopper.js
var INVALID_ELEMENT_ERROR = "Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.";
var INFINITE_LOOP_ERROR = "Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.";
var DEFAULT_OPTIONS = {
  placement: "bottom",
  modifiers: [],
  strategy: "absolute"
};
function areValidElements() {
  for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {
    args[_key] = arguments[_key];
  }
  return !args.some(function(element) {
    return !(element && typeof element.getBoundingClientRect === "function");
  });
}
function popperGenerator(generatorOptions) {
  if (generatorOptions === void 0) {
    generatorOptions = {};
  }
  var _generatorOptions = generatorOptions, _generatorOptions$def = _generatorOptions.defaultModifiers, defaultModifiers2 = _generatorOptions$def === void 0 ? [] : _generatorOptions$def, _generatorOptions$def2 = _generatorOptions.defaultOptions, defaultOptions = _generatorOptions$def2 === void 0 ? DEFAULT_OPTIONS : _generatorOptions$def2;
  return function createPopper2(reference2, popper2, options) {
    if (options === void 0) {
      options = defaultOptions;
    }
    var state = {
      placement: "bottom",
      orderedModifiers: [],
      options: Object.assign({}, DEFAULT_OPTIONS, defaultOptions),
      modifiersData: {},
      elements: {
        reference: reference2,
        popper: popper2
      },
      attributes: {},
      styles: {}
    };
    var effectCleanupFns = [];
    var isDestroyed = false;
    var instance = {
      state,
      setOptions: function setOptions(setOptionsAction) {
        var options2 = typeof setOptionsAction === "function" ? setOptionsAction(state.options) : setOptionsAction;
        cleanupModifierEffects();
        state.options = Object.assign({}, defaultOptions, state.options, options2);
        state.scrollParents = {
          reference: isElement(reference2) ? listScrollParents(reference2) : reference2.contextElement ? listScrollParents(reference2.contextElement) : [],
          popper: listScrollParents(popper2)
        };
        var orderedModifiers = orderModifiers(mergeByName([].concat(defaultModifiers2, state.options.modifiers)));
        state.orderedModifiers = orderedModifiers.filter(function(m) {
          return m.enabled;
        });
        if (true) {
          var modifiers = uniqueBy([].concat(orderedModifiers, state.options.modifiers), function(_ref) {
            var name = _ref.name;
            return name;
          });
          validateModifiers(modifiers);
          if (getBasePlacement(state.options.placement) === auto) {
            var flipModifier = state.orderedModifiers.find(function(_ref2) {
              var name = _ref2.name;
              return name === "flip";
            });
            if (!flipModifier) {
              console.error(['Popper: "auto" placements require the "flip" modifier be', "present and enabled to work."].join(" "));
            }
          }
          var _getComputedStyle = getComputedStyle(popper2), marginTop = _getComputedStyle.marginTop, marginRight = _getComputedStyle.marginRight, marginBottom = _getComputedStyle.marginBottom, marginLeft = _getComputedStyle.marginLeft;
          if ([marginTop, marginRight, marginBottom, marginLeft].some(function(margin) {
            return parseFloat(margin);
          })) {
            console.warn(['Popper: CSS "margin" styles cannot be used to apply padding', "between the popper and its reference element or boundary.", "To replicate margin, use the `offset` modifier, as well as", "the `padding` option in the `preventOverflow` and `flip`", "modifiers."].join(" "));
          }
        }
        runModifierEffects();
        return instance.update();
      },
      forceUpdate: function forceUpdate() {
        if (isDestroyed) {
          return;
        }
        var _state$elements = state.elements, reference3 = _state$elements.reference, popper3 = _state$elements.popper;
        if (!areValidElements(reference3, popper3)) {
          if (true) {
            console.error(INVALID_ELEMENT_ERROR);
          }
          return;
        }
        state.rects = {
          reference: getCompositeRect(reference3, getOffsetParent(popper3), state.options.strategy === "fixed"),
          popper: getLayoutRect(popper3)
        };
        state.reset = false;
        state.placement = state.options.placement;
        state.orderedModifiers.forEach(function(modifier) {
          return state.modifiersData[modifier.name] = Object.assign({}, modifier.data);
        });
        var __debug_loops__ = 0;
        for (var index = 0; index < state.orderedModifiers.length; index++) {
          if (true) {
            __debug_loops__ += 1;
            if (__debug_loops__ > 100) {
              console.error(INFINITE_LOOP_ERROR);
              break;
            }
          }
          if (state.reset === true) {
            state.reset = false;
            index = -1;
            continue;
          }
          var _state$orderedModifie = state.orderedModifiers[index], fn2 = _state$orderedModifie.fn, _state$orderedModifie2 = _state$orderedModifie.options, _options = _state$orderedModifie2 === void 0 ? {} : _state$orderedModifie2, name = _state$orderedModifie.name;
          if (typeof fn2 === "function") {
            state = fn2({
              state,
              options: _options,
              name,
              instance
            }) || state;
          }
        }
      },
      update: debounce(function() {
        return new Promise(function(resolve) {
          instance.forceUpdate();
          resolve(state);
        });
      }),
      destroy: function destroy() {
        cleanupModifierEffects();
        isDestroyed = true;
      }
    };
    if (!areValidElements(reference2, popper2)) {
      if (true) {
        console.error(INVALID_ELEMENT_ERROR);
      }
      return instance;
    }
    instance.setOptions(options).then(function(state2) {
      if (!isDestroyed && options.onFirstUpdate) {
        options.onFirstUpdate(state2);
      }
    });
    function runModifierEffects() {
      state.orderedModifiers.forEach(function(_ref3) {
        var name = _ref3.name, _ref3$options = _ref3.options, options2 = _ref3$options === void 0 ? {} : _ref3$options, effect4 = _ref3.effect;
        if (typeof effect4 === "function") {
          var cleanupFn = effect4({
            state,
            name,
            instance,
            options: options2
          });
          var noopFn = function noopFn2() {
          };
          effectCleanupFns.push(cleanupFn || noopFn);
        }
      });
    }
    function cleanupModifierEffects() {
      effectCleanupFns.forEach(function(fn2) {
        return fn2();
      });
      effectCleanupFns = [];
    }
    return instance;
  };
}

// node_modules/@popperjs/core/lib/popper.js
var defaultModifiers = [eventListeners_default, popperOffsets_default, computeStyles_default, applyStyles_default, offset_default, flip_default, preventOverflow_default, arrow_default, hide_default];
var createPopper = /* @__PURE__ */ popperGenerator({
  defaultModifiers
});

// src/suggester/suggest.ts
var wrapAround = (value, size) => {
  return (value % size + size) % size;
};
var Suggest = class {
  constructor(owner, containerEl, scope) {
    this.owner = owner;
    this.containerEl = containerEl;
    containerEl.on("click", ".suggestion-item", this.onSuggestionClick.bind(this));
    containerEl.on("mousemove", ".suggestion-item", this.onSuggestionMouseover.bind(this));
    scope.register([], "ArrowUp", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem - 1, true);
        return false;
      }
    });
    scope.register([], "ArrowDown", (event) => {
      if (!event.isComposing) {
        this.setSelectedItem(this.selectedItem + 1, true);
        return false;
      }
    });
    scope.register([], "Enter", (event) => {
      if (!event.isComposing) {
        this.useSelectedItem(event);
        return false;
      }
    });
  }
  onSuggestionClick(event, el) {
    event.preventDefault();
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
    this.useSelectedItem(event);
  }
  onSuggestionMouseover(_event, el) {
    const item = this.suggestions.indexOf(el);
    this.setSelectedItem(item, false);
  }
  setSuggestions(values) {
    this.containerEl.empty();
    const suggestionEls = [];
    values.forEach((value) => {
      const suggestionEl = this.containerEl.createDiv("suggestion-item");
      this.owner.renderSuggestion(value, suggestionEl);
      suggestionEls.push(suggestionEl);
    });
    this.values = values;
    this.suggestions = suggestionEls;
    this.setSelectedItem(0, false);
  }
  useSelectedItem(event) {
    const currentValue = this.values[this.selectedItem];
    if (currentValue) {
      this.owner.selectSuggestion(currentValue, event);
    }
  }
  setSelectedItem(selectedIndex, scrollIntoView) {
    const normalizedIndex = wrapAround(selectedIndex, this.suggestions.length);
    const prevSelectedSuggestion = this.suggestions[this.selectedItem];
    const selectedSuggestion = this.suggestions[normalizedIndex];
    prevSelectedSuggestion == null ? void 0 : prevSelectedSuggestion.removeClass("is-selected");
    selectedSuggestion == null ? void 0 : selectedSuggestion.addClass("is-selected");
    this.selectedItem = normalizedIndex;
    if (scrollIntoView) {
      selectedSuggestion.scrollIntoView(false);
    }
  }
};
var TextInputSuggest = class {
  constructor(app2, inputEl) {
    this.app = app2;
    this.inputEl = inputEl;
    this.scope = new import_obsidian9.Scope();
    this.suggestEl = createDiv("suggestion-container");
    const suggestion = this.suggestEl.createDiv("suggestion");
    this.suggest = new Suggest(this, suggestion, this.scope);
    this.scope.register([], "Escape", this.close.bind(this));
    this.inputEl.addEventListener("input", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("focus", this.onInputChanged.bind(this));
    this.inputEl.addEventListener("blur", this.close.bind(this));
    this.suggestEl.on("mousedown", ".suggestion-container", (event) => {
      event.preventDefault();
    });
  }
  onInputChanged() {
    const inputStr = this.inputEl.value;
    const suggestions = this.getSuggestions(inputStr);
    if (!suggestions) {
      this.close();
      return;
    }
    if (suggestions.length > 0) {
      this.suggest.setSuggestions(suggestions);
      this.open(this.app.dom.appContainerEl, this.inputEl);
    } else {
      this.close();
    }
  }
  open(container, inputEl) {
    this.app.keymap.pushScope(this.scope);
    container.appendChild(this.suggestEl);
    this.popper = createPopper(inputEl, this.suggestEl, {
      placement: "bottom-start",
      modifiers: [
        {
          name: "sameWidth",
          enabled: true,
          fn: ({ state, instance }) => {
            const targetWidth = `${state.rects.reference.width}px`;
            if (state.styles.popper.width === targetWidth) {
              return;
            }
            state.styles.popper.width = targetWidth;
            instance.update();
          },
          phase: "beforeWrite",
          requires: ["computeStyles"]
        }
      ]
    });
  }
  close() {
    this.app.keymap.popScope(this.scope);
    this.suggest.setSuggestions([]);
    if (this.popper)
      this.popper.destroy();
    this.suggestEl.detach();
  }
};

// src/utils/fileUtils.ts
var import_obsidian10 = require("obsidian");
function resolve_tfolder(app2, folder_str) {
  folder_str = (0, import_obsidian10.normalizePath)(folder_str);
  const folder = app2.vault.getAbstractFileByPath(folder_str);
  if (!folder) {
    throw new Error(`Folder "${folder_str}" doesn't exist`);
  }
  if (!(folder instanceof import_obsidian10.TFolder)) {
    throw new Error(`${folder_str} is a file, not a folder`);
  }
  return folder;
}
function get_tfiles_from_folder(app2, folder_str) {
  const folder = resolve_tfolder(app2, folder_str);
  const files = [];
  import_obsidian10.Vault.recurseChildren(folder, (file) => {
    if (file instanceof import_obsidian10.TFile) {
      files.push(file);
    }
  });
  files.sort((a, b) => {
    return a.basename.localeCompare(b.basename);
  });
  return files;
}

// src/suggester/FileSuggester.ts
var FileSuggest = class extends TextInputSuggest {
  constructor(app2, inputEl, plugin, folder) {
    super(app2, inputEl);
    this.app = app2;
    this.inputEl = inputEl;
    this.plugin = plugin;
    this.folder = folder;
  }
  getSuggestions(input_str) {
    const all_files = [];
    try {
      all_files.push(...get_tfiles_from_folder(this.app, this.folder));
    } catch (error) {
    }
    const files = [];
    const lower_input_str = input_str.toLowerCase();
    all_files.forEach((file) => {
      if (file instanceof import_obsidian11.TFile && file.extension === "md" && file.path.toLowerCase().contains(lower_input_str)) {
        files.push(file);
      }
    });
    return files;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/fields/fieldManagers/AbstractListBasedField.ts
var AbstractListBasedField = class extends FieldManager2 {
  constructor(field, type) {
    super(field, type);
  }
  setValueListText(header) {
    header.setText(`Preset options: ${Object.values(this.field.options).join(", ")}`);
  }
  createListNoteContainer(parentNode, plugin) {
    const listNoteContainerLabel = parentNode.createDiv({ cls: "metadata-menu-setting-fileClass-search" });
    listNoteContainerLabel.setText(`Path of the note containing the values:`);
    const input = new import_obsidian12.TextComponent(listNoteContainerLabel);
    new FileSuggest(plugin.app, input.inputEl, plugin, "/");
    const listNotePath = this.field.valuesListNotePath;
    input.setValue(listNotePath);
    input.setPlaceholder("Path/of/the/note.md");
    input.onChange((value) => this.field.valuesListNotePath = value);
  }
  removePresetValue(key) {
    let newValues = {};
    for (let _key in this.field.options) {
      if (key !== _key) {
        newValues[_key] = this.field.options[_key];
      }
      ;
    }
    ;
    this.field.options = newValues;
  }
  createValueContainer(parentNode, header, key) {
    const options = this.field.options;
    const presetValue = options[key];
    const valueContainer = parentNode.createDiv({
      cls: "metadata-menu-prompt-container"
    });
    const input = new import_obsidian12.TextComponent(valueContainer);
    this.valuesPromptComponents.push(input);
    input.setValue(presetValue);
    input.onChange((value) => {
      this.field.options[key] = value;
      this.setValueListText(header);
      FieldSettingsModal.removeValidationError(input);
    });
    const valueRemoveButton = new import_obsidian12.ButtonComponent(valueContainer);
    valueRemoveButton.setIcon("trash").onClick((evt) => {
      evt.preventDefault;
      this.removePresetValue(key);
      this.setValueListText(header);
      parentNode.removeChild(valueContainer);
      this.valuesPromptComponents.remove(input);
    });
    if (key != Object.keys(this.field.options)[0]) {
      const valueUpgradeButton = new import_obsidian12.ButtonComponent(valueContainer);
      valueUpgradeButton.setButtonText("\u25B2");
      valueUpgradeButton.onClick((evt) => {
        const thisValue = options[key];
        const inputIndex = this.valuesPromptComponents.indexOf(input);
        const upperComponent = inputIndex !== -1 ? this.valuesPromptComponents[inputIndex - 1] : this.valuesPromptComponents.last();
        if (upperComponent) {
          const upperValue = upperComponent.inputEl.value;
          const upperKey = Object.keys(options).filter((k) => options[k] == upperValue)[0];
          if (upperKey) {
            upperComponent.setValue(thisValue);
            options[upperKey] = thisValue;
            input.setValue(upperValue);
            options[key] = upperValue;
          }
          ;
        }
        ;
      });
    }
    ;
    return input;
  }
  validateValue(value) {
    return __async(this, null, function* () {
      if (this.field.options && Object.values(this.field.options).length > 0) {
        return Object.values(this.field.options).includes(value.trim());
      } else if (this.field.valuesListNotePath) {
        const listNoteValues = yield FieldSetting.getValuesListFromNote(this.field.valuesListNotePath, app);
        return listNoteValues.contains(value.trim());
      } else {
        return false;
      }
    });
  }
  getOptionsStr() {
    if (this.field.valuesListNotePath)
      return this.field.valuesListNotePath;
    else if (Object.values(this.field.options).length)
      return Object.values(this.field.options).join(", ");
    else
      return "";
  }
  validateOptions() {
    let error = false;
    this.valuesPromptComponents.forEach((input) => {
      var _a, _b, _c;
      if (/^[#>-]/.test(input.inputEl.value) && ((_a = input.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values cannot cannot start with #, >, -");
        error = true;
      }
      ;
      if (/[,]/gu.test(input.inputEl.value) && ((_b = input.inputEl.parentElement) == null ? void 0 : _b.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values cannot contain a comma");
        error = true;
      }
      ;
      if (input.inputEl.value == "" && ((_c = input.inputEl.parentElement) == null ? void 0 : _c.lastElementChild)) {
        FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values can't be null.");
        error = true;
      }
      ;
    });
    return !error;
  }
  createAddButton(valuesList, valuesListBody, valuesListHeader) {
    const valuesListFooter = valuesList.createDiv();
    const addValue = valuesListFooter.createEl("button");
    addValue.type = "button";
    addValue.textContent = "Add";
    addValue.onClickEvent((evt) => __async(this, null, function* () {
      evt.preventDefault;
      const newKey = yield this.field.insertNewValue("");
      this.createValueContainer(valuesListBody, valuesListHeader, newKey);
    }));
    valuesList.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  createSettingContainer(parentContainer, plugin, location) {
    if (location === 0 /* PluginSettings */)
      this.createListNoteContainer(parentContainer, plugin);
    this.presetValuesFields = parentContainer.createDiv();
    this.presetValuesFields.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
    const valuesList = this.presetValuesFields.createDiv();
    const valuesListHeader = valuesList.createDiv();
    valuesListHeader.createEl("h2");
    valuesListHeader.setText(`Preset options: ${Object.values(this.field.options).join(", ")}`);
    const valuesListBody = valuesList.createDiv();
    Object.keys(this.field.options).forEach((key) => {
      this.valuesPromptComponents.push(this.createValueContainer(valuesListBody, valuesListHeader, key));
    });
    this.createAddButton(valuesList, valuesListBody, valuesListHeader);
  }
  createDvField(plugin, dv, p, fieldContainer, attrs) {
    return __async(this, null, function* () {
      const fieldValue = dv.el("span", p[this.field.name]);
      fieldContainer.appendChild(fieldValue);
    });
  }
};

// src/optionModals/valueSelectModal.ts
var import_obsidian13 = require("obsidian");
var valueSelectModal = class extends import_obsidian13.Modal {
  constructor(app2, file, value, field, lineNumber = -1, inFrontMatter = false, top2 = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.field = field;
    this.value = value;
    this.newValue = null;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top2;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.containerEl.addClass("metadata-menu");
      const inputDiv = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
      yield this.buildInputEl(inputDiv);
    });
  }
  buildInputEl(inputDiv) {
    return __async(this, null, function* () {
      const selectEl = new import_obsidian13.DropdownComponent(inputDiv);
      selectEl.selectEl.addClass("metadata-menu-select");
      const options = this.field.options;
      selectEl.addOption("", "--Empty--");
      const listNoteValues = yield FieldSetting.getValuesListFromNote(this.field.valuesListNotePath, this.app);
      listNoteValues.forEach((value) => selectEl.addOption(value, value));
      if (listNoteValues.includes(this.value)) {
        selectEl.setValue(this.value);
      }
      ;
      if (listNoteValues.length === 0) {
        Object.keys(options).forEach((key) => {
          selectEl.addOption(options[key], options[key]);
        });
        if (Object.values(options).includes(this.value)) {
          selectEl.setValue(this.value);
        }
        ;
      }
      selectEl.onChange((value) => this.newValue = value != "--Empty--" ? value : "");
      const submitButton = new import_obsidian13.ButtonComponent(inputDiv);
      submitButton.setTooltip("Save").setIcon("checkmark").onClick(() => __async(this, null, function* () {
        if (this.lineNumber == -1) {
          if (this.newValue || this.newValue == "") {
            replaceValues(this.app, this.file, this.field.name, this.newValue);
          }
          ;
        } else {
          insertValues(this.app, this.file, this.field.name, selectEl.getValue(), this.lineNumber, this.inFrontmatter, this.top);
        }
        ;
        this.close();
      }));
    });
  }
};

// src/fields/fieldManagers/SelectField.ts
var SelectField = class extends AbstractListBasedField {
  constructor(field) {
    super(field, "Select" /* Select */);
    this.valuesPromptComponents = [];
  }
  addMenuOption(name, value, app2, file, category) {
    const modal = new valueSelectModal(app2, file, value, this.field);
    modal.titleEl.setText("Select value");
    if (SelectField.isMenu(category)) {
      category.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon("right-triangle");
        item.onClick(() => modal.open());
        item.setSection("target-metadata");
      });
    } else if (SelectField.isSelect(category)) {
      category.addOption(`update_${name}`, `Update <${name}>`);
      category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
  createAndOpenFieldModal(app2, file, selectedFieldName, lineNumber, inFrontmatter, top2) {
    const fieldModal = new valueSelectModal(app2, file, "", this.field, lineNumber, inFrontmatter, top2);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(plugin, dv, p, fieldContainer, attrs) {
    return __async(this, null, function* () {
      const valueContainer = document.createElement("div");
      ;
      const valueLabel = dv.el("span", p[this.field.name] || "");
      valueContainer.appendChild(valueLabel);
      const dropDownButton = document.createElement("button");
      dropDownButton.setText("\u{1F53D}");
      dropDownButton.addClass("metadata-menu-dv-field-button");
      valueContainer.appendChild(dropDownButton);
      const selectContainer = document.createElement("div");
      const select = document.createElement("select");
      select.setAttr("class", "metadata-menu-dv-select");
      selectContainer.appendChild(select);
      const dismissBtn = document.createElement("button");
      dismissBtn.setText("\u274C");
      dismissBtn.addClass("metadata-menu-dv-field-button");
      selectContainer.appendChild(dismissBtn);
      const nullOption = new Option("--select--", void 0);
      select.add(nullOption);
      const listNoteValues = yield FieldSetting.getValuesListFromNote(this.field.valuesListNotePath, plugin.app);
      if (listNoteValues.length) {
        listNoteValues.forEach((o) => {
          const option = new Option(o, o);
          if (p[this.field.name] === o || p[this.field.name] && Object.keys(p[this.field.name]).includes("path") && `[[${p[this.field.name].path.replace(".md", "")}]]` === o) {
            option.selected = true;
          }
          select.add(option);
          select.onchange = () => {
            let newValue = "";
            if (select.value !== void 0) {
              newValue = select.value;
            }
            fieldContainer.removeChild(selectContainer);
            fieldContainer.appendChild(valueContainer);
            SelectField.replaceValues(plugin.app, p["file"]["path"], this.field.name, newValue);
          };
        });
      } else {
        Object.keys(this.field.options).forEach((o) => {
          const option = new Option(this.field.options[o], o);
          if (p[this.field.name] === this.field.options[o] || p[this.field.name] && Object.keys(p[this.field.name]).includes("path") && `[[${p[this.field.name].path.replace(".md", "")}]]` === this.field.options[o]) {
            option.selected = true;
          }
          select.add(option);
          select.onchange = () => {
            let newValue = "";
            if (select.value !== void 0) {
              newValue = this.field.options[select.value];
            }
            fieldContainer.removeChild(selectContainer);
            fieldContainer.appendChild(valueContainer);
            SelectField.replaceValues(plugin.app, p["file"]["path"], this.field.name, newValue);
          };
        });
      }
      dropDownButton.onclick = () => {
        fieldContainer.removeChild(valueContainer);
        fieldContainer.appendChild(selectContainer);
      };
      dismissBtn.onclick = () => {
        fieldContainer.removeChild(selectContainer);
        fieldContainer.appendChild(valueContainer);
      };
      fieldContainer.appendChild(valueContainer);
    });
  }
};

// src/fields/fieldManagers/CycleField.ts
var CycleField = class extends AbstractListBasedField {
  constructor(field) {
    super(field, "Cycle" /* Cycle */);
    this.valuesPromptComponents = [];
  }
  addMenuOption(name, value, app2, file, category) {
    const options = this.field.options;
    const keys = Object.keys(options);
    const keyForValue = keys.find((key) => options[key] === value);
    let nextOption;
    if (keyForValue) {
      const nextKey = keys[(keys.indexOf(keyForValue) + 1) % keys.length];
      nextOption = options[nextKey];
    } else {
      nextOption = options[Object.keys(options)[0]];
    }
    ;
    if (CycleField.isMenu(category)) {
      category.addItem((item) => {
        item.setTitle(`${name} : ${value} \u25B7 ${nextOption}`);
        item.setIcon("switch");
        item.onClick(() => replaceValues(app2, file, name, nextOption));
        item.setSection("target-metadata");
      });
    } else if (CycleField.isSelect(category)) {
      category.addOption(`${name}_${value}_${nextOption}`, `${name} : ${value} \u25B7 ${nextOption}`);
      category.modals[`${name}_${value}_${nextOption}`] = () => replaceValues(app2, file, name, nextOption);
    }
    ;
  }
  createAndOpenFieldModal(app2, file, selectedFieldName, lineNumber, inFrontmatter, top2) {
    const fieldModal = new valueSelectModal(app2, file, "", this.field, lineNumber, inFrontmatter, top2);
    fieldModal.titleEl.setText(`Select option for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(plugin, dv, p, fieldContainer, attrs) {
    return __async(this, null, function* () {
      const options = this.field.options;
      const keys = Object.keys(options);
      const keyForValue = keys.find((key) => options[key] === p[this.field.name]);
      let nextOption;
      if (keyForValue) {
        const nextKey = keys[(keys.indexOf(keyForValue) + 1) % keys.length];
        nextOption = options[nextKey];
      } else {
        nextOption = options[Object.keys(options)[0]];
      }
      ;
      const fieldValue = dv.el("span", p[this.field.name], attrs);
      const spacer = document.createElement("div");
      spacer.setAttr("class", "metadata-menu-dv-field-spacer");
      const button = document.createElement("button");
      button.setText("\u25B6\uFE0F");
      button.setAttr("class", "metadata-menu-dv-field-button");
      button.hide();
      spacer.show();
      fieldContainer.onmouseover = () => {
        button.show();
        spacer.hide();
      };
      fieldContainer.onmouseout = () => {
        button.hide();
        spacer.show();
      };
      button.onclick = (e) => {
        CycleField.replaceValues(plugin.app, p["file"]["path"], this.field.name, nextOption);
        button.hide();
        spacer.show();
      };
      fieldContainer.appendChild(button);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(spacer);
    });
  }
};

// src/optionModals/valueMultiSelectModal.ts
var import_obsidian14 = require("obsidian");
var valueMultiSelectModal = class extends import_obsidian14.Modal {
  constructor(app2, file, field, initialOptions, lineNumber = -1, inFrontMatter = false, top2 = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.field = field;
    if (initialOptions) {
      if (initialOptions.toString().startsWith("[[")) {
        this.options = initialOptions.split(",").map((item) => item.trim());
      } else {
        this.options = initialOptions.toString().replace(/^\[(.*)\]$/, "$1").split(",").map((item) => item.trim());
      }
      ;
    } else {
      this.options = [];
    }
    ;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top2;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.containerEl.addClass("metadata-menu");
      const valueGrid = this.contentEl.createDiv({
        cls: "metadata-menu-value-grid"
      });
      const listNoteValues = yield FieldSetting.getValuesListFromNote(this.field.valuesListNotePath, this.app);
      yield this.populateValuesGrid(valueGrid, listNoteValues);
    });
  }
  populateValuesGrid(valueGrid, listNoteValues) {
    return __async(this, null, function* () {
      if (listNoteValues.length === 0) {
        Object.keys(this.field.options).forEach((key) => {
          const presetValue = this.field.options[key];
          this.buildValueToggler(valueGrid, presetValue);
        });
      }
      ;
      listNoteValues.forEach((value) => {
        this.buildValueToggler(valueGrid, value);
      });
      const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
      const saveButton = new import_obsidian14.ButtonComponent(footer);
      saveButton.setIcon("checkmark");
      saveButton.onClick(() => __async(this, null, function* () {
        if (this.lineNumber == -1) {
          replaceValues(this.app, this.file, this.field.name, this.options.join(","));
        } else {
          const renderedValues = !this.inFrontmatter ? this.options.join(",") : this.options.length > 1 ? `[${this.options.join(", ")}]` : this.options[0];
          insertValues(this.app, this.file, this.field.name, renderedValues, this.lineNumber, this.inFrontmatter, this.top);
        }
        ;
        this.close();
      }));
      const cancelButton = new import_obsidian14.ExtraButtonComponent(footer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => this.close());
    });
  }
  buildValueToggler(valueGrid, presetOption) {
    const valueSelectorContainer = valueGrid.createDiv({
      cls: "metadata-menu-value-selector-container"
    });
    const valueTogglerContainer = valueSelectorContainer.createDiv({
      cls: "metadata-menu-value-selector-toggler"
    });
    const valueToggler = new import_obsidian14.ToggleComponent(valueTogglerContainer);
    this.options.forEach((options) => {
      if (options == presetOption) {
        valueToggler.setValue(true);
      }
      ;
    });
    valueToggler.onChange((value) => {
      if (value && !this.options.includes(presetOption)) {
        this.options.push(presetOption);
      }
      ;
      if (!value) {
        this.options.remove(presetOption);
      }
      ;
    });
    const valueLabel = valueSelectorContainer.createDiv({ cls: "metadata-menu-value-selector-label" });
    valueLabel.setText(presetOption);
  }
};

// src/fields/fieldManagers/MultiField.ts
var MultiField = class extends AbstractListBasedField {
  constructor(field) {
    super(field, "Multi" /* Multi */);
    this.valuesPromptComponents = [];
  }
  addMenuOption(name, value, app2, file, category) {
    const modal = new valueMultiSelectModal(app2, file, this.field, value);
    modal.titleEl.setText("Select values");
    if (MultiField.isMenu(category)) {
      category.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon("bullet-list");
        item.onClick(() => modal.open());
        item.setSection("target-metadata");
      });
    } else if (MultiField.isSelect(category)) {
      category.addOption(`update_${name}`, `Update <${name}>`);
      category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
  createAndOpenFieldModal(app2, file, selectedFieldName, lineNumber, inFrontmatter, top2) {
    const fieldModal = new valueMultiSelectModal(app2, file, this.field, "", lineNumber, inFrontmatter, top2);
    fieldModal.titleEl.setText(`Select options for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(plugin, dv, p, fieldContainer, attrs) {
    return __async(this, null, function* () {
      let valueHovered = false;
      let currentValues = [];
      if (p[this.field.name]) {
        if (Object.keys(p[this.field.name]).includes("path")) {
          currentValues = [`[[${p[this.field.name].path.replace(".md", "")}]]`];
        } else if (Array.isArray(p[this.field.name])) {
          currentValues.push(...p[this.field.name].last().split(",").map((v) => v.trim()));
        } else {
          currentValues = p[this.field.name].split(",").map((v) => v.trim());
        }
      }
      const selectContainer = document.createElement("div");
      const select = document.createElement("select");
      select.setAttr("class", "metadata-menu-dv-select");
      selectContainer.appendChild(select);
      const nullOption = new Option("--select--", void 0);
      select.add(nullOption);
      Object.keys(this.field.options).filter((o) => !currentValues.contains(this.field.options[o])).forEach((o) => {
        const option = new Option(this.field.options[o], o);
        if (p[this.field.name] === this.field.options[o]) {
          option.selected = true;
        }
        select.add(option);
      });
      select.onchange = () => {
        const newValues = [...currentValues, this.field.options[select.value]].join(", ");
        MultiField.replaceValues(plugin.app, p["file"]["path"], this.field.name, newValues);
        singleSpacer.hide();
        doubleSpacer.show();
        addBtn.hide();
        fieldContainer.appendChild(valuesContainer);
        fieldContainer.appendChild(singleSpacer);
        fieldContainer.appendChild(doubleSpacer);
        fieldContainer.removeChild(selectContainer);
      };
      select.onkeydown = (e) => {
        if (e.key === "Escape") {
          fieldContainer.appendChild(valuesContainer);
          fieldContainer.appendChild(singleSpacer);
          fieldContainer.appendChild(doubleSpacer);
          fieldContainer.removeChild(selectContainer);
        }
      };
      const closeSelect = document.createElement("button");
      closeSelect.setText("\u274C");
      closeSelect.addClass("metadata-menu-dv-field-button");
      closeSelect.addClass("multi");
      closeSelect.onclick = () => {
        fieldContainer.appendChild(valuesContainer);
        fieldContainer.appendChild(singleSpacer);
        fieldContainer.appendChild(doubleSpacer);
        fieldContainer.removeChild(selectContainer);
      };
      selectContainer.appendChild(closeSelect);
      const valuesContainer = document.createElement("div");
      valuesContainer.addClass("metadata-menu-dv-multi-values-container");
      currentValues.forEach((v) => {
        const valueContainer = document.createElement("div");
        valueContainer.addClass("metadata-menu-dv-multi-values-container");
        const valueRemoveBtn = document.createElement("button");
        valueRemoveBtn.setText("\u274C");
        valueRemoveBtn.addClass("metadata-menu-dv-field-button");
        valueRemoveBtn.addClass("multi");
        valueRemoveBtn.hide();
        valueRemoveBtn.onclick = () => {
          const remainingValues = currentValues.filter((cV) => cV !== v).join(", ");
          MultiField.replaceValues(plugin.app, p["file"]["path"], this.field.name, remainingValues);
        };
        valueContainer.appendChild(valueRemoveBtn);
        const valueLabel = document.createElement("div");
        valueLabel.setText(v);
        valueLabel.addClass("metadata-menu-dv-multi-value-label");
        valueContainer.appendChild(valueLabel);
        valueContainer.onmouseover = () => {
          valueHovered = true;
          doubleSpacer.hide();
          singleSpacer.hide();
          valueRemoveBtn.show();
          valueLabel.addClass("hovered");
        };
        valueContainer.onmouseout = () => {
          valueHovered = false;
          valueRemoveBtn.hide();
          singleSpacer.show();
          doubleSpacer.hide();
          valueLabel.removeClass("hovered");
        };
        valuesContainer.appendChild(valueContainer);
      });
      const addBtn = document.createElement("button");
      addBtn.setText("\u2795");
      addBtn.setAttr("class", "metadata-menu-dv-field-button");
      addBtn.hide();
      valuesContainer.appendChild(addBtn);
      addBtn.onclick = () => {
        fieldContainer.removeChild(valuesContainer);
        fieldContainer.removeChild(singleSpacer);
        fieldContainer.removeChild(doubleSpacer);
        fieldContainer.appendChild(selectContainer);
      };
      const singleSpacer = document.createElement("div");
      singleSpacer.setAttr("class", "metadata-menu-dv-field-spacer");
      const doubleSpacer = document.createElement("div");
      doubleSpacer.setAttr("class", "metadata-menu-dv-field-double-spacer");
      fieldContainer.onmouseover = () => {
        addBtn.show();
        doubleSpacer.hide();
        if (!valueHovered)
          singleSpacer.show();
      };
      fieldContainer.onmouseout = () => {
        addBtn.hide();
        singleSpacer.hide();
        doubleSpacer.show();
      };
      singleSpacer.hide();
      doubleSpacer.show();
      addBtn.hide();
      fieldContainer.appendChild(valuesContainer);
      fieldContainer.appendChild(singleSpacer);
      fieldContainer.appendChild(doubleSpacer);
    });
  }
};

// src/fields/fieldManagers/FileField.ts
var import_obsidian16 = require("obsidian");

// src/optionModals/fileFuzzySuggestModal.ts
var import_obsidian15 = require("obsidian");
var FileFuzzySuggester = class extends import_obsidian15.FuzzySuggestModal {
  constructor(app2, file, field, lineNumber = -1, inFrontMatter = false, top2 = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.field = field;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top2;
  }
  getItems() {
    try {
      const fileManager = new FieldManager[this.field.type](this.field);
      return fileManager.getFiles();
    } catch (error) {
      this.close();
      throw error;
    }
  }
  getItemText(item) {
    return item.basename;
  }
  onChooseItem(item) {
    if (this.lineNumber == -1) {
      replaceValues(this.app, this.file, this.field.name, FileField.buildMarkDownLink(this.app, this.file, item.basename));
    } else {
      insertValues(this.app, this.file, this.field.name, FileField.buildMarkDownLink(this.app, this.file, item.basename), this.lineNumber, this.inFrontmatter, this.top);
    }
    ;
  }
};

// src/fields/fieldManagers/FileField.ts
var FileField = class extends FieldManager2 {
  constructor(field) {
    super(field, "File" /* File */);
    this.getFiles = () => {
      const getResults = (api) => {
        try {
          return new Function("dv", `return ${this.field.options.dvQueryString}`)(api);
        } catch (error) {
          new import_obsidian16.Notice(`Wrong query for field <${this.field.name}>
check your settings`, 3e3);
        }
      };
      const dataview = app.plugins.plugins["dataview"];
      if (this.field.options.dvQueryString && (dataview == null ? void 0 : dataview.settings.enableDataviewJs) && (dataview == null ? void 0 : dataview.settings.enableInlineDataviewJs)) {
        try {
          const filesPath = getResults(dataview.api).values.map((v) => v.file.path);
          return app.vault.getMarkdownFiles().filter((f) => filesPath.includes(f.path));
        } catch (error) {
          throw error;
        }
      } else {
        return app.vault.getMarkdownFiles();
      }
    };
  }
  static buildMarkDownLink(app2, file, path) {
    const destFile = app2.metadataCache.getFirstLinkpathDest(path, file.path);
    if (destFile) {
      return app2.fileManager.generateMarkdownLink(destFile, file.path, void 0, destFile.basename);
    }
    return "";
  }
  addMenuOption(name, value, app2, file, category) {
    const modal = new FileFuzzySuggester(app2, file, this.field);
    modal.titleEl.setText("Select value");
    if (FileField.isMenu(category)) {
      category.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon("search");
        item.onClick(() => modal.open());
        item.setSection("target-metadata");
      });
    } else if (FileField.isSelect(category)) {
      category.addOption(`update_${name}`, `Update <${name}>`);
      category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
  createAndOpenFieldModal(app2, file, selectedFieldName, lineNumber, inFrontmatter, top2) {
    const fieldModal = new FileFuzzySuggester(app2, file, this.field, lineNumber, inFrontmatter, top2);
    fieldModal.titleEl.setText(`Enter value for ${selectedFieldName}`);
    fieldModal.open();
  }
  createDvField(plugin, dv, p, fieldContainer, attrs) {
    const fieldValueContainer = document.createElement("div");
    const fieldValue = dv.el("span", p[this.field.name], attrs);
    const searchBtn = document.createElement("button");
    searchBtn.setText("\u{1F50E}");
    searchBtn.addClass("metadata-menu-dv-field-button");
    fieldValueContainer.appendChild(fieldValue);
    fieldValueContainer.appendChild(searchBtn);
    const file = app.vault.getAbstractFileByPath(p["file"]["path"]);
    let fieldModal;
    if (file instanceof import_obsidian16.TFile && file.extension == "md") {
      fieldModal = new FileFuzzySuggester(app, file, this.field);
    } else {
      return Promise.reject("path doesn't correspond to a proper file");
    }
    searchBtn.onclick = () => {
      fieldModal.open();
    };
    fieldContainer.appendChild(fieldValueContainer);
    return Promise.resolve();
  }
  createFileContainer(parentContainer) {
    const dvQueryStringContainer = parentContainer.createDiv();
    dvQueryStringContainer.createEl("span", { text: "Dataview Query (optional)", cls: "metadata-menu-field-option" });
    this.dvQueryString = new import_obsidian16.TextAreaComponent(dvQueryStringContainer);
    this.dvQueryString.inputEl.cols = 60;
    this.dvQueryString.inputEl.rows = 6;
    this.dvQueryString.setValue(this.field.options.dvQueryString || "");
    this.dvQueryString.onChange((value) => {
      this.field.options.dvQueryString = value;
      FieldSettingsModal.removeValidationError(this.dvQueryString);
    });
  }
  createSettingContainer(parentContainer, plugin, location) {
    this.fileValidatorField = parentContainer.createDiv({ cls: "metadata-menu-number-options" });
    this.createFileContainer(this.fileValidatorField);
    this.fileValidatorField.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  getOptionsStr() {
    return this.field.options.dvQueryString || "";
  }
  validateOptions() {
    return true;
  }
  validateValue(value) {
    const basename = value.trim().replace(/^\[\[/g, "").replace(/\]\]$/g, "");
    return Promise.resolve(!!this.getFiles().map((f) => f.basename).find((item) => item === basename));
  }
};

// src/fields/fieldManagers/Managers.ts
var Managers = {
  Input: InputField,
  Boolean: BooleanField,
  Number: NumberField,
  Select: SelectField,
  Cycle: CycleField,
  Multi: MultiField,
  File: FileField
};
var Managers_default = Managers;

// src/types/fieldTypes.ts
var FieldTypeLabelMapping = {
  "Input": "Input" /* Input */,
  "Select": "Select" /* Select */,
  "Multi": "Multi" /* Multi */,
  "Cycle": "Cycle" /* Cycle */,
  "Boolean": "Boolean" /* Boolean */,
  "Number": "Number" /* Number */,
  "File": "File" /* File */
};
var FieldTypeTagClass = {
  "Input": "single",
  "Select": "select",
  "Multi": "multi",
  "Cycle": "cycle",
  "Boolean": "boolean",
  "Number": "number",
  "File": "file"
};
var FieldTypeTooltip = {
  "Input": "Accept any value",
  "Select": "Accept a single value from a list",
  "Multi": "Accept multiple values from a list",
  "Cycle": "Cycle through values from a list",
  "Boolean": "Accept true of false",
  "Number": "Accept a number",
  "File": "Accept a link to a file in your vault"
};
var FieldManager = {
  "Input": Managers_default.Input,
  "Select": Managers_default.Select,
  "Multi": Managers_default.Multi,
  "Cycle": Managers_default.Cycle,
  "Boolean": Managers_default.Boolean,
  "Number": Managers_default.Number,
  "File": Managers_default.File
};

// src/fields/Field.ts
var Field = class {
  constructor(name = "", options = {}, id = "", valuesListNotePath = "", type = "Input" /* Input */) {
    this.name = name;
    this.options = options;
    this.id = id;
    this.valuesListNotePath = valuesListNotePath;
    this.type = type;
    this.insertNewValue.bind(this);
  }
  insertNewValue(value) {
    return __async(this, null, function* () {
      let newKey = 1;
      Object.keys(this.options).forEach((key) => {
        if (parseInt(key) && parseInt(key) >= newKey) {
          newKey = parseInt(key) + 1;
        }
        ;
      });
      this.options[newKey.toString()] = value;
      return newKey.toString();
    });
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.valuesListNotePath = source.valuesListNotePath;
    target.type = source.type;
    Object.keys(source.options).forEach((k) => {
      target.options[k] = source.options[k];
    });
    Object.keys(target.options).forEach((k) => {
      if (!Object.keys(source.options).includes(k)) {
        delete target.options[k];
      }
      ;
    });
  }
  static createDefault(name) {
    const field = new Field();
    field.type = "Input" /* Input */;
    field.name = name;
    return field;
  }
};
var Field_default = Field;

// src/settings/FieldSettingsModal.ts
var FieldSettingsModal = class extends import_obsidian17.Modal {
  constructor(app2, plugin, parentSettingContainer, parentSetting, field) {
    super(app2);
    this.saved = false;
    this.new = true;
    this.plugin = plugin;
    this.parentSetting = parentSetting;
    this.initialField = new Field_default();
    this.parentSettingContainer = parentSettingContainer;
    if (field) {
      this.new = false;
      this.field = field;
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      let newId = 1;
      this.plugin.initialProperties.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.field = new Field_default();
      this.field.id = newId.toString();
      this.initialField.id = newId.toString();
    }
    ;
    this.fieldManager = new FieldManager[this.field.type](this.field);
  }
  onOpen() {
    return __async(this, null, function* () {
      if (this.field.name == "") {
        this.titleEl.setText(`Add a field and define options`);
      } else {
        this.titleEl.setText(`Manage settings options for ${this.field.name}`);
      }
      ;
      yield this.createForm();
    });
  }
  onClose() {
    Object.assign(this.field, this.initialField);
    if (!this.new && this.parentSetting) {
      this.parentSetting.setTextContentWithname();
    } else if (this.saved) {
      new FieldSetting(this.parentSettingContainer, this.field, this.app, this.plugin);
    }
    ;
  }
  createnameInputContainer(parentNode) {
    const fieldNameContainerLabel = parentNode.createDiv();
    fieldNameContainerLabel.setText(`Field Name:`);
    const input = new import_obsidian17.TextComponent(parentNode);
    const name = this.field.name;
    input.setValue(name);
    input.setPlaceholder("Name of the field");
    input.onChange((value) => {
      this.field.name = value;
      this.titleEl.setText(`Manage predefined options for ${this.field.name}`);
      FieldSettingsModal.removeValidationError(input);
    });
    return input;
  }
  createTypeSelectorContainer(parentNode) {
    const typeSelectorContainerLabel = parentNode.createDiv();
    typeSelectorContainerLabel.setText(`Field type:`);
    const select = new import_obsidian17.DropdownComponent(parentNode);
    Object.keys(FieldTypeLabelMapping).forEach((f) => select.addOption(f, FieldTypeTooltip[f]));
    if (this.field.type) {
      select.setValue(this.field.type);
    }
    select.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.namePromptComponent.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  createForm() {
    return __async(this, null, function* () {
      const div = this.contentEl.createDiv({ cls: "metadata-menu-prompt-div" });
      const mainDiv = div.createDiv({ cls: "metadata-menu-prompt-form" });
      const nameContainer = mainDiv.createDiv();
      this.namePromptComponent = this.createnameInputContainer(nameContainer);
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const typeSelectContainer = mainDiv.createDiv();
      this.fieldOptionsContainer = mainDiv.createDiv();
      const footerEl = this.contentEl.createDiv();
      const footerButtons = new import_obsidian17.Setting(footerEl);
      footerButtons.addButton((b) => this.createSaveButton(b));
      footerButtons.addExtraButton((b) => this.createCancelButton(b));
      this.createTypeSelectorContainer(typeSelectContainer);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 0 /* PluginSettings */);
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.namePromptComponent, this.namePromptComponent.inputEl) && this.fieldManager.validateOptions();
  }
  createSaveButton(b) {
    b.setTooltip("Save");
    b.setIcon("checkmark");
    b.onClick(() => __async(this, null, function* () {
      var _a;
      let error = !this.validateFields();
      if (error) {
        new import_obsidian17.Notice("Fix errors before saving.");
        return;
      }
      ;
      this.saved = true;
      const currentExistingField = this.plugin.initialProperties.filter((p) => p.id == this.field.id)[0];
      if (currentExistingField) {
        Field_default.copyProperty(currentExistingField, this.field);
      } else {
        this.plugin.initialProperties.push(this.field);
      }
      ;
      Field_default.copyProperty(this.initialField, this.field);
      if (this.parentSetting)
        Field_default.copyProperty(this.parentSetting.field, this.field);
      (_a = this.parentSetting) == null ? void 0 : _a.setTextContentWithname();
      this.plugin.saveSettings();
      this.close();
    }));
    return b;
  }
  createCancelButton(b) {
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialField.name != "") {
        Object.assign(this.field, this.initialField);
      }
      ;
      this.close();
    });
    return b;
  }
  static setValidationError(textInput, insertAfter, message) {
    var _a;
    textInput.inputEl.addClass("is-invalid");
    if (message && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      let mDiv = textInput.inputEl.parentElement.querySelector(".invalid-feedback");
      if (!mDiv) {
        mDiv = createDiv({ cls: "invalid-feedback" });
      }
      mDiv.innerText = message;
      mDiv.insertAfter(insertAfter);
    }
  }
  static removeValidationError(textInput) {
    var _a;
    if (textInput.inputEl.hasClass("is-invalid") && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      textInput.inputEl.removeClass("is-invalid");
      textInput.inputEl.parentElement.removeChild(textInput.inputEl.parentElement.lastElementChild);
    }
    ;
  }
};

// src/suggester/FolderSuggester.ts
var import_obsidian18 = require("obsidian");
var FolderSuggest = class extends TextInputSuggest {
  getSuggestions(inputStr) {
    const abstractFiles = this.app.vault.getAllLoadedFiles();
    const folders = [];
    const lowerCaseInputStr = inputStr.toLowerCase();
    abstractFiles.forEach((folder) => {
      if (folder instanceof import_obsidian18.TFolder && folder.path.toLowerCase().contains(lowerCaseInputStr)) {
        folders.push(folder);
      }
    });
    return folders;
  }
  renderSuggestion(file, el) {
    el.setText(file.path);
  }
  selectSuggestion(file) {
    this.inputEl.value = file.path;
    this.inputEl.trigger("input");
    this.close();
  }
};

// src/settings/MetadataMenuSettingTab.ts
var SettingsMigrationConfirmModal = class extends import_obsidian19.Modal {
  constructor(plugin, tab) {
    super(plugin.app);
    this.plugin = plugin;
    this.tab = tab;
  }
  onOpen() {
    this.titleEl.setText("Confirm");
    const body = this.contentEl.createDiv({
      cls: "modal-text-danger"
    });
    body.setText("This will erase current settings. Are you sure?");
    const confirmButton = new import_obsidian19.ButtonComponent(this.contentEl);
    confirmButton.setIcon("check");
    confirmButton.onClick(() => {
      if (this.app.plugins.plugins.hasOwnProperty("supercharged-links-obsidian")) {
        let settings = this.app.plugins.plugins["supercharged-links-obsidian"].settings;
        this.plugin.initialProperties = [];
        settings.presetFields.forEach((prop) => {
          const field = new Field_default();
          Object.assign(field, prop);
          this.plugin.initialProperties.push(field);
        });
        this.plugin.saveSettings();
        this.close();
      }
      ;
    });
  }
  onClose() {
    this.tab.display();
  }
};
var MetadataMenuSettingTab = class extends import_obsidian19.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    const globalSettings = containerEl.createEl("div");
    globalSettings.createEl("h4", { text: "Global settings", cls: "metadata-menu-setting-section-header" });
    globalSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Global settings to apply to your whole vault"
    });
    new import_obsidian19.Setting(globalSettings).setName("Display field options in context menu").setDesc("Choose to show or hide fields options in the context menu of a link or a file").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.displayFieldsInContextMenu);
      toggle.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.displayFieldsInContextMenu = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian19.Setting(globalSettings).setName("Globally ignored fields").setDesc("Fields to be ignored by the plugin when adding options to the context menu").addTextArea((text) => {
      text.setPlaceholder("Enter fields as string, comma separated").setValue(this.plugin.settings.globallyIgnoredFields.join(", ")).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.globallyIgnoredFields = value.replace(/\s/g, "").split(",");
        yield this.plugin.saveSettings();
      }));
      text.inputEl.rows = 6;
      text.inputEl.cols = 25;
    });
    const presetFieldsSettings = containerEl.createEl("div");
    presetFieldsSettings.createEl("h4", { text: "Preset Fields settings", cls: "metadata-menu-setting-section-header" });
    presetFieldsSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage globally predefined type and options for a field throughout your whole vault"
    });
    new import_obsidian19.Setting(presetFieldsSettings).setName("Add New Field Setting").setDesc("Add a new Frontmatter property for which you want preset options.").addButton((button) => {
      return button.setTooltip("Add New Property Manager").setButtonText("+").onClick(() => __async(this, null, function* () {
        let modal = new FieldSettingsModal(this.app, this.plugin, presetFieldsSettings);
        modal.open();
      }));
    });
    this.plugin.initialProperties.forEach((prop) => {
      const property = new Field_default();
      Object.assign(property, prop);
      new FieldSetting(presetFieldsSettings, property, this.app, this.plugin);
    });
    const classFilesSettings = containerEl.createEl("div");
    classFilesSettings.createEl("h4", { text: "FileClass settings", cls: "metadata-menu-setting-section-header" });
    classFilesSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage fileClass folder and alias. When a note has a fielClass defined, fileClass field properties will override global preset fields settings for the same field name"
    });
    new import_obsidian19.Setting(classFilesSettings).setName("class Files path").setDesc("Path to the files containing the authorized fields for a type of note").addSearch((cfs) => {
      new FolderSuggest(this.app, cfs.inputEl);
      cfs.setPlaceholder("Folder").setValue(this.plugin.settings.classFilesPath).onChange((new_folder) => {
        const newPath = new_folder.endsWith("/") ? new_folder : new_folder + "/";
        this.plugin.settings.classFilesPath = newPath;
        this.plugin.saveSettings();
      });
      cfs.containerEl.addClass("metadata-menu-setting-fileClass-search");
    });
    new import_obsidian19.Setting(classFilesSettings).setName("fileClass field alias").setDesc("Choose another name for fileClass field in frontmatter (example: Category, type, ...").addText((text) => {
      text.setValue(this.plugin.settings.fileClassAlias).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.fileClassAlias = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian19.Setting(classFilesSettings).setName("global fileClass").setDesc("Choose one fileClass to be applicable to all files (even it is not present as a fileClass attribute in their frontmatter). This will override the preset Fields defined above").addSearch((cfs) => {
      new FileSuggest(this.app, cfs.inputEl, this.plugin, this.plugin.settings.classFilesPath);
      cfs.setPlaceholder("Global fileClass");
      cfs.setValue(this.plugin.settings.globalFileClass ? this.plugin.settings.classFilesPath + this.plugin.settings.globalFileClass + ".md" : "").onChange((newPath) => {
        var _a;
        this.plugin.settings.globalFileClass = newPath ? (_a = newPath.split("\\").pop().split("/").pop()) == null ? void 0 : _a.replace(".md", "") : "";
        this.plugin.saveSettings();
      });
      cfs.containerEl.addClass("metadata-menu-setting-fileClass-search");
    });
    const migrateSettings = containerEl.createEl("div");
    migrateSettings.createEl("h4", { text: "Migrate" });
    new import_obsidian19.Setting(migrateSettings).setName("Copy settings from supercharged links plugin").setDesc("Copy settings from supercharged links plugin").addButton((button) => {
      return button.setTooltip("Get settings from supercharged links").setButtonText("Copy").onClick(() => __async(this, null, function* () {
        let modal = new SettingsMigrationConfirmModal(this.plugin, this);
        modal.open();
      }));
    });
  }
};

// src/settings/MetadataMenuSettings.ts
var DEFAULT_SETTINGS = {
  presetFields: [],
  displayFieldsInContextMenu: true,
  globallyIgnoredFields: [],
  classFilesPath: "",
  isAutosuggestEnabled: true,
  fileClassAlias: "fileClass",
  settingsVersion: void 0,
  globalFileClass: void 0
};

// src/commands/getValues.ts
var import_obsidian20 = require("obsidian");
function getValues(app2, fileOrfilePath, attribute) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrfilePath instanceof import_obsidian20.TFile) {
      file = fileOrfilePath;
    } else {
      const _file = app2.vault.getAbstractFileByPath(fileOrfilePath);
      if (_file instanceof import_obsidian20.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const content = (yield app2.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = this.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const { position: { start: start2, end: end2 } } = frontmatter ? frontmatter : { position: { start: void 0, end: void 0 } };
    const result = [];
    content.map((line, i) => {
      if (frontmatter && i >= start2.line && i <= end2.line) {
        const regex = new RegExp(`${attribute}:(.*)`, "u");
        const r = line.match(regex);
        if (r && r.length > 0)
          result.push(r[1]);
      } else {
        const fullLineRegex2 = new RegExp(`^${inlineFieldRegex(attribute)}`, "u");
        const fR = encodeLink(line).match(fullLineRegex2);
        if (fR == null ? void 0 : fR.groups) {
          result.push(decodeLink(fR.groups.values));
        }
        ;
        const inSentenceRegexBrackets2 = new RegExp(`\\[${inlineFieldRegex(attribute)}\\]`, "gu");
        const sRB = encodeLink(line).matchAll(inSentenceRegexBrackets2);
        let next = sRB.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRB.next();
        }
        const inSentenceRegexPar2 = new RegExp(`\\(${inlineFieldRegex(attribute)}\\)`, "gu");
        const sRP = encodeLink(line).matchAll(inSentenceRegexPar2);
        next = sRP.next();
        while (!next.done) {
          if (next.value.groups) {
            result.push(decodeLink(next.value.groups.values));
          }
          next = sRP.next();
        }
      }
    });
    return result;
  });
}

// src/commands/getField.ts
function getField(plugin, propertyName, fileClass) {
  const matchingSettings = plugin.settings.presetFields.filter((p) => p.name == propertyName);
  if (fileClass) {
    const fileClassAttributesWithName = fileClass.attributes.filter((attr) => attr.name == propertyName);
    if (fileClassAttributesWithName.length > 0) {
      const fileClassAttribute = fileClassAttributesWithName[0];
      if (fileClassAttribute.type) {
        return fileClassAttribute.getField();
      } else if (matchingSettings.length > 0) {
        return matchingSettings[0];
      }
      ;
    }
  } else if (matchingSettings.length > 0) {
    return matchingSettings[0];
  }
  ;
}

// src/utils/textUtils.ts
var capitalize = (s) => {
  return s && s[0].toUpperCase() + s.slice(1);
};

// src/fileClass/fileClassAttribute.ts
var FileClassAttribute = class {
  constructor(raw, origin) {
    var _a, _b;
    this.origin = origin;
    const completeRegex = new RegExp(`^${genericFieldRegex}::(?<fieldSettings>.+)?`, "u");
    const nameRegex = new RegExp(`^${genericFieldRegex}$`, "u");
    let fieldName;
    let { attribute, fieldSettings } = ((_a = raw.match(completeRegex)) == null ? void 0 : _a.groups) || {};
    if (attribute) {
      fieldName = attribute;
    } else {
      let { attribute: attribute2 } = ((_b = raw.match(nameRegex)) == null ? void 0 : _b.groups) || {};
      fieldName = attribute2;
    }
    if (fieldName) {
      this.name = fieldName.trim();
      if (fieldSettings) {
        const settings = JSON.parse(`${fieldSettings.trim()}`);
        this.type = FieldTypeLabelMapping[capitalize(settings["type"])];
        this.options = settings["options"];
      } else {
        this.type = "Input" /* Input */;
      }
    } else {
      const error = new Error("Improper value");
      throw error;
    }
  }
  getField() {
    var _a;
    let options = {};
    if (Array.isArray(this.options)) {
      (_a = this.options) == null ? void 0 : _a.forEach((option, index) => {
        options[index] = option;
      });
    } else {
      options = this.options;
    }
    return new Field_default(this.name, options, this.name, void 0, this.type);
  }
};

// src/fileClass/fileClass.ts
var import_obsidian21 = require("obsidian");
var FileClassManager = class {
  constructor(instance) {
    this.instance = instance;
  }
  all() {
    const filesWithFileClassName = this.instance.plugin.app.vault.getMarkdownFiles().filter((file) => {
      const cache = this.instance.plugin.app.metadataCache.getFileCache(file);
      const fileClassAlias = this.instance.plugin.settings.fileClassAlias;
      return (cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).includes(fileClassAlias) && cache.frontmatter[fileClassAlias] == this.instance.name;
    });
    return filesWithFileClassName;
  }
  get(name) {
    const filesWithName = this.all().filter((file) => file.basename == name);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
  getPath(path) {
    const filesWithName = this.all().filter((file) => file.path == path);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
};
var FileClass = class {
  constructor(plugin, name) {
    this.plugin = plugin;
    this.name = name;
    this.objects = new FileClassManager(this);
    this.attributes = [];
  }
  getClassFile() {
    const filesClassPath = this.plugin.settings.classFilesPath;
    const file = this.plugin.app.vault.getAbstractFileByPath(`${filesClassPath}${this.name}.md`);
    if (file instanceof import_obsidian21.TFile && file.extension == "md") {
      return file;
    } else {
      const error = new Error(`no file named <${this.name}.md> in <${filesClassPath}> folder to match <${this.plugin.settings.fileClassAlias}: ${this.name}> in one of these notes`);
      throw error;
    }
  }
  getParentClass() {
    return;
  }
  getAttributes(excludeParents = false) {
    return __async(this, null, function* () {
      var _a, _b, _c, _d;
      try {
        const file = this.getClassFile();
        let attributes = [];
        let errors = [];
        const result = yield this.plugin.app.vault.cachedRead(file);
        const parent = (_b = (_a = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter) == null ? void 0 : _b.extends;
        const excludedFields = (_d = (_c = this.plugin.app.metadataCache.getFileCache(file)) == null ? void 0 : _c.frontmatter) == null ? void 0 : _d.excludes;
        if (parent && !excludeParents) {
          try {
            const parentFileClass = yield createFileClass(this.plugin, parent);
            yield parentFileClass.getAttributes();
            attributes = [...parentFileClass.attributes];
          } catch (error) {
            errors.push(error);
          }
        }
        result.split("\n").forEach((line) => {
          try {
            const attribute = new FileClassAttribute(line, this.name);
            attributes.push(attribute);
          } catch (error) {
            errors.push(error);
          }
        });
        this.attributes = Array.isArray(excludedFields) ? attributes.filter((attr) => !excludedFields.includes(attr.name)) : attributes;
        this.errors = errors;
      } catch (error) {
        throw error;
      }
    });
  }
  updateAttribute(newType, newName, newOptions, attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      let result = yield this.plugin.app.vault.read(file);
      if (attr) {
        let newContent = [];
        result.split("\n").forEach((line) => {
          if (line.startsWith(attr.name)) {
            if (newType == "Input") {
              newContent.push(`${newName}:: {"type": "Input"}`);
            } else {
              let settings = {};
              settings["type"] = newType;
              if (newOptions)
                settings["options"] = newOptions;
              newContent.push(`${newName}:: ${JSON.stringify(settings)}`);
            }
          } else {
            newContent.push(line);
          }
        });
        this.plugin.app.vault.modify(file, newContent.join("\n"));
      } else {
        let settings = {};
        settings["type"] = newType;
        if (newOptions)
          settings["options"] = newOptions;
        result += `
${newName}:: ${JSON.stringify(settings)}`;
        yield this.plugin.app.vault.modify(file, result);
      }
    });
  }
  removeAttribute(attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      const result = yield this.plugin.app.vault.read(file);
      let newContent = [];
      result.split("\n").forEach((line) => {
        if (!line.startsWith(attr.name)) {
          newContent.push(line);
        }
      });
      yield this.plugin.app.vault.modify(file, newContent.join("\n"));
    });
  }
};
function createFileClass(plugin, name, excludeParent = false) {
  return __async(this, null, function* () {
    return new Promise((resolve, reject) => {
      const fileClass = new FileClass(plugin, name);
      fileClass.getAttributes(excludeParent).then(() => {
        resolve(fileClass);
      }).catch((error) => {
        reject(error);
      });
    });
  });
}

// src/commands/fieldModifier.ts
function fieldModifier(plugin, dv, p, fieldName, attrs) {
  return __async(this, null, function* () {
    const fieldContainer = dv.el("div", "");
    fieldContainer.setAttr("class", "metadata-menu-dv-field-container");
    if (p[fieldName] === void 0) {
      const emptyField = dv.el("span", null, attrs);
      fieldContainer.appendChild(emptyField);
    } else {
      const fileClassAlias = plugin.settings.fileClassAlias;
      if (p[fileClassAlias] || plugin.settings.globalFileClass) {
        const fileClassName = p[fileClassAlias] || plugin.settings.globalFileClass;
        const fileClass = yield createFileClass(plugin, fileClassName);
        const field = getField(plugin, fieldName, fileClass);
        if (field == null ? void 0 : field.type) {
          const fieldManager = new FieldManager[field.type](field);
          yield fieldManager.createDvField(plugin, dv, p, fieldContainer, attrs);
        } else {
          const fieldManager = FieldManager2.createDefault(fieldName);
          yield fieldManager.createDvField(plugin, dv, p, fieldContainer, attrs);
        }
      } else if (plugin.settings.presetFields.filter((attr) => attr.name == fieldName)) {
        const field = getField(plugin, fieldName);
        if (field == null ? void 0 : field.type) {
          const fieldManager = new FieldManager[field.type](field);
          yield fieldManager.createDvField(plugin, dv, p, fieldContainer, attrs);
        } else {
          const fieldManager = FieldManager2.createDefault(fieldName);
          yield fieldManager.createDvField(plugin, dv, p, fieldContainer, attrs);
        }
      } else {
        const fieldManager = FieldManager2.createDefault(fieldName);
        yield fieldManager.createDvField(plugin, dv, p, fieldContainer, attrs);
      }
    }
    return fieldContainer;
  });
}

// src/commands/fileFields.ts
var import_obsidian22 = require("obsidian");
var FieldInfo = class {
  constructor() {
    this.type = void 0;
    this.sourceType = void 0;
    this.fileClass = void 0;
    this.options = void 0;
    this.isValid = void 0;
    this.value = "";
    this.valuesListNotePath = void 0;
    this.unique = true;
  }
  setInfos(plugin, fieldName, value, fileClass) {
    return __async(this, null, function* () {
      this.value = value;
      this.ignoreInMenu = plugin.settings.globallyIgnoredFields.includes(fieldName);
      if (fileClass) {
        const fileClassFields = fileClass.attributes.map((attr) => attr.name);
        if (fileClassFields.includes(fieldName)) {
          const field = getField(plugin, fieldName, fileClass);
          if (field) {
            const fieldManager = new FieldManager[field.type](field);
            this.isValid = yield fieldManager.validateValue(value);
            this.sourceType = "fileClass";
            const attribute = fileClass.attributes.filter((a) => a.name === fieldName)[0];
            this.fileClass = attribute.origin;
            this.type = attribute.type;
            this.options = attribute.options;
          }
        }
      } else if (plugin.settings.presetFields.map((f) => f.name).includes(fieldName)) {
        const field = getField(plugin, fieldName);
        if (field) {
          const fieldManager = new FieldManager[field.type](field);
          this.isValid = yield fieldManager.validateValue(value);
          this.type = field.type;
          this.options = field.options;
          this.valuesListNotePath = field.valuesListNotePath;
          this.sourceType = "settings";
        }
      }
    });
  }
};
function fileFields(plugin, fileOrfilePath) {
  return __async(this, null, function* () {
    var _a;
    let file;
    if (fileOrfilePath instanceof import_obsidian22.TFile) {
      file = fileOrfilePath;
    } else {
      const _file = app.vault.getAbstractFileByPath(fileOrfilePath);
      if (_file instanceof import_obsidian22.TFile && _file.extension == "md") {
        file = _file;
      } else {
        throw Error("path doesn't correspond to a proper file");
      }
    }
    const frontmatter = (_a = plugin.app.metadataCache.getCache(file.path)) == null ? void 0 : _a.frontmatter;
    const fields = {};
    let fileClass;
    if (plugin.settings.globalFileClass) {
      try {
        fileClass = yield createFileClass(plugin, plugin.settings.globalFileClass);
      } catch (error) {
        fileClass = void 0;
      }
    }
    if (frontmatter) {
      const _b = frontmatter, { position } = _b, attributes = __objRest(_b, ["position"]);
      const fileClassAlias = plugin.settings.fileClassAlias;
      if (Object.keys(attributes).includes(fileClassAlias)) {
        const fileClassName = attributes[fileClassAlias];
        try {
          fileClass = yield createFileClass(plugin, fileClassName);
        } catch (error) {
          fileClass = void 0;
        }
      }
      Object.keys(attributes).forEach((key) => __async(this, null, function* () {
        const fieldInfo = new FieldInfo();
        fieldInfo.unique = !Object.keys(fields).includes(key);
        fields[key] = fieldInfo;
        yield fieldInfo.setInfos(plugin, key, attributes[key], fileClass);
      }));
    }
    const result = yield plugin.app.vault.read(file);
    result.split("\n").map((line) => __async(this, null, function* () {
      const lineFields = getLineFields(line);
      lineFields.forEach((_0) => __async(this, [_0], function* ({ attribute, values }) {
        const fieldName = attribute.trim();
        const fieldInfo = new FieldInfo();
        fieldInfo.unique = !Object.keys(fields).includes(fieldName);
        fields[fieldName] = fieldInfo;
        yield fieldInfo.setInfos(plugin, fieldName, values, fileClass);
      }));
    }));
    return fields;
  });
}

// src/MetadataMenuApi.ts
var MetadataMenuApi = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  make() {
    return {
      getValues: this.getValues(),
      replaceValues: this.replaceValues(),
      insertValues: this.insertValues(),
      fieldModifier: this.fieldModifier(),
      fileFields: this.fileFields()
    };
  }
  getValues() {
    return (fileOrFilePath, attribute) => __async(this, null, function* () {
      return getValues(this.plugin.app, fileOrFilePath, attribute);
    });
  }
  replaceValues() {
    return (fileOrFilePath, attribute, input) => __async(this, null, function* () {
      return replaceValues(this.plugin.app, fileOrFilePath, attribute, input);
    });
  }
  insertValues() {
    return (fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, top2) => __async(this, null, function* () {
      return insertValues(this.plugin.app, fileOrFilePath, fieldName, value, lineNumber, inFrontmatter, top2);
    });
  }
  fieldModifier() {
    return (dv, p, fieldName, attrs) => fieldModifier(this.plugin, dv, p, fieldName, attrs);
  }
  fileFields() {
    return (fileOrFilePath) => __async(this, null, function* () {
      return fileFields(this.plugin, fileOrFilePath);
    });
  }
};

// src/options/linkContextMenu.ts
var import_obsidian30 = require("obsidian");

// src/optionModals/chooseSectionModal.ts
var import_obsidian25 = require("obsidian");

// src/optionModals/fieldSelectModal.ts
var import_obsidian24 = require("obsidian");

// src/optionModals/addNewFieldModal.ts
var import_obsidian23 = require("obsidian");
var addNewFieldModal = class extends import_obsidian23.Modal {
  constructor(plugin, lineNumber, file, inFrontmatter, top2) {
    super(plugin.app);
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.file = file;
    this.top = top2;
  }
  onOpen() {
    this.titleEl.setText("Insert new field");
    const addNewFieldContainer = this.contentEl.createDiv();
    const nameInputContainer = addNewFieldContainer.createDiv();
    nameInputContainer.setText("Field Name: ");
    const nameInputEl = new import_obsidian23.TextComponent(nameInputContainer);
    nameInputEl.setPlaceholder("Field name");
    const valueInputContainer = addNewFieldContainer.createDiv();
    valueInputContainer.setText("Field value: ");
    const valueInputEl = new import_obsidian23.TextComponent(valueInputContainer);
    valueInputEl.setPlaceholder("Field value");
    const footerButtons = this.contentEl.createDiv({
      cls: "metadata-menu-textarea-buttons"
    });
    const saveButton = new import_obsidian23.ButtonComponent(footerButtons);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      insertValues(this.app, this.file, nameInputEl.getValue(), valueInputEl.getValue(), this.lineNumber, this.inFrontmatter, this.top);
    }));
    const cancelButton = new import_obsidian23.ExtraButtonComponent(footerButtons);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
  }
};

// src/optionModals/fieldSelectModal.ts
var fieldSelectModal = class extends import_obsidian24.Modal {
  constructor(plugin, file, lineNumber, line, inFrontmatter, top2, fileClass) {
    super(plugin.app);
    this.line = line;
    this.lineNumber = lineNumber;
    this.plugin = plugin;
    this.file = file;
    this.inFrontmatter = inFrontmatter;
    this.top = top2;
    this.fileClass = fileClass;
  }
  onOpen() {
    this.titleEl.setText(`Insert field after > ${this.line.substring(0, 20)}${this.line.length > 20 ? "..." : ""}`);
    const container = this.contentEl.createDiv({ cls: "metadata-menu-field-select" });
    const settingsDropdownContainer = container.createDiv();
    const settingsSelector = new import_obsidian24.DropdownComponent(settingsDropdownContainer);
    settingsSelector.addOption("---", "Choose Field");
    settingsSelector.addOption("++New", "New");
    if (this.fileClass) {
      this.fileClass.attributes.forEach((attr) => {
        settingsSelector.addOption(attr.name, attr.name);
      });
    } else {
      this.plugin.settings.presetFields.forEach((setting) => {
        settingsSelector.addOption(setting.name, setting.name);
      });
    }
    ;
    settingsSelector.onChange((selectedFieldName) => {
      if (selectedFieldName == "++New") {
        const newFieldModal = new addNewFieldModal(this.plugin, this.lineNumber, this.file, this.inFrontmatter, this.top);
        newFieldModal.open();
        this.close();
      } else if (this.fileClass) {
        const fileClassAttributesWithName = this.fileClass.attributes.filter((attr) => attr.name == selectedFieldName);
        let field;
        let type;
        if (fileClassAttributesWithName.length > 0) {
          const fileClassAttribute = fileClassAttributesWithName[0];
          field = fileClassAttribute.getField();
          type = fileClassAttribute.type;
        }
        if (field) {
          const fieldManager = new FieldManager[field.type](field);
          fieldManager.createAndOpenFieldModal(this.app, this.file, selectedFieldName, this.lineNumber, this.inFrontmatter, this.top);
        }
        this.close();
      } else {
        const field = this.plugin.settings.presetFields.filter((_field) => _field.name == selectedFieldName)[0];
        const fieldManager = new FieldManager[field.type](field);
        fieldManager.createAndOpenFieldModal(this.app, this.file, selectedFieldName, this.lineNumber, this.inFrontmatter, this.top);
        this.close();
      }
      ;
    });
  }
};

// src/optionModals/chooseSectionModal.ts
var chooseSectionModal = class extends import_obsidian25.Modal {
  constructor(plugin, file, fileClass) {
    super(plugin.app);
    this.file = file;
    this.plugin = plugin;
    this.fileClass = fileClass;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.titleEl.setText("Add a field in this note after:");
      const inputDiv = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
      const selectEl = new import_obsidian25.DropdownComponent(inputDiv);
      selectEl.selectEl.addClass("metadata-menu-select");
      selectEl.addOption("", "Select line");
      selectEl.addOption("top_0", "top");
      const result = yield this.app.vault.read(this.file);
      let foreHeadText = false;
      let frontmatterStart = false;
      let frontmatterEnd = false;
      let inFrontmatter = false;
      result.split("\n").forEach((line, lineNumber) => {
        if (line != "---" && !foreHeadText && !frontmatterStart) {
          foreHeadText = true;
        }
        ;
        if (line == "---" && !foreHeadText) {
          if (!frontmatterStart) {
            frontmatterStart = true;
            inFrontmatter = true;
          } else if (!frontmatterEnd) {
            frontmatterEnd = true;
            inFrontmatter = false;
          }
          ;
        }
        if (inFrontmatter) {
          selectEl.addOption(`frontmatter_${lineNumber}`, `${line.substring(0, 30)}${line.length > 30 ? "..." : ""}`);
        } else {
          selectEl.addOption(`body_${lineNumber}`, `${line.substring(0, 30)}${line.length > 30 ? "..." : ""}`);
        }
        ;
      });
      selectEl.onChange(() => {
        const valueArray = selectEl.getValue().match(/(\w+)_(\d+)/);
        const position = valueArray && valueArray.length > 0 ? valueArray[1] : 0;
        const lineNumber = Number(valueArray && valueArray.length > 1 ? valueArray[2] : 0);
        const inFrontmatter2 = position == "frontmatter" ? true : false;
        const top2 = position == "top" ? true : false;
        const modal = new fieldSelectModal(this.plugin, this.file, lineNumber, result.split("\n")[lineNumber], inFrontmatter2, top2, this.fileClass);
        this.close();
        modal.open();
      });
    });
  }
};

// src/fileClass/FileClassAttributeSelectModal.ts
var import_obsidian27 = require("obsidian");

// src/fileClass/FileClassAttributeModal.ts
var import_obsidian26 = require("obsidian");
var FileClassAttributeModal = class extends import_obsidian26.Modal {
  constructor(plugin, fileClass, attr) {
    super(plugin.app);
    this.plugin = plugin;
    this.attr = attr;
    this.fileClass = fileClass;
    this.initialField = new Field_default();
    if (this.attr) {
      this.field = attr.getField();
      Field_default.copyProperty(this.initialField, this.field);
    } else {
      this.field = new Field_default();
    }
    this.fieldManager = new FieldManager[this.field.type](this.field);
    this.nameInputContainer = this.contentEl.createDiv();
    this.typeSelectContainer = this.contentEl.createDiv({ cls: "metadata-menu-value-selector-container" });
    this.fieldOptionsContainer = this.contentEl.createDiv();
  }
  buildNameInputContainer() {
    this.nameInputContainer.setText("Name: ");
    this.nameInput = new import_obsidian26.TextComponent(this.nameInputContainer);
    this.attr ? this.nameInput.setValue(this.field.name) : this.nameInput.setPlaceholder("Type a name for this attribute");
    this.nameInput.onChange((value) => {
      this.field.name = value;
      this.attrName.setText(`<${value}>`);
    });
    this.typeSelectContainer.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
  }
  buildTypeSelectContainer() {
    const typeSelectHeader = this.typeSelectContainer.createDiv();
    const attrLine = typeSelectHeader.createEl("div");
    this.attrName = attrLine.createEl("strong");
    this.attrName.setText(`<${this.field.name}>`);
    attrLine.append(" fields in files with:");
    String(`---
${this.plugin.settings.fileClassAlias}: ${this.fileClass.name}
...
---`).split("\n").forEach((line) => {
      typeSelectHeader.createEl("div", "yaml-metadata-menu-red").setText(line);
    });
    const typeSelectLabel = this.typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-inline-label" });
    typeSelectLabel.setText("will: ");
    const typeSelectDropDown = this.typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-toggler" });
    const typeSelect = new import_obsidian26.DropdownComponent(typeSelectDropDown);
    Object.keys(FieldTypeTooltip).forEach((key) => typeSelect.addOption(key, FieldTypeTooltip[key]));
    typeSelect.setValue(this.field.type);
    typeSelect.onChange((typeLabel) => {
      this.field = new Field_default();
      Field_default.copyProperty(this.field, this.initialField);
      this.field.name = this.nameInput.getValue();
      this.field.type = FieldTypeLabelMapping[typeLabel];
      if (this.field.type !== this.initialField.type && ![this.field.type, this.initialField.type].every((fieldType) => ["Multi" /* Multi */, "Select" /* Select */, "Cycle" /* Cycle */].includes(fieldType))) {
        this.field.options = {};
      }
      while (this.fieldOptionsContainer.firstChild) {
        this.fieldOptionsContainer.removeChild(this.fieldOptionsContainer.firstChild);
      }
      this.fieldManager = new FieldManager[this.field.type](this.field);
      this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
    });
  }
  validateFields() {
    return this.fieldManager.validateName(this.nameInput, this.nameInput.inputEl) && this.fieldManager.validateOptions();
  }
  createSaveBtn(container) {
    const saveButton = new import_obsidian26.ButtonComponent(container);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => {
      let error = !this.validateFields();
      if (error) {
        new import_obsidian26.Notice("Fix errors before saving.");
        return;
      }
      ;
      this.fileClass.updateAttribute(this.field.type, this.field.name, this.field.options, this.attr);
      this.close();
    });
  }
  createRemovelBtn(container) {
    const removeButton = new import_obsidian26.ButtonComponent(container);
    removeButton.setIcon("trash");
    removeButton.onClick(() => {
      var _a;
      const confirmModal = new import_obsidian26.Modal(this.plugin.app);
      confirmModal.titleEl.setText("Please confirm");
      confirmModal.contentEl.createDiv().setText(`Do you really want to remove ${(_a = this.attr) == null ? void 0 : _a.name} attribute from ${this.fileClass.name}?`);
      const confirmFooter = confirmModal.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
      const confirmButton = new import_obsidian26.ButtonComponent(confirmFooter);
      confirmButton.setIcon("checkmark");
      confirmButton.onClick(() => {
        if (this.attr)
          this.fileClass.removeAttribute(this.attr);
        confirmModal.close();
        this.close();
      });
      const dismissButton = new import_obsidian26.ExtraButtonComponent(confirmFooter);
      dismissButton.setIcon("cross");
      dismissButton.onClick(() => this.close());
      confirmModal.open();
    });
  }
  createCancelBtn(container) {
    const cancelButton = new import_obsidian26.ExtraButtonComponent(container);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => this.close());
  }
  onOpen() {
    this.titleEl.setText(this.attr ? `Manage ${this.attr.name}` : `Create a new attribute for ${this.fileClass.name}`);
    this.buildNameInputContainer();
    this.buildTypeSelectContainer();
    this.fieldManager.createSettingContainer(this.fieldOptionsContainer, this.plugin, 1 /* FileClassAttributeSettings */);
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    this.createSaveBtn(footer);
    if (this.attr)
      this.createRemovelBtn(footer);
    this.createCancelBtn(footer);
  }
};

// src/fileClass/FileClassAttributeSelectModal.ts
var FileClassAttributeSelectModal = class extends import_obsidian27.Modal {
  constructor(plugin, file) {
    super(plugin.app);
    this.file = file;
    this.plugin = plugin;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.titleEl.setText(`Select the field to update`);
      const fileClass = yield createFileClass(this.plugin, this.file.basename, true);
      this.titleEl.setText(`Select the field to update in ${fileClass.name}`);
      const selectContainer = this.contentEl.createDiv();
      const select = new import_obsidian27.DropdownComponent(selectContainer);
      select.addOption("select an attribute", "--select an attribute--");
      fileClass.attributes.forEach((attr) => {
        select.addOption(attr.name, attr.name);
      });
      select.addOption("++newAttr++", "++Add a new attribute++");
      select.onChange((attrName) => {
        if (attrName == "++newAttr") {
          const modal = new FileClassAttributeModal(this.plugin, fileClass);
          modal.open();
          this.close();
        } else {
          const modal = new FileClassAttributeModal(this.plugin, fileClass, fileClass.attributes.filter((attr) => attr.name == attrName)[0]);
          modal.open();
          this.close();
        }
      });
    });
  }
};

// src/options/OptionsList.ts
function isMenu(category) {
  return category.addItem !== void 0;
}
function isSelect(category) {
  return category.modals !== void 0;
}
var OptionsList = class {
  constructor(plugin, file, category) {
    this.file = file;
    this.plugin = plugin;
    this.category = category;
    this.attributes = {};
    this.fileClassFields = [];
    this.fileClassForFields = false;
  }
  fetchFrontmatterFields() {
    return __async(this, null, function* () {
      var _a;
      const frontmatter = (_a = this.plugin.app.metadataCache.getCache(this.file.path)) == null ? void 0 : _a.frontmatter;
      if (frontmatter) {
        const _b = frontmatter, { position } = _b, attributes = __objRest(_b, ["position"]);
        Object.keys(attributes).forEach((key) => {
          if (!this.plugin.settings.globallyIgnoredFields.includes(key)) {
            this.attributes[key] = attributes[key];
          }
          ;
        });
        const fileClassAlias = this.plugin.settings.fileClassAlias;
        if (Object.keys(this.attributes).includes(fileClassAlias) || this.plugin.settings.globalFileClass) {
          const fileClass = this.attributes[fileClassAlias] || this.plugin.settings.globalFileClass;
          try {
            const _fileClass = yield createFileClass(this.plugin, fileClass);
            this.fileClass = _fileClass;
            this.fileClassFields = _fileClass.attributes.map((attr) => attr.name);
            this.fileClassForFields = true;
            Object.keys(attributes).forEach((key) => {
              if (!this.fileClassFields.includes(key) && key != fileClassAlias) {
                delete this.attributes[key];
              }
              ;
            });
          } catch (error) {
          }
        }
      }
    });
  }
  fetchInlineFields() {
    return __async(this, null, function* () {
      const result = yield this.plugin.app.vault.read(this.file);
      result.split("\n").map((line) => {
        const lineFields = getLineFields(line);
        lineFields.forEach(({ attribute, values }) => {
          if (attribute && !this.plugin.settings.globallyIgnoredFields.includes(attribute.trim())) {
            if (this.fileClassForFields) {
              if (this.fileClassFields.includes(attribute.trim())) {
                this.attributes[attribute.trim()] = values ? values.trim() : "";
              }
              ;
            } else {
              this.attributes[attribute.trim()] = values ? values.trim() : "";
            }
            ;
          }
          ;
        });
      });
    });
  }
  createExtraOptionList() {
    return __async(this, null, function* () {
      yield this.fetchFrontmatterFields();
      yield this.fetchInlineFields();
      if (this.fileClass) {
        const fileClassAttributeSelectModal = new FileClassAttributeSelectModal(this.plugin, this.fileClass.getClassFile());
        if (isMenu(this.category)) {
          this.category.addSeparator();
          this.category.addItem((item) => {
            item.setIcon("gear");
            item.setTitle(`Manage <${this.fileClass.name}> fields`);
            item.onClick(() => fileClassAttributeSelectModal.open());
          });
        } else {
          this.category.addOption("manage_fileClass_attributes", `Manage <${this.fileClass.name}> fields`);
          this.category.modals["manage_fileClass_attributes"] = () => fileClassAttributeSelectModal.open();
        }
        ;
      }
      if (isMenu(this.category)) {
        this.category.addSeparator();
      }
      ;
      this.buildFieldOptions();
      this.addSectionSelectModalOption();
    });
  }
  buildFieldOptions() {
    Object.keys(this.attributes).forEach((key) => {
      const value = this.attributes[key];
      const field = getField(this.plugin, key, this.fileClass);
      if (field) {
        const fieldManager = new FieldManager[field.type](field);
        fieldManager.addMenuOption(key, value, this.plugin.app, this.file, this.category);
      } else {
        const defaultField = new Field_default(key);
        defaultField.type = "Input" /* Input */;
        const fieldManager = new Managers_default.Input(defaultField);
        fieldManager.addMenuOption(key, value, this.plugin.app, this.file, this.category);
      }
    });
  }
  addSectionSelectModalOption() {
    const modal = new chooseSectionModal(this.plugin, this.file, this.fileClass);
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setIcon("pencil");
        item.setTitle("Add field at section...");
        item.onClick((evt) => {
          modal.open();
        });
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption("add_field_at_section", "Add field at section...");
      this.category.modals["add_field_at_section"] = () => modal.open();
    }
    ;
  }
};

// src/options/NoteFieldsCommandsModal.ts
var import_obsidian29 = require("obsidian");

// src/optionModals/SelectModal.ts
var import_obsidian28 = require("obsidian");
var SelectModal = class extends import_obsidian28.DropdownComponent {
  constructor(containerEl) {
    super(containerEl);
    this.modals = {};
  }
};

// src/options/NoteFieldsCommandsModal.ts
var NoteFieldsCommandsModal = class extends import_obsidian29.Modal {
  constructor(app2, plugin, file) {
    super(app2);
    this.app = app2;
    this.plugin = plugin;
    this.file = file;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.titleEl.setText(`Select the field to manage`);
      this.containerEl.addClass("metadata-menu");
      const optionsListContainer = this.contentEl.createDiv({ cls: "field-options" });
      this.select = new SelectModal(optionsListContainer);
      this.select.addOption("---", "Choose Field");
      this.optionsList = new OptionsList(this.plugin, this.file, this.select);
      yield this.optionsList.createExtraOptionList();
      this.select.onChange((value) => {
        this.select.modals[value]();
        this.close();
      });
      this.select.selectEl.focus();
    });
  }
};

// src/options/linkContextMenu.ts
var linkContextMenu = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.createContextMenu();
  }
  createContextMenu() {
    this.plugin.registerEvent(this.plugin.app.workspace.on("file-menu", (menu, abstractFile, source) => {
      const file = this.plugin.app.vault.getAbstractFileByPath(abstractFile.path);
      if (file instanceof import_obsidian30.TFile && file.extension === "md") {
        this.file = file;
        if (file.parent.path + "/" == this.plugin.settings.classFilesPath) {
          menu.addSeparator();
          menu.addItem((item) => {
            item.setIcon("gear");
            item.setTitle(`Manage <${file.basename}> fields`);
            item.onClick((evt) => {
              const fileClassAttributeSelectModal = new FileClassAttributeSelectModal(this.plugin, file);
              fileClassAttributeSelectModal.open();
            });
          });
        } else {
          if (this.plugin.settings.displayFieldsInContextMenu) {
            this.optionsList = new OptionsList(this.plugin, this.file, menu);
            this.optionsList.createExtraOptionList();
          } else {
            this.optionsList = new OptionsList(this.plugin, this.file, menu);
            menu.addItem((item) => {
              item.setIcon("bullet-list"), item.setTitle(`Field Options`), item.onClick((evt) => {
                const fieldOptions = new NoteFieldsCommandsModal(app, this.plugin, file);
                fieldOptions.open();
              });
              item.setSection("target-metadata");
            });
          }
        }
        ;
      }
      ;
    }));
  }
};

// src/suggester/metadataSuggester.ts
var import_obsidian31 = require("obsidian");
var ValueSuggest = class extends import_obsidian31.EditorSuggest {
  constructor(app2, plugin) {
    super(app2);
    this.inFrontmatter = false;
    this.inFullLine = false;
    this.inSentence = false;
    this.didSelect = false;
    this.filterOption = (firstValues, lastValue, option) => {
      return !firstValues || !(firstValues == null ? void 0 : firstValues.contains(encodeLink(option))) && (!lastValue || !!lastValue && encodeLink(option).contains(lastValue));
    };
    this.app = app2;
    this.plugin = plugin;
    this.setInstructions([{ command: "Shift", purpose: "put a space after::" }]);
    this.scope.register(["Shift"], "Enter", (evt) => {
      this.suggestions.useSelectedItem(evt);
      return false;
    });
  }
  onTrigger(cursor, editor, file) {
    if (this.didSelect) {
      this.didSelect = false;
      return null;
    }
    if (!this.plugin.settings.isAutosuggestEnabled) {
      return null;
    }
    ;
    const frontmatter = this.plugin.app.metadataCache.getFileCache(file).frontmatter;
    const fullLine = editor.getLine(editor.getCursor().line);
    this.inFrontmatter = frontmatter !== void 0 && frontmatter.position.start.line < cursor.line && cursor.line < frontmatter.position.end.line;
    if (this.inFrontmatter) {
      const regex = new RegExp(`^${genericFieldRegex}:(?<values>.*)`, "u");
      if (!regex.test(fullLine))
        return null;
    } else if (getLineFields(fullLine).length === 0) {
      return null;
    }
    return {
      start: cursor,
      end: cursor,
      query: editor.getLine(cursor.line)
    };
  }
  getSuggestions(context) {
    return __async(this, null, function* () {
      const suggestions = yield this.getValueSuggestions(context);
      if (suggestions.length) {
        return suggestions;
      }
      return [];
    });
  }
  getValueSuggestions(context) {
    return __async(this, null, function* () {
      var _a;
      const lineNumber = context.start.line;
      const matchField = { attribute: void 0, values: "" };
      if (!this.inFrontmatter) {
        const lineFields = getLineFields(encodeLink(context.editor.getLine(lineNumber)));
        const position = context.editor.getCursor().ch;
        const activeLineField = lineFields.find((lineField) => lineField.index <= position && lineField.index + lineField.length >= position);
        if (activeLineField) {
          this.inSentence = activeLineField.index > 0;
          this.inFullLine = activeLineField.index === 0;
          matchField.attribute = activeLineField.attribute;
          matchField.values = activeLineField.values;
        }
      } else {
        const regex = new RegExp(`^${genericFieldRegex}:(?<values>.+)?`, "u");
        const regexResult = context.editor.getRange({ line: lineNumber, ch: 0 }, context.end).match(regex);
        if (regexResult == null ? void 0 : regexResult.groups) {
          matchField.attribute = regexResult.groups.attribute;
          matchField.values = regexResult.groups.values;
        }
      }
      ;
      if (matchField.attribute) {
        const fieldName = matchField.attribute;
        const valuesList = (_a = matchField.values) == null ? void 0 : _a.replace(/^\[|^\s\[|^\(|^\s\(/, "").replace(/\]$|\)$/, "").split(",").map((o) => encodeLink(o.trim()));
        const lastValue = valuesList == null ? void 0 : valuesList.last();
        const firstValues = valuesList == null ? void 0 : valuesList.slice(0, -1);
        if (fieldName === "tags" && this.inFrontmatter) {
          return Object.keys(this.app.metadataCache.getTags()).filter((t) => lastValue ? t.contains(lastValue) : t).sort().map((tag) => Object({ value: tag.replace(/^#/, "") }));
        }
        const cache = this.plugin.app.metadataCache.getCache(context.file.path);
        let tryWithPresetField = !(cache == null ? void 0 : cache.frontmatter);
        if (cache == null ? void 0 : cache.frontmatter) {
          const _b = cache.frontmatter, { position } = _b, attributes = __objRest(_b, ["position"]);
          const fileClassAlias = this.plugin.settings.fileClassAlias;
          if (Object.keys(attributes).contains(fileClassAlias)) {
            const fileClassValue = attributes[fileClassAlias];
            try {
              const fileClass = yield createFileClass(this.plugin, fileClassValue);
              this.fileClass = fileClass;
              const fileClassAttributes = this.fileClass.attributes;
              if (fileClassAttributes.map((attr) => attr.name).contains(fieldName)) {
                const field = fileClassAttributes.find((attr) => attr.name == fieldName).getField();
                if (["Cycle" /* Cycle */, "Multi" /* Multi */, "Select" /* Select */].contains(field.type)) {
                  const filteredOptions = Array.isArray(field.options) ? field.options.filter((option) => this.filterOption(firstValues, lastValue, option)) : Object.keys(field.options).map((k) => field.options[k]).filter((option) => this.filterOption(firstValues, lastValue, option));
                  return filteredOptions.map((option) => Object({ value: option }));
                } else if (field.type === "File" /* File */) {
                  return [];
                } else {
                  return [];
                }
              }
            } catch (error) {
              tryWithPresetField = true;
            }
            ;
          } else {
            tryWithPresetField = true;
          }
          ;
        }
        ;
        if (tryWithPresetField) {
          const presetField = this.plugin.settings.presetFields.find((field) => field.name == fieldName);
          if (presetField) {
            if (["Cycle" /* Cycle */, "Multi" /* Multi */, "Select" /* Select */].contains(presetField.type)) {
              if (presetField.valuesListNotePath) {
                const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.valuesListNotePath);
                if (valuesFile instanceof import_obsidian31.TFile && valuesFile.extension == "md") {
                  const values2 = yield (yield this.plugin.app.vault.read(valuesFile)).split("\n").filter((option) => this.filterOption(firstValues, lastValue, option)).map((_value) => Object({ value: _value }));
                  return values2;
                }
                ;
              }
              ;
              const values = Object.entries(presetField.options).map((option) => option[1]).filter((option) => this.filterOption(firstValues, lastValue, option));
              return values.map((_value) => Object({ value: _value }));
            } else if (presetField.type === "File" /* File */) {
              const fieldManager = new FieldManager[presetField.type](presetField);
              const files = fieldManager.getFiles();
              if (lastValue) {
                return files.filter((f) => f.basename.includes(lastValue)).map((f) => Object({ value: FileField.buildMarkDownLink(app, context.file, f.basename) }));
              } else {
                return files.map((f) => Object({ value: FileField.buildMarkDownLink(app, context.file, f.basename) }));
              }
            } else {
              return [];
            }
          }
          ;
        }
        ;
      }
      ;
      return [];
    });
  }
  renderSuggestion(suggestion, el) {
    el.setText(suggestion.value);
  }
  selectSuggestion(suggestion, event) {
    var _a;
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian31.MarkdownView);
    if (!activeView) {
      return;
    }
    ;
    const editor = activeView.editor;
    const activeLine = editor.getLine(this.context.start.line);
    if (this.inFrontmatter) {
      try {
        let parsedField = (0, import_obsidian31.parseYaml)(activeLine);
        let [attr, pastValues] = Object.entries(parsedField)[0];
        let newField;
        if (!pastValues) {
          newField = attr + ": " + suggestion.value;
        } else if (typeof pastValues == "string") {
          if (!pastValues.contains(",")) {
            newField = attr + ": " + suggestion.value;
          } else {
            newField = attr + ": [" + pastValues.split(",").map((o) => o.trim()).slice(0, -1).join(", ") + ", " + suggestion.value + "]";
          }
        } else if (Array.isArray(pastValues)) {
          if (activeLine.endsWith(",]") || activeLine.endsWith(", ]")) {
            newField = attr + ": [" + [...pastValues, suggestion.value].join(", ") + "]";
          } else {
            newField = attr + ": [" + [...pastValues.slice(0, -1), suggestion.value].join(", ") + "]";
          }
        } else {
          newField = attr + ": [" + [...pastValues].join(", ") + "]";
        }
        editor.replaceRange(newField, { line: this.context.start.line, ch: 0 }, { line: this.context.start.line, ch: activeLine.length });
        if (Array.isArray(pastValues) || typeof pastValues === "string" && pastValues.contains(",")) {
          editor.setCursor({ line: this.context.start.line, ch: newField.length - 1 });
        } else {
          editor.setCursor({ line: this.context.start.line, ch: newField.length });
        }
      } catch (error) {
        new import_obsidian31.Notice("Frontmatter wrongly formatted", 2e3);
        this.close();
        return;
      }
    } else if (this.inFullLine) {
      let cleanedLine = activeLine;
      while (![",", ":"].contains(cleanedLine.charAt(cleanedLine.length - 1))) {
        cleanedLine = cleanedLine.slice(0, -1);
      }
      editor.replaceRange(`${cleanedLine}${event.shiftKey ? " " : ""}` + suggestion.value, { line: this.context.start.line, ch: 0 }, this.context.end);
    } else if (this.inSentence) {
      const position = ((_a = this.context) == null ? void 0 : _a.editor.getCursor().ch) || 0;
      let beforeCursor = activeLine.slice(0, position);
      let afterCursor = activeLine.slice(position);
      let separatorPos = position;
      let currentValueLength = 0;
      while (!beforeCursor.endsWith("::") && !beforeCursor.endsWith(",") && beforeCursor.length) {
        separatorPos = separatorPos - 1;
        currentValueLength = currentValueLength + 1;
        beforeCursor = beforeCursor.slice(0, -1);
      }
      let nextBracketPos = position;
      while (!encodeLink(afterCursor).match("(\\]|\\)).*") && afterCursor.length) {
        nextBracketPos = nextBracketPos + 1;
        afterCursor = afterCursor.slice(nextBracketPos - position);
      }
      editor.replaceRange(suggestion.value, { line: this.context.start.line, ch: separatorPos }, { line: this.context.start.line, ch: nextBracketPos });
      editor.setCursor({ line: this.context.start.line, ch: nextBracketPos - currentValueLength + suggestion.value.length });
    }
    this.didSelect = true;
    this.close();
  }
};

// src/settings/migrateSettingV1toV2.ts
var migrateSettingsV1toV2 = (plugin) => __async(void 0, null, function* () {
  const presetFields = plugin.settings.presetFields;
  presetFields.forEach((p) => {
    if (!Object.keys(p).contains("type")) {
      if (p.isMulti)
        p.type = "Multi" /* Multi */;
      else if (p.isCycle)
        p.type = "Cycle" /* Cycle */;
      else if (p.isBoolean)
        p.type = "Boolean" /* Boolean */;
      else if (p.options && Object.keys(p.options).length > 0)
        p.type = "Select" /* Select */;
      else
        p.type = "Input" /* Input */;
    }
    delete p.isMulti;
    delete p.isCycle;
    delete p.isBoolean;
    if (Object.getOwnPropertyDescriptor(p, "values") !== void 0) {
      Object.defineProperty(p, "options", Object.getOwnPropertyDescriptor(p, "values"));
      delete p["values"];
    }
  });
  plugin.settings.settingsVersion = 2;
  yield plugin.saveData(plugin.settings);
  console.log("Metadata menu settings migrated");
});

// main.ts
var MetadataMenu = class extends import_obsidian32.Plugin {
  constructor() {
    super(...arguments);
    this.initialProperties = [];
  }
  onload() {
    return __async(this, null, function* () {
      console.log("Metadata Menu loaded");
      yield this.loadSettings();
      if (this.settings.settingsVersion === void 0) {
        yield migrateSettingsV1toV2(this);
      }
      this.settings.presetFields.forEach((prop) => {
        const property = new Field_default();
        Object.assign(property, prop);
        this.initialProperties.push(property);
      });
      this.addSettingTab(new MetadataMenuSettingTab(this.app, this));
      this.registerEditorSuggest(new ValueSuggest(this.app, this));
      this.api = new MetadataMenuApi(this).make();
      this.addCommand({
        id: "field_options",
        name: "field options",
        checkCallback: (checking) => {
          const view = this.app.workspace.getActiveViewOfType(import_obsidian32.MarkdownView);
          if (checking) {
            return !!(view == null ? void 0 : view.file);
          }
          const fieldsOptionsModal = new NoteFieldsCommandsModal(this.app, this, view.file);
          fieldsOptionsModal.open();
        }
      });
      this.addCommand({
        id: "fileClassAttr_options",
        name: "fileClass attributes options",
        checkCallback: (checking) => {
          const view = this.app.workspace.getActiveViewOfType(import_obsidian32.MarkdownView);
          if (checking) {
            return !!(view == null ? void 0 : view.file) && `${view.file.parent.path}/` == this.settings.classFilesPath;
          }
          const modal = new FileClassAttributeSelectModal(this, view.file);
          modal.open();
        }
      });
      new linkContextMenu(this);
    });
  }
  onunload() {
    console.log("Metadata Menu unloaded");
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      this.settings.presetFields = this.initialProperties;
      yield this.saveData(this.settings);
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYi50cyIsICJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsLnRzIiwgInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyLnRzIiwgInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzLnRzIiwgInNyYy91dGlscy9wYXJzZXIudHMiLCAic3JjL29wdGlvbk1vZGFscy92YWx1ZVRleHRJbnB1dE1vZGFsLnRzIiwgInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXMudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0lucHV0RmllbGQudHMiLCAic3JjL29wdGlvbk1vZGFscy92YWx1ZVRvZ2dsZU1vZGFsLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9Cb29sZWFuRmllbGQudHMiLCAic3JjL29wdGlvbk1vZGFscy9udW1iZXJNb2RhbC50cyIsICJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTnVtYmVyRmllbGQudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0Fic3RyYWN0TGlzdEJhc2VkRmllbGQudHMiLCAic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZy50cyIsICJzcmMvc3VnZ2VzdGVyL0ZpbGVTdWdnZXN0ZXIudHMiLCAic3JjL3N1Z2dlc3Rlci9zdWdnZXN0LnRzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZW51bXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Tm9kZU5hbWUuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0V2luZG93LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2luc3RhbmNlT2YuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvYXBwbHlTdHlsZXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvbWF0aC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9jb250YWlucy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRDb21wdXRlZFN0eWxlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzVGFibGVFbGVtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldERvY3VtZW50RWxlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRQYXJlbnROb2RlLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3dpdGhpbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEZyZXNoU2lkZU9iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL21lcmdlUGFkZGluZ09iamVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2V4cGFuZFRvSGFzaE1hcC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9hcnJvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldFZhcmlhdGlvbi5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9jb21wdXRlU3R5bGVzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2V2ZW50TGlzdGVuZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZ2V0T3Bwb3NpdGVQbGFjZW1lbnQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9nZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRXaW5kb3dTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0V2luZG93U2Nyb2xsQmFyWC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9nZXRWaWV3cG9ydFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2lzU2Nyb2xsUGFyZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldFNjcm9sbFBhcmVudC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL2RvbS11dGlscy9saXN0U2Nyb2xsUGFyZW50cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3JlY3RUb0NsaWVudFJlY3QuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q2xpcHBpbmdSZWN0LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvY29tcHV0ZU9mZnNldHMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9kZXRlY3RPdmVyZmxvdy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2NvbXB1dGVBdXRvUGxhY2VtZW50LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvbW9kaWZpZXJzL2ZsaXAuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvaGlkZS5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL21vZGlmaWVycy9vZmZzZXQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcG9wcGVyT2Zmc2V0cy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL2dldEFsdEF4aXMuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9tb2RpZmllcnMvcHJldmVudE92ZXJmbG93LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldEhUTUxFbGVtZW50U2Nyb2xsLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvZG9tLXV0aWxzL2dldE5vZGVTY3JvbGwuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9kb20tdXRpbHMvZ2V0Q29tcG9zaXRlUmVjdC5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL29yZGVyTW9kaWZpZXJzLmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvZGVib3VuY2UuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy9mb3JtYXQuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi91dGlscy92YWxpZGF0ZU1vZGlmaWVycy5qcyIsICJub2RlX21vZHVsZXMvQHBvcHBlcmpzL2NvcmUvbGliL3V0aWxzL3VuaXF1ZUJ5LmpzIiwgIm5vZGVfbW9kdWxlcy9AcG9wcGVyanMvY29yZS9saWIvdXRpbHMvbWVyZ2VCeU5hbWUuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9jcmVhdGVQb3BwZXIuanMiLCAibm9kZV9tb2R1bGVzL0Bwb3BwZXJqcy9jb3JlL2xpYi9wb3BwZXIuanMiLCAic3JjL3V0aWxzL2ZpbGVVdGlscy50cyIsICJzcmMvb3B0aW9uTW9kYWxzL3ZhbHVlU2VsZWN0TW9kYWwudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL1NlbGVjdEZpZWxkLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9DeWNsZUZpZWxkLnRzIiwgInNyYy9vcHRpb25Nb2RhbHMvdmFsdWVNdWx0aVNlbGVjdE1vZGFsLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NdWx0aUZpZWxkLnRzIiwgInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9GaWxlRmllbGQudHMiLCAic3JjL29wdGlvbk1vZGFscy9maWxlRnV6enlTdWdnZXN0TW9kYWwudHMiLCAic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL01hbmFnZXJzLnRzIiwgInNyYy90eXBlcy9maWVsZFR5cGVzLnRzIiwgInNyYy9maWVsZHMvRmllbGQudHMiLCAic3JjL3N1Z2dlc3Rlci9Gb2xkZXJTdWdnZXN0ZXIudHMiLCAic3JjL3NldHRpbmdzL01ldGFkYXRhTWVudVNldHRpbmdzLnRzIiwgInNyYy9jb21tYW5kcy9nZXRWYWx1ZXMudHMiLCAic3JjL2NvbW1hbmRzL2dldEZpZWxkLnRzIiwgInNyYy91dGlscy90ZXh0VXRpbHMudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGUudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3MudHMiLCAic3JjL2NvbW1hbmRzL2ZpZWxkTW9kaWZpZXIudHMiLCAic3JjL2NvbW1hbmRzL2ZpbGVGaWVsZHMudHMiLCAic3JjL01ldGFkYXRhTWVudUFwaS50cyIsICJzcmMvb3B0aW9ucy9saW5rQ29udGV4dE1lbnUudHMiLCAic3JjL29wdGlvbk1vZGFscy9jaG9vc2VTZWN0aW9uTW9kYWwudHMiLCAic3JjL29wdGlvbk1vZGFscy9maWVsZFNlbGVjdE1vZGFsLnRzIiwgInNyYy9vcHRpb25Nb2RhbHMvYWRkTmV3RmllbGRNb2RhbC50cyIsICJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsLnRzIiwgInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwudHMiLCAic3JjL29wdGlvbnMvT3B0aW9uc0xpc3QudHMiLCAic3JjL29wdGlvbnMvTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWwudHMiLCAic3JjL29wdGlvbk1vZGFscy9TZWxlY3RNb2RhbC50cyIsICJzcmMvc3VnZ2VzdGVyL21ldGFkYXRhU3VnZ2VzdGVyLnRzIiwgInNyYy9zZXR0aW5ncy9taWdyYXRlU2V0dGluZ1YxdG9WMi50cyJdLAogICJzb3VyY2VzQ29udGVudCI6IFsiaW1wb3J0IHsgUGx1Z2luLCBNYXJrZG93blZpZXcgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgTWV0YWRhdGFNZW51U2V0dGluZ1RhYiBmcm9tIFwic3JjL3NldHRpbmdzL01ldGFkYXRhTWVudVNldHRpbmdUYWJcIjtcbmltcG9ydCB7IE1ldGFkYXRhTWVudVNldHRpbmdzLCBERUZBVUxUX1NFVFRJTkdTIH0gZnJvbSBcInNyYy9zZXR0aW5ncy9NZXRhZGF0YU1lbnVTZXR0aW5nc1wiO1xuaW1wb3J0IHR5cGUgeyBJTWV0YWRhdGFNZW51QXBpIH0gZnJvbSAnc3JjL01ldGFkYXRhTWVudUFwaSc7XG5pbXBvcnQgeyBNZXRhZGF0YU1lbnVBcGkgfSBmcm9tICdzcmMvTWV0YWRhdGFNZW51QXBpJztcbmltcG9ydCBGaWVsZCBmcm9tICdzcmMvZmllbGRzL0ZpZWxkJztcbmltcG9ydCBsaW5rQ29udGV4dE1lbnUgZnJvbSBcInNyYy9vcHRpb25zL2xpbmtDb250ZXh0TWVudVwiO1xuaW1wb3J0IE5vdGVGaWVsZHNDb21tYW5kc01vZGFsIGZyb20gXCJzcmMvb3B0aW9ucy9Ob3RlRmllbGRzQ29tbWFuZHNNb2RhbFwiO1xuaW1wb3J0IEZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsIGZyb20gJ3NyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwnO1xuaW1wb3J0IFZhbHVlU3VnZ2VzdCBmcm9tIFwic3JjL3N1Z2dlc3Rlci9tZXRhZGF0YVN1Z2dlc3RlclwiO1xuaW1wb3J0IHsgbWlncmF0ZVNldHRpbmdzVjF0b1YyIH0gZnJvbSAnc3JjL3NldHRpbmdzL21pZ3JhdGVTZXR0aW5nVjF0b1YyJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWV0YWRhdGFNZW51IGV4dGVuZHMgUGx1Z2luIHtcblx0cHVibGljIGFwaTogSU1ldGFkYXRhTWVudUFwaTtcblx0cHVibGljIHNldHRpbmdzOiBNZXRhZGF0YU1lbnVTZXR0aW5ncztcblx0cHVibGljIGluaXRpYWxQcm9wZXJ0aWVzOiBBcnJheTxGaWVsZD4gPSBbXTtcblx0cHVibGljIHNldHRpbmdUYWI6IE1ldGFkYXRhTWVudVNldHRpbmdUYWI7XG5cblx0YXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnNvbGUubG9nKCdNZXRhZGF0YSBNZW51IGxvYWRlZCcpO1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0aWYgKHRoaXMuc2V0dGluZ3Muc2V0dGluZ3NWZXJzaW9uID09PSB1bmRlZmluZWQpIHtcblx0XHRcdGF3YWl0IG1pZ3JhdGVTZXR0aW5nc1YxdG9WMih0aGlzKVxuXHRcdH1cblxuXHRcdHRoaXMuc2V0dGluZ3MucHJlc2V0RmllbGRzLmZvckVhY2gocHJvcCA9PiB7XG5cdFx0XHRjb25zdCBwcm9wZXJ0eSA9IG5ldyBGaWVsZCgpO1xuXHRcdFx0T2JqZWN0LmFzc2lnbihwcm9wZXJ0eSwgcHJvcCk7XG5cdFx0XHR0aGlzLmluaXRpYWxQcm9wZXJ0aWVzLnB1c2gocHJvcGVydHkpO1xuXHRcdH0pO1xuXHRcdHRoaXMuYWRkU2V0dGluZ1RhYihuZXcgTWV0YWRhdGFNZW51U2V0dGluZ1RhYih0aGlzLmFwcCwgdGhpcykpO1xuXG5cdFx0dGhpcy5yZWdpc3RlckVkaXRvclN1Z2dlc3QobmV3IFZhbHVlU3VnZ2VzdCh0aGlzLmFwcCwgdGhpcykpO1xuXHRcdHRoaXMuYXBpID0gbmV3IE1ldGFkYXRhTWVudUFwaSh0aGlzKS5tYWtlKCk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiZmllbGRfb3B0aW9uc1wiLFxuXHRcdFx0bmFtZTogXCJmaWVsZCBvcHRpb25zXCIsXG5cdFx0XHRjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldylcblx0XHRcdFx0aWYgKGNoZWNraW5nKSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhKHZpZXc/LmZpbGUpXG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3QgZmllbGRzT3B0aW9uc01vZGFsID0gbmV3IE5vdGVGaWVsZHNDb21tYW5kc01vZGFsKHRoaXMuYXBwLCB0aGlzLCB2aWV3IS5maWxlKVxuXHRcdFx0XHRmaWVsZHNPcHRpb25zTW9kYWwub3BlbigpXG5cdFx0XHR9LFxuXHRcdH0pO1xuXG5cdFx0LyogVE9ETyA6IGFkZCBhIGNvbnRleHQgbWVudSBmb3IgZmlsZUNsYXNzIGZpbGVzIHRvIHNob3cgdGhlIHNhbWUgb3B0aW9ucyBhcyBpbiBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCovXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcImZpbGVDbGFzc0F0dHJfb3B0aW9uc1wiLFxuXHRcdFx0bmFtZTogXCJmaWxlQ2xhc3MgYXR0cmlidXRlcyBvcHRpb25zXCIsXG5cdFx0XHRjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0Y29uc3QgdmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldylcblx0XHRcdFx0aWYgKGNoZWNraW5nKSB7XG5cdFx0XHRcdFx0cmV0dXJuICEhKHZpZXc/LmZpbGUpICYmIGAke3ZpZXcuZmlsZS5wYXJlbnQucGF0aH0vYCA9PSB0aGlzLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG5cdFx0XHRcdH1cblx0XHRcdFx0Y29uc3QgbW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwodGhpcywgdmlldyEuZmlsZSlcblx0XHRcdFx0bW9kYWwub3BlbigpXG5cdFx0XHR9LFxuXHRcdH0pO1xuXG5cdFx0bmV3IGxpbmtDb250ZXh0TWVudSh0aGlzKTtcblx0fTtcblxuXHRvbnVubG9hZCgpIHtcblx0XHRjb25zb2xlLmxvZygnTWV0YWRhdGEgTWVudSB1bmxvYWRlZCcpO1xuXHR9O1xuXG5cdGFzeW5jIGxvYWRTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzID0gT2JqZWN0LmFzc2lnbih7fSwgREVGQVVMVF9TRVRUSU5HUywgYXdhaXQgdGhpcy5sb2FkRGF0YSgpKTtcblx0fTtcblxuXHRhc3luYyBzYXZlU2V0dGluZ3MoKSB7XG5cdFx0dGhpcy5zZXR0aW5ncy5wcmVzZXRGaWVsZHMgPSB0aGlzLmluaXRpYWxQcm9wZXJ0aWVzO1xuXHRcdGF3YWl0IHRoaXMuc2F2ZURhdGEodGhpcy5zZXR0aW5ncyk7XG5cdH07XG59XG4iLCAiaW1wb3J0IHsgQXBwLCBQbHVnaW5TZXR0aW5nVGFiLCBTZXR0aW5nLCBCdXR0b25Db21wb25lbnQsIFRvZ2dsZUNvbXBvbmVudCwgTW9kYWwgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWVsZFNldHRpbmdzTW9kYWwgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdzTW9kYWxcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuaW1wb3J0IHsgRm9sZGVyU3VnZ2VzdCB9IGZyb20gXCJzcmMvc3VnZ2VzdGVyL0ZvbGRlclN1Z2dlc3RlclwiO1xuaW1wb3J0IHsgRmlsZVN1Z2dlc3QgfSBmcm9tIFwic3JjL3N1Z2dlc3Rlci9GaWxlU3VnZ2VzdGVyXCI7XG5cbmNsYXNzIFNldHRpbmdzTWlncmF0aW9uQ29uZmlybU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG5cdHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG5cdHByaXZhdGUgdGFiOiBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiO1xuXG5cdGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCB0YWI6IE1ldGFkYXRhTWVudVNldHRpbmdUYWIpIHtcblx0XHRzdXBlcihwbHVnaW4uYXBwKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLnRhYiA9IHRhYjtcblx0fTtcblxuXHRvbk9wZW4oKTogdm9pZCB7XG5cblx0XHR0aGlzLnRpdGxlRWwuc2V0VGV4dChcIkNvbmZpcm1cIik7XG5cdFx0Y29uc3QgYm9keSA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7XG5cdFx0XHRjbHM6IFwibW9kYWwtdGV4dC1kYW5nZXJcIlxuXHRcdH0pO1xuXHRcdGJvZHkuc2V0VGV4dChcIlRoaXMgd2lsbCBlcmFzZSBjdXJyZW50IHNldHRpbmdzLiBBcmUgeW91IHN1cmU/XCIpO1xuXHRcdGNvbnN0IGNvbmZpcm1CdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHRoaXMuY29udGVudEVsKTtcblx0XHRjb25maXJtQnV0dG9uLnNldEljb24oXCJjaGVja1wiKTtcblx0XHRjb25maXJtQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuXHRcdFx0Ly9AdHMtaWdub3JlXG5cdFx0XHRpZiAodGhpcy5hcHAucGx1Z2lucy5wbHVnaW5zLmhhc093blByb3BlcnR5KFwic3VwZXJjaGFyZ2VkLWxpbmtzLW9ic2lkaWFuXCIpKSB7XG5cdFx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0XHRsZXQgc2V0dGluZ3MgPSB0aGlzLmFwcC5wbHVnaW5zLnBsdWdpbnNbXCJzdXBlcmNoYXJnZWQtbGlua3Mtb2JzaWRpYW5cIl0uc2V0dGluZ3M7XG5cdFx0XHRcdC8vZGVlcCBjb3B5aW5nIHByZXNldEZpZWxkcyBpbiBpbml0aWFsUHJvcGVydHlcblx0XHRcdFx0dGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMgPSBbXTtcblx0XHRcdFx0c2V0dGluZ3MucHJlc2V0RmllbGRzLmZvckVhY2goKHByb3A6IEZpZWxkKSA9PiB7XG5cdFx0XHRcdFx0Y29uc3QgZmllbGQgPSBuZXcgRmllbGQoKTtcblx0XHRcdFx0XHRPYmplY3QuYXNzaWduKGZpZWxkLCBwcm9wKTtcblx0XHRcdFx0XHR0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5wdXNoKGZpZWxkKTtcblx0XHRcdFx0fSlcblxuXHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0dGhpcy5jbG9zZSgpO1xuXHRcdFx0fTtcblx0XHR9KTtcblx0fTtcblxuXHRvbkNsb3NlKCk6IHZvaWQge1xuXHRcdHRoaXMudGFiLmRpc3BsYXkoKTtcblx0fTtcbn07XG5cblxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiIGV4dGVuZHMgUGx1Z2luU2V0dGluZ1RhYiB7XG5cdHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG5cblx0Y29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG5cdFx0c3VwZXIoYXBwLCBwbHVnaW4pO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHR9O1xuXG5cdGRpc3BsYXkoKTogdm9pZCB7XG5cdFx0bGV0IHsgY29udGFpbmVyRWwgfSA9IHRoaXM7XG5cdFx0Y29udGFpbmVyRWwuZW1wdHkoKTtcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0R2xvYmFsIFNldHRpbmdzIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ki9cblx0XHRjb25zdCBnbG9iYWxTZXR0aW5ncyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKCdkaXYnKVxuXHRcdGdsb2JhbFNldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0dsb2JhbCBzZXR0aW5ncycsIGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRnbG9iYWxTZXR0aW5ncy5jcmVhdGVFbCgnZGl2Jywge1xuXHRcdFx0Y2xzOiBcInNldHRpbmctaXRlbS1kZXNjcmlwdGlvbiBtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1kZXNjXCIsXG5cdFx0XHR0ZXh0OiBcIkdsb2JhbCBzZXR0aW5ncyB0byBhcHBseSB0byB5b3VyIHdob2xlIHZhdWx0XCJcblx0XHR9KVxuXG5cdFx0LyogTWFuYWdlIG1lbnUgb3B0aW9ucyBkaXNwbGF5Ki9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiRGlzcGxheSBmaWVsZCBvcHRpb25zIGluIGNvbnRleHQgbWVudVwiKVxuXHRcdFx0LnNldERlc2MoXCJDaG9vc2UgdG8gc2hvdyBvciBoaWRlIGZpZWxkcyBvcHRpb25zIGluIHRoZSBjb250ZXh0IG1lbnUgb2YgYSBsaW5rIG9yIGEgZmlsZVwiKVxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlOiBUb2dnbGVDb21wb25lbnQpID0+IHtcblx0XHRcdFx0dG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51KVxuXHRcdFx0XHR0b2dnbGUub25DaGFuZ2UoYXN5bmMgdmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51ID0gdmFsdWVcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdC8qIEV4Y2x1ZGUgRmllbGRzIGZyb20gY29udGV4dCBtZW51Ki9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdHbG9iYWxseSBpZ25vcmVkIGZpZWxkcycpXG5cdFx0XHQuc2V0RGVzYygnRmllbGRzIHRvIGJlIGlnbm9yZWQgYnkgdGhlIHBsdWdpbiB3aGVuIGFkZGluZyBvcHRpb25zIHRvIHRoZSBjb250ZXh0IG1lbnUnKVxuXHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGZpZWxkcyBhcyBzdHJpbmcsIGNvbW1hIHNlcGFyYXRlZCcpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5qb2luKCcsICcpKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcyA9IHZhbHVlLnJlcGxhY2UoL1xccy9nLCAnJykuc3BsaXQoJywnKTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwucm93cyA9IDY7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5jb2xzID0gMjU7XG5cdFx0XHR9KTtcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0TWFuYWdpbmcgcHJlZGVmaW5lZCBvcHRpb25zIGZvciBwcm9wZXJ0aWVzIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0Ki9cblx0XHQvKiBBZGQgbmV3IHByb3BlcnR5IGZvciB3aGljaCB3ZSB3YW50IHRvIHByZXNldCBvcHRpb25zKi9cblx0XHRjb25zdCBwcmVzZXRGaWVsZHNTZXR0aW5ncyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIpXG5cdFx0cHJlc2V0RmllbGRzU2V0dGluZ3MuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnUHJlc2V0IEZpZWxkcyBzZXR0aW5ncycsIGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRwcmVzZXRGaWVsZHNTZXR0aW5ncy5jcmVhdGVFbCgnZGl2Jywge1xuXHRcdFx0Y2xzOiBcInNldHRpbmctaXRlbS1kZXNjcmlwdGlvbiBtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1kZXNjXCIsXG5cdFx0XHR0ZXh0OiBcIk1hbmFnZSBnbG9iYWxseSBwcmVkZWZpbmVkIHR5cGUgYW5kIG9wdGlvbnMgZm9yIGEgZmllbGQgdGhyb3VnaG91dCB5b3VyIHdob2xlIHZhdWx0XCJcblx0XHR9KVxuXHRcdG5ldyBTZXR0aW5nKHByZXNldEZpZWxkc1NldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJBZGQgTmV3IEZpZWxkIFNldHRpbmdcIilcblx0XHRcdC5zZXREZXNjKFwiQWRkIGEgbmV3IEZyb250bWF0dGVyIHByb3BlcnR5IGZvciB3aGljaCB5b3Ugd2FudCBwcmVzZXQgb3B0aW9ucy5cIilcblx0XHRcdC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50ID0+IHtcblx0XHRcdFx0cmV0dXJuIGJ1dHRvblxuXHRcdFx0XHRcdC5zZXRUb29sdGlwKFwiQWRkIE5ldyBQcm9wZXJ0eSBNYW5hZ2VyXCIpXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoXCIrXCIpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0bGV0IG1vZGFsID0gbmV3IEZpZWxkU2V0dGluZ3NNb2RhbCh0aGlzLmFwcCwgdGhpcy5wbHVnaW4sIHByZXNldEZpZWxkc1NldHRpbmdzKTtcblx0XHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0LyogTWFuYWdlZCBwcm9wZXJ0aWVzIHRoYXQgY3VycmVudGx5IGhhdmUgcHJlc2V0IG9wdGlvbnMgKi9cblx0XHR0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5mb3JFYWNoKHByb3AgPT4ge1xuXHRcdFx0Y29uc3QgcHJvcGVydHkgPSBuZXcgRmllbGQoKTtcblx0XHRcdE9iamVjdC5hc3NpZ24ocHJvcGVydHksIHByb3ApO1xuXHRcdFx0bmV3IEZpZWxkU2V0dGluZyhwcmVzZXRGaWVsZHNTZXR0aW5ncywgcHJvcGVydHksIHRoaXMuYXBwLCB0aGlzLnBsdWdpbik7XG5cdFx0fSk7XG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdE1hbmFnaW5nIGZpbGVDbGFzcyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0LyogU2V0IGNsYXNzRmlsZXMgUGF0aCovXG5cdFx0Y29uc3QgY2xhc3NGaWxlc1NldHRpbmdzID0gY29udGFpbmVyRWwuY3JlYXRlRWwoXCJkaXZcIilcblx0XHRjbGFzc0ZpbGVzU2V0dGluZ3MuY3JlYXRlRWwoJ2g0JywgeyB0ZXh0OiAnRmlsZUNsYXNzIHNldHRpbmdzJywgY2xzOiBcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1zZWN0aW9uLWhlYWRlclwiIH0pO1xuXHRcdGNsYXNzRmlsZXNTZXR0aW5ncy5jcmVhdGVFbCgnZGl2Jywge1xuXHRcdFx0Y2xzOiBcInNldHRpbmctaXRlbS1kZXNjcmlwdGlvbiBtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1kZXNjXCIsXG5cdFx0XHR0ZXh0OiBcIk1hbmFnZSBmaWxlQ2xhc3MgZm9sZGVyIGFuZCBhbGlhcy4gXCIgK1xuXHRcdFx0XHRcIldoZW4gYSBub3RlIGhhcyBhIGZpZWxDbGFzcyBkZWZpbmVkLCBmaWxlQ2xhc3MgZmllbGQgcHJvcGVydGllcyB3aWxsIG92ZXJyaWRlIGdsb2JhbCBwcmVzZXQgZmllbGRzIHNldHRpbmdzIGZvciB0aGUgc2FtZSBmaWVsZCBuYW1lXCJcblx0XHR9KVxuXHRcdG5ldyBTZXR0aW5nKGNsYXNzRmlsZXNTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdjbGFzcyBGaWxlcyBwYXRoJylcblx0XHRcdC5zZXREZXNjKCdQYXRoIHRvIHRoZSBmaWxlcyBjb250YWluaW5nIHRoZSBhdXRob3JpemVkIGZpZWxkcyBmb3IgYSB0eXBlIG9mIG5vdGUnKVxuXHRcdFx0LmFkZFNlYXJjaCgoY2ZzKSA9PiB7XG5cdFx0XHRcdG5ldyBGb2xkZXJTdWdnZXN0KHRoaXMuYXBwLCBjZnMuaW5wdXRFbCk7XG5cdFx0XHRcdGNmcy5zZXRQbGFjZWhvbGRlcihcIkZvbGRlclwiKVxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aClcblx0XHRcdFx0XHQub25DaGFuZ2UoKG5ld19mb2xkZXIpID0+IHtcblx0XHRcdFx0XHRcdGNvbnN0IG5ld1BhdGggPSBuZXdfZm9sZGVyLmVuZHNXaXRoKFwiL1wiKSA/IG5ld19mb2xkZXIgOiBuZXdfZm9sZGVyICsgXCIvXCI7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCA9IG5ld1BhdGg7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0Ly8gQHRzLWlnbm9yZVxuXHRcdFx0XHRjZnMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXNldHRpbmctZmlsZUNsYXNzLXNlYXJjaFwiKVxuXHRcdFx0fSk7XG5cblx0XHRuZXcgU2V0dGluZyhjbGFzc0ZpbGVzU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnZmlsZUNsYXNzIGZpZWxkIGFsaWFzJylcblx0XHRcdC5zZXREZXNjKCdDaG9vc2UgYW5vdGhlciBuYW1lIGZvciBmaWxlQ2xhc3MgZmllbGQgaW4gZnJvbnRtYXR0ZXIgKGV4YW1wbGU6IENhdGVnb3J5LCB0eXBlLCAuLi4nKVxuXHRcdFx0LmFkZFRleHQoKHRleHQpID0+IHtcblx0XHRcdFx0dGV4dFxuXHRcdFx0XHRcdC5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcylcblx0XHRcdFx0XHQub25DaGFuZ2UoYXN5bmMgKHZhbHVlKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcyA9IHZhbHVlO1xuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdC8qIFxuXG5cdFx0LyogU2V0IGdsb2JhbCBmaWxlQ2xhc3MqL1xuXHRcdG5ldyBTZXR0aW5nKGNsYXNzRmlsZXNTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdnbG9iYWwgZmlsZUNsYXNzJylcblx0XHRcdC5zZXREZXNjKCdDaG9vc2Ugb25lIGZpbGVDbGFzcyB0byBiZSBhcHBsaWNhYmxlIHRvIGFsbCBmaWxlcyAoZXZlbiBpdCBpcyBub3QgcHJlc2VudCBhcyBhIGZpbGVDbGFzcyBhdHRyaWJ1dGUgaW4gdGhlaXIgZnJvbnRtYXR0ZXIpLiBUaGlzIHdpbGwgb3ZlcnJpZGUgdGhlIHByZXNldCBGaWVsZHMgZGVmaW5lZCBhYm92ZScpXG5cdFx0XHQuYWRkU2VhcmNoKChjZnMpID0+IHtcblx0XHRcdFx0bmV3IEZpbGVTdWdnZXN0KFxuXHRcdFx0XHRcdHRoaXMuYXBwLFxuXHRcdFx0XHRcdGNmcy5pbnB1dEVsLFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoXG5cdFx0XHRcdCk7XG5cdFx0XHRcdGNmcy5zZXRQbGFjZWhvbGRlcihcIkdsb2JhbCBmaWxlQ2xhc3NcIilcblx0XHRcdFx0Y2ZzLnNldFZhbHVlKFxuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyA/XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5jbGFzc0ZpbGVzUGF0aCArIHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyArIFwiLm1kXCIgOlxuXHRcdFx0XHRcdFx0XCJcIlxuXHRcdFx0XHQpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKChuZXdQYXRoKSA9PiB7XG5cdFx0XHRcdFx0XHR0aGlzLnBsdWdpbi5zZXR0aW5ncy5nbG9iYWxGaWxlQ2xhc3MgPSBuZXdQYXRoID9cblx0XHRcdFx0XHRcdFx0bmV3UGF0aC5zcGxpdCgnXFxcXCcpLnBvcCgpIS5zcGxpdCgnLycpLnBvcCgpPy5yZXBsYWNlKFwiLm1kXCIsIFwiXCIpIDpcblx0XHRcdFx0XHRcdFx0XCJcIjtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHQvLyBAdHMtaWdub3JlXG5cdFx0XHRcdGNmcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1maWxlQ2xhc3Mtc2VhcmNoXCIpXG5cdFx0XHR9KVxuXG5cblx0XHQvKiBcblx0XHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0XHRNaWdyYXRpb24gc2V0dGluZ3MgXG5cdFx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdFx0Ki9cblx0XHRjb25zdCBtaWdyYXRlU2V0dGluZ3MgPSBjb250YWluZXJFbC5jcmVhdGVFbChcImRpdlwiKVxuXHRcdG1pZ3JhdGVTZXR0aW5ncy5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdNaWdyYXRlJyB9KTtcblxuXHRcdC8qIEFkZCBuZXcgcHJvcGVydHkgZm9yIHdoaWNoIHdlIHdhbnQgdG8gcHJlc2V0IG9wdGlvbnMqL1xuXHRcdG5ldyBTZXR0aW5nKG1pZ3JhdGVTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiQ29weSBzZXR0aW5ncyBmcm9tIHN1cGVyY2hhcmdlZCBsaW5rcyBwbHVnaW5cIilcblx0XHRcdC5zZXREZXNjKFwiQ29weSBzZXR0aW5ncyBmcm9tIHN1cGVyY2hhcmdlZCBsaW5rcyBwbHVnaW5cIilcblx0XHRcdC5hZGRCdXR0b24oKGJ1dHRvbjogQnV0dG9uQ29tcG9uZW50KTogQnV0dG9uQ29tcG9uZW50ID0+IHtcblx0XHRcdFx0cmV0dXJuIGJ1dHRvblxuXHRcdFx0XHRcdC5zZXRUb29sdGlwKFwiR2V0IHNldHRpbmdzIGZyb20gc3VwZXJjaGFyZ2VkIGxpbmtzXCIpXG5cdFx0XHRcdFx0LnNldEJ1dHRvblRleHQoXCJDb3B5XCIpXG5cdFx0XHRcdFx0Lm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuXHRcdFx0XHRcdFx0bGV0IG1vZGFsID0gbmV3IFNldHRpbmdzTWlncmF0aW9uQ29uZmlybU1vZGFsKHRoaXMucGx1Z2luLCB0aGlzKTtcblx0XHRcdFx0XHRcdG1vZGFsLm9wZW4oKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHR9O1xufTtcbiIsICJpbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBBcHAsIEJ1dHRvbkNvbXBvbmVudCwgRHJvcGRvd25Db21wb25lbnQsIEV4dHJhQnV0dG9uQ29tcG9uZW50LCBNb2RhbCwgTm90aWNlLCBTZXR0aW5nLCBUZXh0Q29tcG9uZW50LCBUZXh0QXJlYUNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIEZpZWxkVHlwZSwgRmllbGRUeXBlTGFiZWxNYXBwaW5nLCBGaWVsZFR5cGVUb29sdGlwIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpZWxkU2V0dGluZ3NNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIG5hbWVQcm9tcHRDb21wb25lbnQ6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBpbml0aWFsRmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgcGFyZW50U2V0dGluZz86IEZpZWxkU2V0dGluZztcbiAgICBwcml2YXRlIG5ldzogYm9vbGVhbiA9IHRydWU7XG4gICAgcHJpdmF0ZSBwYXJlbnRTZXR0aW5nQ29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIGZpZWxkT3B0aW9uc0NvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBmaWVsZE1hbmFnZXI6IEY7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIHBhcmVudFNldHRpbmdDb250YWluZXI6IEhUTUxFbGVtZW50LCBwYXJlbnRTZXR0aW5nPzogRmllbGRTZXR0aW5nLCBmaWVsZD86IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnBhcmVudFNldHRpbmcgPSBwYXJlbnRTZXR0aW5nO1xuICAgICAgICB0aGlzLmluaXRpYWxGaWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICB0aGlzLnBhcmVudFNldHRpbmdDb250YWluZXIgPSBwYXJlbnRTZXR0aW5nQ29udGFpbmVyO1xuICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgIHRoaXMubmV3ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7XG4gICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5pbml0aWFsRmllbGQsIHRoaXMuZmllbGQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgbmV3SWQgPSAxO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZm9yRWFjaChwcm9wID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQocHJvcC5pZCkgJiYgcGFyc2VJbnQocHJvcC5pZCkgPj0gbmV3SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3SWQgPSBwYXJzZUludChwcm9wLmlkKSArIDE7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5maWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICAgICAgdGhpcy5maWVsZC5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxGaWVsZC5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMuZmllbGQpO1xuICAgIH07XG5cbiAgICBhc3luYyBvbk9wZW4oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm5hbWUgPT0gXCJcIikge1xuICAgICAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYEFkZCBhIGZpZWxkIGFuZCBkZWZpbmUgb3B0aW9uc2ApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYE1hbmFnZSBzZXR0aW5ncyBvcHRpb25zIGZvciAke3RoaXMuZmllbGQubmFtZX1gKTtcbiAgICAgICAgfTtcbiAgICAgICAgYXdhaXQgdGhpcy5jcmVhdGVGb3JtKCk7XG4gICAgfTtcblxuICAgIG9uQ2xvc2UoKTogdm9pZCB7XG4gICAgICAgIE9iamVjdC5hc3NpZ24odGhpcy5maWVsZCwgdGhpcy5pbml0aWFsRmllbGQpO1xuICAgICAgICBpZiAoIXRoaXMubmV3ICYmIHRoaXMucGFyZW50U2V0dGluZykge1xuICAgICAgICAgICAgdGhpcy5wYXJlbnRTZXR0aW5nLnNldFRleHRDb250ZW50V2l0aG5hbWUoKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuc2F2ZWQpIHtcbiAgICAgICAgICAgIG5ldyBGaWVsZFNldHRpbmcodGhpcy5wYXJlbnRTZXR0aW5nQ29udGFpbmVyLCB0aGlzLmZpZWxkLCB0aGlzLmFwcCwgdGhpcy5wbHVnaW4pO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZW5hbWVJbnB1dENvbnRhaW5lcihwYXJlbnROb2RlOiBIVE1MRGl2RWxlbWVudCk6IFRleHRDb21wb25lbnQge1xuICAgICAgICBjb25zdCBmaWVsZE5hbWVDb250YWluZXJMYWJlbCA9IHBhcmVudE5vZGUuY3JlYXRlRGl2KCk7XG4gICAgICAgIGZpZWxkTmFtZUNvbnRhaW5lckxhYmVsLnNldFRleHQoYEZpZWxkIE5hbWU6YCk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IFRleHRDb21wb25lbnQocGFyZW50Tm9kZSk7XG4gICAgICAgIGNvbnN0IG5hbWUgPSB0aGlzLmZpZWxkLm5hbWU7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKG5hbWUpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihcIk5hbWUgb2YgdGhlIGZpZWxkXCIpO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm5hbWUgPSB2YWx1ZTtcbiAgICAgICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBNYW5hZ2UgcHJlZGVmaW5lZCBvcHRpb25zIGZvciAke3RoaXMuZmllbGQubmFtZX1gKTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoaW5wdXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZVR5cGVTZWxlY3RvckNvbnRhaW5lcihwYXJlbnROb2RlOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB0eXBlU2VsZWN0b3JDb250YWluZXJMYWJlbCA9IHBhcmVudE5vZGUuY3JlYXRlRGl2KCk7XG4gICAgICAgIHR5cGVTZWxlY3RvckNvbnRhaW5lckxhYmVsLnNldFRleHQoYEZpZWxkIHR5cGU6YCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChwYXJlbnROb2RlKTtcbiAgICAgICAgT2JqZWN0LmtleXMoRmllbGRUeXBlTGFiZWxNYXBwaW5nKS5mb3JFYWNoKChmOiBrZXlvZiB0eXBlb2YgRmllbGRUeXBlKSA9PiBzZWxlY3QuYWRkT3B0aW9uKGYsIEZpZWxkVHlwZVRvb2x0aXBbZl0pKVxuICAgICAgICBpZiAodGhpcy5maWVsZC50eXBlKSB7XG4gICAgICAgICAgICBzZWxlY3Quc2V0VmFsdWUodGhpcy5maWVsZC50eXBlKVxuICAgICAgICB9XG4gICAgICAgIHNlbGVjdC5vbkNoYW5nZSgodHlwZUxhYmVsOiBrZXlvZiB0eXBlb2YgRmllbGRUeXBlKSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5maWVsZCwgdGhpcy5pbml0aWFsRmllbGQpO1xuICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lID0gdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50LmdldFZhbHVlKClcbiAgICAgICAgICAgIHRoaXMuZmllbGQudHlwZSA9IEZpZWxkVHlwZUxhYmVsTWFwcGluZ1t0eXBlTGFiZWxdO1xuICAgICAgICAgICAgaWYgKHRoaXMuZmllbGQudHlwZSAhPT0gdGhpcy5pbml0aWFsRmllbGQudHlwZSAmJlxuICAgICAgICAgICAgICAgICFbdGhpcy5maWVsZC50eXBlLCB0aGlzLmluaXRpYWxGaWVsZC50eXBlXS5ldmVyeShmaWVsZFR5cGUgPT5cbiAgICAgICAgICAgICAgICAgICAgW0ZpZWxkVHlwZS5NdWx0aSwgRmllbGRUeXBlLlNlbGVjdCwgRmllbGRUeXBlLkN5Y2xlXS5pbmNsdWRlcyhmaWVsZFR5cGUpXG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zID0ge31cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHdoaWxlICh0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5maXJzdENoaWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIucmVtb3ZlQ2hpbGQodGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIuZmlyc3RDaGlsZCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLmZpZWxkKVxuICAgICAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIuY3JlYXRlU2V0dGluZ0NvbnRhaW5lcih0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciwgdGhpcy5wbHVnaW4sIFNldHRpbmdMb2NhdGlvbi5QbHVnaW5TZXR0aW5ncylcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGFzeW5jIGNyZWF0ZUZvcm0oKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGRpdiA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXByb21wdC1kaXZcIiB9KTtcbiAgICAgICAgY29uc3QgbWFpbkRpdiA9IGRpdi5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1wcm9tcHQtZm9ybVwiIH0pO1xuXG4gICAgICAgIC8qIFNlY3Rpb25zICovXG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQgPSB0aGlzLmNyZWF0ZW5hbWVJbnB1dENvbnRhaW5lcihuYW1lQ29udGFpbmVyKTtcbiAgICAgICAgbWFpbkRpdi5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICBjb25zdCB0eXBlU2VsZWN0Q29udGFpbmVyID0gbWFpbkRpdi5jcmVhdGVEaXYoKVxuICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciA9IG1haW5EaXYuY3JlYXRlRGl2KClcblxuICAgICAgICAvKiBmb290ZXIgYnV0dG9ucyovXG4gICAgICAgIGNvbnN0IGZvb3RlckVsID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGZvb3RlckJ1dHRvbnMgPSBuZXcgU2V0dGluZyhmb290ZXJFbCk7XG4gICAgICAgIGZvb3RlckJ1dHRvbnMuYWRkQnV0dG9uKChiKSA9PiB0aGlzLmNyZWF0ZVNhdmVCdXR0b24oYikpO1xuICAgICAgICBmb290ZXJCdXR0b25zLmFkZEV4dHJhQnV0dG9uKChiKSA9PiB0aGlzLmNyZWF0ZUNhbmNlbEJ1dHRvbihiKSk7XG5cbiAgICAgICAgLyogaW5pdCBzdGF0ZSAqL1xuICAgICAgICB0aGlzLmNyZWF0ZVR5cGVTZWxlY3RvckNvbnRhaW5lcih0eXBlU2VsZWN0Q29udGFpbmVyKVxuICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci5jcmVhdGVTZXR0aW5nQ29udGFpbmVyKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLCB0aGlzLnBsdWdpbiwgU2V0dGluZ0xvY2F0aW9uLlBsdWdpblNldHRpbmdzKVxuICAgIH07XG5cbiAgICBwcml2YXRlIHZhbGlkYXRlRmllbGRzKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdGhpcy5maWVsZE1hbmFnZXIudmFsaWRhdGVOYW1lKFxuICAgICAgICAgICAgdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50LFxuICAgICAgICAgICAgdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50LmlucHV0RWxcbiAgICAgICAgKSAmJlxuICAgICAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIudmFsaWRhdGVPcHRpb25zKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVTYXZlQnV0dG9uKGI6IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCB7XG4gICAgICAgIGIuc2V0VG9vbHRpcChcIlNhdmVcIik7XG4gICAgICAgIGIuc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgYi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGxldCBlcnJvciA9ICF0aGlzLnZhbGlkYXRlRmllbGRzKCk7XG4gICAgICAgICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiRml4IGVycm9ycyBiZWZvcmUgc2F2aW5nLlwiKTtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5zYXZlZCA9IHRydWU7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50RXhpc3RpbmdGaWVsZCA9IHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLmZpbHRlcihwID0+IHAuaWQgPT0gdGhpcy5maWVsZC5pZClbMF07XG4gICAgICAgICAgICBpZiAoY3VycmVudEV4aXN0aW5nRmllbGQpIHtcbiAgICAgICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkoY3VycmVudEV4aXN0aW5nRmllbGQsIHRoaXMuZmllbGQpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5wdXNoKHRoaXMuZmllbGQpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIEZpZWxkLmNvcHlQcm9wZXJ0eSh0aGlzLmluaXRpYWxGaWVsZCwgdGhpcy5maWVsZClcbiAgICAgICAgICAgIGlmICh0aGlzLnBhcmVudFNldHRpbmcpIEZpZWxkLmNvcHlQcm9wZXJ0eSh0aGlzLnBhcmVudFNldHRpbmcuZmllbGQsIHRoaXMuZmllbGQpO1xuICAgICAgICAgICAgdGhpcy5wYXJlbnRTZXR0aW5nPy5zZXRUZXh0Q29udGVudFdpdGhuYW1lKClcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGI7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlQ2FuY2VsQnV0dG9uKGI6IEV4dHJhQnV0dG9uQ29tcG9uZW50KTogRXh0cmFCdXR0b25Db21wb25lbnQge1xuICAgICAgICBiLnNldEljb24oXCJjcm9zc1wiKVxuICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJDYW5jZWxcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICB0aGlzLnNhdmVkID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgLyogcmVzZXQgb3B0aW9ucyBmcm9tIHNldHRpbmdzICovXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbEZpZWxkLm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZmllbGQsIHRoaXMuaW5pdGlhbEZpZWxkKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYjtcbiAgICB9O1xuXG4gICAgLyogdXRpbHMgZnVuY3Rpb25zICovXG5cbiAgICBwdWJsaWMgc3RhdGljIHNldFZhbGlkYXRpb25FcnJvcih0ZXh0SW5wdXQ6IFRleHRDb21wb25lbnQsIGluc2VydEFmdGVyOiBFbGVtZW50LCBtZXNzYWdlPzogc3RyaW5nKSB7XG4gICAgICAgIHRleHRJbnB1dC5pbnB1dEVsLmFkZENsYXNzKFwiaXMtaW52YWxpZFwiKTtcbiAgICAgICAgaWYgKG1lc3NhZ2UgJiYgdGV4dElucHV0LmlucHV0RWwucGFyZW50RWxlbWVudD8ubGFzdEVsZW1lbnRDaGlsZCkge1xuXG4gICAgICAgICAgICBsZXQgbURpdiA9IHRleHRJbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgICAgICAgICAgICAgICBcIi5pbnZhbGlkLWZlZWRiYWNrXCJcbiAgICAgICAgICAgICkgYXMgSFRNTERpdkVsZW1lbnQ7XG5cbiAgICAgICAgICAgIGlmICghbURpdikge1xuICAgICAgICAgICAgICAgIG1EaXYgPSBjcmVhdGVEaXYoeyBjbHM6IFwiaW52YWxpZC1mZWVkYmFja1wiIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbURpdi5pbm5lclRleHQgPSBtZXNzYWdlO1xuICAgICAgICAgICAgbURpdi5pbnNlcnRBZnRlcihpbnNlcnRBZnRlcik7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcHVibGljIHN0YXRpYyByZW1vdmVWYWxpZGF0aW9uRXJyb3IodGV4dElucHV0OiBUZXh0Q29tcG9uZW50IHwgVGV4dEFyZWFDb21wb25lbnQpIHtcbiAgICAgICAgaWYgKHRleHRJbnB1dC5pbnB1dEVsLmhhc0NsYXNzKFwiaXMtaW52YWxpZFwiKSAmJiB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICB0ZXh0SW5wdXQuaW5wdXRFbC5yZW1vdmVDbGFzcyhcImlzLWludmFsaWRcIilcbiAgICAgICAgICAgIHRleHRJbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoXG4gICAgICAgICAgICAgICAgdGV4dElucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5sYXN0RWxlbWVudENoaWxkXG4gICAgICAgICAgICApO1xuICAgICAgICB9O1xuICAgIH07XG59OyIsICJpbXBvcnQgeyBBcHAsIFRGaWxlLCBNZW51LCBUZXh0Q29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuL0ZpZWxkXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRk0gfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcblxuXG5leHBvcnQgaW50ZXJmYWNlIEZpZWxkTWFuYWdlciB7XG4gICAgZmllbGQ6IEZpZWxkO1xufVxuXG5leHBvcnQgY29uc3QgZW51bSBTZXR0aW5nTG9jYXRpb24ge1xuICAgIFwiUGx1Z2luU2V0dGluZ3NcIixcbiAgICBcIkZpbGVDbGFzc0F0dHJpYnV0ZVNldHRpbmdzXCJcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBhYnN0cmFjdCBhZGRNZW51T3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBjYXRlZ29yeTogTWVudSB8IFNlbGVjdE1vZGFsKTogdm9pZDtcbiAgICBhYnN0cmFjdCB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbjtcbiAgICBhYnN0cmFjdCBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsb2NhdGlvbj86IFNldHRpbmdMb2NhdGlvbik6IHZvaWQ7XG4gICAgYWJzdHJhY3QgY3JlYXRlRHZGaWVsZChwbHVnaW46IE1ldGFkYXRhTWVudSwgZHY6IGFueSwgcDogYW55LCBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KTogUHJvbWlzZTx2b2lkPlxuICAgIGFic3RyYWN0IGdldE9wdGlvbnNTdHIoKTogc3RyaW5nO1xuICAgIGFic3RyYWN0IGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIHRvcD86IGJvb2xlYW4pOiB2b2lkXG5cbiAgICBjb25zdHJ1Y3RvcihmaWVsZDogRmllbGQsIHR5cGU6IEZpZWxkVHlwZSkge1xuICAgICAgICBpZiAoZmllbGQudHlwZSAhPT0gdHlwZSkgdGhyb3cgRXJyb3IoYFRoaXMgZmllbGQgaXMgbm90IG9mIHR5cGUgJHt0eXBlfWApXG4gICAgICAgIHRoaXMuZmllbGQgPSBmaWVsZFxuICAgIH1cblxuICAgIHZhbGlkYXRlTmFtZSh0ZXh0SW5wdXQ6IFRleHRDb21wb25lbnQsIGluc2VydEFmdGVyOiBFbGVtZW50KTogYm9vbGVhbiB7XG4gICAgICAgIGxldCBlcnJvciA9IGZhbHNlO1xuICAgICAgICBpZiAoL15bIz4tXS8udGVzdCh0aGlzLmZpZWxkLm5hbWUpKSB7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgIHRleHRJbnB1dCwgaW5zZXJ0QWZ0ZXIsXG4gICAgICAgICAgICAgICAgXCJGaWVsZCBuYW1lIGNhbm5vdCBzdGFydCB3aXRoICMsID4sIC1cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKHRoaXMuZmllbGQubmFtZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgIHRleHRJbnB1dCwgaW5zZXJ0QWZ0ZXIsXG4gICAgICAgICAgICAgICAgXCJGaWVsZCBuYW1lIGNhbiBub3QgYmUgRW1wdHlcIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgfTtcbiAgICAgICAgcmV0dXJuICFlcnJvclxuICAgIH1cblxuICAgIGFzeW5jIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICBzdGF0aWMgcmVwbGFjZVZhbHVlcyhhcHA6IEFwcCwgcGF0aDogc3RyaW5nLCBmaWVsZE5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwYXRoKVxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhhcHAsIGZpbGUsIGZpZWxkTmFtZSwgdmFsdWUpXG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBzdGF0aWMgaXNNZW51KGNhdGVnb3J5OiBNZW51IHwgU2VsZWN0TW9kYWwpOiBjYXRlZ29yeSBpcyBNZW51IHtcbiAgICAgICAgcmV0dXJuIChjYXRlZ29yeSBhcyBNZW51KS5hZGRJdGVtICE9PSB1bmRlZmluZWQ7XG4gICAgfTtcblxuICAgIHN0YXRpYyBpc1NlbGVjdChjYXRlZ29yeTogTWVudSB8IFNlbGVjdE1vZGFsKTogY2F0ZWdvcnkgaXMgU2VsZWN0TW9kYWwge1xuICAgICAgICByZXR1cm4gKGNhdGVnb3J5IGFzIFNlbGVjdE1vZGFsKS5tb2RhbHMgIT09IHVuZGVmaW5lZDtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBjcmVhdGVEZWZhdWx0KG5hbWU6IHN0cmluZyk6IEZpZWxkTWFuYWdlciB7XG4gICAgICAgIGNvbnN0IGZpZWxkID0gRmllbGQuY3JlYXRlRGVmYXVsdChuYW1lKTtcbiAgICAgICAgcmV0dXJuIG5ldyBGTVtmaWVsZC50eXBlXShmaWVsZCk7XG4gICAgfVxufSIsICJpbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBmaWVsZENvbXBvbmVudHMsIGlubGluZUZpZWxkUmVnZXgsIGVuY29kZUxpbmssIGRlY29kZUxpbmsgfSBmcm9tIFwic3JjL3V0aWxzL3BhcnNlclwiO1xuXG5jb25zdCBlbnVtIExvY2F0aW9uIHtcbiAgICAnZnVsbExpbmUnID0gJ2Z1bGxMaW5lJyxcbiAgICAnYnJhY2tldHMnID0gJ2JyYWNrZXRzJyxcbiAgICAncGFyZW50aGVzaXMnID0gJ3BhcmVudGhlc2lzJ1xufVxuXG5jb25zdCBMb2NhdGlvbldyYXBwZXI6IFJlY29yZDxrZXlvZiB0eXBlb2YgTG9jYXRpb24sIHsgc3RhcnQ6IFwiXCIgfCBcIltcIiB8IFwiKFwiLCBlbmQ6IFwiXCIgfCBcIl1cIiB8IFwiKVwiIH0+ID0ge1xuICAgIFwiZnVsbExpbmVcIjogeyBzdGFydDogXCJcIiwgZW5kOiBcIlwiIH0sXG4gICAgXCJicmFja2V0c1wiOiB7IHN0YXJ0OiBcIltcIiwgZW5kOiBcIl1cIiB9LFxuICAgIFwicGFyZW50aGVzaXNcIjogeyBzdGFydDogXCIoXCIsIGVuZDogXCIpXCIgfVxufVxuXG50eXBlIEZpZWxkUmVwbGFjZSA9IHtcbiAgICBvbGRGaWVsZDogc3RyaW5nLFxuICAgIG5ld0ZpZWxkOiBzdHJpbmcsXG59XG5cbmV4cG9ydCBjb25zdCBtYXRjaElubGluZUZpZWxkcyA9IChyZWdleDogUmVnRXhwLCBsaW5lOiBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nLCBpbnB1dDogc3RyaW5nLCBsb2NhdGlvbjoga2V5b2YgdHlwZW9mIExvY2F0aW9uID0gXCJmdWxsTGluZVwiKTogRmllbGRSZXBsYWNlW10gPT4ge1xuICAgIGNvbnN0IHNSID0gbGluZS5tYXRjaEFsbChyZWdleCk7XG4gICAgbGV0IG5leHQgPSBzUi5uZXh0KCk7XG4gICAgY29uc3QgbmV3RmllbGRzOiBGaWVsZFJlcGxhY2VbXSA9IFtdO1xuICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgIGNvbnN0IG1hdGNoID0gbmV4dC52YWx1ZTtcbiAgICAgICAgaWYgKG1hdGNoLmdyb3VwcyAmJiBPYmplY3Qua2V5cyhtYXRjaC5ncm91cHMpLmV2ZXJ5KGogPT4gZmllbGRDb21wb25lbnRzLmluY2x1ZGVzKGopKSkge1xuICAgICAgICAgICAgY29uc3QgeyBpbkxpc3QsIHN0YXJ0U3R5bGUsIGVuZFN0eWxlLCBiZWZvcmVTZXBhcmF0b3JTcGFjZXIsIGFmdGVyU2VwYXJhdG9yU3BhY2VyLCB2YWx1ZXMgfSA9IG1hdGNoLmdyb3Vwc1xuICAgICAgICAgICAgY29uc3QgaW5wdXRBcnJheSA9IGlucHV0ID8gaW5wdXQucmVwbGFjZSgvKFxcLFxccyspL2csICcsJykuc3BsaXQoJywnKSA6IFtcIlwiXTtcbiAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gaW5wdXRBcnJheS5sZW5ndGggPT0gMSA/IGlucHV0QXJyYXlbMF0gOiBgJHtpbnB1dEFycmF5LmpvaW4oJywgJyl9YDtcbiAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gTG9jYXRpb25XcmFwcGVyW2xvY2F0aW9uXS5zdGFydDtcbiAgICAgICAgICAgIGNvbnN0IGVuZCA9IExvY2F0aW9uV3JhcHBlcltsb2NhdGlvbl0uZW5kO1xuICAgICAgICAgICAgbmV3RmllbGRzLnB1c2goe1xuICAgICAgICAgICAgICAgIG9sZEZpZWxkOiBtYXRjaFswXSxcbiAgICAgICAgICAgICAgICBuZXdGaWVsZDogYCR7c3RhcnR9JHtpbkxpc3QgfHwgXCJcIn0ke3N0YXJ0U3R5bGV9JHthdHRyaWJ1dGV9JHtlbmRTdHlsZX0ke2JlZm9yZVNlcGFyYXRvclNwYWNlcn06OiR7YWZ0ZXJTZXBhcmF0b3JTcGFjZXJ9JHtuZXdWYWx1ZX0ke2VuZH1gLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBuZXh0ID0gc1IubmV4dCgpXG4gICAgfVxuICAgIHJldHVybiBuZXdGaWVsZHNcbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VWYWx1ZXMoYXBwOiBBcHAsIGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcsIGlucHV0OiBzdHJpbmcpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPckZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPckZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlT3JGaWxlUGF0aClcbiAgICAgICAgaWYgKF9maWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgX2ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmlsZSA9IF9maWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGNvbnRlbnQgPSAoYXdhaXQgYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSkpLnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcjtcbiAgICBjb25zdCB7IHBvc2l0aW9uOiB7IHN0YXJ0LCBlbmQgfSB9ID0gZnJvbnRtYXR0ZXIgPyBmcm9udG1hdHRlciA6IHsgcG9zaXRpb246IHsgc3RhcnQ6IHVuZGVmaW5lZCwgZW5kOiB1bmRlZmluZWQgfSB9O1xuICAgIGNvbnN0IG5ld0NvbnRlbnQgPSBjb250ZW50Lm1hcCgobGluZSwgaSkgPT4ge1xuICAgICAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgaSA+PSBzdGFydC5saW5lICYmIGkgPD0gZW5kLmxpbmUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgJHthdHRyaWJ1dGV9OmAsICd1Jyk7XG4gICAgICAgICAgICBjb25zdCByID0gbGluZS5tYXRjaChyZWdleCk7XG4gICAgICAgICAgICBpZiAociAmJiByLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEFycmF5ID0gaW5wdXQgPyBpbnB1dC5yZXBsYWNlKC8oXFwsXFxzKykvZywgJywnKS5zcGxpdCgnLCcpIDogW1wiXCJdO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gaW5wdXRBcnJheS5sZW5ndGggPT0gMSA/IGlucHV0QXJyYXlbMF0gOiBgWyR7aW5wdXRBcnJheS5qb2luKCcsICcpfV1gO1xuICAgICAgICAgICAgICAgIHJldHVybiBgJHthdHRyaWJ1dGV9OiAke25ld1ZhbHVlfWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZW5jb2RlZElucHV0ID0gZW5jb2RlTGluayhpbnB1dClcbiAgICAgICAgICAgIGxldCBlbmNvZGVkTGluZSA9IGVuY29kZUxpbmsobGluZSlcbiAgICAgICAgICAgIGNvbnN0IGZ1bGxMaW5lUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9YCwgXCJ1XCIpO1xuICAgICAgICAgICAgY29uc3QgZlIgPSBlbmNvZGVkTGluZS5tYXRjaChmdWxsTGluZVJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChmUj8uZ3JvdXBzICYmIE9iamVjdC5rZXlzKGZSLmdyb3VwcykuZXZlcnkoaiA9PiBmaWVsZENvbXBvbmVudHMuaW5jbHVkZXMoaikpKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBpbkxpc3QsIHN0YXJ0U3R5bGUsIGVuZFN0eWxlLCBiZWZvcmVTZXBhcmF0b3JTcGFjZXIsIGFmdGVyU2VwYXJhdG9yU3BhY2VyLCB2YWx1ZXMgfSA9IGZSLmdyb3Vwc1xuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0QXJyYXkgPSBpbnB1dCA/IGlucHV0LnJlcGxhY2UoLyhcXCxcXHMrKS9nLCAnLCcpLnNwbGl0KCcsJykgOiBbXCJcIl07XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gaW5wdXRBcnJheVswXSA6IGAke2lucHV0QXJyYXkuam9pbignLCAnKX1gO1xuICAgICAgICAgICAgICAgIHJldHVybiBgJHtpbkxpc3QgfHwgXCJcIn0ke3N0YXJ0U3R5bGV9JHthdHRyaWJ1dGV9JHtlbmRTdHlsZX0ke2JlZm9yZVNlcGFyYXRvclNwYWNlcn06OiR7YWZ0ZXJTZXBhcmF0b3JTcGFjZXJ9JHtuZXdWYWx1ZX1gO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCBuZXdGaWVsZHM6IEZpZWxkUmVwbGFjZVtdID0gW107XG4gICAgICAgICAgICAgICAgY29uc3QgaW5TZW50ZW5jZVJlZ2V4QnJhY2tldHMgPSBuZXcgUmVnRXhwKGBcXFxcWyR7aW5saW5lRmllbGRSZWdleChhdHRyaWJ1dGUpfVxcXFxdYCwgXCJndVwiKTtcbiAgICAgICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhQYXIgPSBuZXcgUmVnRXhwKGBcXFxcKCR7aW5saW5lRmllbGRSZWdleChhdHRyaWJ1dGUpfVxcXFwpYCwgXCJndVwiKTtcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHMucHVzaCguLi5tYXRjaElubGluZUZpZWxkcyhpblNlbnRlbmNlUmVnZXhCcmFja2V0cywgZW5jb2RlZExpbmUsIGF0dHJpYnV0ZSwgZW5jb2RlZElucHV0LCBMb2NhdGlvbi5icmFja2V0cykpXG4gICAgICAgICAgICAgICAgbmV3RmllbGRzLnB1c2goLi4ubWF0Y2hJbmxpbmVGaWVsZHMoaW5TZW50ZW5jZVJlZ2V4UGFyLCBlbmNvZGVkTGluZSwgYXR0cmlidXRlLCBlbmNvZGVkSW5wdXQsIExvY2F0aW9uLnBhcmVudGhlc2lzKSlcbiAgICAgICAgICAgICAgICBuZXdGaWVsZHMuZm9yRWFjaChmaWVsZCA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkUmVnZXggPSBuZXcgUmVnRXhwKGZpZWxkLm9sZEZpZWxkLnJlcGxhY2UoL1suKis/XiR7fSgpfFtcXF1cXFxcXS9nLCAnXFxcXCQmJyksIFwidVwiKVxuICAgICAgICAgICAgICAgICAgICBlbmNvZGVkTGluZSA9IGVuY29kZWRMaW5lLnJlcGxhY2UoZmllbGRSZWdleCwgZmllbGQubmV3RmllbGQpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgcmV0dXJuIGRlY29kZUxpbmsoZW5jb2RlZExpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICBhcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xufSIsICJleHBvcnQgY29uc3QgZmllbGRDb21wb25lbnRzID0gWydpbkxpc3QnLCAnc3RhcnRTdHlsZScsICdhdHRyaWJ1dGUnLCAnZW5kU3R5bGUnLCAnYmVmb3JlU2VwYXJhdG9yU3BhY2VyJywgJ2FmdGVyU2VwYXJhdG9yU3BhY2VyJywgJ3ZhbHVlcyddXG5cbmV4cG9ydCBjb25zdCBnZW5lcmljRmllbGRSZWdleCA9IFwiKD88aW5MaXN0Pi0gKT8oPzxzdGFydFN0eWxlPltfXFxcXCp+YF0qKSg/PGF0dHJpYnV0ZT5bMC05XFxcXHdcXFxccHtMZXR0ZXJ9XFxcXHB7RW1vamlfUHJlc2VudGF0aW9ufV1bLTAtOVxcXFx3XFxcXHB7TGV0dGVyfVxcXFxwe0Vtb2ppX1ByZXNlbnRhdGlvbn1cXFxcc10qKSg/PGVuZFN0eWxlPltfXFxcXCp+YF0qKSg/PGJlZm9yZVNlcGFyYXRvclNwYWNlcj5cXFxccyopXCI7XG5cbmV4cG9ydCBjb25zdCBpbmxpbmVGaWVsZFJlZ2V4ID0gKGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBgKD88aW5MaXN0Pi0gKT8oPzxzdGFydFN0eWxlPltfXFxcXCp+XFxgXSopKD88YXR0cmlidXRlPiR7YXR0cmlidXRlfSkoPzxlbmRTdHlsZT5bX1xcXFwqflxcYF0qKSg/PGJlZm9yZVNlcGFyYXRvclNwYWNlcj5cXFxccyopOjooPzxhZnRlclNlcGFyYXRvclNwYWNlcj5cXFxccyopKD88dmFsdWVzPlteXFxcXF1dKilgO1xuXG5leHBvcnQgY29uc3QgZnVsbExpbmVSZWdleCA9IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTo6XFxzKig/PHZhbHVlcz4uKik/YCwgXCJ1XCIpO1xuXG4vL3NlYXJjaCBmb3IgdGhlbVxuZXhwb3J0IGNvbnN0IGluU2VudGVuY2VSZWdleEJyYWNrZXRzID0gbmV3IFJlZ0V4cChgXFxcXFske2dlbmVyaWNGaWVsZFJlZ2V4fTo6XFxzKig/PHZhbHVlcz5bXlxcXFxdXSspP1xcXFxdYCwgXCJndVwiKTtcbmV4cG9ydCBjb25zdCBpblNlbnRlbmNlUmVnZXhQYXIgPSBuZXcgUmVnRXhwKGBcXFxcKCR7Z2VuZXJpY0ZpZWxkUmVnZXh9OjpcXHMqKD88dmFsdWVzPlteXFxcXF1dKyk/XFxcXClgLCBcImd1XCIpO1xuXG5leHBvcnQgY29uc3QgZW5jb2RlTGluayA9ICh2YWx1ZTogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICAvKiByZXBsYWNlIGxpbmsgYnJhY2tldHMgYnkgXCJpbXBvc3NpYmxlXCIgY29tYmluYXRpb24gb2YgY2hhcmFjdGVycyBzbyB0aGF0IHRoZXkgd29uJ3QgYmUgbWl4ZWQgdXAgd2l0aCBpblNlbnRlbmNlIGZpZWxkIGJyYWNrZXRzIHdoZW4gc2VhY2hpbmcgd2l0aCByZWdleCovXG4gICAgcmV0dXJuIHZhbHVlID8gdmFsdWVcbiAgICAgICAgLnJlcGxhY2UoL1xcW1xcWy9nLCBcIlx1RDgzRFx1REQyN1x1RDgzRFx1REMwMFwiKVxuICAgICAgICAucmVwbGFjZSgvXFxdXFxdL2csIFwiXHVEODNEXHVEQzEzXHVEODNEXHVERDRDXCIpIDogdmFsdWVcbn1cblxuZXhwb3J0IGNvbnN0IGRlY29kZUxpbmsgPSAodmFsdWU6IHN0cmluZyk6IHN0cmluZyA9PiB7XG4gICAgLyogcmVwbGFjZSBsaW5rIGJyYWNrZXRzIGJ5IFwiaW1wb3NzaWJsZVwiIGNvbWJpbmF0aW9uIG9mIGNoYXJhY3RlcnMgc28gdGhhdCB0aGV5IHdvbid0IGJlIG1peGVkIHVwIHdpdGggaW5TZW50ZW5jZSBmaWVsZCBicmFja2V0cyB3aGVuIHNlYWNoaW5nIHdpdGggcmVnZXgqL1xuICAgIHJldHVybiB2YWx1ZSA/IHZhbHVlXG4gICAgICAgIC5yZXBsYWNlKC9cdUQ4M0RcdUREMjdcdUQ4M0RcdURDMDAvZ3UsIFwiW1tcIilcbiAgICAgICAgLnJlcGxhY2UoL1x1RDgzRFx1REMxM1x1RDgzRFx1REQ0Qy9ndSwgXCJdXVwiKSA6IHZhbHVlXG59XG5cbmV4cG9ydCBjb25zdCBnZXRMaW5lRmllbGRzID0gKGxpbmU6IHN0cmluZyk6IHsgYXR0cmlidXRlOiBzdHJpbmcsIHZhbHVlczogc3RyaW5nLCBpbmRleDogbnVtYmVyLCBsZW5ndGg6IG51bWJlciB9W10gPT4ge1xuICAgIGNvbnN0IGZpZWxkczogeyBhdHRyaWJ1dGU6IHN0cmluZywgdmFsdWVzOiBzdHJpbmcsIGluZGV4OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyIH1bXSA9IFtdXG4gICAgY29uc3QgZlIgPSBsaW5lLm1hdGNoKGZ1bGxMaW5lUmVnZXgpO1xuICAgIGlmIChmUj8uZ3JvdXBzKSB7XG4gICAgICAgIGNvbnN0IHsgYXR0cmlidXRlLCB2YWx1ZXMgfSA9IGZSPy5ncm91cHNcbiAgICAgICAgZmllbGRzLnB1c2goeyBhdHRyaWJ1dGUsIHZhbHVlcywgaW5kZXg6IDAsIGxlbmd0aDogbGluZS5sZW5ndGggfSlcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBzUkJrID0gZW5jb2RlTGluayhsaW5lKS5tYXRjaEFsbChpblNlbnRlbmNlUmVnZXhCcmFja2V0cyk7XG4gICAgICAgIGxldCBuZXh0ID0gc1JCay5uZXh0KCk7XG4gICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICBpZiAobmV4dC52YWx1ZS5ncm91cHMpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IGF0dHJpYnV0ZSwgdmFsdWVzIH0gPSBuZXh0LnZhbHVlLmdyb3VwcztcbiAgICAgICAgICAgICAgICBmaWVsZHMucHVzaCh7IGF0dHJpYnV0ZSwgdmFsdWVzOiBkZWNvZGVMaW5rKHZhbHVlcyksIGluZGV4OiBuZXh0LnZhbHVlLmluZGV4IHx8IDAsIGxlbmd0aDogbmV4dC52YWx1ZVswXS5sZW5ndGggfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBuZXh0ID0gc1JCay5uZXh0KCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgc1JCYyA9IGVuY29kZUxpbmsobGluZSkubWF0Y2hBbGwoaW5TZW50ZW5jZVJlZ2V4UGFyKTtcbiAgICAgICAgbmV4dCA9IHNSQmMubmV4dCgpO1xuICAgICAgICB3aGlsZSAoIW5leHQuZG9uZSkge1xuICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBhdHRyaWJ1dGUsIHZhbHVlcyB9ID0gbmV4dC52YWx1ZS5ncm91cHM7XG4gICAgICAgICAgICAgICAgZmllbGRzLnB1c2goeyBhdHRyaWJ1dGUsIHZhbHVlczogZGVjb2RlTGluayh2YWx1ZXMpLCBpbmRleDogbmV4dC52YWx1ZS5pbmRleCB8fCAwLCBsZW5ndGg6IG5leHQudmFsdWVbMF0ubGVuZ3RoIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbmV4dCA9IHNSQmMubmV4dCgpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGZpZWxkcy5zb3J0KChhLCBiKSA9PiB7XG4gICAgICAgIGlmIChhLmluZGV4IDwgYi5pbmRleCkgcmV0dXJuIC0xO1xuICAgICAgICBpZiAoYS5pbmRleCA+IGIuaW5kZXgpIHJldHVybiAxO1xuICAgICAgICByZXR1cm4gMFxuICAgIH0pXG4gICAgcmV0dXJuIGZpZWxkc1xufSAgICIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBUZXh0Q29tcG9uZW50LCBURmlsZSwgVG9nZ2xlQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgdmFsdWVUZXh0SW5wdXRNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XG4gICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nO1xuICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyO1xuICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbjtcbiAgICBwcml2YXRlIHRvcDogYm9vbGVhbjtcbiAgICBwcml2YXRlIHBhcnNlRGF0ZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBmaWVsZDogRmllbGQsIHZhbHVlOiBzdHJpbmcsIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLCBpbkZyb250TWF0dGVyOiBib29sZWFuID0gZmFsc2UsIHRvcDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZU51bWJlcjtcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gaW5Gcm9udE1hdHRlcjtcbiAgICAgICAgdGhpcy50b3AgPSB0b3A7XG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgaW5wdXREaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1tb2RhbC12YWx1ZVwiIH0pO1xuICAgICAgICB0aGlzLmJ1aWxkSW5wdXRFbChpbnB1dERpdik7XG4gICAgfTtcblxuICAgIGJ1aWxkRGF0ZVBhcnNlVG9nZ2xlcihjb250YWluZXI6IEhUTUxFbGVtZW50KSB7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBubGRhdGVzID0gYXBwLnBsdWdpbnMucGx1Z2luc1snbmxkYXRlcy1vYnNpZGlhbiddO1xuICAgICAgICBjb25zdCBkYXRlUGFyc2VyTGFiZWwgPSBjb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LWRhdGUtcGFyc2VyLWxhYmVsXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGRhdGVQYXJzZXJMYWJlbC5zZXRUZXh0KFwiXHVEODNEXHVEQ0M2XCIpO1xuICAgICAgICBjb25zdCBkYXRlUGFyc2VyVG9nZ2xlciA9IG5ldyBUb2dnbGVDb21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgZGF0ZVBhcnNlclRvZ2dsZXIuc2V0VmFsdWUodGhpcy5wYXJzZURhdGUpXG4gICAgICAgIGRhdGVQYXJzZXJUb2dnbGVyLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMucGFyc2VEYXRlID0gdmFsdWU7XG4gICAgICAgIH0pO1xuICAgICAgICBkYXRlUGFyc2VyTGFiZWwub25jbGljayA9ICgpID0+IGRhdGVQYXJzZXJUb2dnbGVyLnNldFZhbHVlKCF0aGlzLnBhcnNlRGF0ZSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYnVpbGRJbnB1dEVsKGlucHV0RGl2OiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgaWYgKGFwcC5wbHVnaW5zLnBsdWdpbnMuaGFzT3duUHJvcGVydHkoJ25sZGF0ZXMtb2JzaWRpYW4nKSAmJiB0aGlzLmZpZWxkLnR5cGUgPT09IEZpZWxkVHlwZS5JbnB1dCkge1xuICAgICAgICAgICAgdGhpcy5idWlsZERhdGVQYXJzZVRvZ2dsZXIoaW5wdXREaXYpO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBmb3JtID0gaW5wdXREaXYuY3JlYXRlRWwoXCJmb3JtXCIpO1xuICAgICAgICBmb3JtLnR5cGUgPSBcInN1Ym1pdFwiO1xuXG4gICAgICAgIGNvbnN0IGlucHV0RWwgPSBuZXcgVGV4dENvbXBvbmVudChmb3JtKTtcbiAgICAgICAgaW5wdXRFbC5pbnB1dEVsLmZvY3VzKCk7XG4gICAgICAgIGlucHV0RWwuc2V0VmFsdWUodGhpcy52YWx1ZSk7XG4gICAgICAgIGlucHV0RWwuaW5wdXRFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWlucHV0XCIpO1xuXG4gICAgICAgIGZvcm0ub25zdWJtaXQgPSBhc3luYyAoZTogRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIGxldCBpbnB1dFZhbHVlID0gaW5wdXRFbC5nZXRWYWx1ZSgpO1xuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICBpZiAoYXBwLnBsdWdpbnMucGx1Z2lucy5oYXNPd25Qcm9wZXJ0eSgnbmxkYXRlcy1vYnNpZGlhbicpICYmIHRoaXMucGFyc2VEYXRlICYmIHRoaXMuZmllbGQudHlwZSA9PT0gRmllbGRUeXBlLklucHV0KSB7XG4gICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgY29uc3QgbmxkYXRlcyA9IGFwcC5wbHVnaW5zLnBsdWdpbnNbJ25sZGF0ZXMtb2JzaWRpYW4nXTtcbiAgICAgICAgICAgICAgICBjb25zdCBmb3JtYXQgPSBubGRhdGVzLnNldHRpbmdzLmZvcm1hdDtcbiAgICAgICAgICAgICAgICBsZXQgdGV4dFN0YXJ0ID0gXCJcIjtcbiAgICAgICAgICAgICAgICBsZXQgdGV4dEVuZCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgbGV0IGRhdGUgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvblN0YXJ0ID0gaW5wdXRFbC5pbnB1dEVsLnNlbGVjdGlvblN0YXJ0O1xuICAgICAgICAgICAgICAgIGNvbnN0IHNlbGVjdGlvbkVuZCA9IGlucHV0RWwuaW5wdXRFbC5zZWxlY3Rpb25FbmQ7XG4gICAgICAgICAgICAgICAgaWYgKHNlbGVjdGlvbkVuZCA9PSBzZWxlY3Rpb25TdGFydCkge1xuICAgICAgICAgICAgICAgICAgICBkYXRlID0gbmxkYXRlcy5wYXJzZURhdGUoaW5wdXRFbC5nZXRWYWx1ZSgpKS5tb21lbnQuZm9ybWF0KGZvcm1hdCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdGV4dFN0YXJ0ID0gaW5wdXRFbC5nZXRWYWx1ZSgpLnNsaWNlKDAsIHNlbGVjdGlvblN0YXJ0ISk7XG4gICAgICAgICAgICAgICAgICAgIGRhdGUgPSBubGRhdGVzLnBhcnNlRGF0ZShpbnB1dEVsLmdldFZhbHVlKCkuc2xpY2Uoc2VsZWN0aW9uU3RhcnQhLCBzZWxlY3Rpb25FbmQhKSkubW9tZW50LmZvcm1hdChmb3JtYXQpO1xuICAgICAgICAgICAgICAgICAgICB0ZXh0RW5kID0gaW5wdXRFbC5nZXRWYWx1ZSgpLnNsaWNlKHNlbGVjdGlvbkVuZCEpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaW5wdXRWYWx1ZSA9IHRleHRTdGFydCArIFwiW1tcIiArIGRhdGUgKyBcIl1dXCIgKyB0ZXh0RW5kO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXModGhpcy5hcHAsIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5zZXJ0VmFsdWVzKHRoaXMuYXBwLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH07XG4gICAgfTtcbn07IiwgImltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGluc2VydFZhbHVlcyhcbiAgICBhcHA6IEFwcCxcbiAgICBmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgdmFsdWU6IHN0cmluZyxcbiAgICBsaW5lTnVtYmVyPzogbnVtYmVyLFxuICAgIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLFxuICAgIHRvcD86IGJvb2xlYW5cbik6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgbGV0IGZpbGU6IFRGaWxlO1xuICAgIGlmIChmaWxlT3JGaWxlUGF0aCBpbnN0YW5jZW9mIFRGaWxlKSB7XG4gICAgICAgIGZpbGUgPSBmaWxlT3JGaWxlUGF0aDtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBfZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZU9yRmlsZVBhdGgpXG4gICAgICAgIGlmIChfZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIF9maWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIGZpbGUgPSBfZmlsZTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IEVycm9yKFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcHAudmF1bHQucmVhZChmaWxlKVxuICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgIGlmICh0b3ApIHtcbiAgICAgICAgbmV3Q29udGVudC5wdXNoKGAke2ZpZWxkTmFtZX0ke2luRnJvbnRtYXR0ZXIgPyBcIjpcIiA6IFwiOjpcIn0gJHt2YWx1ZX1gKTtcbiAgICAgICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIF9saW5lTnVtYmVyKSA9PiBuZXdDb250ZW50LnB1c2gobGluZSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4ge1xuICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgaWYgKF9saW5lTnVtYmVyID09IGxpbmVOdW1iZXIpIHtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7ZmllbGROYW1lfSR7aW5Gcm9udG1hdHRlciA/IFwiOlwiIDogXCI6OlwifSAke3ZhbHVlfWApO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcbiAgICBhcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xufSIsICJpbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB2YWx1ZVRleHRJbnB1dE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL3ZhbHVlVGV4dElucHV0TW9kYWxcIjtcbmltcG9ydCB7IEFwcCwgTWVudSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBTZWxlY3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9TZWxlY3RNb2RhbFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBJbnB1dEZpZWxkIGV4dGVuZHMgRmllbGRNYW5hZ2VyIHtcblxuICAgIGNvbnN0cnVjdG9yKGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihmaWVsZCwgRmllbGRUeXBlLklucHV0KVxuICAgIH1cblxuICAgIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIFwiXCJcbiAgICB9XG5cbiAgICBhZGRNZW51T3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBjYXRlZ29yeTogTWVudSB8IFNlbGVjdE1vZGFsKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IHZhbHVlVGV4dElucHV0TW9kYWwoYXBwLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSk7XG4gICAgICAgIG1vZGFsLnRpdGxlRWwuc2V0VGV4dChgQ2hhbmdlIFZhbHVlIGZvciA8JHtuYW1lfT5gKTtcbiAgICAgICAgaWYgKElucHV0RmllbGQuaXNNZW51KGNhdGVnb3J5KSkge1xuICAgICAgICAgICAgY2F0ZWdvcnkuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSA8JHtuYW1lfT5gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oJ3BlbmNpbCcpO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiBtb2RhbC5vcGVuKCkpO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcInRhcmdldC1tZXRhZGF0YVwiKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSBpZiAoSW5wdXRGaWVsZC5pc1NlbGVjdChjYXRlZ29yeSkpIHtcbiAgICAgICAgICAgIGNhdGVnb3J5LmFkZE9wdGlvbihgdXBkYXRlXyR7bmFtZX1gLCBgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgY2F0ZWdvcnkubW9kYWxzW2B1cGRhdGVfJHtuYW1lfWBdID0gKCkgPT4gbW9kYWwub3BlbigpO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgICAgIC8vbm8gbmVlZCBvZiBzZXR0aW5ncyBmb3Igc3RhbmRhcmQgaW5wdXQgZmllbGRcbiAgICB9XG5cbiAgICB2YWxpZGF0ZU9wdGlvbnMoKTogYm9vbGVhbiB7XG4gICAgICAgIC8vYWx3YXlzIHRydWUgc2luY2UgdGhlcmUgYXJlIG5vIG9wdGlvbnNcbiAgICAgICAgcmV0dXJuIHRydWVcbiAgICB9XG5cbiAgICBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChhcHA6IEFwcCwgZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCB0b3A/OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgdmFsdWVUZXh0SW5wdXRNb2RhbChhcHAsIGZpbGUsIHRoaXMuZmllbGQsIFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIHRvcCk7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBFbnRlciB2YWx1ZSBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpXG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICAgICAgICBjb25zdCBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKVxuICAgICAgICBpbnB1dC5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWlucHV0XCIpXG4gICAgICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKGlucHV0KVxuICAgICAgICBpbnB1dC52YWx1ZSA9IHBbdGhpcy5maWVsZC5uYW1lXVxuICAgICAgICAvKiBlbmQgc3BhY2VyICovXG4gICAgICAgIGNvbnN0IHNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICAgICAgc3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtc3BhY2VyXCIpXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIilcbiAgICAgICAgYnV0dG9uLnNldFRleHQoXCJcdUQ4M0RcdUREOERcIilcbiAgICAgICAgYnV0dG9uLnNldEF0dHIoJ2NsYXNzJywgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKVxuICAgICAgICBidXR0b24uaGlkZSgpXG4gICAgICAgIHNwYWNlci5zaG93KClcbiAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBidXR0b24uc2hvdygpXG4gICAgICAgICAgICBzcGFjZXIuaGlkZSgpXG4gICAgICAgIH1cbiAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgIGJ1dHRvbi5oaWRlKClcbiAgICAgICAgICAgIHNwYWNlci5zaG93KClcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZhbGlkYXRlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIilcbiAgICAgICAgdmFsaWRhdGVJY29uLnRleHRDb250ZW50ID0gXCJcdTI3MDVcIlxuICAgICAgICB2YWxpZGF0ZUljb24uc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICAgICAgdmFsaWRhdGVJY29uLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICAgICAgSW5wdXRGaWVsZC5yZXBsYWNlVmFsdWVzKHBsdWdpbi5hcHAsIHBbXCJmaWxlXCJdW1wicGF0aFwiXSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dC52YWx1ZSk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgfVxuICAgICAgICBpbnB1dENvbnRhaW5lcj8uYXBwZW5kQ2hpbGQodmFsaWRhdGVJY29uKVxuICAgICAgICBjb25zdCBjYW5jZWxJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKVxuICAgICAgICBjYW5jZWxJY29uLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpXG4gICAgICAgIGNhbmNlbEljb24udGV4dENvbnRlbnQgPSBcIlx1Mjc0Q1wiXG4gICAgICAgIGNhbmNlbEljb24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGJ1dHRvbilcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzcGFjZXIpXG4gICAgICAgIH1cbiAgICAgICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQoY2FuY2VsSWNvbilcbiAgICAgICAgaW5wdXQuZm9jdXMoKVxuXG4gICAgICAgIGlucHV0Lm9ua2V5ZG93biA9IChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgICAgIElucHV0RmllbGQucmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBwW1wiZmlsZVwiXVtcInBhdGhcIl0sIHRoaXMuZmllbGQubmFtZSwgaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGJ1dHRvbilcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKVxuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNwYWNlcilcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICAvKiBidXR0b24gb24gY2xpY2sgOiByZW1vdmUgYnV0dG9uIGFuZCBmaWVsZCBhbmQgZGlzcGxheSBpbnB1dCBmaWVsZCovXG4gICAgICAgIGJ1dHRvbi5vbmNsaWNrID0gKGUpID0+IHtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChidXR0b24pXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzcGFjZXIpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgICAgIGlucHV0LmZvY3VzKClcbiAgICAgICAgfVxuICAgICAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGJ1dHRvbilcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSlcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgVG9nZ2xlQ29tcG9uZW50LCBURmlsZSwgQnV0dG9uQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyB2YWx1ZVRvZ2dsZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIHZhbHVlOiBib29sZWFuO1xuICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyO1xuICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbjtcbiAgICBwcml2YXRlIHRvcDogYm9vbGVhbjtcbiAgICBwcml2YXRlIGZpZWxkOiBGaWVsZDtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgZmllbGQ6IEZpZWxkLCB2YWx1ZTogYm9vbGVhbiwgbGluZU51bWJlcjogbnVtYmVyID0gLTEsIGluRnJvbnRNYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSwgdG9wOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZU51bWJlcjtcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gaW5Gcm9udE1hdHRlcjtcbiAgICAgICAgdGhpcy50b3AgPSB0b3A7XG4gICAgICAgIHRoaXMuZmllbGQgPSBmaWVsZFxuICAgIH07XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IGlucHV0RGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LXRvZ2dsZXJcIlxuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5idWlsZFRvZ2dsZUVsKGlucHV0RGl2KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBidWlsZFRvZ2dsZUVsKGlucHV0RGl2OiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB0b2dnbGVFbCA9IG5ldyBUb2dnbGVDb21wb25lbnQoaW5wdXREaXYpO1xuICAgICAgICB0b2dnbGVFbC5zZXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICAgICAgdG9nZ2xlRWwub25DaGFuZ2UodmFsdWUgPT4geyB0aGlzLnZhbHVlID0gdmFsdWUgfSlcbiAgICAgICAgY29uc3QgZm9vdGVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZC1mb290ZXJcIiB9KTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWUgPSB0aGlzLnZhbHVlLnRvU3RyaW5nKClcbiAgICAgICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXBsYWNlVmFsdWVzKHRoaXMuYXBwLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgdmFsdWUpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbnNlcnRWYWx1ZXModGhpcy5hcHAsIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCB2YWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG59OyIsICJpbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB2YWx1ZVRvZ2dsZU1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL3ZhbHVlVG9nZ2xlTW9kYWxcIjtcbmltcG9ydCB7IEFwcCwgTWVudSwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBTZWxlY3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9TZWxlY3RNb2RhbFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCb29sZWFuRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgY29uc3RydWN0b3IoZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKGZpZWxkLCBGaWVsZFR5cGUuQm9vbGVhbilcbiAgICB9XG5cbiAgICBwcml2YXRlIHN0cmluZ1RvQm9vbGVhbih2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGxldCB0b0Jvb2xlYW5WYWx1ZTogYm9vbGVhbiA9IGZhbHNlO1xuICAgICAgICBpZiAoaXNCb29sZWFuKHZhbHVlKSkge1xuICAgICAgICAgICAgdG9Cb29sZWFuVmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgfSBlbHNlIGlmICgvdHJ1ZS9pLnRlc3QodmFsdWUpKSB7XG4gICAgICAgICAgICB0b0Jvb2xlYW5WYWx1ZSA9IHRydWU7XG4gICAgICAgIH0gZWxzZSBpZiAoL2ZhbHNlL2kudGVzdCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIHRvQm9vbGVhblZhbHVlID0gZmFsc2U7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aHJvdyBFcnJvcihcInRoaXMgdmFsdWUgaXMgbm90IGEgYm9vbGVhblwiKVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gdG9Cb29sZWFuVmFsdWU7XG4gICAgfVxuXG4gICAgYWRkTWVudU9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGFwcDogQXBwLCBmaWxlOiBURmlsZSwgY2F0ZWdvcnk6IE1lbnUgfCBTZWxlY3RNb2RhbCk6IHZvaWQge1xuICAgICAgICBjb25zdCBiVmFsdWUgPSB0aGlzLnN0cmluZ1RvQm9vbGVhbih2YWx1ZSk7XG4gICAgICAgIGlmIChCb29sZWFuRmllbGQuaXNNZW51KGNhdGVnb3J5KSkge1xuICAgICAgICAgICAgY2F0ZWdvcnkuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYDwke25hbWV9PiAke2JWYWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIn1gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oJ2NoZWNrbWFyaycpO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiByZXBsYWNlVmFsdWVzKGFwcCwgZmlsZSwgbmFtZSwgKCFiVmFsdWUpLnRvU3RyaW5nKCkpKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJ0YXJnZXQtbWV0YWRhdGFcIik7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2UgaWYgKEJvb2xlYW5GaWVsZC5pc1NlbGVjdChjYXRlZ29yeSkpIHtcbiAgICAgICAgICAgIGNhdGVnb3J5LmFkZE9wdGlvbihgdXBkYXRlXyR7bmFtZX1gLCBgPCR7bmFtZX0+ICR7YlZhbHVlID8gXCJcdTI3MDUgXHUyNUI3IFx1Mjc0Q1wiIDogXCJcdTI3NEMgXHUyNUI3IFx1MjcwNVwifWApO1xuICAgICAgICAgICAgY2F0ZWdvcnkubW9kYWxzW2B1cGRhdGVfJHtuYW1lfWBdID0gKCkgPT4gcmVwbGFjZVZhbHVlcyhhcHAsIGZpbGUsIG5hbWUsICghYlZhbHVlKS50b1N0cmluZygpKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIFwiXCJcbiAgICB9XG5cbiAgICBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgICAgIC8vbm8gbmVlZCBvZiBzZXR0aW5ncyBmb3IgYm9vbGVhbiBmaWVsZFxuICAgIH1cblxuICAgIGFzeW5jIHZhbGlkYXRlVmFsdWUodmFsdWU6IHN0cmluZyk6IFByb21pc2U8Ym9vbGVhbj4ge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgYlZhbHVlID0gdGhpcy5zdHJpbmdUb0Jvb2xlYW4odmFsdWUpXG4gICAgICAgICAgICByZXR1cm4gaXNCb29sZWFuKGJWYWx1ZSlcbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICAvL2Fsd2F5cyB0cnVlIHNpbmNlIHRoZXJlIGFyZSBubyBvcHRpb25zXG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgfVxuXG4gICAgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgdG9wPzogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IHZhbHVlVG9nZ2xlTW9kYWwoYXBwLCBmaWxlLCB0aGlzLmZpZWxkLCBmYWxzZSwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgdG9wKVxuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgU2V0IHZhbHVlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBhc3luYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGNoZWNrYm94OiBIVE1MSW5wdXRFbGVtZW50ID0gZHYuZWwoXCJpbnB1dFwiLCBcIlwiLCB7IC4uLmF0dHJzLCBcInR5cGVcIjogXCJjaGVja2JveFwiIH0pXG4gICAgICAgIGNoZWNrYm94LmNoZWNrZWQgPSBwW3RoaXMuZmllbGQubmFtZV1cbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoY2hlY2tib3gpXG4gICAgICAgIGNoZWNrYm94Lm9uY2hhbmdlID0gKHZhbHVlKSA9PiB7XG4gICAgICAgICAgICBCb29sZWFuRmllbGQucmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBwW1wiZmlsZVwiXVtcInBhdGhcIl0sIHRoaXMuZmllbGQubmFtZSwgY2hlY2tib3guY2hlY2tlZC50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgVGV4dENvbXBvbmVudCwgVEZpbGUsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IE51bWJlckZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTnVtYmVyRmllbGRcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBudW1iZXJ0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBwcml2YXRlIGZpbGU6IFRGaWxlO1xuICAgIHByaXZhdGUgdmFsdWU6IHN0cmluZztcbiAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlcjtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSB0b3A6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBmaWVsZDogRmllbGQ7XG4gICAgcHJpdmF0ZSBmaWVsZE1hbmFnZXI6IE51bWJlckZpZWxkO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBmaWVsZDogRmllbGQsIHZhbHVlOiBzdHJpbmcsIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLCBpbkZyb250TWF0dGVyOiBib29sZWFuID0gZmFsc2UsIHRvcDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZU51bWJlcjtcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gaW5Gcm9udE1hdHRlcjtcbiAgICAgICAgdGhpcy50b3AgPSB0b3A7XG4gICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMuZmllbGQpXG4gICAgfTtcblxuICAgIG9uT3BlbigpIHtcbiAgICAgICAgY29uc3QgaW5wdXREaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5idWlsZElucHV0RWwoaW5wdXREaXYpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGRlY3JlbWVudChpbnB1dEVsOiBUZXh0Q29tcG9uZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCB9ID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcCk7XG4gICAgICAgIGlmICghaXNOYU4oZlN0ZXApKSB7XG4gICAgICAgICAgICBpbnB1dEVsLnNldFZhbHVlKChwYXJzZUZsb2F0KGlucHV0RWwuZ2V0VmFsdWUoKSkgLSBmU3RlcCkudG9TdHJpbmcoKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnB1dEVsLnNldFZhbHVlKChwYXJzZUZsb2F0KGlucHV0RWwuZ2V0VmFsdWUoKSkgLSAxKS50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgaW5jcmVtZW50KGlucHV0RWw6IFRleHRDb21wb25lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgeyBzdGVwIH0gPSB0aGlzLmZpZWxkLm9wdGlvbnNcbiAgICAgICAgY29uc3QgZlN0ZXAgPSBwYXJzZUZsb2F0KHN0ZXApXG4gICAgICAgIGlmICghaXNOYU4oZlN0ZXApKSB7XG4gICAgICAgICAgICBpbnB1dEVsLnNldFZhbHVlKChwYXJzZUZsb2F0KGlucHV0RWwuZ2V0VmFsdWUoKSkgKyBmU3RlcCkudG9TdHJpbmcoKSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnB1dEVsLnNldFZhbHVlKChwYXJzZUZsb2F0KGlucHV0RWwuZ2V0VmFsdWUoKSkgKyAxKS50b1N0cmluZygpKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHByaXZhdGUgdG9nZ2xlQnV0dG9uc1N0YXRlKG1pbnVzQnRuOiBCdXR0b25Db21wb25lbnQsIHBsdXNCdG46IEJ1dHRvbkNvbXBvbmVudCwgaW5wdXRFbDogVGV4dENvbXBvbmVudCk6IHZvaWQge1xuICAgICAgICBtaW51c0J0bi5zZXREaXNhYmxlZCghdGhpcy5maWVsZE1hbmFnZXIuY2FuRGVjcmVtZW50KGlucHV0RWwuZ2V0VmFsdWUoKSkpO1xuICAgICAgICBwbHVzQnRuLnNldERpc2FibGVkKCF0aGlzLmZpZWxkTWFuYWdlci5jYW5JbmNyZW1lbnQoaW5wdXRFbC5nZXRWYWx1ZSgpKSk7XG4gICAgICAgIGlmICh0aGlzLmZpZWxkTWFuYWdlci5jYW5EZWNyZW1lbnQoaW5wdXRFbC5nZXRWYWx1ZSgpKSkge1xuICAgICAgICAgICAgbWludXNCdG4uc2V0Q3RhKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBtaW51c0J0bi5yZW1vdmVDdGEoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWVsZE1hbmFnZXIuY2FuSW5jcmVtZW50KGlucHV0RWwuZ2V0VmFsdWUoKSkpIHtcbiAgICAgICAgICAgIHBsdXNCdG4uc2V0Q3RhKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBwbHVzQnRuLnJlbW92ZUN0YSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHJpdmF0ZSB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICAgICAgY29uc3QgeyBtaW4sIG1heCB9ID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICBjb25zdCBmTWluID0gcGFyc2VGbG9hdChtaW4pO1xuICAgICAgICBjb25zdCBmTWF4ID0gcGFyc2VGbG9hdChtYXgpO1xuICAgICAgICBjb25zdCBmVmFsdWUgPSBwYXJzZUZsb2F0KHZhbHVlKTtcbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICAgICFpc05hTihmVmFsdWUpICYmIChpc05hTihmTWluKSB8fCBmVmFsdWUgPj0gZk1pbikgJiYgKGlzTmFOKGZNYXgpIHx8IGZWYWx1ZSA8PSBmTWF4KVxuICAgICAgICApXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBidWlsZElucHV0RWwoaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCB9ID0gdGhpcy5maWVsZC5vcHRpb25zXG5cbiAgICAgICAgY29uc3QgZm9ybSA9IGlucHV0RGl2LmNyZWF0ZUVsKFwiZm9ybVwiKTtcbiAgICAgICAgZm9ybS50eXBlID0gXCJzdWJtaXRcIjtcblxuICAgICAgICBjb25zdCBmaWVsZENvbnRhaW5lciA9IGZvcm0uY3JlYXRlRWwoXCJkaXZcIiwgeyBjbHM6IFwibWV0YWRhdGEtbWVudS1tb2RhbC12YWx1ZS13aXRoLWJ0blwiIH0pXG5cbiAgICAgICAgY29uc3QgaW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgaW5wdXRFbC5pbnB1dEVsLmZvY3VzKCk7XG4gICAgICAgIGlucHV0RWwuc2V0VmFsdWUodGhpcy52YWx1ZSk7XG5cbiAgICAgICAgY29uc3QgbWludXNCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgbWludXNCdG4uc2V0QnV0dG9uVGV4dChgLSAkeyEhc3RlcCA/IHN0ZXAgOiAxfWApO1xuXG4gICAgICAgIGNvbnN0IHBsdXNCdG4gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZpZWxkQ29udGFpbmVyKTtcbiAgICAgICAgcGx1c0J0bi5zZXRCdXR0b25UZXh0KGArICR7ISFzdGVwID8gc3RlcCA6IDF9YCk7XG4gICAgICAgIHBsdXNCdG4uc2V0RGlzYWJsZWQoIXRoaXMuZmllbGRNYW5hZ2VyLmNhbkluY3JlbWVudChpbnB1dEVsLmdldFZhbHVlKCkpKTtcblxuICAgICAgICBjb25zdCBlcnJvckZpZWxkID0gZm9ybS5jcmVhdGVFbChcImRpdlwiLCB7IGNsczogXCJtZXRhZGF0YS1tZW51LW1vZGFsLXZhbHVlLXdpdGgtYnRuLWVycm9yLWZpZWxkXCIgfSlcbiAgICAgICAgZXJyb3JGaWVsZC5oaWRlKClcblxuICAgICAgICBjb25zdCBmb290ZXIgPSBmb3JtLmNyZWF0ZUVsKFwiZGl2XCIsIHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZC1mb290ZXJcIiB9KVxuXG4gICAgICAgIGNvbnN0IHZhbGlkYXRlQnRuID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmb290ZXIpO1xuICAgICAgICB2YWxpZGF0ZUJ0bi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuXG4gICAgICAgIGNvbnN0IGNhbmNlbEJ0biA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgY2FuY2VsQnRuLnNldEljb24oXCJjcm9zc1wiKTtcblxuXG4gICAgICAgIHRoaXMudG9nZ2xlQnV0dG9uc1N0YXRlKG1pbnVzQnRuLCBwbHVzQnRuLCBpbnB1dEVsKTtcblxuICAgICAgICAvL2V2ZW50IGhhbmRsZXJzXG4gICAgICAgIGlucHV0RWwub25DaGFuZ2UoKCkgPT4ge1xuICAgICAgICAgICAgaW5wdXRFbC5pbnB1dEVsLnJlbW92ZUNsYXNzKFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgZXJyb3JGaWVsZC5oaWRlKCk7XG4gICAgICAgICAgICBlcnJvckZpZWxkLnNldFRleHQoXCJcIik7XG4gICAgICAgICAgICB0aGlzLnRvZ2dsZUJ1dHRvbnNTdGF0ZShtaW51c0J0biwgcGx1c0J0biwgaW5wdXRFbClcbiAgICAgICAgfSlcblxuICAgICAgICBwbHVzQnRuLm9uQ2xpY2soKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuaW5jcmVtZW50KGlucHV0RWwpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25zU3RhdGUobWludXNCdG4sIHBsdXNCdG4sIGlucHV0RWwpO1xuICAgICAgICB9KVxuXG4gICAgICAgIG1pbnVzQnRuLm9uQ2xpY2soKGUpID0+IHtcbiAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIHRoaXMuZGVjcmVtZW50KGlucHV0RWwpO1xuICAgICAgICAgICAgdGhpcy50b2dnbGVCdXR0b25zU3RhdGUobWludXNCdG4sIHBsdXNCdG4sIGlucHV0RWwpO1xuICAgICAgICB9KVxuXG4gICAgICAgIGNhbmNlbEJ0bi5vbkNsaWNrKChlKSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgfSlcblxuICAgICAgICBmb3JtLm9uc3VibWl0ID0gYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBsZXQgaW5wdXRWYWx1ZSA9IGlucHV0RWwuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIGlmICghdGhpcy5maWVsZE1hbmFnZXIudmFsaWRhdGVWYWx1ZShpbnB1dFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuICAgICAgICAgICAgICAgIGVycm9yRmllbGQuc2hvdygpO1xuICAgICAgICAgICAgICAgIGVycm9yRmllbGQuc2V0VGV4dChgdmFsdWUgbXVzdCBiZSBudW1lcmljJHttaW4gPyBcIiBhbmQgPj0gXCIgKyBtaW4gOiBcIlwifSAke21heCA/IFwiIGFuZCA8PSBcIiArIG1heCA6IFwiXCJ9YClcbiAgICAgICAgICAgICAgICBpbnB1dEVsLmlucHV0RWwuc2V0QXR0cihcImNsYXNzXCIsIFwiaXMtaW52YWxpZFwiKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXModGhpcy5hcHAsIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dFZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgaW5zZXJ0VmFsdWVzKHRoaXMuYXBwLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXRWYWx1ZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH07XG4gICAgfTtcbn07IiwgImltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCIuLi9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIH0gZnJvbSBcIi4uL0ZpZWxkTWFuYWdlclwiO1xuaW1wb3J0IG51bWJlcnRNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9udW1iZXJNb2RhbFwiO1xuaW1wb3J0IHsgQXBwLCBNZW51LCBURmlsZSwgVGV4dENvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IFNlbGVjdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL1NlbGVjdE1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE51bWJlckZpZWxkIGV4dGVuZHMgRmllbGRNYW5hZ2VyIHtcblxuICAgIHByaXZhdGUgbnVtYmVyVmFsaWRhdG9yRmllbGQ6IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgbnVtYmVyU3RlcFZhbHVlOiBUZXh0Q29tcG9uZW50O1xuICAgIHByaXZhdGUgbnVtYmVyTWluVmFsdWU6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBudW1iZXJNYXhWYWx1ZTogVGV4dENvbXBvbmVudDtcblxuICAgIGNvbnN0cnVjdG9yKGZpZWxkOiBGaWVsZCkge1xuICAgICAgICBzdXBlcihmaWVsZCwgRmllbGRUeXBlLk51bWJlcilcbiAgICB9XG5cbiAgICBnZXRPcHRpb25zU3RyKCk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuZmllbGQub3B0aW9ucykuZm9yRWFjaCgoaykgPT4geyBpZiAodGhpcy5maWVsZC5vcHRpb25zW2tdKSBvcHRpb25zLnB1c2goYCR7a306ICR7dGhpcy5maWVsZC5vcHRpb25zW2tdfWApIH0pXG4gICAgICAgIHJldHVybiBvcHRpb25zLmpvaW4oXCIgfCBcIilcbiAgICB9XG5cbiAgICBjYW5EZWNyZW1lbnQodmFsdWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBjb25zdCB7IHN0ZXAsIG1pbiB9ID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcCk7XG4gICAgICAgIGNvbnN0IGZNaW4gPSBwYXJzZUZsb2F0KG1pbik7XG4gICAgICAgIHJldHVybiAhKFxuICAgICAgICAgICAgaXNOYU4ocGFyc2VGbG9hdCh2YWx1ZSkpIHx8XG4gICAgICAgICAgICAhaXNOYU4oZk1pbikgJiZcbiAgICAgICAgICAgIChcbiAgICAgICAgICAgICAgICAhaXNOYU4oZlN0ZXApICYmIChcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdCh2YWx1ZSkgLSBmU3RlcCA8IGZNaW4gfHxcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VGbG9hdCh2YWx1ZSkgLSAxIDwgZk1pblxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgICAgIClcbiAgICAgICAgKVxuICAgIH1cblxuICAgIGNhbkluY3JlbWVudCh2YWx1ZTogc3RyaW5nKTogYm9vbGVhbiB7XG4gICAgICAgIGNvbnN0IHsgc3RlcCwgbWF4IH0gPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKTtcbiAgICAgICAgY29uc3QgZk1heCA9IHBhcnNlRmxvYXQobWF4KTtcbiAgICAgICAgcmV0dXJuICEoXG4gICAgICAgICAgICBpc05hTihwYXJzZUZsb2F0KHZhbHVlKSkgfHxcbiAgICAgICAgICAgICFpc05hTihmTWF4KSAmJlxuICAgICAgICAgICAgKFxuICAgICAgICAgICAgICAgICFpc05hTihmU3RlcCkgJiYgKFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSArIGZTdGVwID4gZk1heCB8fFxuICAgICAgICAgICAgICAgICAgICBwYXJzZUZsb2F0KHZhbHVlKSArIDEgPiBmTWF4XG4gICAgICAgICAgICAgICAgKVxuICAgICAgICAgICAgKVxuICAgICAgICApXG4gICAgfVxuXG4gICAgYXN5bmMgdmFsaWRhdGVWYWx1ZSh2YWx1ZTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGNvbnN0IHsgbWluLCBtYXggfSA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgY29uc3QgZk1pbiA9IHBhcnNlRmxvYXQobWluKTtcbiAgICAgICAgY29uc3QgZk1heCA9IHBhcnNlRmxvYXQobWF4KTtcbiAgICAgICAgY29uc3QgZlZhbHVlID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG4gICAgICAgIHJldHVybiAoXG4gICAgICAgICAgICAhaXNOYU4oZlZhbHVlKSAmJiAoaXNOYU4oZk1pbikgfHwgZlZhbHVlID49IGZNaW4pICYmIChpc05hTihmTWF4KSB8fCBmVmFsdWUgPD0gZk1heClcbiAgICAgICAgKVxuICAgIH1cblxuICAgIGFkZE1lbnVPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGNhdGVnb3J5OiBNZW51IHwgU2VsZWN0TW9kYWwpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgbnVtYmVydE1vZGFsKGFwcCwgZmlsZSwgdGhpcy5maWVsZCwgdmFsdWUpO1xuICAgICAgICBtb2RhbC50aXRsZUVsLnNldFRleHQoYENoYW5nZSBWYWx1ZSBmb3IgPCR7bmFtZX0+YCk7XG4gICAgICAgIGlmIChOdW1iZXJGaWVsZC5pc01lbnUoY2F0ZWdvcnkpKSB7XG4gICAgICAgICAgICBjYXRlZ29yeS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbigncGVuY2lsJyk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKCgpID0+IG1vZGFsLm9wZW4oKSk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwidGFyZ2V0LW1ldGFkYXRhXCIpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIGNvbnN0IHsgbWluLCBtYXgsIHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9uc1xuXG4gICAgICAgICAgICBjb25zdCBmTWluID0gcGFyc2VGbG9hdChtaW4pXG4gICAgICAgICAgICBjb25zdCBmTWF4ID0gcGFyc2VGbG9hdChtYXgpXG4gICAgICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgICAgIGNvbnN0IGZWYWx1ZSA9IHBhcnNlRmxvYXQodmFsdWUpXG4gICAgICAgICAgICBpZiAoZlN0ZXApIHtcbiAgICAgICAgICAgICAgICBpZiAoaXNOYU4oZk1pbikgfHwgKGZNaW4gJiYgZlZhbHVlIC0gZlN0ZXAgPiBmTWluKSlcbiAgICAgICAgICAgICAgICAgICAgY2F0ZWdvcnkuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKCdwZW5jaWwnKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYDwke25hbWV9PiBcdTI3QTFcdUZFMEYgJHtmVmFsdWUgLSBmU3RlcH1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiByZXBsYWNlVmFsdWVzKGFwcCwgZmlsZSwgbmFtZSwgKGZWYWx1ZSAtIGZTdGVwKS50b1N0cmluZygpKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFNlY3Rpb24oXCJ0YXJnZXQtbWV0YWRhdGFcIik7XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKGZNYXgpIHx8IChmTWF4ICYmIGZWYWx1ZSArIGZTdGVwIDwgZk1heCkpXG4gICAgICAgICAgICAgICAgICAgIGNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbigncGVuY2lsJyk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGA8JHtuYW1lfT4gXHUyN0ExXHVGRTBGICR7ZlZhbHVlICsgZlN0ZXB9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdGVtLm9uQ2xpY2soKCkgPT4gcmVwbGFjZVZhbHVlcyhhcHAsIGZpbGUsIG5hbWUsIChmVmFsdWUgKyBmU3RlcCkudG9TdHJpbmcoKSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwidGFyZ2V0LW1ldGFkYXRhXCIpO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKE51bWJlckZpZWxkLmlzU2VsZWN0KGNhdGVnb3J5KSkge1xuICAgICAgICAgICAgY2F0ZWdvcnkuYWRkT3B0aW9uKGB1cGRhdGVfJHtuYW1lfWAsIGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICBjYXRlZ29yeS5tb2RhbHNbYHVwZGF0ZV8ke25hbWV9YF0gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGNyZWF0ZU51bWJlckNvbnRhaW5lcihwYXJlbnRDb250YWluZXI6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG51bWJlclN0ZXBWYWx1ZUNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgbnVtYmVyU3RlcFZhbHVlQ29udGFpbmVyLmNyZWF0ZUVsKFwic3BhblwiLCB7IHRleHQ6IFwiU3RlcCAob3B0aW9uYWwpXCIsIGNsczogJ21ldGFkYXRhLW1lbnUtZmllbGQtb3B0aW9uJyB9KVxuICAgICAgICB0aGlzLm51bWJlclN0ZXBWYWx1ZSA9IG5ldyBUZXh0Q29tcG9uZW50KG51bWJlclN0ZXBWYWx1ZUNvbnRhaW5lcilcbiAgICAgICAgdGhpcy5udW1iZXJTdGVwVmFsdWUuc2V0VmFsdWUodGhpcy5maWVsZC5vcHRpb25zLnN0ZXAgfHwgXCJcIilcblxuICAgICAgICBjb25zdCBudW1iZXJNaW5WYWx1ZUNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgbnVtYmVyTWluVmFsdWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJNaW4gdmFsdWUgKG9wdGlvbmFsKVwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSlcbiAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZSA9IG5ldyBUZXh0Q29tcG9uZW50KG51bWJlck1pblZhbHVlQ29udGFpbmVyKVxuICAgICAgICB0aGlzLm51bWJlck1pblZhbHVlLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5taW4gfHwgXCJcIilcblxuICAgICAgICBjb25zdCBudW1iZXJNYXhWYWx1ZUNvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgbnVtYmVyTWF4VmFsdWVDb250YWluZXIuY3JlYXRlRWwoXCJzcGFuXCIsIHsgdGV4dDogXCJNYXggdmFsdWUgKG9wdGlvbmFsKVwiLCBjbHM6ICdtZXRhZGF0YS1tZW51LWZpZWxkLW9wdGlvbicgfSlcbiAgICAgICAgdGhpcy5udW1iZXJNYXhWYWx1ZSA9IG5ldyBUZXh0Q29tcG9uZW50KG51bWJlck1heFZhbHVlQ29udGFpbmVyKVxuICAgICAgICB0aGlzLm51bWJlck1heFZhbHVlLnNldFZhbHVlKHRoaXMuZmllbGQub3B0aW9ucy5tYXggfHwgXCJcIilcbiAgICAgICAgdGhpcy5udW1iZXJTdGVwVmFsdWUub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLnN0ZXAgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5udW1iZXJTdGVwVmFsdWUpO1xuICAgICAgICB9KVxuICAgICAgICB0aGlzLm51bWJlck1pblZhbHVlLm9uQ2hhbmdlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQub3B0aW9ucy5taW4gPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5udW1iZXJNaW5WYWx1ZSk7XG4gICAgICAgIH0pXG4gICAgICAgIHRoaXMubnVtYmVyTWF4VmFsdWUub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLm1heCA9IHZhbHVlO1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnJlbW92ZVZhbGlkYXRpb25FcnJvcih0aGlzLm51bWJlck1heFZhbHVlKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgICAgIHRoaXMubnVtYmVyVmFsaWRhdG9yRmllbGQgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbnVtYmVyLW9wdGlvbnNcIiB9KVxuICAgICAgICB0aGlzLmNyZWF0ZU51bWJlckNvbnRhaW5lcih0aGlzLm51bWJlclZhbGlkYXRvckZpZWxkKVxuICAgICAgICB0aGlzLm51bWJlclZhbGlkYXRvckZpZWxkLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuICAgIH1cblxuICAgIHZhbGlkYXRlT3B0aW9ucygpOiBib29sZWFuIHtcbiAgICAgICAgbGV0IGVycm9yID0gZmFsc2VcbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5zdGVwICYmIGlzTmFOKHBhcnNlRmxvYXQodGhpcy5maWVsZC5vcHRpb25zLnN0ZXApKSkge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0aGlzLm51bWJlclN0ZXBWYWx1ZSwgdGhpcy5udW1iZXJTdGVwVmFsdWUuaW5wdXRFbCxcbiAgICAgICAgICAgICAgICBcIlZhbHVlcyBtdXN0IGJlIG51bWVyaWMuXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHRoaXMuZmllbGQub3B0aW9ucy5taW4gJiYgaXNOYU4ocGFyc2VGbG9hdCh0aGlzLmZpZWxkLm9wdGlvbnMubWluKSkpIHtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgdGhpcy5udW1iZXJNaW5WYWx1ZSwgdGhpcy5udW1iZXJNaW5WYWx1ZS5pbnB1dEVsLFxuICAgICAgICAgICAgICAgIFwiVmFsdWVzIG11c3QgYmUgbnVtZXJpYy5cIlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLm1heCAmJiBpc05hTihwYXJzZUZsb2F0KHRoaXMuZmllbGQub3B0aW9ucy5tYXgpKSkge1xuICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICB0aGlzLm51bWJlck1heFZhbHVlLCB0aGlzLm51bWJlck1heFZhbHVlLmlucHV0RWwsXG4gICAgICAgICAgICAgICAgXCJWYWx1ZXMgbXVzdCBiZSBudW1lcmljLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiAhZXJyb3JcbiAgICB9XG5cbiAgICBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChhcHA6IEFwcCwgZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCB0b3A/OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgbnVtYmVydE1vZGFsKGFwcCwgZmlsZSwgdGhpcy5maWVsZCwgXCJcIiwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgdG9wKTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYEVudGVyIHZhbHVlIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBwcml2YXRlIHRvZ2dsZUR2QnV0dG9ucyhkZWNyZW1lbnRCdG46IEhUTUxCdXR0b25FbGVtZW50LCBpbmNyZW1lbnRCdG46IEhUTUxCdXR0b25FbGVtZW50LCB2YWx1ZTogc3RyaW5nKSB7XG4gICAgICAgIGlmICh0aGlzLmNhbkRlY3JlbWVudCh2YWx1ZSkpIHtcbiAgICAgICAgICAgIGRlY3JlbWVudEJ0bi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGRlY3JlbWVudEJ0bi5hZGRDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodGhpcy5jYW5JbmNyZW1lbnQodmFsdWUpKSB7XG4gICAgICAgICAgICBpbmNyZW1lbnRCdG4ucmVtb3ZlQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbmNyZW1lbnRCdG4uYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7O1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuXG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpXG4gICAgICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIik7XG4gICAgICAgIGlucHV0LnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtaW5wdXRcIik7XG4gICAgICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKGlucHV0KTtcbiAgICAgICAgaW5wdXQudmFsdWUgPSBwW3RoaXMuZmllbGQubmFtZV07XG4gICAgICAgIC8qIGVuZCBzcGFjZXIgKi9cbiAgICAgICAgY29uc3QgdHJpcGxlU3BhY2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgdHJpcGxlU3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtdHJpcGxlLXNwYWNlclwiKTtcblxuICAgICAgICAvKiBidXR0b24gdG8gZGlzcGxheSBpbnB1dCAqL1xuICAgICAgICBjb25zdCBlZGl0QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgZWRpdEJ1dHRvbi5zZXRUZXh0KFwiXHVEODNEXHVERDhEXCIpO1xuICAgICAgICBlZGl0QnV0dG9uLnNldEF0dHIoJ2NsYXNzJywgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgZWRpdEJ1dHRvbi5oaWRlKCk7XG5cbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgZGVjcmVtZW50QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgZGVjcmVtZW50QnV0dG9uLnNldFRleHQoXCJcdTI1QzBcdUZFMEZcIik7XG4gICAgICAgIGRlY3JlbWVudEJ1dHRvbi5zZXRBdHRyKCdjbGFzcycsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIik7XG4gICAgICAgIGRlY3JlbWVudEJ1dHRvbi5oaWRlKCk7XG5cbiAgICAgICAgLyogYnV0dG9uIHRvIGRpc3BsYXkgaW5wdXQgKi9cbiAgICAgICAgY29uc3QgaW5jcmVtZW50QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgaW5jcmVtZW50QnV0dG9uLnNldFRleHQoXCJcdTI1QjZcdUZFMEZcIik7XG4gICAgICAgIGluY3JlbWVudEJ1dHRvbi5zZXRBdHRyKCdjbGFzcycsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIik7XG4gICAgICAgIGluY3JlbWVudEJ1dHRvbi5oaWRlKCk7XG5cbiAgICAgICAgdHJpcGxlU3BhY2VyLnNob3coKTtcblxuICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgIGVkaXRCdXR0b24uc2hvdygpO1xuICAgICAgICAgICAgZGVjcmVtZW50QnV0dG9uLnNob3coKTtcbiAgICAgICAgICAgIGluY3JlbWVudEJ1dHRvbi5zaG93KCk7XG4gICAgICAgICAgICB0cmlwbGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICB9XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdXQgPSAoKSA9PiB7XG4gICAgICAgICAgICBlZGl0QnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIGRlY3JlbWVudEJ1dHRvbi5oaWRlKCk7XG4gICAgICAgICAgICBpbmNyZW1lbnRCdXR0b24uaGlkZSgpO1xuICAgICAgICAgICAgdHJpcGxlU3BhY2VyLnNob3coKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IHZhbGlkYXRlSWNvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJhXCIpXG4gICAgICAgIHZhbGlkYXRlSWNvbi50ZXh0Q29udGVudCA9IFwiXHUyNzA1XCJcbiAgICAgICAgdmFsaWRhdGVJY29uLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpXG4gICAgICAgIHZhbGlkYXRlSWNvbi5vbmNsaWNrID0gYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKGF3YWl0IHRoaXMudmFsaWRhdGVWYWx1ZShpbnB1dC52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHJlcGxhY2VWYWx1ZXMocGx1Z2luLmFwcCwgZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBpbnB1dC52YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIGlucHV0LnZhbHVlKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpbnB1dENvbnRhaW5lcj8uYXBwZW5kQ2hpbGQodmFsaWRhdGVJY29uKVxuICAgICAgICBjb25zdCBjYW5jZWxJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIilcbiAgICAgICAgY2FuY2VsSWNvbi5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKVxuICAgICAgICBjYW5jZWxJY29uLnRleHRDb250ZW50ID0gXCJcdTI3NENcIlxuICAgICAgICBjYW5jZWxJY29uLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZGVjcmVtZW50QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbmNyZW1lbnRCdXR0b24pO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodHJpcGxlU3BhY2VyKTtcbiAgICAgICAgfVxuICAgICAgICBpbnB1dENvbnRhaW5lci5hcHBlbmRDaGlsZChjYW5jZWxJY29uKTtcbiAgICAgICAgaW5wdXQuZm9jdXMoKTtcblxuICAgICAgICBpbnB1dC5vbmtleXVwID0gKGUpID0+IHtcbiAgICAgICAgICAgIGlmICghdGhpcy52YWxpZGF0ZVZhbHVlKGlucHV0LnZhbHVlKSkge1xuICAgICAgICAgICAgICAgIGlucHV0LmFkZENsYXNzKCdpcy1pbnZhbGlkJyk7XG4gICAgICAgICAgICAgICAgdmFsaWRhdGVJY29uLmFkZENsYXNzKCdkaXNhYmxlZCcpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBpbnB1dC5yZW1vdmVDbGFzcygnaXMtaW52YWxpZCcpO1xuICAgICAgICAgICAgICAgIHZhbGlkYXRlSWNvbi5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGlucHV0Lm9ua2V5ZG93biA9IGFzeW5jIChlKSA9PiB7XG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgICAgIGlmIChhd2FpdCB0aGlzLnZhbGlkYXRlVmFsdWUoaW5wdXQudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW1wiZmlsZVwiXVtcInBhdGhcIl0pXG4gICAgICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBhd2FpdCByZXBsYWNlVmFsdWVzKHBsdWdpbi5hcHAsIGZpbGUsIHRoaXMuZmllbGQubmFtZSwgaW5wdXQudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIGlucHV0LnZhbHVlKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChlLmtleSA9PT0gJ0VzY2FwZScpIHtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbnB1dENvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZGVjcmVtZW50QnV0dG9uKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChlZGl0QnV0dG9uKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbmNyZW1lbnRCdXR0b24pO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHRyaXBsZVNwYWNlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLyogZWRpdEJ1dHRvbiBvbiBjbGljayA6IHJlbW92ZSBidXR0b24gYW5kIGZpZWxkIGFuZCBkaXNwbGF5IGlucHV0IGZpZWxkKi9cbiAgICAgICAgZWRpdEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChlZGl0QnV0dG9uKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGRlY3JlbWVudEJ1dHRvbik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChpbmNyZW1lbnRCdXR0b24pO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQodHJpcGxlU3BhY2VyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGlucHV0Q29udGFpbmVyKTtcbiAgICAgICAgICAgIGlucHV0LmZvY3VzKClcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGRlY3JlbWVudCBidXR0b24gb24gY2xpY2s6IGRlY3JlbWVudCBieSBzdGVwIG9yIGJ5IDEgKi9cbiAgICAgICAgZGVjcmVtZW50QnV0dG9uLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5jYW5EZWNyZW1lbnQocFt0aGlzLmZpZWxkLm5hbWVdKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgc3RlcCB9ID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZTdGVwID0gcGFyc2VGbG9hdChzdGVwKVxuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGUgPSBwbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChwW1wiZmlsZVwiXVtcInBhdGhcIl0pXG4gICAgICAgICAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSAoISFmU3RlcCA/IHBbdGhpcy5maWVsZC5uYW1lXSAtIGZTdGVwIDogcFt0aGlzLmZpZWxkLm5hbWVdIC0gMSkudG9TdHJpbmcoKTtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgcmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBmaWxlLCB0aGlzLmZpZWxkLm5hbWUsIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy50b2dnbGVEdkJ1dHRvbnMoZGVjcmVtZW50QnV0dG9uLCBpbmNyZW1lbnRCdXR0b24sIG5ld1ZhbHVlKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBpbmNyZW1lbnQgYnV0dG9uIG9uIGNsaWNrOiBpbmNyZW1lbnQgYnkgc3RlcCBvciBieSAxICovXG4gICAgICAgIGluY3JlbWVudEJ1dHRvbi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMuY2FuSW5jcmVtZW50KHBbdGhpcy5maWVsZC5uYW1lXSkpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHN0ZXAgfSA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgICAgICAgICBjb25zdCBmU3RlcCA9IHBhcnNlRmxvYXQoc3RlcClcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gKCEhZlN0ZXAgPyBwW3RoaXMuZmllbGQubmFtZV0gKyBmU3RlcCA6IHBbdGhpcy5maWVsZC5uYW1lXSArIDEpLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXMocGx1Z2luLmFwcCwgZmlsZSwgdGhpcy5maWVsZC5uYW1lLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudG9nZ2xlRHZCdXR0b25zKGRlY3JlbWVudEJ1dHRvbiwgaW5jcmVtZW50QnV0dG9uLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkZWNyZW1lbnRCdXR0b24pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZWRpdEJ1dHRvbik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGluY3JlbWVudEJ1dHRvbik7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHRyaXBsZVNwYWNlcik7XG4gICAgICAgIHRoaXMudG9nZ2xlRHZCdXR0b25zKGRlY3JlbWVudEJ1dHRvbiwgaW5jcmVtZW50QnV0dG9uLCBwW3RoaXMuZmllbGQubmFtZV0pO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCB7IFRleHRDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuaW1wb3J0IHsgRmlsZVN1Z2dlc3QgfSBmcm9tIFwic3JjL3N1Z2dlc3Rlci9GaWxlU3VnZ2VzdGVyXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGFic3RyYWN0IGNsYXNzIEFic3RyYWN0TGlzdEJhc2VkRmllbGQgZXh0ZW5kcyBGaWVsZE1hbmFnZXIge1xuXG4gICAgYWJzdHJhY3QgdmFsdWVzUHJvbXB0Q29tcG9uZW50czogQXJyYXk8VGV4dENvbXBvbmVudD47XG4gICAgYWJzdHJhY3QgcHJlc2V0VmFsdWVzRmllbGRzOiBIVE1MRGl2RWxlbWVudDtcblxuICAgIGNvbnN0cnVjdG9yKGZpZWxkOiBGaWVsZCwgdHlwZTogRmllbGRUeXBlKSB7XG4gICAgICAgIHN1cGVyKGZpZWxkLCB0eXBlKVxuICAgIH1cblxuICAgIC8vU2V0dGluZ3NcbiAgICBwcml2YXRlIHNldFZhbHVlTGlzdFRleHQoaGVhZGVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBoZWFkZXIuc2V0VGV4dChgUHJlc2V0IG9wdGlvbnM6ICR7T2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMpLmpvaW4oJywgJyl9YCk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlTGlzdE5vdGVDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGxpc3ROb3RlQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctZmlsZUNsYXNzLXNlYXJjaFwiIH0pO1xuICAgICAgICBsaXN0Tm90ZUNvbnRhaW5lckxhYmVsLnNldFRleHQoYFBhdGggb2YgdGhlIG5vdGUgY29udGFpbmluZyB0aGUgdmFsdWVzOmApO1xuXG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IFRleHRDb21wb25lbnQobGlzdE5vdGVDb250YWluZXJMYWJlbCk7XG5cbiAgICAgICAgbmV3IEZpbGVTdWdnZXN0KFxuICAgICAgICAgICAgcGx1Z2luLmFwcCxcbiAgICAgICAgICAgIGlucHV0LmlucHV0RWwsXG4gICAgICAgICAgICBwbHVnaW4sXG4gICAgICAgICAgICBcIi9cIlxuICAgICAgICApXG4gICAgICAgIGNvbnN0IGxpc3ROb3RlUGF0aCA9IHRoaXMuZmllbGQudmFsdWVzTGlzdE5vdGVQYXRoO1xuICAgICAgICBpbnB1dC5zZXRWYWx1ZShsaXN0Tm90ZVBhdGgpO1xuICAgICAgICBpbnB1dC5zZXRQbGFjZWhvbGRlcihcIlBhdGgvb2YvdGhlL25vdGUubWRcIik7XG4gICAgICAgIGlucHV0Lm9uQ2hhbmdlKHZhbHVlID0+IHRoaXMuZmllbGQudmFsdWVzTGlzdE5vdGVQYXRoID0gdmFsdWUpO1xuICAgIH1cblxuICAgIHByaXZhdGUgcmVtb3ZlUHJlc2V0VmFsdWUoa2V5OiBzdHJpbmcpOiB2b2lkIHtcbiAgICAgICAgbGV0IG5ld1ZhbHVlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgICAgICBmb3IgKGxldCBfa2V5IGluIHRoaXMuZmllbGQub3B0aW9ucykge1xuICAgICAgICAgICAgaWYgKGtleSAhPT0gX2tleSkge1xuICAgICAgICAgICAgICAgIG5ld1ZhbHVlc1tfa2V5XSA9IHRoaXMuZmllbGQub3B0aW9uc1tfa2V5XTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMuZmllbGQub3B0aW9ucyA9IG5ld1ZhbHVlcztcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVWYWx1ZUNvbnRhaW5lcihwYXJlbnROb2RlOiBIVE1MRGl2RWxlbWVudCwgaGVhZGVyOiBIVE1MRGl2RWxlbWVudCwga2V5OiBzdHJpbmcpOiBUZXh0Q29tcG9uZW50IHtcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHRoaXMuZmllbGQub3B0aW9ucztcbiAgICAgICAgY29uc3QgcHJlc2V0VmFsdWUgPSBvcHRpb25zW2tleV07XG4gICAgICAgIGNvbnN0IHZhbHVlQ29udGFpbmVyID0gcGFyZW50Tm9kZS5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiAnbWV0YWRhdGEtbWVudS1wcm9tcHQtY29udGFpbmVyJyxcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGlucHV0ID0gbmV3IFRleHRDb21wb25lbnQodmFsdWVDb250YWluZXIpO1xuICAgICAgICB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMucHVzaChpbnB1dClcbiAgICAgICAgaW5wdXQuc2V0VmFsdWUocHJlc2V0VmFsdWUpO1xuICAgICAgICBpbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcik7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGlucHV0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlUmVtb3ZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIHZhbHVlUmVtb3ZlQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdDtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVByZXNldFZhbHVlKGtleSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcik7XG4gICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLnJlbW92ZShpbnB1dCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgaWYgKGtleSAhPSBPYmplY3Qua2V5cyh0aGlzLmZpZWxkLm9wdGlvbnMpWzBdKSB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZVVwZ3JhZGVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KHZhbHVlQ29udGFpbmVyKTtcbiAgICAgICAgICAgIHZhbHVlVXBncmFkZUJ1dHRvbi5zZXRCdXR0b25UZXh0KFwiXHUyNUIyXCIpO1xuICAgICAgICAgICAgdmFsdWVVcGdyYWRlQnV0dG9uLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHRoaXNWYWx1ZSA9IG9wdGlvbnNba2V5XTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEluZGV4ID0gdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmluZGV4T2YoaW5wdXQpXG4gICAgICAgICAgICAgICAgY29uc3QgdXBwZXJDb21wb25lbnQgPSBpbnB1dEluZGV4ICE9PSAtMSA/IHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50c1tpbnB1dEluZGV4IC0gMV0gOiB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMubGFzdCgpO1xuICAgICAgICAgICAgICAgIGlmICh1cHBlckNvbXBvbmVudCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cHBlclZhbHVlID0gdXBwZXJDb21wb25lbnQuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBwZXJLZXkgPSBPYmplY3Qua2V5cyhvcHRpb25zKS5maWx0ZXIoayA9PiBvcHRpb25zW2tdID09IHVwcGVyVmFsdWUpWzBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAodXBwZXJLZXkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwcGVyQ29tcG9uZW50LnNldFZhbHVlKHRoaXNWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBvcHRpb25zW3VwcGVyS2V5XSA9IHRoaXNWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnNldFZhbHVlKHVwcGVyVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgb3B0aW9uc1trZXldID0gdXBwZXJWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9O1xuXG4gICAgYXN5bmMgdmFsaWRhdGVWYWx1ZSh2YWx1ZTogc3RyaW5nKTogUHJvbWlzZTxib29sZWFuPiB7XG4gICAgICAgIGlmICh0aGlzLmZpZWxkLm9wdGlvbnMgJiYgT2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMpLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJldHVybiBPYmplY3QudmFsdWVzKHRoaXMuZmllbGQub3B0aW9ucykuaW5jbHVkZXModmFsdWUudHJpbSgpKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuZmllbGQudmFsdWVzTGlzdE5vdGVQYXRoKSB7XG4gICAgICAgICAgICBjb25zdCBsaXN0Tm90ZVZhbHVlcyA9IGF3YWl0IEZpZWxkU2V0dGluZy5nZXRWYWx1ZXNMaXN0RnJvbU5vdGUodGhpcy5maWVsZC52YWx1ZXNMaXN0Tm90ZVBhdGgsIGFwcClcbiAgICAgICAgICAgIHJldHVybiBsaXN0Tm90ZVZhbHVlcy5jb250YWlucyh2YWx1ZS50cmltKCkpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2VcbiAgICAgICAgfVxuXG4gICAgfVxuXG4gICAgZ2V0T3B0aW9uc1N0cigpOiBzdHJpbmcge1xuICAgICAgICBpZiAodGhpcy5maWVsZC52YWx1ZXNMaXN0Tm90ZVBhdGgpIHJldHVybiB0aGlzLmZpZWxkLnZhbHVlc0xpc3ROb3RlUGF0aFxuICAgICAgICBlbHNlIGlmIChPYmplY3QudmFsdWVzKHRoaXMuZmllbGQub3B0aW9ucykubGVuZ3RoKSByZXR1cm4gT2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMpLmpvaW4oXCIsIFwiKVxuICAgICAgICBlbHNlIHJldHVybiBcIlwiXG4gICAgfVxuXG4gICAgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICBsZXQgZXJyb3IgPSBmYWxzZTtcbiAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgICAgICAgaWYgKC9eWyM+LV0vLnRlc3QoaW5wdXQuaW5wdXRFbC52YWx1ZSkgJiYgaW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQsIGlucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5sYXN0RWxlbWVudENoaWxkLFxuICAgICAgICAgICAgICAgICAgICBcIlZhbHVlcyBjYW5ub3QgY2Fubm90IHN0YXJ0IHdpdGggIywgPiwgLVwiXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgaWYgKC9bLF0vZ3UudGVzdChpbnB1dC5pbnB1dEVsLnZhbHVlKSAmJiBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICBpbnB1dCwgaW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Lmxhc3RFbGVtZW50Q2hpbGQsXG4gICAgICAgICAgICAgICAgICAgIFwiVmFsdWVzIGNhbm5vdCBjb250YWluIGEgY29tbWFcIlxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChpbnB1dC5pbnB1dEVsLnZhbHVlID09IFwiXCIgJiYgaW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICAgICAgaW5wdXQsIGlucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5sYXN0RWxlbWVudENoaWxkLFxuICAgICAgICAgICAgICAgICAgICBcIlZhbHVlcyBjYW4ndCBiZSBudWxsLlwiXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuICFlcnJvclxuICAgIH1cblxuICAgIGNyZWF0ZUFkZEJ1dHRvbih2YWx1ZXNMaXN0OiBIVE1MRGl2RWxlbWVudCwgdmFsdWVzTGlzdEJvZHk6IEhUTUxEaXZFbGVtZW50LCB2YWx1ZXNMaXN0SGVhZGVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0Rm9vdGVyID0gdmFsdWVzTGlzdC5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgYWRkVmFsdWUgPSB2YWx1ZXNMaXN0Rm9vdGVyLmNyZWF0ZUVsKCdidXR0b24nKTtcbiAgICAgICAgYWRkVmFsdWUudHlwZSA9ICdidXR0b24nO1xuICAgICAgICBhZGRWYWx1ZS50ZXh0Q29udGVudCA9ICdBZGQnO1xuICAgICAgICBhZGRWYWx1ZS5vbkNsaWNrRXZlbnQoYXN5bmMgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgZXZ0LnByZXZlbnREZWZhdWx0O1xuICAgICAgICAgICAgY29uc3QgbmV3S2V5ID0gYXdhaXQgdGhpcy5maWVsZC5pbnNlcnROZXdWYWx1ZShcIlwiKVxuICAgICAgICAgICAgdGhpcy5jcmVhdGVWYWx1ZUNvbnRhaW5lcih2YWx1ZXNMaXN0Qm9keSwgdmFsdWVzTGlzdEhlYWRlciwgbmV3S2V5KVxuICAgICAgICB9KTtcbiAgICAgICAgdmFsdWVzTGlzdC5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcbiAgICB9XG5cbiAgICBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogTWV0YWRhdGFNZW51LCBsb2NhdGlvbj86IFNldHRpbmdMb2NhdGlvbik6IHZvaWQge1xuICAgICAgICBpZiAobG9jYXRpb24gPT09IFNldHRpbmdMb2NhdGlvbi5QbHVnaW5TZXR0aW5ncykgdGhpcy5jcmVhdGVMaXN0Tm90ZUNvbnRhaW5lcihwYXJlbnRDb250YWluZXIsIHBsdWdpbik7XG4gICAgICAgIHRoaXMucHJlc2V0VmFsdWVzRmllbGRzID0gcGFyZW50Q29udGFpbmVyLmNyZWF0ZURpdigpXG4gICAgICAgIHRoaXMucHJlc2V0VmFsdWVzRmllbGRzLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0ID0gdGhpcy5wcmVzZXRWYWx1ZXNGaWVsZHMuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3RIZWFkZXIgPSB2YWx1ZXNMaXN0LmNyZWF0ZURpdigpO1xuICAgICAgICB2YWx1ZXNMaXN0SGVhZGVyLmNyZWF0ZUVsKFwiaDJcIik7XG4gICAgICAgIHZhbHVlc0xpc3RIZWFkZXIuc2V0VGV4dChgUHJlc2V0IG9wdGlvbnM6ICR7T2JqZWN0LnZhbHVlcyh0aGlzLmZpZWxkLm9wdGlvbnMpLmpvaW4oJywgJyl9YCk7XG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3RCb2R5ID0gdmFsdWVzTGlzdC5jcmVhdGVEaXYoKTtcbiAgICAgICAgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMucHVzaCh0aGlzLmNyZWF0ZVZhbHVlQ29udGFpbmVyKHZhbHVlc0xpc3RCb2R5LCB2YWx1ZXNMaXN0SGVhZGVyLCBrZXkpKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuY3JlYXRlQWRkQnV0dG9uKHZhbHVlc0xpc3QsIHZhbHVlc0xpc3RCb2R5LCB2YWx1ZXNMaXN0SGVhZGVyKVxuICAgIH1cblxuICAgIGFzeW5jIGNyZWF0ZUR2RmllbGQoXG4gICAgICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgICAgICBkdjogYW55LFxuICAgICAgICBwOiBhbnksXG4gICAgICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICAgICAgYXR0cnM/OiB7IGNsczogc3RyaW5nLCBhdHRyOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH1cbiAgICApOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGR2LmVsKFwic3BhblwiLCBwW3RoaXMuZmllbGQubmFtZV0pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICB9XG59IiwgImltcG9ydCB7IEFwcCwgU2V0dGluZywgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyLCBGaWVsZFR5cGVUYWdDbGFzcyB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IHsgRmllbGRNYW5hZ2VyIGFzIEYgfSBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZE1hbmFnZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgRmllbGRTZXR0aW5nIGV4dGVuZHMgU2V0dGluZyB7XG4gICAgcHVibGljIGZpZWxkOiBGaWVsZDtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBjb250YWluZXJFbDogSFRNTEVsZW1lbnQ7XG4gICAgcHJpdmF0ZSBmaWVsZE5hbWVDb250YWluZXI6IEhUTUxTcGFuRWxlbWVudDtcbiAgICBwcml2YXRlIHR5cGVDb250YWluZXI6IEhUTUxTcGFuRWxlbWVudDtcbiAgICBwcml2YXRlIGZpZWxkT3B0aW9uc0NvbnRhaW5lcjogSFRNTFNwYW5FbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwcm9wZXJ0eTogRmllbGQsIGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgICAgICBzdXBlcihjb250YWluZXJFbCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwgPSBjb250YWluZXJFbDtcbiAgICAgICAgdGhpcy5maWVsZCA9IHByb3BlcnR5O1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpO1xuICAgICAgICB0aGlzLmFkZEVkaXRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGREZWxldGVCdXR0b24oKTtcbiAgICB9O1xuXG4gICAgcHVibGljIHNldFRleHRDb250ZW50V2l0aG5hbWUoKTogdm9pZCB7XG5cbiAgICAgICAgY29uc3QgbWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLmZpZWxkKSBhcyBGO1xuICAgICAgICB0aGlzLmluZm9FbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgICAgIHRoaXMuaW5mb0VsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLWl0ZW1cIilcbiAgICAgICAgdGhpcy5maWVsZE5hbWVDb250YWluZXIgPSB0aGlzLmluZm9FbC5jcmVhdGVFbChcImRpdlwiLCBcIm1ldGFkYXRhLW1lbnUtc2V0dGluZy1pdGVtLW5hbWVcIilcbiAgICAgICAgdGhpcy5maWVsZE5hbWVDb250YWluZXIuc2V0VGV4dCh0aGlzLmZpZWxkLm5hbWUpXG4gICAgICAgIHRoaXMudHlwZUNvbnRhaW5lciA9IHRoaXMuaW5mb0VsLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgIHRoaXMudHlwZUNvbnRhaW5lci5zZXRBdHRyKFwiY2xhc3NcIiwgYG1ldGFkYXRhLW1lbnUtc2V0dGluZy1pdGVtLWluZm8tdHlwZSAke0ZpZWxkVHlwZVRhZ0NsYXNzW3RoaXMuZmllbGQudHlwZV19YClcbiAgICAgICAgdGhpcy50eXBlQ29udGFpbmVyLnNldFRleHQodGhpcy5maWVsZC50eXBlKVxuICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lciA9IHRoaXMuaW5mb0VsLmNyZWF0ZUVsKFwiZGl2XCIpXG4gICAgICAgIHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLnNldFRleHQoYCR7bWFuYWdlci5nZXRPcHRpb25zU3RyKCl9YClcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhZGRFZGl0QnV0dG9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgYi5zZXRJY29uKFwicGVuY2lsXCIpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJFZGl0XCIpXG4gICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbW9kYWwgPSBuZXcgRmllbGRTZXR0aW5nc01vZGFsKHRoaXMuYXBwLCB0aGlzLnBsdWdpbiwgdGhpcy5jb250YWluZXJFbCwgdGhpcywgdGhpcy5maWVsZCk7XG4gICAgICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYWRkRGVsZXRlQnV0dG9uKCk6IHZvaWQge1xuICAgICAgICB0aGlzLmFkZEJ1dHRvbigoYikgPT4ge1xuICAgICAgICAgICAgYi5zZXRJY29uKFwidHJhc2hcIilcbiAgICAgICAgICAgICAgICAuc2V0VG9vbHRpcChcIkRlbGV0ZVwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nUHJvcGVydHkgPSB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5maWx0ZXIocCA9PiBwLmlkID09IHRoaXMuZmllbGQuaWQpWzBdO1xuICAgICAgICAgICAgICAgICAgICBpZiAoY3VycmVudEV4aXN0aW5nUHJvcGVydHkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLnJlbW92ZShjdXJyZW50RXhpc3RpbmdQcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuc2V0dGluZ0VsLnBhcmVudEVsZW1lbnQ/LnJlbW92ZUNoaWxkKHRoaXMuc2V0dGluZ0VsKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGFzeW5jIGdldFZhbHVlc0xpc3RGcm9tTm90ZShub3RlUGF0aDogc3RyaW5nLCBhcHA6IEFwcCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgbGV0IHZhbHVlczogQXJyYXk8c3RyaW5nPiA9IFtdO1xuICAgICAgICBjb25zdCBmaWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChub3RlUGF0aCk7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBhcHAudmF1bHQucmVhZChmaWxlKVxuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIGlmICgvXiguKikkLy50ZXN0KGxpbmUpKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlcy5wdXNoKGxpbmUudHJpbSgpKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWVzO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9O1xuICAgIH07XG59OyIsICIvLyBDcmVkaXRzIGdvIHRvIExpYW0ncyBQZXJpb2RpYyBOb3RlcyBQbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9saWFtY2Fpbi9vYnNpZGlhbi1wZXJpb2RpYy1ub3Rlc1xuXG5pbXBvcnQgeyBBcHAsIFRBYnN0cmFjdEZpbGUsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBUZXh0SW5wdXRTdWdnZXN0IH0gZnJvbSBcIi4vc3VnZ2VzdFwiO1xuaW1wb3J0IHsgZ2V0X3RmaWxlc19mcm9tX2ZvbGRlciB9IGZyb20gXCIuLi91dGlscy9maWxlVXRpbHNcIjtcbmltcG9ydCBUZW1wbGF0ZXJQbHVnaW4gZnJvbSBcIm1haW5cIjtcblxuZXhwb3J0IGNsYXNzIEZpbGVTdWdnZXN0IGV4dGVuZHMgVGV4dElucHV0U3VnZ2VzdDxURmlsZT4ge1xuICAgIGNvbnN0cnVjdG9yKFxuICAgICAgICBwdWJsaWMgYXBwOiBBcHAsXG4gICAgICAgIHB1YmxpYyBpbnB1dEVsOiBIVE1MSW5wdXRFbGVtZW50LFxuICAgICAgICBwcml2YXRlIHBsdWdpbjogVGVtcGxhdGVyUGx1Z2luLFxuICAgICAgICBwdWJsaWMgZm9sZGVyOiBzdHJpbmdcbiAgICApIHtcbiAgICAgICAgc3VwZXIoYXBwLCBpbnB1dEVsKTtcbiAgICB9XG5cbiAgICBnZXRTdWdnZXN0aW9ucyhpbnB1dF9zdHI6IHN0cmluZyk6IFRGaWxlW10ge1xuICAgICAgICBjb25zdCBhbGxfZmlsZXMgPSBbXVxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgYWxsX2ZpbGVzLnB1c2goLi4uZ2V0X3RmaWxlc19mcm9tX2ZvbGRlcih0aGlzLmFwcCwgdGhpcy5mb2xkZXIpKVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuXG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZmlsZXM6IFRGaWxlW10gPSBbXTtcbiAgICAgICAgY29uc3QgbG93ZXJfaW5wdXRfc3RyID0gaW5wdXRfc3RyLnRvTG93ZXJDYXNlKCk7XG5cbiAgICAgICAgYWxsX2ZpbGVzLmZvckVhY2goKGZpbGU6IFRBYnN0cmFjdEZpbGUpID0+IHtcbiAgICAgICAgICAgIGlmIChcbiAgICAgICAgICAgICAgICBmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiZcbiAgICAgICAgICAgICAgICBmaWxlLmV4dGVuc2lvbiA9PT0gXCJtZFwiICYmXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoLnRvTG93ZXJDYXNlKCkuY29udGFpbnMobG93ZXJfaW5wdXRfc3RyKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgZmlsZXMucHVzaChmaWxlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgcmV0dXJuIGZpbGVzO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oZmlsZTogVEZpbGUsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQge1xuICAgICAgICBlbC5zZXRUZXh0KGZpbGUucGF0aCk7XG4gICAgfVxuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbihmaWxlOiBURmlsZSk6IHZvaWQge1xuICAgICAgICB0aGlzLmlucHV0RWwudmFsdWUgPSBmaWxlLnBhdGg7XG4gICAgICAgIHRoaXMuaW5wdXRFbC50cmlnZ2VyKFwiaW5wdXRcIik7XG4gICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG59XG4iLCAiLy8gQ3JlZGl0cyBnbyB0byBMaWFtJ3MgUGVyaW9kaWMgTm90ZXMgUGx1Z2luOiBodHRwczovL2dpdGh1Yi5jb20vbGlhbWNhaW4vb2JzaWRpYW4tcGVyaW9kaWMtbm90ZXNcblxuaW1wb3J0IHsgQXBwLCBJU3VnZ2VzdE93bmVyLCBTY29wZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY3JlYXRlUG9wcGVyLCBJbnN0YW5jZSBhcyBQb3BwZXJJbnN0YW5jZSB9IGZyb20gXCJAcG9wcGVyanMvY29yZVwiO1xuXG5jb25zdCB3cmFwQXJvdW5kID0gKHZhbHVlOiBudW1iZXIsIHNpemU6IG51bWJlcik6IG51bWJlciA9PiB7XG4gICAgcmV0dXJuICgodmFsdWUgJSBzaXplKSArIHNpemUpICUgc2l6ZTtcbn07XG5cbmNsYXNzIFN1Z2dlc3Q8VD4ge1xuICAgIHByaXZhdGUgb3duZXI6IElTdWdnZXN0T3duZXI8VD47XG4gICAgcHJpdmF0ZSB2YWx1ZXM6IFRbXTtcbiAgICBwcml2YXRlIHN1Z2dlc3Rpb25zOiBIVE1MRGl2RWxlbWVudFtdO1xuICAgIHByaXZhdGUgc2VsZWN0ZWRJdGVtOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBjb250YWluZXJFbDogSFRNTEVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgb3duZXI6IElTdWdnZXN0T3duZXI8VD4sXG4gICAgICAgIGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCxcbiAgICAgICAgc2NvcGU6IFNjb3BlXG4gICAgKSB7XG4gICAgICAgIHRoaXMub3duZXIgPSBvd25lcjtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbCA9IGNvbnRhaW5lckVsO1xuXG4gICAgICAgIGNvbnRhaW5lckVsLm9uKFxuICAgICAgICAgICAgXCJjbGlja1wiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1pdGVtXCIsXG4gICAgICAgICAgICB0aGlzLm9uU3VnZ2VzdGlvbkNsaWNrLmJpbmQodGhpcylcbiAgICAgICAgKTtcbiAgICAgICAgY29udGFpbmVyRWwub24oXG4gICAgICAgICAgICBcIm1vdXNlbW92ZVwiLFxuICAgICAgICAgICAgXCIuc3VnZ2VzdGlvbi1pdGVtXCIsXG4gICAgICAgICAgICB0aGlzLm9uU3VnZ2VzdGlvbk1vdXNlb3Zlci5iaW5kKHRoaXMpXG4gICAgICAgICk7XG5cbiAgICAgICAgc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dVcFwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbSh0aGlzLnNlbGVjdGVkSXRlbSAtIDEsIHRydWUpO1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG5cbiAgICAgICAgc2NvcGUucmVnaXN0ZXIoW10sIFwiQXJyb3dEb3duXCIsIChldmVudCkgPT4ge1xuICAgICAgICAgICAgaWYgKCFldmVudC5pc0NvbXBvc2luZykge1xuICAgICAgICAgICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKHRoaXMuc2VsZWN0ZWRJdGVtICsgMSwgdHJ1ZSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICBzY29wZS5yZWdpc3RlcihbXSwgXCJFbnRlclwiLCAoZXZlbnQpID0+IHtcbiAgICAgICAgICAgIGlmICghZXZlbnQuaXNDb21wb3NpbmcpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnVzZVNlbGVjdGVkSXRlbShldmVudCk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBvblN1Z2dlc3Rpb25DbGljayhldmVudDogTW91c2VFdmVudCwgZWw6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgY29uc3QgaXRlbSA9IHRoaXMuc3VnZ2VzdGlvbnMuaW5kZXhPZihlbCk7XG4gICAgICAgIHRoaXMuc2V0U2VsZWN0ZWRJdGVtKGl0ZW0sIGZhbHNlKTtcbiAgICAgICAgdGhpcy51c2VTZWxlY3RlZEl0ZW0oZXZlbnQpO1xuICAgIH1cblxuICAgIG9uU3VnZ2VzdGlvbk1vdXNlb3ZlcihfZXZlbnQ6IE1vdXNlRXZlbnQsIGVsOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCBpdGVtID0gdGhpcy5zdWdnZXN0aW9ucy5pbmRleE9mKGVsKTtcbiAgICAgICAgdGhpcy5zZXRTZWxlY3RlZEl0ZW0oaXRlbSwgZmFsc2UpO1xuICAgIH1cblxuICAgIHNldFN1Z2dlc3Rpb25zKHZhbHVlczogVFtdKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuZW1wdHkoKTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkVsczogSFRNTERpdkVsZW1lbnRbXSA9IFtdO1xuXG4gICAgICAgIHZhbHVlcy5mb3JFYWNoKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbkVsID0gdGhpcy5jb250YWluZXJFbC5jcmVhdGVEaXYoXCJzdWdnZXN0aW9uLWl0ZW1cIik7XG4gICAgICAgICAgICB0aGlzLm93bmVyLnJlbmRlclN1Z2dlc3Rpb24odmFsdWUsIHN1Z2dlc3Rpb25FbCk7XG4gICAgICAgICAgICBzdWdnZXN0aW9uRWxzLnB1c2goc3VnZ2VzdGlvbkVsKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgdGhpcy52YWx1ZXMgPSB2YWx1ZXM7XG4gICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMgPSBzdWdnZXN0aW9uRWxzO1xuICAgICAgICB0aGlzLnNldFNlbGVjdGVkSXRlbSgwLCBmYWxzZSk7XG4gICAgfVxuXG4gICAgdXNlU2VsZWN0ZWRJdGVtKGV2ZW50OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSB0aGlzLnZhbHVlc1t0aGlzLnNlbGVjdGVkSXRlbV07XG4gICAgICAgIGlmIChjdXJyZW50VmFsdWUpIHtcbiAgICAgICAgICAgIHRoaXMub3duZXIuc2VsZWN0U3VnZ2VzdGlvbihjdXJyZW50VmFsdWUsIGV2ZW50KTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHNldFNlbGVjdGVkSXRlbShzZWxlY3RlZEluZGV4OiBudW1iZXIsIHNjcm9sbEludG9WaWV3OiBib29sZWFuKSB7XG4gICAgICAgIGNvbnN0IG5vcm1hbGl6ZWRJbmRleCA9IHdyYXBBcm91bmQoXG4gICAgICAgICAgICBzZWxlY3RlZEluZGV4LFxuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy5sZW5ndGhcbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgcHJldlNlbGVjdGVkU3VnZ2VzdGlvbiA9IHRoaXMuc3VnZ2VzdGlvbnNbdGhpcy5zZWxlY3RlZEl0ZW1dO1xuICAgICAgICBjb25zdCBzZWxlY3RlZFN1Z2dlc3Rpb24gPSB0aGlzLnN1Z2dlc3Rpb25zW25vcm1hbGl6ZWRJbmRleF07XG5cbiAgICAgICAgcHJldlNlbGVjdGVkU3VnZ2VzdGlvbj8ucmVtb3ZlQ2xhc3MoXCJpcy1zZWxlY3RlZFwiKTtcbiAgICAgICAgc2VsZWN0ZWRTdWdnZXN0aW9uPy5hZGRDbGFzcyhcImlzLXNlbGVjdGVkXCIpO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0ZWRJdGVtID0gbm9ybWFsaXplZEluZGV4O1xuXG4gICAgICAgIGlmIChzY3JvbGxJbnRvVmlldykge1xuICAgICAgICAgICAgc2VsZWN0ZWRTdWdnZXN0aW9uLnNjcm9sbEludG9WaWV3KGZhbHNlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFRleHRJbnB1dFN1Z2dlc3Q8VD4gaW1wbGVtZW50cyBJU3VnZ2VzdE93bmVyPFQ+IHtcbiAgICBwcm90ZWN0ZWQgYXBwOiBBcHA7XG4gICAgcHJvdGVjdGVkIGlucHV0RWw6IEhUTUxJbnB1dEVsZW1lbnQgfCBIVE1MVGV4dEFyZWFFbGVtZW50O1xuXG4gICAgcHJpdmF0ZSBwb3BwZXI6IFBvcHBlckluc3RhbmNlO1xuICAgIHByaXZhdGUgc2NvcGU6IFNjb3BlO1xuICAgIHByaXZhdGUgc3VnZ2VzdEVsOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHN1Z2dlc3Q6IFN1Z2dlc3Q8VD47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgaW5wdXRFbDogSFRNTElucHV0RWxlbWVudCB8IEhUTUxUZXh0QXJlYUVsZW1lbnQpIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuaW5wdXRFbCA9IGlucHV0RWw7XG4gICAgICAgIHRoaXMuc2NvcGUgPSBuZXcgU2NvcGUoKTtcblxuICAgICAgICB0aGlzLnN1Z2dlc3RFbCA9IGNyZWF0ZURpdihcInN1Z2dlc3Rpb24tY29udGFpbmVyXCIpO1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9uID0gdGhpcy5zdWdnZXN0RWwuY3JlYXRlRGl2KFwic3VnZ2VzdGlvblwiKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0ID0gbmV3IFN1Z2dlc3QodGhpcywgc3VnZ2VzdGlvbiwgdGhpcy5zY29wZSk7XG5cbiAgICAgICAgdGhpcy5zY29wZS5yZWdpc3RlcihbXSwgXCJFc2NhcGVcIiwgdGhpcy5jbG9zZS5iaW5kKHRoaXMpKTtcblxuICAgICAgICB0aGlzLmlucHV0RWwuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIHRoaXMub25JbnB1dENoYW5nZWQuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuaW5wdXRFbC5hZGRFdmVudExpc3RlbmVyKFwiZm9jdXNcIiwgdGhpcy5vbklucHV0Q2hhbmdlZC5iaW5kKHRoaXMpKTtcbiAgICAgICAgdGhpcy5pbnB1dEVsLmFkZEV2ZW50TGlzdGVuZXIoXCJibHVyXCIsIHRoaXMuY2xvc2UuYmluZCh0aGlzKSk7XG4gICAgICAgIHRoaXMuc3VnZ2VzdEVsLm9uKFxuICAgICAgICAgICAgXCJtb3VzZWRvd25cIixcbiAgICAgICAgICAgIFwiLnN1Z2dlc3Rpb24tY29udGFpbmVyXCIsXG4gICAgICAgICAgICAoZXZlbnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH1cblxuICAgIG9uSW5wdXRDaGFuZ2VkKCk6IHZvaWQge1xuICAgICAgICBjb25zdCBpbnB1dFN0ciA9IHRoaXMuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgY29uc3Qgc3VnZ2VzdGlvbnMgPSB0aGlzLmdldFN1Z2dlc3Rpb25zKGlucHV0U3RyKTtcblxuICAgICAgICBpZiAoIXN1Z2dlc3Rpb25zKSB7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgdGhpcy5zdWdnZXN0LnNldFN1Z2dlc3Rpb25zKHN1Z2dlc3Rpb25zKTtcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55XG4gICAgICAgICAgICB0aGlzLm9wZW4oKDxhbnk+dGhpcy5hcHApLmRvbS5hcHBDb250YWluZXJFbCwgdGhpcy5pbnB1dEVsKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9wZW4oY29udGFpbmVyOiBIVE1MRWxlbWVudCwgaW5wdXRFbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgKDxhbnk+dGhpcy5hcHApLmtleW1hcC5wdXNoU2NvcGUodGhpcy5zY29wZSk7XG5cbiAgICAgICAgY29udGFpbmVyLmFwcGVuZENoaWxkKHRoaXMuc3VnZ2VzdEVsKTtcbiAgICAgICAgdGhpcy5wb3BwZXIgPSBjcmVhdGVQb3BwZXIoaW5wdXRFbCwgdGhpcy5zdWdnZXN0RWwsIHtcbiAgICAgICAgICAgIHBsYWNlbWVudDogXCJib3R0b20tc3RhcnRcIixcbiAgICAgICAgICAgIG1vZGlmaWVyczogW1xuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogXCJzYW1lV2lkdGhcIixcbiAgICAgICAgICAgICAgICAgICAgZW5hYmxlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgZm46ICh7IHN0YXRlLCBpbnN0YW5jZSB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBOb3RlOiBwb3NpdGlvbmluZyBuZWVkcyB0byBiZSBjYWxjdWxhdGVkIHR3aWNlIC1cbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGZpcnN0IHBhc3MgLSBwb3NpdGlvbmluZyBpdCBhY2NvcmRpbmcgdG8gdGhlIHdpZHRoIG9mIHRoZSBwb3BwZXJcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIHNlY29uZCBwYXNzIC0gcG9zaXRpb24gaXQgd2l0aCB0aGUgd2lkdGggYm91bmQgdG8gdGhlIHJlZmVyZW5jZSBlbGVtZW50XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyB3ZSBuZWVkIHRvIGVhcmx5IGV4aXQgdG8gYXZvaWQgYW4gaW5maW5pdGUgbG9vcFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdGFyZ2V0V2lkdGggPSBgJHtzdGF0ZS5yZWN0cy5yZWZlcmVuY2Uud2lkdGh9cHhgO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXRlLnN0eWxlcy5wb3BwZXIud2lkdGggPT09IHRhcmdldFdpZHRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGUuc3R5bGVzLnBvcHBlci53aWR0aCA9IHRhcmdldFdpZHRoO1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5zdGFuY2UudXBkYXRlKCk7XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHBoYXNlOiBcImJlZm9yZVdyaXRlXCIsXG4gICAgICAgICAgICAgICAgICAgIHJlcXVpcmVzOiBbXCJjb21wdXRlU3R5bGVzXCJdLFxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBdLFxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBjbG9zZSgpOiB2b2lkIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnlcbiAgICAgICAgKDxhbnk+dGhpcy5hcHApLmtleW1hcC5wb3BTY29wZSh0aGlzLnNjb3BlKTtcblxuICAgICAgICB0aGlzLnN1Z2dlc3Quc2V0U3VnZ2VzdGlvbnMoW10pO1xuICAgICAgICBpZiAodGhpcy5wb3BwZXIpIHRoaXMucG9wcGVyLmRlc3Ryb3koKTtcbiAgICAgICAgdGhpcy5zdWdnZXN0RWwuZGV0YWNoKCk7XG4gICAgfVxuXG4gICAgYWJzdHJhY3QgZ2V0U3VnZ2VzdGlvbnMoaW5wdXRTdHI6IHN0cmluZyk6IFRbXTtcbiAgICBhYnN0cmFjdCByZW5kZXJTdWdnZXN0aW9uKGl0ZW06IFQsIGVsOiBIVE1MRWxlbWVudCk6IHZvaWQ7XG4gICAgYWJzdHJhY3Qgc2VsZWN0U3VnZ2VzdGlvbihpdGVtOiBUKTogdm9pZDtcbn1cbiIsICJleHBvcnQgdmFyIHRvcCA9ICd0b3AnO1xuZXhwb3J0IHZhciBib3R0b20gPSAnYm90dG9tJztcbmV4cG9ydCB2YXIgcmlnaHQgPSAncmlnaHQnO1xuZXhwb3J0IHZhciBsZWZ0ID0gJ2xlZnQnO1xuZXhwb3J0IHZhciBhdXRvID0gJ2F1dG8nO1xuZXhwb3J0IHZhciBiYXNlUGxhY2VtZW50cyA9IFt0b3AsIGJvdHRvbSwgcmlnaHQsIGxlZnRdO1xuZXhwb3J0IHZhciBzdGFydCA9ICdzdGFydCc7XG5leHBvcnQgdmFyIGVuZCA9ICdlbmQnO1xuZXhwb3J0IHZhciBjbGlwcGluZ1BhcmVudHMgPSAnY2xpcHBpbmdQYXJlbnRzJztcbmV4cG9ydCB2YXIgdmlld3BvcnQgPSAndmlld3BvcnQnO1xuZXhwb3J0IHZhciBwb3BwZXIgPSAncG9wcGVyJztcbmV4cG9ydCB2YXIgcmVmZXJlbmNlID0gJ3JlZmVyZW5jZSc7XG5leHBvcnQgdmFyIHZhcmlhdGlvblBsYWNlbWVudHMgPSAvKiNfX1BVUkVfXyovYmFzZVBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICByZXR1cm4gYWNjLmNvbmNhdChbcGxhY2VtZW50ICsgXCItXCIgKyBzdGFydCwgcGxhY2VtZW50ICsgXCItXCIgKyBlbmRdKTtcbn0sIFtdKTtcbmV4cG9ydCB2YXIgcGxhY2VtZW50cyA9IC8qI19fUFVSRV9fKi9bXS5jb25jYXQoYmFzZVBsYWNlbWVudHMsIFthdXRvXSkucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICByZXR1cm4gYWNjLmNvbmNhdChbcGxhY2VtZW50LCBwbGFjZW1lbnQgKyBcIi1cIiArIHN0YXJ0LCBwbGFjZW1lbnQgKyBcIi1cIiArIGVuZF0pO1xufSwgW10pOyAvLyBtb2RpZmllcnMgdGhhdCBuZWVkIHRvIHJlYWQgdGhlIERPTVxuXG5leHBvcnQgdmFyIGJlZm9yZVJlYWQgPSAnYmVmb3JlUmVhZCc7XG5leHBvcnQgdmFyIHJlYWQgPSAncmVhZCc7XG5leHBvcnQgdmFyIGFmdGVyUmVhZCA9ICdhZnRlclJlYWQnOyAvLyBwdXJlLWxvZ2ljIG1vZGlmaWVyc1xuXG5leHBvcnQgdmFyIGJlZm9yZU1haW4gPSAnYmVmb3JlTWFpbic7XG5leHBvcnQgdmFyIG1haW4gPSAnbWFpbic7XG5leHBvcnQgdmFyIGFmdGVyTWFpbiA9ICdhZnRlck1haW4nOyAvLyBtb2RpZmllciB3aXRoIHRoZSBwdXJwb3NlIHRvIHdyaXRlIHRvIHRoZSBET00gKG9yIHdyaXRlIGludG8gYSBmcmFtZXdvcmsgc3RhdGUpXG5cbmV4cG9ydCB2YXIgYmVmb3JlV3JpdGUgPSAnYmVmb3JlV3JpdGUnO1xuZXhwb3J0IHZhciB3cml0ZSA9ICd3cml0ZSc7XG5leHBvcnQgdmFyIGFmdGVyV3JpdGUgPSAnYWZ0ZXJXcml0ZSc7XG5leHBvcnQgdmFyIG1vZGlmaWVyUGhhc2VzID0gW2JlZm9yZVJlYWQsIHJlYWQsIGFmdGVyUmVhZCwgYmVmb3JlTWFpbiwgbWFpbiwgYWZ0ZXJNYWluLCBiZWZvcmVXcml0ZSwgd3JpdGUsIGFmdGVyV3JpdGVdOyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXROb2RlTmFtZShlbGVtZW50KSB7XG4gIHJldHVybiBlbGVtZW50ID8gKGVsZW1lbnQubm9kZU5hbWUgfHwgJycpLnRvTG93ZXJDYXNlKCkgOiBudWxsO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRXaW5kb3cobm9kZSkge1xuICBpZiAobm9kZSA9PSBudWxsKSB7XG4gICAgcmV0dXJuIHdpbmRvdztcbiAgfVxuXG4gIGlmIChub2RlLnRvU3RyaW5nKCkgIT09ICdbb2JqZWN0IFdpbmRvd10nKSB7XG4gICAgdmFyIG93bmVyRG9jdW1lbnQgPSBub2RlLm93bmVyRG9jdW1lbnQ7XG4gICAgcmV0dXJuIG93bmVyRG9jdW1lbnQgPyBvd25lckRvY3VtZW50LmRlZmF1bHRWaWV3IHx8IHdpbmRvdyA6IHdpbmRvdztcbiAgfVxuXG4gIHJldHVybiBub2RlO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuXG5mdW5jdGlvbiBpc0VsZW1lbnQobm9kZSkge1xuICB2YXIgT3duRWxlbWVudCA9IGdldFdpbmRvdyhub2RlKS5FbGVtZW50O1xuICByZXR1cm4gbm9kZSBpbnN0YW5jZW9mIE93bkVsZW1lbnQgfHwgbm9kZSBpbnN0YW5jZW9mIEVsZW1lbnQ7XG59XG5cbmZ1bmN0aW9uIGlzSFRNTEVsZW1lbnQobm9kZSkge1xuICB2YXIgT3duRWxlbWVudCA9IGdldFdpbmRvdyhub2RlKS5IVE1MRWxlbWVudDtcbiAgcmV0dXJuIG5vZGUgaW5zdGFuY2VvZiBPd25FbGVtZW50IHx8IG5vZGUgaW5zdGFuY2VvZiBIVE1MRWxlbWVudDtcbn1cblxuZnVuY3Rpb24gaXNTaGFkb3dSb290KG5vZGUpIHtcbiAgLy8gSUUgMTEgaGFzIG5vIFNoYWRvd1Jvb3RcbiAgaWYgKHR5cGVvZiBTaGFkb3dSb290ID09PSAndW5kZWZpbmVkJykge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIHZhciBPd25FbGVtZW50ID0gZ2V0V2luZG93KG5vZGUpLlNoYWRvd1Jvb3Q7XG4gIHJldHVybiBub2RlIGluc3RhbmNlb2YgT3duRWxlbWVudCB8fCBub2RlIGluc3RhbmNlb2YgU2hhZG93Um9vdDtcbn1cblxuZXhwb3J0IHsgaXNFbGVtZW50LCBpc0hUTUxFbGVtZW50LCBpc1NoYWRvd1Jvb3QgfTsiLCAiaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjsgLy8gVGhpcyBtb2RpZmllciB0YWtlcyB0aGUgc3R5bGVzIHByZXBhcmVkIGJ5IHRoZSBgY29tcHV0ZVN0eWxlc2AgbW9kaWZpZXJcbi8vIGFuZCBhcHBsaWVzIHRoZW0gdG8gdGhlIEhUTUxFbGVtZW50cyBzdWNoIGFzIHBvcHBlciBhbmQgYXJyb3dcblxuZnVuY3Rpb24gYXBwbHlTdHlsZXMoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlO1xuICBPYmplY3Qua2V5cyhzdGF0ZS5lbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgIHZhciBzdHlsZSA9IHN0YXRlLnN0eWxlc1tuYW1lXSB8fCB7fTtcbiAgICB2YXIgYXR0cmlidXRlcyA9IHN0YXRlLmF0dHJpYnV0ZXNbbmFtZV0gfHwge307XG4gICAgdmFyIGVsZW1lbnQgPSBzdGF0ZS5lbGVtZW50c1tuYW1lXTsgLy8gYXJyb3cgaXMgb3B0aW9uYWwgKyB2aXJ0dWFsIGVsZW1lbnRzXG5cbiAgICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgIWdldE5vZGVOYW1lKGVsZW1lbnQpKSB7XG4gICAgICByZXR1cm47XG4gICAgfSAvLyBGbG93IGRvZXNuJ3Qgc3VwcG9ydCB0byBleHRlbmQgdGhpcyBwcm9wZXJ0eSwgYnV0IGl0J3MgdGhlIG1vc3RcbiAgICAvLyBlZmZlY3RpdmUgd2F5IHRvIGFwcGx5IHN0eWxlcyB0byBhbiBIVE1MRWxlbWVudFxuICAgIC8vICRGbG93Rml4TWVbY2Fubm90LXdyaXRlXVxuXG5cbiAgICBPYmplY3QuYXNzaWduKGVsZW1lbnQuc3R5bGUsIHN0eWxlKTtcbiAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgICB2YXIgdmFsdWUgPSBhdHRyaWJ1dGVzW25hbWVdO1xuXG4gICAgICBpZiAodmFsdWUgPT09IGZhbHNlKSB7XG4gICAgICAgIGVsZW1lbnQucmVtb3ZlQXR0cmlidXRlKG5hbWUpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZWxlbWVudC5zZXRBdHRyaWJ1dGUobmFtZSwgdmFsdWUgPT09IHRydWUgPyAnJyA6IHZhbHVlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGVmZmVjdChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZTtcbiAgdmFyIGluaXRpYWxTdHlsZXMgPSB7XG4gICAgcG9wcGVyOiB7XG4gICAgICBwb3NpdGlvbjogc3RhdGUub3B0aW9ucy5zdHJhdGVneSxcbiAgICAgIGxlZnQ6ICcwJyxcbiAgICAgIHRvcDogJzAnLFxuICAgICAgbWFyZ2luOiAnMCdcbiAgICB9LFxuICAgIGFycm93OiB7XG4gICAgICBwb3NpdGlvbjogJ2Fic29sdXRlJ1xuICAgIH0sXG4gICAgcmVmZXJlbmNlOiB7fVxuICB9O1xuICBPYmplY3QuYXNzaWduKHN0YXRlLmVsZW1lbnRzLnBvcHBlci5zdHlsZSwgaW5pdGlhbFN0eWxlcy5wb3BwZXIpO1xuICBzdGF0ZS5zdHlsZXMgPSBpbml0aWFsU3R5bGVzO1xuXG4gIGlmIChzdGF0ZS5lbGVtZW50cy5hcnJvdykge1xuICAgIE9iamVjdC5hc3NpZ24oc3RhdGUuZWxlbWVudHMuYXJyb3cuc3R5bGUsIGluaXRpYWxTdHlsZXMuYXJyb3cpO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBPYmplY3Qua2V5cyhzdGF0ZS5lbGVtZW50cykuZm9yRWFjaChmdW5jdGlvbiAobmFtZSkge1xuICAgICAgdmFyIGVsZW1lbnQgPSBzdGF0ZS5lbGVtZW50c1tuYW1lXTtcbiAgICAgIHZhciBhdHRyaWJ1dGVzID0gc3RhdGUuYXR0cmlidXRlc1tuYW1lXSB8fCB7fTtcbiAgICAgIHZhciBzdHlsZVByb3BlcnRpZXMgPSBPYmplY3Qua2V5cyhzdGF0ZS5zdHlsZXMuaGFzT3duUHJvcGVydHkobmFtZSkgPyBzdGF0ZS5zdHlsZXNbbmFtZV0gOiBpbml0aWFsU3R5bGVzW25hbWVdKTsgLy8gU2V0IGFsbCB2YWx1ZXMgdG8gYW4gZW1wdHkgc3RyaW5nIHRvIHVuc2V0IHRoZW1cblxuICAgICAgdmFyIHN0eWxlID0gc3R5bGVQcm9wZXJ0aWVzLnJlZHVjZShmdW5jdGlvbiAoc3R5bGUsIHByb3BlcnR5KSB7XG4gICAgICAgIHN0eWxlW3Byb3BlcnR5XSA9ICcnO1xuICAgICAgICByZXR1cm4gc3R5bGU7XG4gICAgICB9LCB7fSk7IC8vIGFycm93IGlzIG9wdGlvbmFsICsgdmlydHVhbCBlbGVtZW50c1xuXG4gICAgICBpZiAoIWlzSFRNTEVsZW1lbnQoZWxlbWVudCkgfHwgIWdldE5vZGVOYW1lKGVsZW1lbnQpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cblxuICAgICAgT2JqZWN0LmFzc2lnbihlbGVtZW50LnN0eWxlLCBzdHlsZSk7XG4gICAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGZ1bmN0aW9uIChhdHRyaWJ1dGUpIHtcbiAgICAgICAgZWxlbWVudC5yZW1vdmVBdHRyaWJ1dGUoYXR0cmlidXRlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnYXBwbHlTdHlsZXMnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ3dyaXRlJyxcbiAgZm46IGFwcGx5U3R5bGVzLFxuICBlZmZlY3Q6IGVmZmVjdCxcbiAgcmVxdWlyZXM6IFsnY29tcHV0ZVN0eWxlcyddXG59OyIsICJpbXBvcnQgeyBhdXRvIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnNwbGl0KCctJylbMF07XG59IiwgImV4cG9ydCB2YXIgbWF4ID0gTWF0aC5tYXg7XG5leHBvcnQgdmFyIG1pbiA9IE1hdGgubWluO1xuZXhwb3J0IHZhciByb3VuZCA9IE1hdGgucm91bmQ7IiwgImltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRCb3VuZGluZ0NsaWVudFJlY3QoZWxlbWVudCwgaW5jbHVkZVNjYWxlKSB7XG4gIGlmIChpbmNsdWRlU2NhbGUgPT09IHZvaWQgMCkge1xuICAgIGluY2x1ZGVTY2FsZSA9IGZhbHNlO1xuICB9XG5cbiAgdmFyIHJlY3QgPSBlbGVtZW50LmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpO1xuICB2YXIgc2NhbGVYID0gMTtcbiAgdmFyIHNjYWxlWSA9IDE7XG5cbiAgaWYgKGlzSFRNTEVsZW1lbnQoZWxlbWVudCkgJiYgaW5jbHVkZVNjYWxlKSB7XG4gICAgdmFyIG9mZnNldEhlaWdodCA9IGVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuICAgIHZhciBvZmZzZXRXaWR0aCA9IGVsZW1lbnQub2Zmc2V0V2lkdGg7IC8vIERvIG5vdCBhdHRlbXB0IHRvIGRpdmlkZSBieSAwLCBvdGhlcndpc2Ugd2UgZ2V0IGBJbmZpbml0eWAgYXMgc2NhbGVcbiAgICAvLyBGYWxsYmFjayB0byAxIGluIGNhc2UgYm90aCB2YWx1ZXMgYXJlIGAwYFxuXG4gICAgaWYgKG9mZnNldFdpZHRoID4gMCkge1xuICAgICAgc2NhbGVYID0gcm91bmQocmVjdC53aWR0aCkgLyBvZmZzZXRXaWR0aCB8fCAxO1xuICAgIH1cblxuICAgIGlmIChvZmZzZXRIZWlnaHQgPiAwKSB7XG4gICAgICBzY2FsZVkgPSByb3VuZChyZWN0LmhlaWdodCkgLyBvZmZzZXRIZWlnaHQgfHwgMTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHdpZHRoOiByZWN0LndpZHRoIC8gc2NhbGVYLFxuICAgIGhlaWdodDogcmVjdC5oZWlnaHQgLyBzY2FsZVksXG4gICAgdG9wOiByZWN0LnRvcCAvIHNjYWxlWSxcbiAgICByaWdodDogcmVjdC5yaWdodCAvIHNjYWxlWCxcbiAgICBib3R0b206IHJlY3QuYm90dG9tIC8gc2NhbGVZLFxuICAgIGxlZnQ6IHJlY3QubGVmdCAvIHNjYWxlWCxcbiAgICB4OiByZWN0LmxlZnQgLyBzY2FsZVgsXG4gICAgeTogcmVjdC50b3AgLyBzY2FsZVlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjsgLy8gUmV0dXJucyB0aGUgbGF5b3V0IHJlY3Qgb2YgYW4gZWxlbWVudCByZWxhdGl2ZSB0byBpdHMgb2Zmc2V0UGFyZW50LiBMYXlvdXRcbi8vIG1lYW5zIGl0IGRvZXNuJ3QgdGFrZSBpbnRvIGFjY291bnQgdHJhbnNmb3Jtcy5cblxuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0TGF5b3V0UmVjdChlbGVtZW50KSB7XG4gIHZhciBjbGllbnRSZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQpOyAvLyBVc2UgdGhlIGNsaWVudFJlY3Qgc2l6ZXMgaWYgaXQncyBub3QgYmVlbiB0cmFuc2Zvcm1lZC5cbiAgLy8gRml4ZXMgaHR0cHM6Ly9naXRodWIuY29tL3BvcHBlcmpzL3BvcHBlci1jb3JlL2lzc3Vlcy8xMjIzXG5cbiAgdmFyIHdpZHRoID0gZWxlbWVudC5vZmZzZXRXaWR0aDtcbiAgdmFyIGhlaWdodCA9IGVsZW1lbnQub2Zmc2V0SGVpZ2h0O1xuXG4gIGlmIChNYXRoLmFicyhjbGllbnRSZWN0LndpZHRoIC0gd2lkdGgpIDw9IDEpIHtcbiAgICB3aWR0aCA9IGNsaWVudFJlY3Qud2lkdGg7XG4gIH1cblxuICBpZiAoTWF0aC5hYnMoY2xpZW50UmVjdC5oZWlnaHQgLSBoZWlnaHQpIDw9IDEpIHtcbiAgICBoZWlnaHQgPSBjbGllbnRSZWN0LmhlaWdodDtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgeDogZWxlbWVudC5vZmZzZXRMZWZ0LFxuICAgIHk6IGVsZW1lbnQub2Zmc2V0VG9wLFxuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodFxuICB9O1xufSIsICJpbXBvcnQgeyBpc1NoYWRvd1Jvb3QgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjb250YWlucyhwYXJlbnQsIGNoaWxkKSB7XG4gIHZhciByb290Tm9kZSA9IGNoaWxkLmdldFJvb3ROb2RlICYmIGNoaWxkLmdldFJvb3ROb2RlKCk7IC8vIEZpcnN0LCBhdHRlbXB0IHdpdGggZmFzdGVyIG5hdGl2ZSBtZXRob2RcblxuICBpZiAocGFyZW50LmNvbnRhaW5zKGNoaWxkKSkge1xuICAgIHJldHVybiB0cnVlO1xuICB9IC8vIHRoZW4gZmFsbGJhY2sgdG8gY3VzdG9tIGltcGxlbWVudGF0aW9uIHdpdGggU2hhZG93IERPTSBzdXBwb3J0XG4gIGVsc2UgaWYgKHJvb3ROb2RlICYmIGlzU2hhZG93Um9vdChyb290Tm9kZSkpIHtcbiAgICAgIHZhciBuZXh0ID0gY2hpbGQ7XG5cbiAgICAgIGRvIHtcbiAgICAgICAgaWYgKG5leHQgJiYgcGFyZW50LmlzU2FtZU5vZGUobmV4dCkpIHtcbiAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfSAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ106IG5lZWQgYSBiZXR0ZXIgd2F5IHRvIGhhbmRsZSB0aGlzLi4uXG5cblxuICAgICAgICBuZXh0ID0gbmV4dC5wYXJlbnROb2RlIHx8IG5leHQuaG9zdDtcbiAgICAgIH0gd2hpbGUgKG5leHQpO1xuICAgIH0gLy8gR2l2ZSB1cCwgdGhlIHJlc3VsdCBpcyBmYWxzZVxuXG5cbiAgcmV0dXJuIGZhbHNlO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KSB7XG4gIHJldHVybiBnZXRXaW5kb3coZWxlbWVudCkuZ2V0Q29tcHV0ZWRTdHlsZShlbGVtZW50KTtcbn0iLCAiaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBpc1RhYmxlRWxlbWVudChlbGVtZW50KSB7XG4gIHJldHVybiBbJ3RhYmxlJywgJ3RkJywgJ3RoJ10uaW5kZXhPZihnZXROb2RlTmFtZShlbGVtZW50KSkgPj0gMDtcbn0iLCAiaW1wb3J0IHsgaXNFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0RG9jdW1lbnRFbGVtZW50KGVsZW1lbnQpIHtcbiAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXTogYXNzdW1lIGJvZHkgaXMgYWx3YXlzIGF2YWlsYWJsZVxuICByZXR1cm4gKChpc0VsZW1lbnQoZWxlbWVudCkgPyBlbGVtZW50Lm93bmVyRG9jdW1lbnQgOiAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgZWxlbWVudC5kb2N1bWVudCkgfHwgd2luZG93LmRvY3VtZW50KS5kb2N1bWVudEVsZW1lbnQ7XG59IiwgImltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCB7IGlzU2hhZG93Um9vdCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFBhcmVudE5vZGUoZWxlbWVudCkge1xuICBpZiAoZ2V0Tm9kZU5hbWUoZWxlbWVudCkgPT09ICdodG1sJykge1xuICAgIHJldHVybiBlbGVtZW50O1xuICB9XG5cbiAgcmV0dXJuICgvLyB0aGlzIGlzIGEgcXVpY2tlciAoYnV0IGxlc3MgdHlwZSBzYWZlKSB3YXkgdG8gc2F2ZSBxdWl0ZSBzb21lIGJ5dGVzIGZyb20gdGhlIGJ1bmRsZVxuICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLXJldHVybl1cbiAgICAvLyAkRmxvd0ZpeE1lW3Byb3AtbWlzc2luZ11cbiAgICBlbGVtZW50LmFzc2lnbmVkU2xvdCB8fCAvLyBzdGVwIGludG8gdGhlIHNoYWRvdyBET00gb2YgdGhlIHBhcmVudCBvZiBhIHNsb3R0ZWQgbm9kZVxuICAgIGVsZW1lbnQucGFyZW50Tm9kZSB8fCAoIC8vIERPTSBFbGVtZW50IGRldGVjdGVkXG4gICAgaXNTaGFkb3dSb290KGVsZW1lbnQpID8gZWxlbWVudC5ob3N0IDogbnVsbCkgfHwgLy8gU2hhZG93Um9vdCBkZXRlY3RlZFxuICAgIC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdOiBIVE1MRWxlbWVudCBpcyBhIE5vZGVcbiAgICBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCkgLy8gZmFsbGJhY2tcblxuICApO1xufSIsICJpbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuL2dldFdpbmRvdy5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9nZXRDb21wdXRlZFN0eWxlLmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50LCBpc1NoYWRvd1Jvb3QgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgaXNUYWJsZUVsZW1lbnQgZnJvbSBcIi4vaXNUYWJsZUVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcblxuZnVuY3Rpb24gZ2V0VHJ1ZU9mZnNldFBhcmVudChlbGVtZW50KSB7XG4gIGlmICghaXNIVE1MRWxlbWVudChlbGVtZW50KSB8fCAvLyBodHRwczovL2dpdGh1Yi5jb20vcG9wcGVyanMvcG9wcGVyLWNvcmUvaXNzdWVzLzgzN1xuICBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpLnBvc2l0aW9uID09PSAnZml4ZWQnKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICByZXR1cm4gZWxlbWVudC5vZmZzZXRQYXJlbnQ7XG59IC8vIGAub2Zmc2V0UGFyZW50YCByZXBvcnRzIGBudWxsYCBmb3IgZml4ZWQgZWxlbWVudHMsIHdoaWxlIGFic29sdXRlIGVsZW1lbnRzXG4vLyByZXR1cm4gdGhlIGNvbnRhaW5pbmcgYmxvY2tcblxuXG5mdW5jdGlvbiBnZXRDb250YWluaW5nQmxvY2soZWxlbWVudCkge1xuICB2YXIgaXNGaXJlZm94ID0gbmF2aWdhdG9yLnVzZXJBZ2VudC50b0xvd2VyQ2FzZSgpLmluZGV4T2YoJ2ZpcmVmb3gnKSAhPT0gLTE7XG4gIHZhciBpc0lFID0gbmF2aWdhdG9yLnVzZXJBZ2VudC5pbmRleE9mKCdUcmlkZW50JykgIT09IC0xO1xuXG4gIGlmIChpc0lFICYmIGlzSFRNTEVsZW1lbnQoZWxlbWVudCkpIHtcbiAgICAvLyBJbiBJRSA5LCAxMCBhbmQgMTEgZml4ZWQgZWxlbWVudHMgY29udGFpbmluZyBibG9jayBpcyBhbHdheXMgZXN0YWJsaXNoZWQgYnkgdGhlIHZpZXdwb3J0XG4gICAgdmFyIGVsZW1lbnRDc3MgPSBnZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpO1xuXG4gICAgaWYgKGVsZW1lbnRDc3MucG9zaXRpb24gPT09ICdmaXhlZCcpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgfVxuXG4gIHZhciBjdXJyZW50Tm9kZSA9IGdldFBhcmVudE5vZGUoZWxlbWVudCk7XG5cbiAgaWYgKGlzU2hhZG93Um9vdChjdXJyZW50Tm9kZSkpIHtcbiAgICBjdXJyZW50Tm9kZSA9IGN1cnJlbnROb2RlLmhvc3Q7XG4gIH1cblxuICB3aGlsZSAoaXNIVE1MRWxlbWVudChjdXJyZW50Tm9kZSkgJiYgWydodG1sJywgJ2JvZHknXS5pbmRleE9mKGdldE5vZGVOYW1lKGN1cnJlbnROb2RlKSkgPCAwKSB7XG4gICAgdmFyIGNzcyA9IGdldENvbXB1dGVkU3R5bGUoY3VycmVudE5vZGUpOyAvLyBUaGlzIGlzIG5vbi1leGhhdXN0aXZlIGJ1dCBjb3ZlcnMgdGhlIG1vc3QgY29tbW9uIENTUyBwcm9wZXJ0aWVzIHRoYXRcbiAgICAvLyBjcmVhdGUgYSBjb250YWluaW5nIGJsb2NrLlxuICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0NTUy9Db250YWluaW5nX2Jsb2NrI2lkZW50aWZ5aW5nX3RoZV9jb250YWluaW5nX2Jsb2NrXG5cbiAgICBpZiAoY3NzLnRyYW5zZm9ybSAhPT0gJ25vbmUnIHx8IGNzcy5wZXJzcGVjdGl2ZSAhPT0gJ25vbmUnIHx8IGNzcy5jb250YWluID09PSAncGFpbnQnIHx8IFsndHJhbnNmb3JtJywgJ3BlcnNwZWN0aXZlJ10uaW5kZXhPZihjc3Mud2lsbENoYW5nZSkgIT09IC0xIHx8IGlzRmlyZWZveCAmJiBjc3Mud2lsbENoYW5nZSA9PT0gJ2ZpbHRlcicgfHwgaXNGaXJlZm94ICYmIGNzcy5maWx0ZXIgJiYgY3NzLmZpbHRlciAhPT0gJ25vbmUnKSB7XG4gICAgICByZXR1cm4gY3VycmVudE5vZGU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGN1cnJlbnROb2RlID0gY3VycmVudE5vZGUucGFyZW50Tm9kZTtcbiAgICB9XG4gIH1cblxuICByZXR1cm4gbnVsbDtcbn0gLy8gR2V0cyB0aGUgY2xvc2VzdCBhbmNlc3RvciBwb3NpdGlvbmVkIGVsZW1lbnQuIEhhbmRsZXMgc29tZSBlZGdlIGNhc2VzLFxuLy8gc3VjaCBhcyB0YWJsZSBhbmNlc3RvcnMgYW5kIGNyb3NzIGJyb3dzZXIgYnVncy5cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRPZmZzZXRQYXJlbnQoZWxlbWVudCkge1xuICB2YXIgd2luZG93ID0gZ2V0V2luZG93KGVsZW1lbnQpO1xuICB2YXIgb2Zmc2V0UGFyZW50ID0gZ2V0VHJ1ZU9mZnNldFBhcmVudChlbGVtZW50KTtcblxuICB3aGlsZSAob2Zmc2V0UGFyZW50ICYmIGlzVGFibGVFbGVtZW50KG9mZnNldFBhcmVudCkgJiYgZ2V0Q29tcHV0ZWRTdHlsZShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uID09PSAnc3RhdGljJykge1xuICAgIG9mZnNldFBhcmVudCA9IGdldFRydWVPZmZzZXRQYXJlbnQob2Zmc2V0UGFyZW50KTtcbiAgfVxuXG4gIGlmIChvZmZzZXRQYXJlbnQgJiYgKGdldE5vZGVOYW1lKG9mZnNldFBhcmVudCkgPT09ICdodG1sJyB8fCBnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpID09PSAnYm9keScgJiYgZ2V0Q29tcHV0ZWRTdHlsZShvZmZzZXRQYXJlbnQpLnBvc2l0aW9uID09PSAnc3RhdGljJykpIHtcbiAgICByZXR1cm4gd2luZG93O1xuICB9XG5cbiAgcmV0dXJuIG9mZnNldFBhcmVudCB8fCBnZXRDb250YWluaW5nQmxvY2soZWxlbWVudCkgfHwgd2luZG93O1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBbJ3RvcCcsICdib3R0b20nXS5pbmRleE9mKHBsYWNlbWVudCkgPj0gMCA/ICd4JyA6ICd5Jztcbn0iLCAiaW1wb3J0IHsgbWF4IGFzIG1hdGhNYXgsIG1pbiBhcyBtYXRoTWluIH0gZnJvbSBcIi4vbWF0aC5qc1wiO1xuZXhwb3J0IGZ1bmN0aW9uIHdpdGhpbihtaW4sIHZhbHVlLCBtYXgpIHtcbiAgcmV0dXJuIG1hdGhNYXgobWluLCBtYXRoTWluKHZhbHVlLCBtYXgpKTtcbn1cbmV4cG9ydCBmdW5jdGlvbiB3aXRoaW5NYXhDbGFtcChtaW4sIHZhbHVlLCBtYXgpIHtcbiAgdmFyIHYgPSB3aXRoaW4obWluLCB2YWx1ZSwgbWF4KTtcbiAgcmV0dXJuIHYgPiBtYXggPyBtYXggOiB2O1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRGcmVzaFNpZGVPYmplY3QoKSB7XG4gIHJldHVybiB7XG4gICAgdG9wOiAwLFxuICAgIHJpZ2h0OiAwLFxuICAgIGJvdHRvbTogMCxcbiAgICBsZWZ0OiAwXG4gIH07XG59IiwgImltcG9ydCBnZXRGcmVzaFNpZGVPYmplY3QgZnJvbSBcIi4vZ2V0RnJlc2hTaWRlT2JqZWN0LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBtZXJnZVBhZGRpbmdPYmplY3QocGFkZGluZ09iamVjdCkge1xuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgZ2V0RnJlc2hTaWRlT2JqZWN0KCksIHBhZGRpbmdPYmplY3QpO1xufSIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBleHBhbmRUb0hhc2hNYXAodmFsdWUsIGtleXMpIHtcbiAgcmV0dXJuIGtleXMucmVkdWNlKGZ1bmN0aW9uIChoYXNoTWFwLCBrZXkpIHtcbiAgICBoYXNoTWFwW2tleV0gPSB2YWx1ZTtcbiAgICByZXR1cm4gaGFzaE1hcDtcbiAgfSwge30pO1xufSIsICJpbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldExheW91dFJlY3QgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRMYXlvdXRSZWN0LmpzXCI7XG5pbXBvcnQgY29udGFpbnMgZnJvbSBcIi4uL2RvbS11dGlscy9jb250YWlucy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldE9mZnNldFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgeyB3aXRoaW4gfSBmcm9tIFwiLi4vdXRpbHMvd2l0aGluLmpzXCI7XG5pbXBvcnQgbWVyZ2VQYWRkaW5nT2JqZWN0IGZyb20gXCIuLi91dGlscy9tZXJnZVBhZGRpbmdPYmplY3QuanNcIjtcbmltcG9ydCBleHBhbmRUb0hhc2hNYXAgZnJvbSBcIi4uL3V0aWxzL2V4cGFuZFRvSGFzaE1hcC5qc1wiO1xuaW1wb3J0IHsgbGVmdCwgcmlnaHQsIGJhc2VQbGFjZW1lbnRzLCB0b3AsIGJvdHRvbSB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuLi9kb20tdXRpbHMvaW5zdGFuY2VPZi5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbnZhciB0b1BhZGRpbmdPYmplY3QgPSBmdW5jdGlvbiB0b1BhZGRpbmdPYmplY3QocGFkZGluZywgc3RhdGUpIHtcbiAgcGFkZGluZyA9IHR5cGVvZiBwYWRkaW5nID09PSAnZnVuY3Rpb24nID8gcGFkZGluZyhPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5yZWN0cywge1xuICAgIHBsYWNlbWVudDogc3RhdGUucGxhY2VtZW50XG4gIH0pKSA6IHBhZGRpbmc7XG4gIHJldHVybiBtZXJnZVBhZGRpbmdPYmplY3QodHlwZW9mIHBhZGRpbmcgIT09ICdudW1iZXInID8gcGFkZGluZyA6IGV4cGFuZFRvSGFzaE1hcChwYWRkaW5nLCBiYXNlUGxhY2VtZW50cykpO1xufTtcblxuZnVuY3Rpb24gYXJyb3coX3JlZikge1xuICB2YXIgX3N0YXRlJG1vZGlmaWVyc0RhdGEkO1xuXG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucztcbiAgdmFyIGFycm93RWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzLmFycm93O1xuICB2YXIgcG9wcGVyT2Zmc2V0cyA9IHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cztcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHN0YXRlLnBsYWNlbWVudCk7XG4gIHZhciBheGlzID0gZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50KGJhc2VQbGFjZW1lbnQpO1xuICB2YXIgaXNWZXJ0aWNhbCA9IFtsZWZ0LCByaWdodF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSA+PSAwO1xuICB2YXIgbGVuID0gaXNWZXJ0aWNhbCA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICBpZiAoIWFycm93RWxlbWVudCB8fCAhcG9wcGVyT2Zmc2V0cykge1xuICAgIHJldHVybjtcbiAgfVxuXG4gIHZhciBwYWRkaW5nT2JqZWN0ID0gdG9QYWRkaW5nT2JqZWN0KG9wdGlvbnMucGFkZGluZywgc3RhdGUpO1xuICB2YXIgYXJyb3dSZWN0ID0gZ2V0TGF5b3V0UmVjdChhcnJvd0VsZW1lbnQpO1xuICB2YXIgbWluUHJvcCA9IGF4aXMgPT09ICd5JyA/IHRvcCA6IGxlZnQ7XG4gIHZhciBtYXhQcm9wID0gYXhpcyA9PT0gJ3knID8gYm90dG9tIDogcmlnaHQ7XG4gIHZhciBlbmREaWZmID0gc3RhdGUucmVjdHMucmVmZXJlbmNlW2xlbl0gKyBzdGF0ZS5yZWN0cy5yZWZlcmVuY2VbYXhpc10gLSBwb3BwZXJPZmZzZXRzW2F4aXNdIC0gc3RhdGUucmVjdHMucG9wcGVyW2xlbl07XG4gIHZhciBzdGFydERpZmYgPSBwb3BwZXJPZmZzZXRzW2F4aXNdIC0gc3RhdGUucmVjdHMucmVmZXJlbmNlW2F4aXNdO1xuICB2YXIgYXJyb3dPZmZzZXRQYXJlbnQgPSBnZXRPZmZzZXRQYXJlbnQoYXJyb3dFbGVtZW50KTtcbiAgdmFyIGNsaWVudFNpemUgPSBhcnJvd09mZnNldFBhcmVudCA/IGF4aXMgPT09ICd5JyA/IGFycm93T2Zmc2V0UGFyZW50LmNsaWVudEhlaWdodCB8fCAwIDogYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50V2lkdGggfHwgMCA6IDA7XG4gIHZhciBjZW50ZXJUb1JlZmVyZW5jZSA9IGVuZERpZmYgLyAyIC0gc3RhcnREaWZmIC8gMjsgLy8gTWFrZSBzdXJlIHRoZSBhcnJvdyBkb2Vzbid0IG92ZXJmbG93IHRoZSBwb3BwZXIgaWYgdGhlIGNlbnRlciBwb2ludCBpc1xuICAvLyBvdXRzaWRlIG9mIHRoZSBwb3BwZXIgYm91bmRzXG5cbiAgdmFyIG1pbiA9IHBhZGRpbmdPYmplY3RbbWluUHJvcF07XG4gIHZhciBtYXggPSBjbGllbnRTaXplIC0gYXJyb3dSZWN0W2xlbl0gLSBwYWRkaW5nT2JqZWN0W21heFByb3BdO1xuICB2YXIgY2VudGVyID0gY2xpZW50U2l6ZSAvIDIgLSBhcnJvd1JlY3RbbGVuXSAvIDIgKyBjZW50ZXJUb1JlZmVyZW5jZTtcbiAgdmFyIG9mZnNldCA9IHdpdGhpbihtaW4sIGNlbnRlciwgbWF4KTsgLy8gUHJldmVudHMgYnJlYWtpbmcgc3ludGF4IGhpZ2hsaWdodGluZy4uLlxuXG4gIHZhciBheGlzUHJvcCA9IGF4aXM7XG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSAoX3N0YXRlJG1vZGlmaWVyc0RhdGEkID0ge30sIF9zdGF0ZSRtb2RpZmllcnNEYXRhJFtheGlzUHJvcF0gPSBvZmZzZXQsIF9zdGF0ZSRtb2RpZmllcnNEYXRhJC5jZW50ZXJPZmZzZXQgPSBvZmZzZXQgLSBjZW50ZXIsIF9zdGF0ZSRtb2RpZmllcnNEYXRhJCk7XG59XG5cbmZ1bmN0aW9uIGVmZmVjdChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmMi5vcHRpb25zO1xuICB2YXIgX29wdGlvbnMkZWxlbWVudCA9IG9wdGlvbnMuZWxlbWVudCxcbiAgICAgIGFycm93RWxlbWVudCA9IF9vcHRpb25zJGVsZW1lbnQgPT09IHZvaWQgMCA/ICdbZGF0YS1wb3BwZXItYXJyb3ddJyA6IF9vcHRpb25zJGVsZW1lbnQ7XG5cbiAgaWYgKGFycm93RWxlbWVudCA9PSBudWxsKSB7XG4gICAgcmV0dXJuO1xuICB9IC8vIENTUyBzZWxlY3RvclxuXG5cbiAgaWYgKHR5cGVvZiBhcnJvd0VsZW1lbnQgPT09ICdzdHJpbmcnKSB7XG4gICAgYXJyb3dFbGVtZW50ID0gc3RhdGUuZWxlbWVudHMucG9wcGVyLnF1ZXJ5U2VsZWN0b3IoYXJyb3dFbGVtZW50KTtcblxuICAgIGlmICghYXJyb3dFbGVtZW50KSB7XG4gICAgICByZXR1cm47XG4gICAgfVxuICB9XG5cbiAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgIGlmICghaXNIVE1MRWxlbWVudChhcnJvd0VsZW1lbnQpKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFsnUG9wcGVyOiBcImFycm93XCIgZWxlbWVudCBtdXN0IGJlIGFuIEhUTUxFbGVtZW50IChub3QgYW4gU1ZHRWxlbWVudCkuJywgJ1RvIHVzZSBhbiBTVkcgYXJyb3csIHdyYXAgaXQgaW4gYW4gSFRNTEVsZW1lbnQgdGhhdCB3aWxsIGJlIHVzZWQgYXMnLCAndGhlIGFycm93LiddLmpvaW4oJyAnKSk7XG4gICAgfVxuICB9XG5cbiAgaWYgKCFjb250YWlucyhzdGF0ZS5lbGVtZW50cy5wb3BwZXIsIGFycm93RWxlbWVudCkpIHtcbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFsnUG9wcGVyOiBcImFycm93XCIgbW9kaWZpZXJcXCdzIGBlbGVtZW50YCBtdXN0IGJlIGEgY2hpbGQgb2YgdGhlIHBvcHBlcicsICdlbGVtZW50LiddLmpvaW4oJyAnKSk7XG4gICAgfVxuXG4gICAgcmV0dXJuO1xuICB9XG5cbiAgc3RhdGUuZWxlbWVudHMuYXJyb3cgPSBhcnJvd0VsZW1lbnQ7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdhcnJvdycsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIGZuOiBhcnJvdyxcbiAgZWZmZWN0OiBlZmZlY3QsXG4gIHJlcXVpcmVzOiBbJ3BvcHBlck9mZnNldHMnXSxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydwcmV2ZW50T3ZlcmZsb3cnXVxufTsiLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkge1xuICByZXR1cm4gcGxhY2VtZW50LnNwbGl0KCctJylbMV07XG59IiwgImltcG9ydCB7IHRvcCwgbGVmdCwgcmlnaHQsIGJvdHRvbSwgZW5kIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZ2V0T2Zmc2V0UGFyZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0VmFyaWF0aW9uIGZyb20gXCIuLi91dGlscy9nZXRWYXJpYXRpb24uanNcIjtcbmltcG9ydCB7IHJvdW5kIH0gZnJvbSBcIi4uL3V0aWxzL21hdGguanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG52YXIgdW5zZXRTaWRlcyA9IHtcbiAgdG9wOiAnYXV0bycsXG4gIHJpZ2h0OiAnYXV0bycsXG4gIGJvdHRvbTogJ2F1dG8nLFxuICBsZWZ0OiAnYXV0bydcbn07IC8vIFJvdW5kIHRoZSBvZmZzZXRzIHRvIHRoZSBuZWFyZXN0IHN1aXRhYmxlIHN1YnBpeGVsIGJhc2VkIG9uIHRoZSBEUFIuXG4vLyBab29taW5nIGNhbiBjaGFuZ2UgdGhlIERQUiwgYnV0IGl0IHNlZW1zIHRvIHJlcG9ydCBhIHZhbHVlIHRoYXQgd2lsbFxuLy8gY2xlYW5seSBkaXZpZGUgdGhlIHZhbHVlcyBpbnRvIHRoZSBhcHByb3ByaWF0ZSBzdWJwaXhlbHMuXG5cbmZ1bmN0aW9uIHJvdW5kT2Zmc2V0c0J5RFBSKF9yZWYpIHtcbiAgdmFyIHggPSBfcmVmLngsXG4gICAgICB5ID0gX3JlZi55O1xuICB2YXIgd2luID0gd2luZG93O1xuICB2YXIgZHByID0gd2luLmRldmljZVBpeGVsUmF0aW8gfHwgMTtcbiAgcmV0dXJuIHtcbiAgICB4OiByb3VuZCh4ICogZHByKSAvIGRwciB8fCAwLFxuICAgIHk6IHJvdW5kKHkgKiBkcHIpIC8gZHByIHx8IDBcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1hcFRvU3R5bGVzKF9yZWYyKSB7XG4gIHZhciBfT2JqZWN0JGFzc2lnbjI7XG5cbiAgdmFyIHBvcHBlciA9IF9yZWYyLnBvcHBlcixcbiAgICAgIHBvcHBlclJlY3QgPSBfcmVmMi5wb3BwZXJSZWN0LFxuICAgICAgcGxhY2VtZW50ID0gX3JlZjIucGxhY2VtZW50LFxuICAgICAgdmFyaWF0aW9uID0gX3JlZjIudmFyaWF0aW9uLFxuICAgICAgb2Zmc2V0cyA9IF9yZWYyLm9mZnNldHMsXG4gICAgICBwb3NpdGlvbiA9IF9yZWYyLnBvc2l0aW9uLFxuICAgICAgZ3B1QWNjZWxlcmF0aW9uID0gX3JlZjIuZ3B1QWNjZWxlcmF0aW9uLFxuICAgICAgYWRhcHRpdmUgPSBfcmVmMi5hZGFwdGl2ZSxcbiAgICAgIHJvdW5kT2Zmc2V0cyA9IF9yZWYyLnJvdW5kT2Zmc2V0cyxcbiAgICAgIGlzRml4ZWQgPSBfcmVmMi5pc0ZpeGVkO1xuICB2YXIgX29mZnNldHMkeCA9IG9mZnNldHMueCxcbiAgICAgIHggPSBfb2Zmc2V0cyR4ID09PSB2b2lkIDAgPyAwIDogX29mZnNldHMkeCxcbiAgICAgIF9vZmZzZXRzJHkgPSBvZmZzZXRzLnksXG4gICAgICB5ID0gX29mZnNldHMkeSA9PT0gdm9pZCAwID8gMCA6IF9vZmZzZXRzJHk7XG5cbiAgdmFyIF9yZWYzID0gdHlwZW9mIHJvdW5kT2Zmc2V0cyA9PT0gJ2Z1bmN0aW9uJyA/IHJvdW5kT2Zmc2V0cyh7XG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH0pIDoge1xuICAgIHg6IHgsXG4gICAgeTogeVxuICB9O1xuXG4gIHggPSBfcmVmMy54O1xuICB5ID0gX3JlZjMueTtcbiAgdmFyIGhhc1ggPSBvZmZzZXRzLmhhc093blByb3BlcnR5KCd4Jyk7XG4gIHZhciBoYXNZID0gb2Zmc2V0cy5oYXNPd25Qcm9wZXJ0eSgneScpO1xuICB2YXIgc2lkZVggPSBsZWZ0O1xuICB2YXIgc2lkZVkgPSB0b3A7XG4gIHZhciB3aW4gPSB3aW5kb3c7XG5cbiAgaWYgKGFkYXB0aXZlKSB7XG4gICAgdmFyIG9mZnNldFBhcmVudCA9IGdldE9mZnNldFBhcmVudChwb3BwZXIpO1xuICAgIHZhciBoZWlnaHRQcm9wID0gJ2NsaWVudEhlaWdodCc7XG4gICAgdmFyIHdpZHRoUHJvcCA9ICdjbGllbnRXaWR0aCc7XG5cbiAgICBpZiAob2Zmc2V0UGFyZW50ID09PSBnZXRXaW5kb3cocG9wcGVyKSkge1xuICAgICAgb2Zmc2V0UGFyZW50ID0gZ2V0RG9jdW1lbnRFbGVtZW50KHBvcHBlcik7XG5cbiAgICAgIGlmIChnZXRDb21wdXRlZFN0eWxlKG9mZnNldFBhcmVudCkucG9zaXRpb24gIT09ICdzdGF0aWMnICYmIHBvc2l0aW9uID09PSAnYWJzb2x1dGUnKSB7XG4gICAgICAgIGhlaWdodFByb3AgPSAnc2Nyb2xsSGVpZ2h0JztcbiAgICAgICAgd2lkdGhQcm9wID0gJ3Njcm9sbFdpZHRoJztcbiAgICAgIH1cbiAgICB9IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhc3RdOiBmb3JjZSB0eXBlIHJlZmluZW1lbnQsIHdlIGNvbXBhcmUgb2Zmc2V0UGFyZW50IHdpdGggd2luZG93IGFib3ZlLCBidXQgRmxvdyBkb2Vzbid0IGRldGVjdCBpdFxuXG5cbiAgICBvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQ7XG5cbiAgICBpZiAocGxhY2VtZW50ID09PSB0b3AgfHwgKHBsYWNlbWVudCA9PT0gbGVmdCB8fCBwbGFjZW1lbnQgPT09IHJpZ2h0KSAmJiB2YXJpYXRpb24gPT09IGVuZCkge1xuICAgICAgc2lkZVkgPSBib3R0b207XG4gICAgICB2YXIgb2Zmc2V0WSA9IGlzRml4ZWQgJiYgb2Zmc2V0UGFyZW50ID09PSB3aW4gJiYgd2luLnZpc3VhbFZpZXdwb3J0ID8gd2luLnZpc3VhbFZpZXdwb3J0LmhlaWdodCA6IC8vICRGbG93Rml4TWVbcHJvcC1taXNzaW5nXVxuICAgICAgb2Zmc2V0UGFyZW50W2hlaWdodFByb3BdO1xuICAgICAgeSAtPSBvZmZzZXRZIC0gcG9wcGVyUmVjdC5oZWlnaHQ7XG4gICAgICB5ICo9IGdwdUFjY2VsZXJhdGlvbiA/IDEgOiAtMTtcbiAgICB9XG5cbiAgICBpZiAocGxhY2VtZW50ID09PSBsZWZ0IHx8IChwbGFjZW1lbnQgPT09IHRvcCB8fCBwbGFjZW1lbnQgPT09IGJvdHRvbSkgJiYgdmFyaWF0aW9uID09PSBlbmQpIHtcbiAgICAgIHNpZGVYID0gcmlnaHQ7XG4gICAgICB2YXIgb2Zmc2V0WCA9IGlzRml4ZWQgJiYgb2Zmc2V0UGFyZW50ID09PSB3aW4gJiYgd2luLnZpc3VhbFZpZXdwb3J0ID8gd2luLnZpc3VhbFZpZXdwb3J0LndpZHRoIDogLy8gJEZsb3dGaXhNZVtwcm9wLW1pc3NpbmddXG4gICAgICBvZmZzZXRQYXJlbnRbd2lkdGhQcm9wXTtcbiAgICAgIHggLT0gb2Zmc2V0WCAtIHBvcHBlclJlY3Qud2lkdGg7XG4gICAgICB4ICo9IGdwdUFjY2VsZXJhdGlvbiA/IDEgOiAtMTtcbiAgICB9XG4gIH1cblxuICB2YXIgY29tbW9uU3R5bGVzID0gT2JqZWN0LmFzc2lnbih7XG4gICAgcG9zaXRpb246IHBvc2l0aW9uXG4gIH0sIGFkYXB0aXZlICYmIHVuc2V0U2lkZXMpO1xuXG4gIHZhciBfcmVmNCA9IHJvdW5kT2Zmc2V0cyA9PT0gdHJ1ZSA/IHJvdW5kT2Zmc2V0c0J5RFBSKHtcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfSkgOiB7XG4gICAgeDogeCxcbiAgICB5OiB5XG4gIH07XG5cbiAgeCA9IF9yZWY0Lng7XG4gIHkgPSBfcmVmNC55O1xuXG4gIGlmIChncHVBY2NlbGVyYXRpb24pIHtcbiAgICB2YXIgX09iamVjdCRhc3NpZ247XG5cbiAgICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgY29tbW9uU3R5bGVzLCAoX09iamVjdCRhc3NpZ24gPSB7fSwgX09iamVjdCRhc3NpZ25bc2lkZVldID0gaGFzWSA/ICcwJyA6ICcnLCBfT2JqZWN0JGFzc2lnbltzaWRlWF0gPSBoYXNYID8gJzAnIDogJycsIF9PYmplY3QkYXNzaWduLnRyYW5zZm9ybSA9ICh3aW4uZGV2aWNlUGl4ZWxSYXRpbyB8fCAxKSA8PSAxID8gXCJ0cmFuc2xhdGUoXCIgKyB4ICsgXCJweCwgXCIgKyB5ICsgXCJweClcIiA6IFwidHJhbnNsYXRlM2QoXCIgKyB4ICsgXCJweCwgXCIgKyB5ICsgXCJweCwgMClcIiwgX09iamVjdCRhc3NpZ24pKTtcbiAgfVxuXG4gIHJldHVybiBPYmplY3QuYXNzaWduKHt9LCBjb21tb25TdHlsZXMsIChfT2JqZWN0JGFzc2lnbjIgPSB7fSwgX09iamVjdCRhc3NpZ24yW3NpZGVZXSA9IGhhc1kgPyB5ICsgXCJweFwiIDogJycsIF9PYmplY3QkYXNzaWduMltzaWRlWF0gPSBoYXNYID8geCArIFwicHhcIiA6ICcnLCBfT2JqZWN0JGFzc2lnbjIudHJhbnNmb3JtID0gJycsIF9PYmplY3QkYXNzaWduMikpO1xufVxuXG5mdW5jdGlvbiBjb21wdXRlU3R5bGVzKF9yZWY1KSB7XG4gIHZhciBzdGF0ZSA9IF9yZWY1LnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWY1Lm9wdGlvbnM7XG4gIHZhciBfb3B0aW9ucyRncHVBY2NlbGVyYXQgPSBvcHRpb25zLmdwdUFjY2VsZXJhdGlvbixcbiAgICAgIGdwdUFjY2VsZXJhdGlvbiA9IF9vcHRpb25zJGdwdUFjY2VsZXJhdCA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJGdwdUFjY2VsZXJhdCxcbiAgICAgIF9vcHRpb25zJGFkYXB0aXZlID0gb3B0aW9ucy5hZGFwdGl2ZSxcbiAgICAgIGFkYXB0aXZlID0gX29wdGlvbnMkYWRhcHRpdmUgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRhZGFwdGl2ZSxcbiAgICAgIF9vcHRpb25zJHJvdW5kT2Zmc2V0cyA9IG9wdGlvbnMucm91bmRPZmZzZXRzLFxuICAgICAgcm91bmRPZmZzZXRzID0gX29wdGlvbnMkcm91bmRPZmZzZXRzID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkcm91bmRPZmZzZXRzO1xuXG4gIGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgICB2YXIgdHJhbnNpdGlvblByb3BlcnR5ID0gZ2V0Q29tcHV0ZWRTdHlsZShzdGF0ZS5lbGVtZW50cy5wb3BwZXIpLnRyYW5zaXRpb25Qcm9wZXJ0eSB8fCAnJztcblxuICAgIGlmIChhZGFwdGl2ZSAmJiBbJ3RyYW5zZm9ybScsICd0b3AnLCAncmlnaHQnLCAnYm90dG9tJywgJ2xlZnQnXS5zb21lKGZ1bmN0aW9uIChwcm9wZXJ0eSkge1xuICAgICAgcmV0dXJuIHRyYW5zaXRpb25Qcm9wZXJ0eS5pbmRleE9mKHByb3BlcnR5KSA+PSAwO1xuICAgIH0pKSB7XG4gICAgICBjb25zb2xlLndhcm4oWydQb3BwZXI6IERldGVjdGVkIENTUyB0cmFuc2l0aW9ucyBvbiBhdCBsZWFzdCBvbmUgb2YgdGhlIGZvbGxvd2luZycsICdDU1MgcHJvcGVydGllczogXCJ0cmFuc2Zvcm1cIiwgXCJ0b3BcIiwgXCJyaWdodFwiLCBcImJvdHRvbVwiLCBcImxlZnRcIi4nLCAnXFxuXFxuJywgJ0Rpc2FibGUgdGhlIFwiY29tcHV0ZVN0eWxlc1wiIG1vZGlmaWVyXFwncyBgYWRhcHRpdmVgIG9wdGlvbiB0byBhbGxvdycsICdmb3Igc21vb3RoIHRyYW5zaXRpb25zLCBvciByZW1vdmUgdGhlc2UgcHJvcGVydGllcyBmcm9tIHRoZSBDU1MnLCAndHJhbnNpdGlvbiBkZWNsYXJhdGlvbiBvbiB0aGUgcG9wcGVyIGVsZW1lbnQgaWYgb25seSB0cmFuc2l0aW9uaW5nJywgJ29wYWNpdHkgb3IgYmFja2dyb3VuZC1jb2xvciBmb3IgZXhhbXBsZS4nLCAnXFxuXFxuJywgJ1dlIHJlY29tbWVuZCB1c2luZyB0aGUgcG9wcGVyIGVsZW1lbnQgYXMgYSB3cmFwcGVyIGFyb3VuZCBhbiBpbm5lcicsICdlbGVtZW50IHRoYXQgY2FuIGhhdmUgYW55IENTUyBwcm9wZXJ0eSB0cmFuc2l0aW9uZWQgZm9yIGFuaW1hdGlvbnMuJ10uam9pbignICcpKTtcbiAgICB9XG4gIH1cblxuICB2YXIgY29tbW9uU3R5bGVzID0ge1xuICAgIHBsYWNlbWVudDogZ2V0QmFzZVBsYWNlbWVudChzdGF0ZS5wbGFjZW1lbnQpLFxuICAgIHZhcmlhdGlvbjogZ2V0VmFyaWF0aW9uKHN0YXRlLnBsYWNlbWVudCksXG4gICAgcG9wcGVyOiBzdGF0ZS5lbGVtZW50cy5wb3BwZXIsXG4gICAgcG9wcGVyUmVjdDogc3RhdGUucmVjdHMucG9wcGVyLFxuICAgIGdwdUFjY2VsZXJhdGlvbjogZ3B1QWNjZWxlcmF0aW9uLFxuICAgIGlzRml4ZWQ6IHN0YXRlLm9wdGlvbnMuc3RyYXRlZ3kgPT09ICdmaXhlZCdcbiAgfTtcblxuICBpZiAoc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzICE9IG51bGwpIHtcbiAgICBzdGF0ZS5zdHlsZXMucG9wcGVyID0gT2JqZWN0LmFzc2lnbih7fSwgc3RhdGUuc3R5bGVzLnBvcHBlciwgbWFwVG9TdHlsZXMoT2JqZWN0LmFzc2lnbih7fSwgY29tbW9uU3R5bGVzLCB7XG4gICAgICBvZmZzZXRzOiBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMsXG4gICAgICBwb3NpdGlvbjogc3RhdGUub3B0aW9ucy5zdHJhdGVneSxcbiAgICAgIGFkYXB0aXZlOiBhZGFwdGl2ZSxcbiAgICAgIHJvdW5kT2Zmc2V0czogcm91bmRPZmZzZXRzXG4gICAgfSkpKTtcbiAgfVxuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhLmFycm93ICE9IG51bGwpIHtcbiAgICBzdGF0ZS5zdHlsZXMuYXJyb3cgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5zdHlsZXMuYXJyb3csIG1hcFRvU3R5bGVzKE9iamVjdC5hc3NpZ24oe30sIGNvbW1vblN0eWxlcywge1xuICAgICAgb2Zmc2V0czogc3RhdGUubW9kaWZpZXJzRGF0YS5hcnJvdyxcbiAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgYWRhcHRpdmU6IGZhbHNlLFxuICAgICAgcm91bmRPZmZzZXRzOiByb3VuZE9mZnNldHNcbiAgICB9KSkpO1xuICB9XG5cbiAgc3RhdGUuYXR0cmlidXRlcy5wb3BwZXIgPSBPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciwge1xuICAgICdkYXRhLXBvcHBlci1wbGFjZW1lbnQnOiBzdGF0ZS5wbGFjZW1lbnRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdjb21wdXRlU3R5bGVzJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdiZWZvcmVXcml0ZScsXG4gIGZuOiBjb21wdXRlU3R5bGVzLFxuICBkYXRhOiB7fVxufTsiLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldFdpbmRvdy5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbnZhciBwYXNzaXZlID0ge1xuICBwYXNzaXZlOiB0cnVlXG59O1xuXG5mdW5jdGlvbiBlZmZlY3QoX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgaW5zdGFuY2UgPSBfcmVmLmluc3RhbmNlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucztcbiAgdmFyIF9vcHRpb25zJHNjcm9sbCA9IG9wdGlvbnMuc2Nyb2xsLFxuICAgICAgc2Nyb2xsID0gX29wdGlvbnMkc2Nyb2xsID09PSB2b2lkIDAgPyB0cnVlIDogX29wdGlvbnMkc2Nyb2xsLFxuICAgICAgX29wdGlvbnMkcmVzaXplID0gb3B0aW9ucy5yZXNpemUsXG4gICAgICByZXNpemUgPSBfb3B0aW9ucyRyZXNpemUgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRyZXNpemU7XG4gIHZhciB3aW5kb3cgPSBnZXRXaW5kb3coc3RhdGUuZWxlbWVudHMucG9wcGVyKTtcbiAgdmFyIHNjcm9sbFBhcmVudHMgPSBbXS5jb25jYXQoc3RhdGUuc2Nyb2xsUGFyZW50cy5yZWZlcmVuY2UsIHN0YXRlLnNjcm9sbFBhcmVudHMucG9wcGVyKTtcblxuICBpZiAoc2Nyb2xsKSB7XG4gICAgc2Nyb2xsUGFyZW50cy5mb3JFYWNoKGZ1bmN0aW9uIChzY3JvbGxQYXJlbnQpIHtcbiAgICAgIHNjcm9sbFBhcmVudC5hZGRFdmVudExpc3RlbmVyKCdzY3JvbGwnLCBpbnN0YW5jZS51cGRhdGUsIHBhc3NpdmUpO1xuICAgIH0pO1xuICB9XG5cbiAgaWYgKHJlc2l6ZSkge1xuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdyZXNpemUnLCBpbnN0YW5jZS51cGRhdGUsIHBhc3NpdmUpO1xuICB9XG5cbiAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoc2Nyb2xsKSB7XG4gICAgICBzY3JvbGxQYXJlbnRzLmZvckVhY2goZnVuY3Rpb24gKHNjcm9sbFBhcmVudCkge1xuICAgICAgICBzY3JvbGxQYXJlbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcignc2Nyb2xsJywgaW5zdGFuY2UudXBkYXRlLCBwYXNzaXZlKTtcbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGlmIChyZXNpemUpIHtcbiAgICAgIHdpbmRvdy5yZW1vdmVFdmVudExpc3RlbmVyKCdyZXNpemUnLCBpbnN0YW5jZS51cGRhdGUsIHBhc3NpdmUpO1xuICAgIH1cbiAgfTtcbn0gLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5cbmV4cG9ydCBkZWZhdWx0IHtcbiAgbmFtZTogJ2V2ZW50TGlzdGVuZXJzJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICd3cml0ZScsXG4gIGZuOiBmdW5jdGlvbiBmbigpIHt9LFxuICBlZmZlY3Q6IGVmZmVjdCxcbiAgZGF0YToge31cbn07IiwgInZhciBoYXNoID0ge1xuICBsZWZ0OiAncmlnaHQnLFxuICByaWdodDogJ2xlZnQnLFxuICBib3R0b206ICd0b3AnLFxuICB0b3A6ICdib3R0b20nXG59O1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQocGxhY2VtZW50KSB7XG4gIHJldHVybiBwbGFjZW1lbnQucmVwbGFjZSgvbGVmdHxyaWdodHxib3R0b218dG9wL2csIGZ1bmN0aW9uIChtYXRjaGVkKSB7XG4gICAgcmV0dXJuIGhhc2hbbWF0Y2hlZF07XG4gIH0pO1xufSIsICJ2YXIgaGFzaCA9IHtcbiAgc3RhcnQ6ICdlbmQnLFxuICBlbmQ6ICdzdGFydCdcbn07XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudChwbGFjZW1lbnQpIHtcbiAgcmV0dXJuIHBsYWNlbWVudC5yZXBsYWNlKC9zdGFydHxlbmQvZywgZnVuY3Rpb24gKG1hdGNoZWQpIHtcbiAgICByZXR1cm4gaGFzaFttYXRjaGVkXTtcbiAgfSk7XG59IiwgImltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRXaW5kb3dTY3JvbGwobm9kZSkge1xuICB2YXIgd2luID0gZ2V0V2luZG93KG5vZGUpO1xuICB2YXIgc2Nyb2xsTGVmdCA9IHdpbi5wYWdlWE9mZnNldDtcbiAgdmFyIHNjcm9sbFRvcCA9IHdpbi5wYWdlWU9mZnNldDtcbiAgcmV0dXJuIHtcbiAgICBzY3JvbGxMZWZ0OiBzY3JvbGxMZWZ0LFxuICAgIHNjcm9sbFRvcDogc2Nyb2xsVG9wXG4gIH07XG59IiwgImltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldFdpbmRvd1Njcm9sbCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGwuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFdpbmRvd1Njcm9sbEJhclgoZWxlbWVudCkge1xuICAvLyBJZiA8aHRtbD4gaGFzIGEgQ1NTIHdpZHRoIGdyZWF0ZXIgdGhhbiB0aGUgdmlld3BvcnQsIHRoZW4gdGhpcyB3aWxsIGJlXG4gIC8vIGluY29ycmVjdCBmb3IgUlRMLlxuICAvLyBQb3BwZXIgMSBpcyBicm9rZW4gaW4gdGhpcyBjYXNlIGFuZCBuZXZlciBoYWQgYSBidWcgcmVwb3J0IHNvIGxldCdzIGFzc3VtZVxuICAvLyBpdCdzIG5vdCBhbiBpc3N1ZS4gSSBkb24ndCB0aGluayBhbnlvbmUgZXZlciBzcGVjaWZpZXMgd2lkdGggb24gPGh0bWw+XG4gIC8vIGFueXdheS5cbiAgLy8gQnJvd3NlcnMgd2hlcmUgdGhlIGxlZnQgc2Nyb2xsYmFyIGRvZXNuJ3QgY2F1c2UgYW4gaXNzdWUgcmVwb3J0IGAwYCBmb3JcbiAgLy8gdGhpcyAoZS5nLiBFZGdlIDIwMTksIElFMTEsIFNhZmFyaSlcbiAgcmV0dXJuIGdldEJvdW5kaW5nQ2xpZW50UmVjdChnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCkpLmxlZnQgKyBnZXRXaW5kb3dTY3JvbGwoZWxlbWVudCkuc2Nyb2xsTGVmdDtcbn0iLCAiaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudEVsZW1lbnQgZnJvbSBcIi4vZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsQmFyWCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGxCYXJYLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRWaWV3cG9ydFJlY3QoZWxlbWVudCkge1xuICB2YXIgd2luID0gZ2V0V2luZG93KGVsZW1lbnQpO1xuICB2YXIgaHRtbCA9IGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KTtcbiAgdmFyIHZpc3VhbFZpZXdwb3J0ID0gd2luLnZpc3VhbFZpZXdwb3J0O1xuICB2YXIgd2lkdGggPSBodG1sLmNsaWVudFdpZHRoO1xuICB2YXIgaGVpZ2h0ID0gaHRtbC5jbGllbnRIZWlnaHQ7XG4gIHZhciB4ID0gMDtcbiAgdmFyIHkgPSAwOyAvLyBOQjogVGhpcyBpc24ndCBzdXBwb3J0ZWQgb24gaU9TIDw9IDEyLiBJZiB0aGUga2V5Ym9hcmQgaXMgb3BlbiwgdGhlIHBvcHBlclxuICAvLyBjYW4gYmUgb2JzY3VyZWQgdW5kZXJuZWF0aCBpdC5cbiAgLy8gQWxzbywgYGh0bWwuY2xpZW50SGVpZ2h0YCBhZGRzIHRoZSBib3R0b20gYmFyIGhlaWdodCBpbiBTYWZhcmkgaU9TLCBldmVuXG4gIC8vIGlmIGl0IGlzbid0IG9wZW4sIHNvIGlmIHRoaXMgaXNuJ3QgYXZhaWxhYmxlLCB0aGUgcG9wcGVyIHdpbGwgYmUgZGV0ZWN0ZWRcbiAgLy8gdG8gb3ZlcmZsb3cgdGhlIGJvdHRvbSBvZiB0aGUgc2NyZWVuIHRvbyBlYXJseS5cblxuICBpZiAodmlzdWFsVmlld3BvcnQpIHtcbiAgICB3aWR0aCA9IHZpc3VhbFZpZXdwb3J0LndpZHRoO1xuICAgIGhlaWdodCA9IHZpc3VhbFZpZXdwb3J0LmhlaWdodDsgLy8gVXNlcyBMYXlvdXQgVmlld3BvcnQgKGxpa2UgQ2hyb21lOyBTYWZhcmkgZG9lcyBub3QgY3VycmVudGx5KVxuICAgIC8vIEluIENocm9tZSwgaXQgcmV0dXJucyBhIHZhbHVlIHZlcnkgY2xvc2UgdG8gMCAoKy8tKSBidXQgY29udGFpbnMgcm91bmRpbmdcbiAgICAvLyBlcnJvcnMgZHVlIHRvIGZsb2F0aW5nIHBvaW50IG51bWJlcnMsIHNvIHdlIG5lZWQgdG8gY2hlY2sgcHJlY2lzaW9uLlxuICAgIC8vIFNhZmFyaSByZXR1cm5zIGEgbnVtYmVyIDw9IDAsIHVzdWFsbHkgPCAtMSB3aGVuIHBpbmNoLXpvb21lZFxuICAgIC8vIEZlYXR1cmUgZGV0ZWN0aW9uIGZhaWxzIGluIG1vYmlsZSBlbXVsYXRpb24gbW9kZSBpbiBDaHJvbWUuXG4gICAgLy8gTWF0aC5hYnMod2luLmlubmVyV2lkdGggLyB2aXN1YWxWaWV3cG9ydC5zY2FsZSAtIHZpc3VhbFZpZXdwb3J0LndpZHRoKSA8XG4gICAgLy8gMC4wMDFcbiAgICAvLyBGYWxsYmFjayBoZXJlOiBcIk5vdCBTYWZhcmlcIiB1c2VyQWdlbnRcblxuICAgIGlmICghL14oKD8hY2hyb21lfGFuZHJvaWQpLikqc2FmYXJpL2kudGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSkge1xuICAgICAgeCA9IHZpc3VhbFZpZXdwb3J0Lm9mZnNldExlZnQ7XG4gICAgICB5ID0gdmlzdWFsVmlld3BvcnQub2Zmc2V0VG9wO1xuICAgIH1cbiAgfVxuXG4gIHJldHVybiB7XG4gICAgd2lkdGg6IHdpZHRoLFxuICAgIGhlaWdodDogaGVpZ2h0LFxuICAgIHg6IHggKyBnZXRXaW5kb3dTY3JvbGxCYXJYKGVsZW1lbnQpLFxuICAgIHk6IHlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldERvY3VtZW50RWxlbWVudCBmcm9tIFwiLi9nZXREb2N1bWVudEVsZW1lbnQuanNcIjtcbmltcG9ydCBnZXRDb21wdXRlZFN0eWxlIGZyb20gXCIuL2dldENvbXB1dGVkU3R5bGUuanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGxCYXJYIGZyb20gXCIuL2dldFdpbmRvd1Njcm9sbEJhclguanNcIjtcbmltcG9ydCBnZXRXaW5kb3dTY3JvbGwgZnJvbSBcIi4vZ2V0V2luZG93U2Nyb2xsLmpzXCI7XG5pbXBvcnQgeyBtYXggfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiOyAvLyBHZXRzIHRoZSBlbnRpcmUgc2l6ZSBvZiB0aGUgc2Nyb2xsYWJsZSBkb2N1bWVudCBhcmVhLCBldmVuIGV4dGVuZGluZyBvdXRzaWRlXG4vLyBvZiB0aGUgYDxodG1sPmAgYW5kIGA8Ym9keT5gIHJlY3QgYm91bmRzIGlmIGhvcml6b250YWxseSBzY3JvbGxhYmxlXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldERvY3VtZW50UmVjdChlbGVtZW50KSB7XG4gIHZhciBfZWxlbWVudCRvd25lckRvY3VtZW47XG5cbiAgdmFyIGh0bWwgPSBnZXREb2N1bWVudEVsZW1lbnQoZWxlbWVudCk7XG4gIHZhciB3aW5TY3JvbGwgPSBnZXRXaW5kb3dTY3JvbGwoZWxlbWVudCk7XG4gIHZhciBib2R5ID0gKF9lbGVtZW50JG93bmVyRG9jdW1lbiA9IGVsZW1lbnQub3duZXJEb2N1bWVudCkgPT0gbnVsbCA/IHZvaWQgMCA6IF9lbGVtZW50JG93bmVyRG9jdW1lbi5ib2R5O1xuICB2YXIgd2lkdGggPSBtYXgoaHRtbC5zY3JvbGxXaWR0aCwgaHRtbC5jbGllbnRXaWR0aCwgYm9keSA/IGJvZHkuc2Nyb2xsV2lkdGggOiAwLCBib2R5ID8gYm9keS5jbGllbnRXaWR0aCA6IDApO1xuICB2YXIgaGVpZ2h0ID0gbWF4KGh0bWwuc2Nyb2xsSGVpZ2h0LCBodG1sLmNsaWVudEhlaWdodCwgYm9keSA/IGJvZHkuc2Nyb2xsSGVpZ2h0IDogMCwgYm9keSA/IGJvZHkuY2xpZW50SGVpZ2h0IDogMCk7XG4gIHZhciB4ID0gLXdpblNjcm9sbC5zY3JvbGxMZWZ0ICsgZ2V0V2luZG93U2Nyb2xsQmFyWChlbGVtZW50KTtcbiAgdmFyIHkgPSAtd2luU2Nyb2xsLnNjcm9sbFRvcDtcblxuICBpZiAoZ2V0Q29tcHV0ZWRTdHlsZShib2R5IHx8IGh0bWwpLmRpcmVjdGlvbiA9PT0gJ3J0bCcpIHtcbiAgICB4ICs9IG1heChodG1sLmNsaWVudFdpZHRoLCBib2R5ID8gYm9keS5jbGllbnRXaWR0aCA6IDApIC0gd2lkdGg7XG4gIH1cblxuICByZXR1cm4ge1xuICAgIHdpZHRoOiB3aWR0aCxcbiAgICBoZWlnaHQ6IGhlaWdodCxcbiAgICB4OiB4LFxuICAgIHk6IHlcbiAgfTtcbn0iLCAiaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gaXNTY3JvbGxQYXJlbnQoZWxlbWVudCkge1xuICAvLyBGaXJlZm94IHdhbnRzIHVzIHRvIGNoZWNrIGAteGAgYW5kIGAteWAgdmFyaWF0aW9ucyBhcyB3ZWxsXG4gIHZhciBfZ2V0Q29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCksXG4gICAgICBvdmVyZmxvdyA9IF9nZXRDb21wdXRlZFN0eWxlLm92ZXJmbG93LFxuICAgICAgb3ZlcmZsb3dYID0gX2dldENvbXB1dGVkU3R5bGUub3ZlcmZsb3dYLFxuICAgICAgb3ZlcmZsb3dZID0gX2dldENvbXB1dGVkU3R5bGUub3ZlcmZsb3dZO1xuXG4gIHJldHVybiAvYXV0b3xzY3JvbGx8b3ZlcmxheXxoaWRkZW4vLnRlc3Qob3ZlcmZsb3cgKyBvdmVyZmxvd1kgKyBvdmVyZmxvd1gpO1xufSIsICJpbXBvcnQgZ2V0UGFyZW50Tm9kZSBmcm9tIFwiLi9nZXRQYXJlbnROb2RlLmpzXCI7XG5pbXBvcnQgaXNTY3JvbGxQYXJlbnQgZnJvbSBcIi4vaXNTY3JvbGxQYXJlbnQuanNcIjtcbmltcG9ydCBnZXROb2RlTmFtZSBmcm9tIFwiLi9nZXROb2RlTmFtZS5qc1wiO1xuaW1wb3J0IHsgaXNIVE1MRWxlbWVudCB9IGZyb20gXCIuL2luc3RhbmNlT2YuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGdldFNjcm9sbFBhcmVudChub2RlKSB7XG4gIGlmIChbJ2h0bWwnLCAnYm9keScsICcjZG9jdW1lbnQnXS5pbmRleE9mKGdldE5vZGVOYW1lKG5vZGUpKSA+PSAwKSB7XG4gICAgLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtcmV0dXJuXTogYXNzdW1lIGJvZHkgaXMgYWx3YXlzIGF2YWlsYWJsZVxuICAgIHJldHVybiBub2RlLm93bmVyRG9jdW1lbnQuYm9keTtcbiAgfVxuXG4gIGlmIChpc0hUTUxFbGVtZW50KG5vZGUpICYmIGlzU2Nyb2xsUGFyZW50KG5vZGUpKSB7XG4gICAgcmV0dXJuIG5vZGU7XG4gIH1cblxuICByZXR1cm4gZ2V0U2Nyb2xsUGFyZW50KGdldFBhcmVudE5vZGUobm9kZSkpO1xufSIsICJpbXBvcnQgZ2V0U2Nyb2xsUGFyZW50IGZyb20gXCIuL2dldFNjcm9sbFBhcmVudC5qc1wiO1xuaW1wb3J0IGdldFBhcmVudE5vZGUgZnJvbSBcIi4vZ2V0UGFyZW50Tm9kZS5qc1wiO1xuaW1wb3J0IGdldFdpbmRvdyBmcm9tIFwiLi9nZXRXaW5kb3cuanNcIjtcbmltcG9ydCBpc1Njcm9sbFBhcmVudCBmcm9tIFwiLi9pc1Njcm9sbFBhcmVudC5qc1wiO1xuLypcbmdpdmVuIGEgRE9NIGVsZW1lbnQsIHJldHVybiB0aGUgbGlzdCBvZiBhbGwgc2Nyb2xsIHBhcmVudHMsIHVwIHRoZSBsaXN0IG9mIGFuY2Vzb3JzXG51bnRpbCB3ZSBnZXQgdG8gdGhlIHRvcCB3aW5kb3cgb2JqZWN0LiBUaGlzIGxpc3QgaXMgd2hhdCB3ZSBhdHRhY2ggc2Nyb2xsIGxpc3RlbmVyc1xudG8sIGJlY2F1c2UgaWYgYW55IG9mIHRoZXNlIHBhcmVudCBlbGVtZW50cyBzY3JvbGwsIHdlJ2xsIG5lZWQgdG8gcmUtY2FsY3VsYXRlIHRoZVxucmVmZXJlbmNlIGVsZW1lbnQncyBwb3NpdGlvbi5cbiovXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGxpc3RTY3JvbGxQYXJlbnRzKGVsZW1lbnQsIGxpc3QpIHtcbiAgdmFyIF9lbGVtZW50JG93bmVyRG9jdW1lbjtcblxuICBpZiAobGlzdCA9PT0gdm9pZCAwKSB7XG4gICAgbGlzdCA9IFtdO1xuICB9XG5cbiAgdmFyIHNjcm9sbFBhcmVudCA9IGdldFNjcm9sbFBhcmVudChlbGVtZW50KTtcbiAgdmFyIGlzQm9keSA9IHNjcm9sbFBhcmVudCA9PT0gKChfZWxlbWVudCRvd25lckRvY3VtZW4gPSBlbGVtZW50Lm93bmVyRG9jdW1lbnQpID09IG51bGwgPyB2b2lkIDAgOiBfZWxlbWVudCRvd25lckRvY3VtZW4uYm9keSk7XG4gIHZhciB3aW4gPSBnZXRXaW5kb3coc2Nyb2xsUGFyZW50KTtcbiAgdmFyIHRhcmdldCA9IGlzQm9keSA/IFt3aW5dLmNvbmNhdCh3aW4udmlzdWFsVmlld3BvcnQgfHwgW10sIGlzU2Nyb2xsUGFyZW50KHNjcm9sbFBhcmVudCkgPyBzY3JvbGxQYXJlbnQgOiBbXSkgOiBzY3JvbGxQYXJlbnQ7XG4gIHZhciB1cGRhdGVkTGlzdCA9IGxpc3QuY29uY2F0KHRhcmdldCk7XG4gIHJldHVybiBpc0JvZHkgPyB1cGRhdGVkTGlzdCA6IC8vICRGbG93Rml4TWVbaW5jb21wYXRpYmxlLWNhbGxdOiBpc0JvZHkgdGVsbHMgdXMgdGFyZ2V0IHdpbGwgYmUgYW4gSFRNTEVsZW1lbnQgaGVyZVxuICB1cGRhdGVkTGlzdC5jb25jYXQobGlzdFNjcm9sbFBhcmVudHMoZ2V0UGFyZW50Tm9kZSh0YXJnZXQpKSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHJlY3RUb0NsaWVudFJlY3QocmVjdCkge1xuICByZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgcmVjdCwge1xuICAgIGxlZnQ6IHJlY3QueCxcbiAgICB0b3A6IHJlY3QueSxcbiAgICByaWdodDogcmVjdC54ICsgcmVjdC53aWR0aCxcbiAgICBib3R0b206IHJlY3QueSArIHJlY3QuaGVpZ2h0XG4gIH0pO1xufSIsICJpbXBvcnQgeyB2aWV3cG9ydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldFZpZXdwb3J0UmVjdCBmcm9tIFwiLi9nZXRWaWV3cG9ydFJlY3QuanNcIjtcbmltcG9ydCBnZXREb2N1bWVudFJlY3QgZnJvbSBcIi4vZ2V0RG9jdW1lbnRSZWN0LmpzXCI7XG5pbXBvcnQgbGlzdFNjcm9sbFBhcmVudHMgZnJvbSBcIi4vbGlzdFNjcm9sbFBhcmVudHMuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4vZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGdldENvbXB1dGVkU3R5bGUgZnJvbSBcIi4vZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IHsgaXNFbGVtZW50LCBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldEJvdW5kaW5nQ2xpZW50UmVjdCBmcm9tIFwiLi9nZXRCb3VuZGluZ0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCBnZXRQYXJlbnROb2RlIGZyb20gXCIuL2dldFBhcmVudE5vZGUuanNcIjtcbmltcG9ydCBjb250YWlucyBmcm9tIFwiLi9jb250YWlucy5qc1wiO1xuaW1wb3J0IGdldE5vZGVOYW1lIGZyb20gXCIuL2dldE5vZGVOYW1lLmpzXCI7XG5pbXBvcnQgcmVjdFRvQ2xpZW50UmVjdCBmcm9tIFwiLi4vdXRpbHMvcmVjdFRvQ2xpZW50UmVjdC5qc1wiO1xuaW1wb3J0IHsgbWF4LCBtaW4gfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBnZXRJbm5lckJvdW5kaW5nQ2xpZW50UmVjdChlbGVtZW50KSB7XG4gIHZhciByZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnQpO1xuICByZWN0LnRvcCA9IHJlY3QudG9wICsgZWxlbWVudC5jbGllbnRUb3A7XG4gIHJlY3QubGVmdCA9IHJlY3QubGVmdCArIGVsZW1lbnQuY2xpZW50TGVmdDtcbiAgcmVjdC5ib3R0b20gPSByZWN0LnRvcCArIGVsZW1lbnQuY2xpZW50SGVpZ2h0O1xuICByZWN0LnJpZ2h0ID0gcmVjdC5sZWZ0ICsgZWxlbWVudC5jbGllbnRXaWR0aDtcbiAgcmVjdC53aWR0aCA9IGVsZW1lbnQuY2xpZW50V2lkdGg7XG4gIHJlY3QuaGVpZ2h0ID0gZWxlbWVudC5jbGllbnRIZWlnaHQ7XG4gIHJlY3QueCA9IHJlY3QubGVmdDtcbiAgcmVjdC55ID0gcmVjdC50b3A7XG4gIHJldHVybiByZWN0O1xufVxuXG5mdW5jdGlvbiBnZXRDbGllbnRSZWN0RnJvbU1peGVkVHlwZShlbGVtZW50LCBjbGlwcGluZ1BhcmVudCkge1xuICByZXR1cm4gY2xpcHBpbmdQYXJlbnQgPT09IHZpZXdwb3J0ID8gcmVjdFRvQ2xpZW50UmVjdChnZXRWaWV3cG9ydFJlY3QoZWxlbWVudCkpIDogaXNFbGVtZW50KGNsaXBwaW5nUGFyZW50KSA/IGdldElubmVyQm91bmRpbmdDbGllbnRSZWN0KGNsaXBwaW5nUGFyZW50KSA6IHJlY3RUb0NsaWVudFJlY3QoZ2V0RG9jdW1lbnRSZWN0KGdldERvY3VtZW50RWxlbWVudChlbGVtZW50KSkpO1xufSAvLyBBIFwiY2xpcHBpbmcgcGFyZW50XCIgaXMgYW4gb3ZlcmZsb3dhYmxlIGNvbnRhaW5lciB3aXRoIHRoZSBjaGFyYWN0ZXJpc3RpYyBvZlxuLy8gY2xpcHBpbmcgKG9yIGhpZGluZykgb3ZlcmZsb3dpbmcgZWxlbWVudHMgd2l0aCBhIHBvc2l0aW9uIGRpZmZlcmVudCBmcm9tXG4vLyBgaW5pdGlhbGBcblxuXG5mdW5jdGlvbiBnZXRDbGlwcGluZ1BhcmVudHMoZWxlbWVudCkge1xuICB2YXIgY2xpcHBpbmdQYXJlbnRzID0gbGlzdFNjcm9sbFBhcmVudHMoZ2V0UGFyZW50Tm9kZShlbGVtZW50KSk7XG4gIHZhciBjYW5Fc2NhcGVDbGlwcGluZyA9IFsnYWJzb2x1dGUnLCAnZml4ZWQnXS5pbmRleE9mKGdldENvbXB1dGVkU3R5bGUoZWxlbWVudCkucG9zaXRpb24pID49IDA7XG4gIHZhciBjbGlwcGVyRWxlbWVudCA9IGNhbkVzY2FwZUNsaXBwaW5nICYmIGlzSFRNTEVsZW1lbnQoZWxlbWVudCkgPyBnZXRPZmZzZXRQYXJlbnQoZWxlbWVudCkgOiBlbGVtZW50O1xuXG4gIGlmICghaXNFbGVtZW50KGNsaXBwZXJFbGVtZW50KSkge1xuICAgIHJldHVybiBbXTtcbiAgfSAvLyAkRmxvd0ZpeE1lW2luY29tcGF0aWJsZS1yZXR1cm5dOiBodHRwczovL2dpdGh1Yi5jb20vZmFjZWJvb2svZmxvdy9pc3N1ZXMvMTQxNFxuXG5cbiAgcmV0dXJuIGNsaXBwaW5nUGFyZW50cy5maWx0ZXIoZnVuY3Rpb24gKGNsaXBwaW5nUGFyZW50KSB7XG4gICAgcmV0dXJuIGlzRWxlbWVudChjbGlwcGluZ1BhcmVudCkgJiYgY29udGFpbnMoY2xpcHBpbmdQYXJlbnQsIGNsaXBwZXJFbGVtZW50KSAmJiBnZXROb2RlTmFtZShjbGlwcGluZ1BhcmVudCkgIT09ICdib2R5JztcbiAgfSk7XG59IC8vIEdldHMgdGhlIG1heGltdW0gYXJlYSB0aGF0IHRoZSBlbGVtZW50IGlzIHZpc2libGUgaW4gZHVlIHRvIGFueSBudW1iZXIgb2Zcbi8vIGNsaXBwaW5nIHBhcmVudHNcblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDbGlwcGluZ1JlY3QoZWxlbWVudCwgYm91bmRhcnksIHJvb3RCb3VuZGFyeSkge1xuICB2YXIgbWFpbkNsaXBwaW5nUGFyZW50cyA9IGJvdW5kYXJ5ID09PSAnY2xpcHBpbmdQYXJlbnRzJyA/IGdldENsaXBwaW5nUGFyZW50cyhlbGVtZW50KSA6IFtdLmNvbmNhdChib3VuZGFyeSk7XG4gIHZhciBjbGlwcGluZ1BhcmVudHMgPSBbXS5jb25jYXQobWFpbkNsaXBwaW5nUGFyZW50cywgW3Jvb3RCb3VuZGFyeV0pO1xuICB2YXIgZmlyc3RDbGlwcGluZ1BhcmVudCA9IGNsaXBwaW5nUGFyZW50c1swXTtcbiAgdmFyIGNsaXBwaW5nUmVjdCA9IGNsaXBwaW5nUGFyZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFjY1JlY3QsIGNsaXBwaW5nUGFyZW50KSB7XG4gICAgdmFyIHJlY3QgPSBnZXRDbGllbnRSZWN0RnJvbU1peGVkVHlwZShlbGVtZW50LCBjbGlwcGluZ1BhcmVudCk7XG4gICAgYWNjUmVjdC50b3AgPSBtYXgocmVjdC50b3AsIGFjY1JlY3QudG9wKTtcbiAgICBhY2NSZWN0LnJpZ2h0ID0gbWluKHJlY3QucmlnaHQsIGFjY1JlY3QucmlnaHQpO1xuICAgIGFjY1JlY3QuYm90dG9tID0gbWluKHJlY3QuYm90dG9tLCBhY2NSZWN0LmJvdHRvbSk7XG4gICAgYWNjUmVjdC5sZWZ0ID0gbWF4KHJlY3QubGVmdCwgYWNjUmVjdC5sZWZ0KTtcbiAgICByZXR1cm4gYWNjUmVjdDtcbiAgfSwgZ2V0Q2xpZW50UmVjdEZyb21NaXhlZFR5cGUoZWxlbWVudCwgZmlyc3RDbGlwcGluZ1BhcmVudCkpO1xuICBjbGlwcGluZ1JlY3Qud2lkdGggPSBjbGlwcGluZ1JlY3QucmlnaHQgLSBjbGlwcGluZ1JlY3QubGVmdDtcbiAgY2xpcHBpbmdSZWN0LmhlaWdodCA9IGNsaXBwaW5nUmVjdC5ib3R0b20gLSBjbGlwcGluZ1JlY3QudG9wO1xuICBjbGlwcGluZ1JlY3QueCA9IGNsaXBwaW5nUmVjdC5sZWZ0O1xuICBjbGlwcGluZ1JlY3QueSA9IGNsaXBwaW5nUmVjdC50b3A7XG4gIHJldHVybiBjbGlwcGluZ1JlY3Q7XG59IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4vZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgZ2V0TWFpbkF4aXNGcm9tUGxhY2VtZW50IGZyb20gXCIuL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0LCBzdGFydCwgZW5kIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBjb21wdXRlT2Zmc2V0cyhfcmVmKSB7XG4gIHZhciByZWZlcmVuY2UgPSBfcmVmLnJlZmVyZW5jZSxcbiAgICAgIGVsZW1lbnQgPSBfcmVmLmVsZW1lbnQsXG4gICAgICBwbGFjZW1lbnQgPSBfcmVmLnBsYWNlbWVudDtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBwbGFjZW1lbnQgPyBnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgOiBudWxsO1xuICB2YXIgdmFyaWF0aW9uID0gcGxhY2VtZW50ID8gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgOiBudWxsO1xuICB2YXIgY29tbW9uWCA9IHJlZmVyZW5jZS54ICsgcmVmZXJlbmNlLndpZHRoIC8gMiAtIGVsZW1lbnQud2lkdGggLyAyO1xuICB2YXIgY29tbW9uWSA9IHJlZmVyZW5jZS55ICsgcmVmZXJlbmNlLmhlaWdodCAvIDIgLSBlbGVtZW50LmhlaWdodCAvIDI7XG4gIHZhciBvZmZzZXRzO1xuXG4gIHN3aXRjaCAoYmFzZVBsYWNlbWVudCkge1xuICAgIGNhc2UgdG9wOlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogY29tbW9uWCxcbiAgICAgICAgeTogcmVmZXJlbmNlLnkgLSBlbGVtZW50LmhlaWdodFxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBib3R0b206XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiBjb21tb25YLFxuICAgICAgICB5OiByZWZlcmVuY2UueSArIHJlZmVyZW5jZS5oZWlnaHRcbiAgICAgIH07XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgcmlnaHQ6XG4gICAgICBvZmZzZXRzID0ge1xuICAgICAgICB4OiByZWZlcmVuY2UueCArIHJlZmVyZW5jZS53aWR0aCxcbiAgICAgICAgeTogY29tbW9uWVxuICAgICAgfTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSBsZWZ0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLnggLSBlbGVtZW50LndpZHRoLFxuICAgICAgICB5OiBjb21tb25ZXG4gICAgICB9O1xuICAgICAgYnJlYWs7XG5cbiAgICBkZWZhdWx0OlxuICAgICAgb2Zmc2V0cyA9IHtcbiAgICAgICAgeDogcmVmZXJlbmNlLngsXG4gICAgICAgIHk6IHJlZmVyZW5jZS55XG4gICAgICB9O1xuICB9XG5cbiAgdmFyIG1haW5BeGlzID0gYmFzZVBsYWNlbWVudCA/IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KSA6IG51bGw7XG5cbiAgaWYgKG1haW5BeGlzICE9IG51bGwpIHtcbiAgICB2YXIgbGVuID0gbWFpbkF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcblxuICAgIHN3aXRjaCAodmFyaWF0aW9uKSB7XG4gICAgICBjYXNlIHN0YXJ0OlxuICAgICAgICBvZmZzZXRzW21haW5BeGlzXSA9IG9mZnNldHNbbWFpbkF4aXNdIC0gKHJlZmVyZW5jZVtsZW5dIC8gMiAtIGVsZW1lbnRbbGVuXSAvIDIpO1xuICAgICAgICBicmVhaztcblxuICAgICAgY2FzZSBlbmQ6XG4gICAgICAgIG9mZnNldHNbbWFpbkF4aXNdID0gb2Zmc2V0c1ttYWluQXhpc10gKyAocmVmZXJlbmNlW2xlbl0gLyAyIC0gZWxlbWVudFtsZW5dIC8gMik7XG4gICAgICAgIGJyZWFrO1xuXG4gICAgICBkZWZhdWx0OlxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBvZmZzZXRzO1xufSIsICJpbXBvcnQgZ2V0Q2xpcHBpbmdSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Q2xpcHBpbmdSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0RG9jdW1lbnRFbGVtZW50LmpzXCI7XG5pbXBvcnQgZ2V0Qm91bmRpbmdDbGllbnRSZWN0IGZyb20gXCIuLi9kb20tdXRpbHMvZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgY29tcHV0ZU9mZnNldHMgZnJvbSBcIi4vY29tcHV0ZU9mZnNldHMuanNcIjtcbmltcG9ydCByZWN0VG9DbGllbnRSZWN0IGZyb20gXCIuL3JlY3RUb0NsaWVudFJlY3QuanNcIjtcbmltcG9ydCB7IGNsaXBwaW5nUGFyZW50cywgcmVmZXJlbmNlLCBwb3BwZXIsIGJvdHRvbSwgdG9wLCByaWdodCwgYmFzZVBsYWNlbWVudHMsIHZpZXdwb3J0IH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgeyBpc0VsZW1lbnQgfSBmcm9tIFwiLi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCBtZXJnZVBhZGRpbmdPYmplY3QgZnJvbSBcIi4vbWVyZ2VQYWRkaW5nT2JqZWN0LmpzXCI7XG5pbXBvcnQgZXhwYW5kVG9IYXNoTWFwIGZyb20gXCIuL2V4cGFuZFRvSGFzaE1hcC5qc1wiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRldGVjdE92ZXJmbG93KHN0YXRlLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX29wdGlvbnMgPSBvcHRpb25zLFxuICAgICAgX29wdGlvbnMkcGxhY2VtZW50ID0gX29wdGlvbnMucGxhY2VtZW50LFxuICAgICAgcGxhY2VtZW50ID0gX29wdGlvbnMkcGxhY2VtZW50ID09PSB2b2lkIDAgPyBzdGF0ZS5wbGFjZW1lbnQgOiBfb3B0aW9ucyRwbGFjZW1lbnQsXG4gICAgICBfb3B0aW9ucyRib3VuZGFyeSA9IF9vcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgYm91bmRhcnkgPSBfb3B0aW9ucyRib3VuZGFyeSA9PT0gdm9pZCAwID8gY2xpcHBpbmdQYXJlbnRzIDogX29wdGlvbnMkYm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRyb290Qm91bmRhcnkgPSBfb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBfb3B0aW9ucyRyb290Qm91bmRhcnkgPT09IHZvaWQgMCA/IHZpZXdwb3J0IDogX29wdGlvbnMkcm9vdEJvdW5kYXJ5LFxuICAgICAgX29wdGlvbnMkZWxlbWVudENvbnRlID0gX29wdGlvbnMuZWxlbWVudENvbnRleHQsXG4gICAgICBlbGVtZW50Q29udGV4dCA9IF9vcHRpb25zJGVsZW1lbnRDb250ZSA9PT0gdm9pZCAwID8gcG9wcGVyIDogX29wdGlvbnMkZWxlbWVudENvbnRlLFxuICAgICAgX29wdGlvbnMkYWx0Qm91bmRhcnkgPSBfb3B0aW9ucy5hbHRCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5ID0gX29wdGlvbnMkYWx0Qm91bmRhcnkgPT09IHZvaWQgMCA/IGZhbHNlIDogX29wdGlvbnMkYWx0Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRwYWRkaW5nID0gX29wdGlvbnMucGFkZGluZyxcbiAgICAgIHBhZGRpbmcgPSBfb3B0aW9ucyRwYWRkaW5nID09PSB2b2lkIDAgPyAwIDogX29wdGlvbnMkcGFkZGluZztcbiAgdmFyIHBhZGRpbmdPYmplY3QgPSBtZXJnZVBhZGRpbmdPYmplY3QodHlwZW9mIHBhZGRpbmcgIT09ICdudW1iZXInID8gcGFkZGluZyA6IGV4cGFuZFRvSGFzaE1hcChwYWRkaW5nLCBiYXNlUGxhY2VtZW50cykpO1xuICB2YXIgYWx0Q29udGV4dCA9IGVsZW1lbnRDb250ZXh0ID09PSBwb3BwZXIgPyByZWZlcmVuY2UgOiBwb3BwZXI7XG4gIHZhciBwb3BwZXJSZWN0ID0gc3RhdGUucmVjdHMucG9wcGVyO1xuICB2YXIgZWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzW2FsdEJvdW5kYXJ5ID8gYWx0Q29udGV4dCA6IGVsZW1lbnRDb250ZXh0XTtcbiAgdmFyIGNsaXBwaW5nQ2xpZW50UmVjdCA9IGdldENsaXBwaW5nUmVjdChpc0VsZW1lbnQoZWxlbWVudCkgPyBlbGVtZW50IDogZWxlbWVudC5jb250ZXh0RWxlbWVudCB8fCBnZXREb2N1bWVudEVsZW1lbnQoc3RhdGUuZWxlbWVudHMucG9wcGVyKSwgYm91bmRhcnksIHJvb3RCb3VuZGFyeSk7XG4gIHZhciByZWZlcmVuY2VDbGllbnRSZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KHN0YXRlLmVsZW1lbnRzLnJlZmVyZW5jZSk7XG4gIHZhciBwb3BwZXJPZmZzZXRzID0gY29tcHV0ZU9mZnNldHMoe1xuICAgIHJlZmVyZW5jZTogcmVmZXJlbmNlQ2xpZW50UmVjdCxcbiAgICBlbGVtZW50OiBwb3BwZXJSZWN0LFxuICAgIHN0cmF0ZWd5OiAnYWJzb2x1dGUnLFxuICAgIHBsYWNlbWVudDogcGxhY2VtZW50XG4gIH0pO1xuICB2YXIgcG9wcGVyQ2xpZW50UmVjdCA9IHJlY3RUb0NsaWVudFJlY3QoT2JqZWN0LmFzc2lnbih7fSwgcG9wcGVyUmVjdCwgcG9wcGVyT2Zmc2V0cykpO1xuICB2YXIgZWxlbWVudENsaWVudFJlY3QgPSBlbGVtZW50Q29udGV4dCA9PT0gcG9wcGVyID8gcG9wcGVyQ2xpZW50UmVjdCA6IHJlZmVyZW5jZUNsaWVudFJlY3Q7IC8vIHBvc2l0aXZlID0gb3ZlcmZsb3dpbmcgdGhlIGNsaXBwaW5nIHJlY3RcbiAgLy8gMCBvciBuZWdhdGl2ZSA9IHdpdGhpbiB0aGUgY2xpcHBpbmcgcmVjdFxuXG4gIHZhciBvdmVyZmxvd09mZnNldHMgPSB7XG4gICAgdG9wOiBjbGlwcGluZ0NsaWVudFJlY3QudG9wIC0gZWxlbWVudENsaWVudFJlY3QudG9wICsgcGFkZGluZ09iamVjdC50b3AsXG4gICAgYm90dG9tOiBlbGVtZW50Q2xpZW50UmVjdC5ib3R0b20gLSBjbGlwcGluZ0NsaWVudFJlY3QuYm90dG9tICsgcGFkZGluZ09iamVjdC5ib3R0b20sXG4gICAgbGVmdDogY2xpcHBpbmdDbGllbnRSZWN0LmxlZnQgLSBlbGVtZW50Q2xpZW50UmVjdC5sZWZ0ICsgcGFkZGluZ09iamVjdC5sZWZ0LFxuICAgIHJpZ2h0OiBlbGVtZW50Q2xpZW50UmVjdC5yaWdodCAtIGNsaXBwaW5nQ2xpZW50UmVjdC5yaWdodCArIHBhZGRpbmdPYmplY3QucmlnaHRcbiAgfTtcbiAgdmFyIG9mZnNldERhdGEgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldDsgLy8gT2Zmc2V0cyBjYW4gYmUgYXBwbGllZCBvbmx5IHRvIHRoZSBwb3BwZXIgZWxlbWVudFxuXG4gIGlmIChlbGVtZW50Q29udGV4dCA9PT0gcG9wcGVyICYmIG9mZnNldERhdGEpIHtcbiAgICB2YXIgb2Zmc2V0ID0gb2Zmc2V0RGF0YVtwbGFjZW1lbnRdO1xuICAgIE9iamVjdC5rZXlzKG92ZXJmbG93T2Zmc2V0cykuZm9yRWFjaChmdW5jdGlvbiAoa2V5KSB7XG4gICAgICB2YXIgbXVsdGlwbHkgPSBbcmlnaHQsIGJvdHRvbV0uaW5kZXhPZihrZXkpID49IDAgPyAxIDogLTE7XG4gICAgICB2YXIgYXhpcyA9IFt0b3AsIGJvdHRvbV0uaW5kZXhPZihrZXkpID49IDAgPyAneScgOiAneCc7XG4gICAgICBvdmVyZmxvd09mZnNldHNba2V5XSArPSBvZmZzZXRbYXhpc10gKiBtdWx0aXBseTtcbiAgICB9KTtcbiAgfVxuXG4gIHJldHVybiBvdmVyZmxvd09mZnNldHM7XG59IiwgImltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4vZ2V0VmFyaWF0aW9uLmpzXCI7XG5pbXBvcnQgeyB2YXJpYXRpb25QbGFjZW1lbnRzLCBiYXNlUGxhY2VtZW50cywgcGxhY2VtZW50cyBhcyBhbGxQbGFjZW1lbnRzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7XG5pbXBvcnQgZGV0ZWN0T3ZlcmZsb3cgZnJvbSBcIi4vZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNvbXB1dGVBdXRvUGxhY2VtZW50KHN0YXRlLCBvcHRpb25zKSB7XG4gIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICBvcHRpb25zID0ge307XG4gIH1cblxuICB2YXIgX29wdGlvbnMgPSBvcHRpb25zLFxuICAgICAgcGxhY2VtZW50ID0gX29wdGlvbnMucGxhY2VtZW50LFxuICAgICAgYm91bmRhcnkgPSBfb3B0aW9ucy5ib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeSA9IF9vcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmcgPSBfb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgZmxpcFZhcmlhdGlvbnMgPSBfb3B0aW9ucy5mbGlwVmFyaWF0aW9ucyxcbiAgICAgIF9vcHRpb25zJGFsbG93ZWRBdXRvUCA9IF9vcHRpb25zLmFsbG93ZWRBdXRvUGxhY2VtZW50cyxcbiAgICAgIGFsbG93ZWRBdXRvUGxhY2VtZW50cyA9IF9vcHRpb25zJGFsbG93ZWRBdXRvUCA9PT0gdm9pZCAwID8gYWxsUGxhY2VtZW50cyA6IF9vcHRpb25zJGFsbG93ZWRBdXRvUDtcbiAgdmFyIHZhcmlhdGlvbiA9IGdldFZhcmlhdGlvbihwbGFjZW1lbnQpO1xuICB2YXIgcGxhY2VtZW50cyA9IHZhcmlhdGlvbiA/IGZsaXBWYXJpYXRpb25zID8gdmFyaWF0aW9uUGxhY2VtZW50cyA6IHZhcmlhdGlvblBsYWNlbWVudHMuZmlsdGVyKGZ1bmN0aW9uIChwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgPT09IHZhcmlhdGlvbjtcbiAgfSkgOiBiYXNlUGxhY2VtZW50cztcbiAgdmFyIGFsbG93ZWRQbGFjZW1lbnRzID0gcGxhY2VtZW50cy5maWx0ZXIoZnVuY3Rpb24gKHBsYWNlbWVudCkge1xuICAgIHJldHVybiBhbGxvd2VkQXV0b1BsYWNlbWVudHMuaW5kZXhPZihwbGFjZW1lbnQpID49IDA7XG4gIH0pO1xuXG4gIGlmIChhbGxvd2VkUGxhY2VtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICBhbGxvd2VkUGxhY2VtZW50cyA9IHBsYWNlbWVudHM7XG5cbiAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICBjb25zb2xlLmVycm9yKFsnUG9wcGVyOiBUaGUgYGFsbG93ZWRBdXRvUGxhY2VtZW50c2Agb3B0aW9uIGRpZCBub3QgYWxsb3cgYW55JywgJ3BsYWNlbWVudHMuIEVuc3VyZSB0aGUgYHBsYWNlbWVudGAgb3B0aW9uIG1hdGNoZXMgdGhlIHZhcmlhdGlvbicsICdvZiB0aGUgYWxsb3dlZCBwbGFjZW1lbnRzLicsICdGb3IgZXhhbXBsZSwgXCJhdXRvXCIgY2Fubm90IGJlIHVzZWQgdG8gYWxsb3cgXCJib3R0b20tc3RhcnRcIi4nLCAnVXNlIFwiYXV0by1zdGFydFwiIGluc3RlYWQuJ10uam9pbignICcpKTtcbiAgICB9XG4gIH0gLy8gJEZsb3dGaXhNZVtpbmNvbXBhdGlibGUtdHlwZV06IEZsb3cgc2VlbXMgdG8gaGF2ZSBwcm9ibGVtcyB3aXRoIHR3byBhcnJheSB1bmlvbnMuLi5cblxuXG4gIHZhciBvdmVyZmxvd3MgPSBhbGxvd2VkUGxhY2VtZW50cy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGxhY2VtZW50KSB7XG4gICAgYWNjW3BsYWNlbWVudF0gPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmdcbiAgICB9KVtnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCldO1xuICAgIHJldHVybiBhY2M7XG4gIH0sIHt9KTtcbiAgcmV0dXJuIE9iamVjdC5rZXlzKG92ZXJmbG93cykuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgIHJldHVybiBvdmVyZmxvd3NbYV0gLSBvdmVyZmxvd3NbYl07XG4gIH0pO1xufSIsICJpbXBvcnQgZ2V0T3Bwb3NpdGVQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE9wcG9zaXRlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi4vdXRpbHMvZ2V0QmFzZVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IGNvbXB1dGVBdXRvUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9jb21wdXRlQXV0b1BsYWNlbWVudC5qc1wiO1xuaW1wb3J0IHsgYm90dG9tLCB0b3AsIHN0YXJ0LCByaWdodCwgbGVmdCwgYXV0byB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldFZhcmlhdGlvbiBmcm9tIFwiLi4vdXRpbHMvZ2V0VmFyaWF0aW9uLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZnVuY3Rpb24gZ2V0RXhwYW5kZWRGYWxsYmFja1BsYWNlbWVudHMocGxhY2VtZW50KSB7XG4gIGlmIChnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgPT09IGF1dG8pIHtcbiAgICByZXR1cm4gW107XG4gIH1cblxuICB2YXIgb3Bwb3NpdGVQbGFjZW1lbnQgPSBnZXRPcHBvc2l0ZVBsYWNlbWVudChwbGFjZW1lbnQpO1xuICByZXR1cm4gW2dldE9wcG9zaXRlVmFyaWF0aW9uUGxhY2VtZW50KHBsYWNlbWVudCksIG9wcG9zaXRlUGxhY2VtZW50LCBnZXRPcHBvc2l0ZVZhcmlhdGlvblBsYWNlbWVudChvcHBvc2l0ZVBsYWNlbWVudCldO1xufVxuXG5mdW5jdGlvbiBmbGlwKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmLm9wdGlvbnMsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuXG4gIGlmIChzdGF0ZS5tb2RpZmllcnNEYXRhW25hbWVdLl9za2lwKSB7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgdmFyIF9vcHRpb25zJG1haW5BeGlzID0gb3B0aW9ucy5tYWluQXhpcyxcbiAgICAgIGNoZWNrTWFpbkF4aXMgPSBfb3B0aW9ucyRtYWluQXhpcyA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJG1haW5BeGlzLFxuICAgICAgX29wdGlvbnMkYWx0QXhpcyA9IG9wdGlvbnMuYWx0QXhpcyxcbiAgICAgIGNoZWNrQWx0QXhpcyA9IF9vcHRpb25zJGFsdEF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRhbHRBeGlzLFxuICAgICAgc3BlY2lmaWVkRmFsbGJhY2tQbGFjZW1lbnRzID0gb3B0aW9ucy5mYWxsYmFja1BsYWNlbWVudHMsXG4gICAgICBwYWRkaW5nID0gb3B0aW9ucy5wYWRkaW5nLFxuICAgICAgYm91bmRhcnkgPSBvcHRpb25zLmJvdW5kYXJ5LFxuICAgICAgcm9vdEJvdW5kYXJ5ID0gb3B0aW9ucy5yb290Qm91bmRhcnksXG4gICAgICBhbHRCb3VuZGFyeSA9IG9wdGlvbnMuYWx0Qm91bmRhcnksXG4gICAgICBfb3B0aW9ucyRmbGlwVmFyaWF0aW8gPSBvcHRpb25zLmZsaXBWYXJpYXRpb25zLFxuICAgICAgZmxpcFZhcmlhdGlvbnMgPSBfb3B0aW9ucyRmbGlwVmFyaWF0aW8gPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRmbGlwVmFyaWF0aW8sXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHMgPSBvcHRpb25zLmFsbG93ZWRBdXRvUGxhY2VtZW50cztcbiAgdmFyIHByZWZlcnJlZFBsYWNlbWVudCA9IHN0YXRlLm9wdGlvbnMucGxhY2VtZW50O1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocHJlZmVycmVkUGxhY2VtZW50KTtcbiAgdmFyIGlzQmFzZVBsYWNlbWVudCA9IGJhc2VQbGFjZW1lbnQgPT09IHByZWZlcnJlZFBsYWNlbWVudDtcbiAgdmFyIGZhbGxiYWNrUGxhY2VtZW50cyA9IHNwZWNpZmllZEZhbGxiYWNrUGxhY2VtZW50cyB8fCAoaXNCYXNlUGxhY2VtZW50IHx8ICFmbGlwVmFyaWF0aW9ucyA/IFtnZXRPcHBvc2l0ZVBsYWNlbWVudChwcmVmZXJyZWRQbGFjZW1lbnQpXSA6IGdldEV4cGFuZGVkRmFsbGJhY2tQbGFjZW1lbnRzKHByZWZlcnJlZFBsYWNlbWVudCkpO1xuICB2YXIgcGxhY2VtZW50cyA9IFtwcmVmZXJyZWRQbGFjZW1lbnRdLmNvbmNhdChmYWxsYmFja1BsYWNlbWVudHMpLnJlZHVjZShmdW5jdGlvbiAoYWNjLCBwbGFjZW1lbnQpIHtcbiAgICByZXR1cm4gYWNjLmNvbmNhdChnZXRCYXNlUGxhY2VtZW50KHBsYWNlbWVudCkgPT09IGF1dG8gPyBjb21wdXRlQXV0b1BsYWNlbWVudChzdGF0ZSwge1xuICAgICAgcGxhY2VtZW50OiBwbGFjZW1lbnQsXG4gICAgICBib3VuZGFyeTogYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmc6IHBhZGRpbmcsXG4gICAgICBmbGlwVmFyaWF0aW9uczogZmxpcFZhcmlhdGlvbnMsXG4gICAgICBhbGxvd2VkQXV0b1BsYWNlbWVudHM6IGFsbG93ZWRBdXRvUGxhY2VtZW50c1xuICAgIH0pIDogcGxhY2VtZW50KTtcbiAgfSwgW10pO1xuICB2YXIgcmVmZXJlbmNlUmVjdCA9IHN0YXRlLnJlY3RzLnJlZmVyZW5jZTtcbiAgdmFyIHBvcHBlclJlY3QgPSBzdGF0ZS5yZWN0cy5wb3BwZXI7XG4gIHZhciBjaGVja3NNYXAgPSBuZXcgTWFwKCk7XG4gIHZhciBtYWtlRmFsbGJhY2tDaGVja3MgPSB0cnVlO1xuICB2YXIgZmlyc3RGaXR0aW5nUGxhY2VtZW50ID0gcGxhY2VtZW50c1swXTtcblxuICBmb3IgKHZhciBpID0gMDsgaSA8IHBsYWNlbWVudHMubGVuZ3RoOyBpKyspIHtcbiAgICB2YXIgcGxhY2VtZW50ID0gcGxhY2VtZW50c1tpXTtcblxuICAgIHZhciBfYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KTtcblxuICAgIHZhciBpc1N0YXJ0VmFyaWF0aW9uID0gZ2V0VmFyaWF0aW9uKHBsYWNlbWVudCkgPT09IHN0YXJ0O1xuICAgIHZhciBpc1ZlcnRpY2FsID0gW3RvcCwgYm90dG9tXS5pbmRleE9mKF9iYXNlUGxhY2VtZW50KSA+PSAwO1xuICAgIHZhciBsZW4gPSBpc1ZlcnRpY2FsID8gJ3dpZHRoJyA6ICdoZWlnaHQnO1xuICAgIHZhciBvdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgICBwbGFjZW1lbnQ6IHBsYWNlbWVudCxcbiAgICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICAgIHJvb3RCb3VuZGFyeTogcm9vdEJvdW5kYXJ5LFxuICAgICAgYWx0Qm91bmRhcnk6IGFsdEJvdW5kYXJ5LFxuICAgICAgcGFkZGluZzogcGFkZGluZ1xuICAgIH0pO1xuICAgIHZhciBtYWluVmFyaWF0aW9uU2lkZSA9IGlzVmVydGljYWwgPyBpc1N0YXJ0VmFyaWF0aW9uID8gcmlnaHQgOiBsZWZ0IDogaXNTdGFydFZhcmlhdGlvbiA/IGJvdHRvbSA6IHRvcDtcblxuICAgIGlmIChyZWZlcmVuY2VSZWN0W2xlbl0gPiBwb3BwZXJSZWN0W2xlbl0pIHtcbiAgICAgIG1haW5WYXJpYXRpb25TaWRlID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpblZhcmlhdGlvblNpZGUpO1xuICAgIH1cblxuICAgIHZhciBhbHRWYXJpYXRpb25TaWRlID0gZ2V0T3Bwb3NpdGVQbGFjZW1lbnQobWFpblZhcmlhdGlvblNpZGUpO1xuICAgIHZhciBjaGVja3MgPSBbXTtcblxuICAgIGlmIChjaGVja01haW5BeGlzKSB7XG4gICAgICBjaGVja3MucHVzaChvdmVyZmxvd1tfYmFzZVBsYWNlbWVudF0gPD0gMCk7XG4gICAgfVxuXG4gICAgaWYgKGNoZWNrQWx0QXhpcykge1xuICAgICAgY2hlY2tzLnB1c2gob3ZlcmZsb3dbbWFpblZhcmlhdGlvblNpZGVdIDw9IDAsIG92ZXJmbG93W2FsdFZhcmlhdGlvblNpZGVdIDw9IDApO1xuICAgIH1cblxuICAgIGlmIChjaGVja3MuZXZlcnkoZnVuY3Rpb24gKGNoZWNrKSB7XG4gICAgICByZXR1cm4gY2hlY2s7XG4gICAgfSkpIHtcbiAgICAgIGZpcnN0Rml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudDtcbiAgICAgIG1ha2VGYWxsYmFja0NoZWNrcyA9IGZhbHNlO1xuICAgICAgYnJlYWs7XG4gICAgfVxuXG4gICAgY2hlY2tzTWFwLnNldChwbGFjZW1lbnQsIGNoZWNrcyk7XG4gIH1cblxuICBpZiAobWFrZUZhbGxiYWNrQ2hlY2tzKSB7XG4gICAgLy8gYDJgIG1heSBiZSBkZXNpcmVkIGluIHNvbWUgY2FzZXMgXHUyMDEzIHJlc2VhcmNoIGxhdGVyXG4gICAgdmFyIG51bWJlck9mQ2hlY2tzID0gZmxpcFZhcmlhdGlvbnMgPyAzIDogMTtcblxuICAgIHZhciBfbG9vcCA9IGZ1bmN0aW9uIF9sb29wKF9pKSB7XG4gICAgICB2YXIgZml0dGluZ1BsYWNlbWVudCA9IHBsYWNlbWVudHMuZmluZChmdW5jdGlvbiAocGxhY2VtZW50KSB7XG4gICAgICAgIHZhciBjaGVja3MgPSBjaGVja3NNYXAuZ2V0KHBsYWNlbWVudCk7XG5cbiAgICAgICAgaWYgKGNoZWNrcykge1xuICAgICAgICAgIHJldHVybiBjaGVja3Muc2xpY2UoMCwgX2kpLmV2ZXJ5KGZ1bmN0aW9uIChjaGVjaykge1xuICAgICAgICAgICAgcmV0dXJuIGNoZWNrO1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcblxuICAgICAgaWYgKGZpdHRpbmdQbGFjZW1lbnQpIHtcbiAgICAgICAgZmlyc3RGaXR0aW5nUGxhY2VtZW50ID0gZml0dGluZ1BsYWNlbWVudDtcbiAgICAgICAgcmV0dXJuIFwiYnJlYWtcIjtcbiAgICAgIH1cbiAgICB9O1xuXG4gICAgZm9yICh2YXIgX2kgPSBudW1iZXJPZkNoZWNrczsgX2kgPiAwOyBfaS0tKSB7XG4gICAgICB2YXIgX3JldCA9IF9sb29wKF9pKTtcblxuICAgICAgaWYgKF9yZXQgPT09IFwiYnJlYWtcIikgYnJlYWs7XG4gICAgfVxuICB9XG5cbiAgaWYgKHN0YXRlLnBsYWNlbWVudCAhPT0gZmlyc3RGaXR0aW5nUGxhY2VtZW50KSB7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXS5fc2tpcCA9IHRydWU7XG4gICAgc3RhdGUucGxhY2VtZW50ID0gZmlyc3RGaXR0aW5nUGxhY2VtZW50O1xuICAgIHN0YXRlLnJlc2V0ID0gdHJ1ZTtcbiAgfVxufSAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cblxuZXhwb3J0IGRlZmF1bHQge1xuICBuYW1lOiAnZmxpcCcsXG4gIGVuYWJsZWQ6IHRydWUsXG4gIHBoYXNlOiAnbWFpbicsXG4gIGZuOiBmbGlwLFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ29mZnNldCddLFxuICBkYXRhOiB7XG4gICAgX3NraXA6IGZhbHNlXG4gIH1cbn07IiwgImltcG9ydCB7IHRvcCwgYm90dG9tLCBsZWZ0LCByaWdodCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGRldGVjdE92ZXJmbG93IGZyb20gXCIuLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuXG5mdW5jdGlvbiBnZXRTaWRlT2Zmc2V0cyhvdmVyZmxvdywgcmVjdCwgcHJldmVudGVkT2Zmc2V0cykge1xuICBpZiAocHJldmVudGVkT2Zmc2V0cyA9PT0gdm9pZCAwKSB7XG4gICAgcHJldmVudGVkT2Zmc2V0cyA9IHtcbiAgICAgIHg6IDAsXG4gICAgICB5OiAwXG4gICAgfTtcbiAgfVxuXG4gIHJldHVybiB7XG4gICAgdG9wOiBvdmVyZmxvdy50b3AgLSByZWN0LmhlaWdodCAtIHByZXZlbnRlZE9mZnNldHMueSxcbiAgICByaWdodDogb3ZlcmZsb3cucmlnaHQgLSByZWN0LndpZHRoICsgcHJldmVudGVkT2Zmc2V0cy54LFxuICAgIGJvdHRvbTogb3ZlcmZsb3cuYm90dG9tIC0gcmVjdC5oZWlnaHQgKyBwcmV2ZW50ZWRPZmZzZXRzLnksXG4gICAgbGVmdDogb3ZlcmZsb3cubGVmdCAtIHJlY3Qud2lkdGggLSBwcmV2ZW50ZWRPZmZzZXRzLnhcbiAgfTtcbn1cblxuZnVuY3Rpb24gaXNBbnlTaWRlRnVsbHlDbGlwcGVkKG92ZXJmbG93KSB7XG4gIHJldHVybiBbdG9wLCByaWdodCwgYm90dG9tLCBsZWZ0XS5zb21lKGZ1bmN0aW9uIChzaWRlKSB7XG4gICAgcmV0dXJuIG92ZXJmbG93W3NpZGVdID49IDA7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiBoaWRlKF9yZWYpIHtcbiAgdmFyIHN0YXRlID0gX3JlZi5zdGF0ZSxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG4gIHZhciByZWZlcmVuY2VSZWN0ID0gc3RhdGUucmVjdHMucmVmZXJlbmNlO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIHByZXZlbnRlZE9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnByZXZlbnRPdmVyZmxvdztcbiAgdmFyIHJlZmVyZW5jZU92ZXJmbG93ID0gZGV0ZWN0T3ZlcmZsb3coc3RhdGUsIHtcbiAgICBlbGVtZW50Q29udGV4dDogJ3JlZmVyZW5jZSdcbiAgfSk7XG4gIHZhciBwb3BwZXJBbHRPdmVyZmxvdyA9IGRldGVjdE92ZXJmbG93KHN0YXRlLCB7XG4gICAgYWx0Qm91bmRhcnk6IHRydWVcbiAgfSk7XG4gIHZhciByZWZlcmVuY2VDbGlwcGluZ09mZnNldHMgPSBnZXRTaWRlT2Zmc2V0cyhyZWZlcmVuY2VPdmVyZmxvdywgcmVmZXJlbmNlUmVjdCk7XG4gIHZhciBwb3BwZXJFc2NhcGVPZmZzZXRzID0gZ2V0U2lkZU9mZnNldHMocG9wcGVyQWx0T3ZlcmZsb3csIHBvcHBlclJlY3QsIHByZXZlbnRlZE9mZnNldHMpO1xuICB2YXIgaXNSZWZlcmVuY2VIaWRkZW4gPSBpc0FueVNpZGVGdWxseUNsaXBwZWQocmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzKTtcbiAgdmFyIGhhc1BvcHBlckVzY2FwZWQgPSBpc0FueVNpZGVGdWxseUNsaXBwZWQocG9wcGVyRXNjYXBlT2Zmc2V0cyk7XG4gIHN0YXRlLm1vZGlmaWVyc0RhdGFbbmFtZV0gPSB7XG4gICAgcmVmZXJlbmNlQ2xpcHBpbmdPZmZzZXRzOiByZWZlcmVuY2VDbGlwcGluZ09mZnNldHMsXG4gICAgcG9wcGVyRXNjYXBlT2Zmc2V0czogcG9wcGVyRXNjYXBlT2Zmc2V0cyxcbiAgICBpc1JlZmVyZW5jZUhpZGRlbjogaXNSZWZlcmVuY2VIaWRkZW4sXG4gICAgaGFzUG9wcGVyRXNjYXBlZDogaGFzUG9wcGVyRXNjYXBlZFxuICB9O1xuICBzdGF0ZS5hdHRyaWJ1dGVzLnBvcHBlciA9IE9iamVjdC5hc3NpZ24oe30sIHN0YXRlLmF0dHJpYnV0ZXMucG9wcGVyLCB7XG4gICAgJ2RhdGEtcG9wcGVyLXJlZmVyZW5jZS1oaWRkZW4nOiBpc1JlZmVyZW5jZUhpZGRlbixcbiAgICAnZGF0YS1wb3BwZXItZXNjYXBlZCc6IGhhc1BvcHBlckVzY2FwZWRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdoaWRlJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdtYWluJyxcbiAgcmVxdWlyZXNJZkV4aXN0czogWydwcmV2ZW50T3ZlcmZsb3cnXSxcbiAgZm46IGhpZGVcbn07IiwgImltcG9ydCBnZXRCYXNlUGxhY2VtZW50IGZyb20gXCIuLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgeyB0b3AsIGxlZnQsIHJpZ2h0LCBwbGFjZW1lbnRzIH0gZnJvbSBcIi4uL2VudW1zLmpzXCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IGZ1bmN0aW9uIGRpc3RhbmNlQW5kU2tpZGRpbmdUb1hZKHBsYWNlbWVudCwgcmVjdHMsIG9mZnNldCkge1xuICB2YXIgYmFzZVBsYWNlbWVudCA9IGdldEJhc2VQbGFjZW1lbnQocGxhY2VtZW50KTtcbiAgdmFyIGludmVydERpc3RhbmNlID0gW2xlZnQsIHRvcF0uaW5kZXhPZihiYXNlUGxhY2VtZW50KSA+PSAwID8gLTEgOiAxO1xuXG4gIHZhciBfcmVmID0gdHlwZW9mIG9mZnNldCA9PT0gJ2Z1bmN0aW9uJyA/IG9mZnNldChPYmplY3QuYXNzaWduKHt9LCByZWN0cywge1xuICAgIHBsYWNlbWVudDogcGxhY2VtZW50XG4gIH0pKSA6IG9mZnNldCxcbiAgICAgIHNraWRkaW5nID0gX3JlZlswXSxcbiAgICAgIGRpc3RhbmNlID0gX3JlZlsxXTtcblxuICBza2lkZGluZyA9IHNraWRkaW5nIHx8IDA7XG4gIGRpc3RhbmNlID0gKGRpc3RhbmNlIHx8IDApICogaW52ZXJ0RGlzdGFuY2U7XG4gIHJldHVybiBbbGVmdCwgcmlnaHRdLmluZGV4T2YoYmFzZVBsYWNlbWVudCkgPj0gMCA/IHtcbiAgICB4OiBkaXN0YW5jZSxcbiAgICB5OiBza2lkZGluZ1xuICB9IDoge1xuICAgIHg6IHNraWRkaW5nLFxuICAgIHk6IGRpc3RhbmNlXG4gIH07XG59XG5cbmZ1bmN0aW9uIG9mZnNldChfcmVmMikge1xuICB2YXIgc3RhdGUgPSBfcmVmMi5zdGF0ZSxcbiAgICAgIG9wdGlvbnMgPSBfcmVmMi5vcHRpb25zLFxuICAgICAgbmFtZSA9IF9yZWYyLm5hbWU7XG4gIHZhciBfb3B0aW9ucyRvZmZzZXQgPSBvcHRpb25zLm9mZnNldCxcbiAgICAgIG9mZnNldCA9IF9vcHRpb25zJG9mZnNldCA9PT0gdm9pZCAwID8gWzAsIDBdIDogX29wdGlvbnMkb2Zmc2V0O1xuICB2YXIgZGF0YSA9IHBsYWNlbWVudHMucmVkdWNlKGZ1bmN0aW9uIChhY2MsIHBsYWNlbWVudCkge1xuICAgIGFjY1twbGFjZW1lbnRdID0gZGlzdGFuY2VBbmRTa2lkZGluZ1RvWFkocGxhY2VtZW50LCBzdGF0ZS5yZWN0cywgb2Zmc2V0KTtcbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG4gIHZhciBfZGF0YSRzdGF0ZSRwbGFjZW1lbnQgPSBkYXRhW3N0YXRlLnBsYWNlbWVudF0sXG4gICAgICB4ID0gX2RhdGEkc3RhdGUkcGxhY2VtZW50LngsXG4gICAgICB5ID0gX2RhdGEkc3RhdGUkcGxhY2VtZW50Lnk7XG5cbiAgaWYgKHN0YXRlLm1vZGlmaWVyc0RhdGEucG9wcGVyT2Zmc2V0cyAhPSBudWxsKSB7XG4gICAgc3RhdGUubW9kaWZpZXJzRGF0YS5wb3BwZXJPZmZzZXRzLnggKz0geDtcbiAgICBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHMueSArPSB5O1xuICB9XG5cbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGRhdGE7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdvZmZzZXQnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICByZXF1aXJlczogWydwb3BwZXJPZmZzZXRzJ10sXG4gIGZuOiBvZmZzZXRcbn07IiwgImltcG9ydCBjb21wdXRlT2Zmc2V0cyBmcm9tIFwiLi4vdXRpbHMvY29tcHV0ZU9mZnNldHMuanNcIjtcblxuZnVuY3Rpb24gcG9wcGVyT2Zmc2V0cyhfcmVmKSB7XG4gIHZhciBzdGF0ZSA9IF9yZWYuc3RhdGUsXG4gICAgICBuYW1lID0gX3JlZi5uYW1lO1xuICAvLyBPZmZzZXRzIGFyZSB0aGUgYWN0dWFsIHBvc2l0aW9uIHRoZSBwb3BwZXIgbmVlZHMgdG8gaGF2ZSB0byBiZVxuICAvLyBwcm9wZXJseSBwb3NpdGlvbmVkIG5lYXIgaXRzIHJlZmVyZW5jZSBlbGVtZW50XG4gIC8vIFRoaXMgaXMgdGhlIG1vc3QgYmFzaWMgcGxhY2VtZW50LCBhbmQgd2lsbCBiZSBhZGp1c3RlZCBieVxuICAvLyB0aGUgbW9kaWZpZXJzIGluIHRoZSBuZXh0IHN0ZXBcbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGNvbXB1dGVPZmZzZXRzKHtcbiAgICByZWZlcmVuY2U6IHN0YXRlLnJlY3RzLnJlZmVyZW5jZSxcbiAgICBlbGVtZW50OiBzdGF0ZS5yZWN0cy5wb3BwZXIsXG4gICAgc3RyYXRlZ3k6ICdhYnNvbHV0ZScsXG4gICAgcGxhY2VtZW50OiBzdGF0ZS5wbGFjZW1lbnRcbiAgfSk7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdwb3BwZXJPZmZzZXRzJyxcbiAgZW5hYmxlZDogdHJ1ZSxcbiAgcGhhc2U6ICdyZWFkJyxcbiAgZm46IHBvcHBlck9mZnNldHMsXG4gIGRhdGE6IHt9XG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRBbHRBeGlzKGF4aXMpIHtcbiAgcmV0dXJuIGF4aXMgPT09ICd4JyA/ICd5JyA6ICd4Jztcbn0iLCAiaW1wb3J0IHsgdG9wLCBsZWZ0LCByaWdodCwgYm90dG9tLCBzdGFydCB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xuaW1wb3J0IGdldEJhc2VQbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldEJhc2VQbGFjZW1lbnQuanNcIjtcbmltcG9ydCBnZXRNYWluQXhpc0Zyb21QbGFjZW1lbnQgZnJvbSBcIi4uL3V0aWxzL2dldE1haW5BeGlzRnJvbVBsYWNlbWVudC5qc1wiO1xuaW1wb3J0IGdldEFsdEF4aXMgZnJvbSBcIi4uL3V0aWxzL2dldEFsdEF4aXMuanNcIjtcbmltcG9ydCB7IHdpdGhpbiwgd2l0aGluTWF4Q2xhbXAgfSBmcm9tIFwiLi4vdXRpbHMvd2l0aGluLmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi4vZG9tLXV0aWxzL2dldExheW91dFJlY3QuanNcIjtcbmltcG9ydCBnZXRPZmZzZXRQYXJlbnQgZnJvbSBcIi4uL2RvbS11dGlscy9nZXRPZmZzZXRQYXJlbnQuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi4vdXRpbHMvZGV0ZWN0T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBnZXRWYXJpYXRpb24gZnJvbSBcIi4uL3V0aWxzL2dldFZhcmlhdGlvbi5qc1wiO1xuaW1wb3J0IGdldEZyZXNoU2lkZU9iamVjdCBmcm9tIFwiLi4vdXRpbHMvZ2V0RnJlc2hTaWRlT2JqZWN0LmpzXCI7XG5pbXBvcnQgeyBtaW4gYXMgbWF0aE1pbiwgbWF4IGFzIG1hdGhNYXggfSBmcm9tIFwiLi4vdXRpbHMvbWF0aC5qc1wiO1xuXG5mdW5jdGlvbiBwcmV2ZW50T3ZlcmZsb3coX3JlZikge1xuICB2YXIgc3RhdGUgPSBfcmVmLnN0YXRlLFxuICAgICAgb3B0aW9ucyA9IF9yZWYub3B0aW9ucyxcbiAgICAgIG5hbWUgPSBfcmVmLm5hbWU7XG4gIHZhciBfb3B0aW9ucyRtYWluQXhpcyA9IG9wdGlvbnMubWFpbkF4aXMsXG4gICAgICBjaGVja01haW5BeGlzID0gX29wdGlvbnMkbWFpbkF4aXMgPT09IHZvaWQgMCA/IHRydWUgOiBfb3B0aW9ucyRtYWluQXhpcyxcbiAgICAgIF9vcHRpb25zJGFsdEF4aXMgPSBvcHRpb25zLmFsdEF4aXMsXG4gICAgICBjaGVja0FsdEF4aXMgPSBfb3B0aW9ucyRhbHRBeGlzID09PSB2b2lkIDAgPyBmYWxzZSA6IF9vcHRpb25zJGFsdEF4aXMsXG4gICAgICBib3VuZGFyeSA9IG9wdGlvbnMuYm91bmRhcnksXG4gICAgICByb290Qm91bmRhcnkgPSBvcHRpb25zLnJvb3RCb3VuZGFyeSxcbiAgICAgIGFsdEJvdW5kYXJ5ID0gb3B0aW9ucy5hbHRCb3VuZGFyeSxcbiAgICAgIHBhZGRpbmcgPSBvcHRpb25zLnBhZGRpbmcsXG4gICAgICBfb3B0aW9ucyR0ZXRoZXIgPSBvcHRpb25zLnRldGhlcixcbiAgICAgIHRldGhlciA9IF9vcHRpb25zJHRldGhlciA9PT0gdm9pZCAwID8gdHJ1ZSA6IF9vcHRpb25zJHRldGhlcixcbiAgICAgIF9vcHRpb25zJHRldGhlck9mZnNldCA9IG9wdGlvbnMudGV0aGVyT2Zmc2V0LFxuICAgICAgdGV0aGVyT2Zmc2V0ID0gX29wdGlvbnMkdGV0aGVyT2Zmc2V0ID09PSB2b2lkIDAgPyAwIDogX29wdGlvbnMkdGV0aGVyT2Zmc2V0O1xuICB2YXIgb3ZlcmZsb3cgPSBkZXRlY3RPdmVyZmxvdyhzdGF0ZSwge1xuICAgIGJvdW5kYXJ5OiBib3VuZGFyeSxcbiAgICByb290Qm91bmRhcnk6IHJvb3RCb3VuZGFyeSxcbiAgICBwYWRkaW5nOiBwYWRkaW5nLFxuICAgIGFsdEJvdW5kYXJ5OiBhbHRCb3VuZGFyeVxuICB9KTtcbiAgdmFyIGJhc2VQbGFjZW1lbnQgPSBnZXRCYXNlUGxhY2VtZW50KHN0YXRlLnBsYWNlbWVudCk7XG4gIHZhciB2YXJpYXRpb24gPSBnZXRWYXJpYXRpb24oc3RhdGUucGxhY2VtZW50KTtcbiAgdmFyIGlzQmFzZVBsYWNlbWVudCA9ICF2YXJpYXRpb247XG4gIHZhciBtYWluQXhpcyA9IGdldE1haW5BeGlzRnJvbVBsYWNlbWVudChiYXNlUGxhY2VtZW50KTtcbiAgdmFyIGFsdEF4aXMgPSBnZXRBbHRBeGlzKG1haW5BeGlzKTtcbiAgdmFyIHBvcHBlck9mZnNldHMgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLnBvcHBlck9mZnNldHM7XG4gIHZhciByZWZlcmVuY2VSZWN0ID0gc3RhdGUucmVjdHMucmVmZXJlbmNlO1xuICB2YXIgcG9wcGVyUmVjdCA9IHN0YXRlLnJlY3RzLnBvcHBlcjtcbiAgdmFyIHRldGhlck9mZnNldFZhbHVlID0gdHlwZW9mIHRldGhlck9mZnNldCA9PT0gJ2Z1bmN0aW9uJyA/IHRldGhlck9mZnNldChPYmplY3QuYXNzaWduKHt9LCBzdGF0ZS5yZWN0cywge1xuICAgIHBsYWNlbWVudDogc3RhdGUucGxhY2VtZW50XG4gIH0pKSA6IHRldGhlck9mZnNldDtcbiAgdmFyIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZSA9IHR5cGVvZiB0ZXRoZXJPZmZzZXRWYWx1ZSA9PT0gJ251bWJlcicgPyB7XG4gICAgbWFpbkF4aXM6IHRldGhlck9mZnNldFZhbHVlLFxuICAgIGFsdEF4aXM6IHRldGhlck9mZnNldFZhbHVlXG4gIH0gOiBPYmplY3QuYXNzaWduKHtcbiAgICBtYWluQXhpczogMCxcbiAgICBhbHRBeGlzOiAwXG4gIH0sIHRldGhlck9mZnNldFZhbHVlKTtcbiAgdmFyIG9mZnNldE1vZGlmaWVyU3RhdGUgPSBzdGF0ZS5tb2RpZmllcnNEYXRhLm9mZnNldCA/IHN0YXRlLm1vZGlmaWVyc0RhdGEub2Zmc2V0W3N0YXRlLnBsYWNlbWVudF0gOiBudWxsO1xuICB2YXIgZGF0YSA9IHtcbiAgICB4OiAwLFxuICAgIHk6IDBcbiAgfTtcblxuICBpZiAoIXBvcHBlck9mZnNldHMpIHtcbiAgICByZXR1cm47XG4gIH1cblxuICBpZiAoY2hlY2tNYWluQXhpcykge1xuICAgIHZhciBfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQ7XG5cbiAgICB2YXIgbWFpblNpZGUgPSBtYWluQXhpcyA9PT0gJ3knID8gdG9wIDogbGVmdDtcbiAgICB2YXIgYWx0U2lkZSA9IG1haW5BeGlzID09PSAneScgPyBib3R0b20gOiByaWdodDtcbiAgICB2YXIgbGVuID0gbWFpbkF4aXMgPT09ICd5JyA/ICdoZWlnaHQnIDogJ3dpZHRoJztcbiAgICB2YXIgb2Zmc2V0ID0gcG9wcGVyT2Zmc2V0c1ttYWluQXhpc107XG4gICAgdmFyIG1pbiA9IG9mZnNldCArIG92ZXJmbG93W21haW5TaWRlXTtcbiAgICB2YXIgbWF4ID0gb2Zmc2V0IC0gb3ZlcmZsb3dbYWx0U2lkZV07XG4gICAgdmFyIGFkZGl0aXZlID0gdGV0aGVyID8gLXBvcHBlclJlY3RbbGVuXSAvIDIgOiAwO1xuICAgIHZhciBtaW5MZW4gPSB2YXJpYXRpb24gPT09IHN0YXJ0ID8gcmVmZXJlbmNlUmVjdFtsZW5dIDogcG9wcGVyUmVjdFtsZW5dO1xuICAgIHZhciBtYXhMZW4gPSB2YXJpYXRpb24gPT09IHN0YXJ0ID8gLXBvcHBlclJlY3RbbGVuXSA6IC1yZWZlcmVuY2VSZWN0W2xlbl07IC8vIFdlIG5lZWQgdG8gaW5jbHVkZSB0aGUgYXJyb3cgaW4gdGhlIGNhbGN1bGF0aW9uIHNvIHRoZSBhcnJvdyBkb2Vzbid0IGdvXG4gICAgLy8gb3V0c2lkZSB0aGUgcmVmZXJlbmNlIGJvdW5kc1xuXG4gICAgdmFyIGFycm93RWxlbWVudCA9IHN0YXRlLmVsZW1lbnRzLmFycm93O1xuICAgIHZhciBhcnJvd1JlY3QgPSB0ZXRoZXIgJiYgYXJyb3dFbGVtZW50ID8gZ2V0TGF5b3V0UmVjdChhcnJvd0VsZW1lbnQpIDoge1xuICAgICAgd2lkdGg6IDAsXG4gICAgICBoZWlnaHQ6IDBcbiAgICB9O1xuICAgIHZhciBhcnJvd1BhZGRpbmdPYmplY3QgPSBzdGF0ZS5tb2RpZmllcnNEYXRhWydhcnJvdyNwZXJzaXN0ZW50J10gPyBzdGF0ZS5tb2RpZmllcnNEYXRhWydhcnJvdyNwZXJzaXN0ZW50J10ucGFkZGluZyA6IGdldEZyZXNoU2lkZU9iamVjdCgpO1xuICAgIHZhciBhcnJvd1BhZGRpbmdNaW4gPSBhcnJvd1BhZGRpbmdPYmplY3RbbWFpblNpZGVdO1xuICAgIHZhciBhcnJvd1BhZGRpbmdNYXggPSBhcnJvd1BhZGRpbmdPYmplY3RbYWx0U2lkZV07IC8vIElmIHRoZSByZWZlcmVuY2UgbGVuZ3RoIGlzIHNtYWxsZXIgdGhhbiB0aGUgYXJyb3cgbGVuZ3RoLCB3ZSBkb24ndCB3YW50XG4gICAgLy8gdG8gaW5jbHVkZSBpdHMgZnVsbCBzaXplIGluIHRoZSBjYWxjdWxhdGlvbi4gSWYgdGhlIHJlZmVyZW5jZSBpcyBzbWFsbFxuICAgIC8vIGFuZCBuZWFyIHRoZSBlZGdlIG9mIGEgYm91bmRhcnksIHRoZSBwb3BwZXIgY2FuIG92ZXJmbG93IGV2ZW4gaWYgdGhlXG4gICAgLy8gcmVmZXJlbmNlIGlzIG5vdCBvdmVyZmxvd2luZyBhcyB3ZWxsIChlLmcuIHZpcnR1YWwgZWxlbWVudHMgd2l0aCBub1xuICAgIC8vIHdpZHRoIG9yIGhlaWdodClcblxuICAgIHZhciBhcnJvd0xlbiA9IHdpdGhpbigwLCByZWZlcmVuY2VSZWN0W2xlbl0sIGFycm93UmVjdFtsZW5dKTtcbiAgICB2YXIgbWluT2Zmc2V0ID0gaXNCYXNlUGxhY2VtZW50ID8gcmVmZXJlbmNlUmVjdFtsZW5dIC8gMiAtIGFkZGl0aXZlIC0gYXJyb3dMZW4gLSBhcnJvd1BhZGRpbmdNaW4gLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXMgOiBtaW5MZW4gLSBhcnJvd0xlbiAtIGFycm93UGFkZGluZ01pbiAtIG5vcm1hbGl6ZWRUZXRoZXJPZmZzZXRWYWx1ZS5tYWluQXhpcztcbiAgICB2YXIgbWF4T2Zmc2V0ID0gaXNCYXNlUGxhY2VtZW50ID8gLXJlZmVyZW5jZVJlY3RbbGVuXSAvIDIgKyBhZGRpdGl2ZSArIGFycm93TGVuICsgYXJyb3dQYWRkaW5nTWF4ICsgbm9ybWFsaXplZFRldGhlck9mZnNldFZhbHVlLm1haW5BeGlzIDogbWF4TGVuICsgYXJyb3dMZW4gKyBhcnJvd1BhZGRpbmdNYXggKyBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUubWFpbkF4aXM7XG4gICAgdmFyIGFycm93T2Zmc2V0UGFyZW50ID0gc3RhdGUuZWxlbWVudHMuYXJyb3cgJiYgZ2V0T2Zmc2V0UGFyZW50KHN0YXRlLmVsZW1lbnRzLmFycm93KTtcbiAgICB2YXIgY2xpZW50T2Zmc2V0ID0gYXJyb3dPZmZzZXRQYXJlbnQgPyBtYWluQXhpcyA9PT0gJ3knID8gYXJyb3dPZmZzZXRQYXJlbnQuY2xpZW50VG9wIHx8IDAgOiBhcnJvd09mZnNldFBhcmVudC5jbGllbnRMZWZ0IHx8IDAgOiAwO1xuICAgIHZhciBvZmZzZXRNb2RpZmllclZhbHVlID0gKF9vZmZzZXRNb2RpZmllclN0YXRlJCA9IG9mZnNldE1vZGlmaWVyU3RhdGUgPT0gbnVsbCA/IHZvaWQgMCA6IG9mZnNldE1vZGlmaWVyU3RhdGVbbWFpbkF4aXNdKSAhPSBudWxsID8gX29mZnNldE1vZGlmaWVyU3RhdGUkIDogMDtcbiAgICB2YXIgdGV0aGVyTWluID0gb2Zmc2V0ICsgbWluT2Zmc2V0IC0gb2Zmc2V0TW9kaWZpZXJWYWx1ZSAtIGNsaWVudE9mZnNldDtcbiAgICB2YXIgdGV0aGVyTWF4ID0gb2Zmc2V0ICsgbWF4T2Zmc2V0IC0gb2Zmc2V0TW9kaWZpZXJWYWx1ZTtcbiAgICB2YXIgcHJldmVudGVkT2Zmc2V0ID0gd2l0aGluKHRldGhlciA/IG1hdGhNaW4obWluLCB0ZXRoZXJNaW4pIDogbWluLCBvZmZzZXQsIHRldGhlciA/IG1hdGhNYXgobWF4LCB0ZXRoZXJNYXgpIDogbWF4KTtcbiAgICBwb3BwZXJPZmZzZXRzW21haW5BeGlzXSA9IHByZXZlbnRlZE9mZnNldDtcbiAgICBkYXRhW21haW5BeGlzXSA9IHByZXZlbnRlZE9mZnNldCAtIG9mZnNldDtcbiAgfVxuXG4gIGlmIChjaGVja0FsdEF4aXMpIHtcbiAgICB2YXIgX29mZnNldE1vZGlmaWVyU3RhdGUkMjtcblxuICAgIHZhciBfbWFpblNpZGUgPSBtYWluQXhpcyA9PT0gJ3gnID8gdG9wIDogbGVmdDtcblxuICAgIHZhciBfYWx0U2lkZSA9IG1haW5BeGlzID09PSAneCcgPyBib3R0b20gOiByaWdodDtcblxuICAgIHZhciBfb2Zmc2V0ID0gcG9wcGVyT2Zmc2V0c1thbHRBeGlzXTtcblxuICAgIHZhciBfbGVuID0gYWx0QXhpcyA9PT0gJ3knID8gJ2hlaWdodCcgOiAnd2lkdGgnO1xuXG4gICAgdmFyIF9taW4gPSBfb2Zmc2V0ICsgb3ZlcmZsb3dbX21haW5TaWRlXTtcblxuICAgIHZhciBfbWF4ID0gX29mZnNldCAtIG92ZXJmbG93W19hbHRTaWRlXTtcblxuICAgIHZhciBpc09yaWdpblNpZGUgPSBbdG9wLCBsZWZ0XS5pbmRleE9mKGJhc2VQbGFjZW1lbnQpICE9PSAtMTtcblxuICAgIHZhciBfb2Zmc2V0TW9kaWZpZXJWYWx1ZSA9IChfb2Zmc2V0TW9kaWZpZXJTdGF0ZSQyID0gb2Zmc2V0TW9kaWZpZXJTdGF0ZSA9PSBudWxsID8gdm9pZCAwIDogb2Zmc2V0TW9kaWZpZXJTdGF0ZVthbHRBeGlzXSkgIT0gbnVsbCA/IF9vZmZzZXRNb2RpZmllclN0YXRlJDIgOiAwO1xuXG4gICAgdmFyIF90ZXRoZXJNaW4gPSBpc09yaWdpblNpZGUgPyBfbWluIDogX29mZnNldCAtIHJlZmVyZW5jZVJlY3RbX2xlbl0gLSBwb3BwZXJSZWN0W19sZW5dIC0gX29mZnNldE1vZGlmaWVyVmFsdWUgKyBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUuYWx0QXhpcztcblxuICAgIHZhciBfdGV0aGVyTWF4ID0gaXNPcmlnaW5TaWRlID8gX29mZnNldCArIHJlZmVyZW5jZVJlY3RbX2xlbl0gKyBwb3BwZXJSZWN0W19sZW5dIC0gX29mZnNldE1vZGlmaWVyVmFsdWUgLSBub3JtYWxpemVkVGV0aGVyT2Zmc2V0VmFsdWUuYWx0QXhpcyA6IF9tYXg7XG5cbiAgICB2YXIgX3ByZXZlbnRlZE9mZnNldCA9IHRldGhlciAmJiBpc09yaWdpblNpZGUgPyB3aXRoaW5NYXhDbGFtcChfdGV0aGVyTWluLCBfb2Zmc2V0LCBfdGV0aGVyTWF4KSA6IHdpdGhpbih0ZXRoZXIgPyBfdGV0aGVyTWluIDogX21pbiwgX29mZnNldCwgdGV0aGVyID8gX3RldGhlck1heCA6IF9tYXgpO1xuXG4gICAgcG9wcGVyT2Zmc2V0c1thbHRBeGlzXSA9IF9wcmV2ZW50ZWRPZmZzZXQ7XG4gICAgZGF0YVthbHRBeGlzXSA9IF9wcmV2ZW50ZWRPZmZzZXQgLSBfb2Zmc2V0O1xuICB9XG5cbiAgc3RhdGUubW9kaWZpZXJzRGF0YVtuYW1lXSA9IGRhdGE7XG59IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuXG5leHBvcnQgZGVmYXVsdCB7XG4gIG5hbWU6ICdwcmV2ZW50T3ZlcmZsb3cnLFxuICBlbmFibGVkOiB0cnVlLFxuICBwaGFzZTogJ21haW4nLFxuICBmbjogcHJldmVudE92ZXJmbG93LFxuICByZXF1aXJlc0lmRXhpc3RzOiBbJ29mZnNldCddXG59OyIsICJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRIVE1MRWxlbWVudFNjcm9sbChlbGVtZW50KSB7XG4gIHJldHVybiB7XG4gICAgc2Nyb2xsTGVmdDogZWxlbWVudC5zY3JvbGxMZWZ0LFxuICAgIHNjcm9sbFRvcDogZWxlbWVudC5zY3JvbGxUb3BcbiAgfTtcbn0iLCAiaW1wb3J0IGdldFdpbmRvd1Njcm9sbCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGwuanNcIjtcbmltcG9ydCBnZXRXaW5kb3cgZnJvbSBcIi4vZ2V0V2luZG93LmpzXCI7XG5pbXBvcnQgeyBpc0hUTUxFbGVtZW50IH0gZnJvbSBcIi4vaW5zdGFuY2VPZi5qc1wiO1xuaW1wb3J0IGdldEhUTUxFbGVtZW50U2Nyb2xsIGZyb20gXCIuL2dldEhUTUxFbGVtZW50U2Nyb2xsLmpzXCI7XG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXROb2RlU2Nyb2xsKG5vZGUpIHtcbiAgaWYgKG5vZGUgPT09IGdldFdpbmRvdyhub2RlKSB8fCAhaXNIVE1MRWxlbWVudChub2RlKSkge1xuICAgIHJldHVybiBnZXRXaW5kb3dTY3JvbGwobm9kZSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGdldEhUTUxFbGVtZW50U2Nyb2xsKG5vZGUpO1xuICB9XG59IiwgImltcG9ydCBnZXRCb3VuZGluZ0NsaWVudFJlY3QgZnJvbSBcIi4vZ2V0Qm91bmRpbmdDbGllbnRSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZVNjcm9sbCBmcm9tIFwiLi9nZXROb2RlU2Nyb2xsLmpzXCI7XG5pbXBvcnQgZ2V0Tm9kZU5hbWUgZnJvbSBcIi4vZ2V0Tm9kZU5hbWUuanNcIjtcbmltcG9ydCB7IGlzSFRNTEVsZW1lbnQgfSBmcm9tIFwiLi9pbnN0YW5jZU9mLmpzXCI7XG5pbXBvcnQgZ2V0V2luZG93U2Nyb2xsQmFyWCBmcm9tIFwiLi9nZXRXaW5kb3dTY3JvbGxCYXJYLmpzXCI7XG5pbXBvcnQgZ2V0RG9jdW1lbnRFbGVtZW50IGZyb20gXCIuL2dldERvY3VtZW50RWxlbWVudC5qc1wiO1xuaW1wb3J0IGlzU2Nyb2xsUGFyZW50IGZyb20gXCIuL2lzU2Nyb2xsUGFyZW50LmpzXCI7XG5pbXBvcnQgeyByb3VuZCB9IGZyb20gXCIuLi91dGlscy9tYXRoLmpzXCI7XG5cbmZ1bmN0aW9uIGlzRWxlbWVudFNjYWxlZChlbGVtZW50KSB7XG4gIHZhciByZWN0ID0gZWxlbWVudC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgdmFyIHNjYWxlWCA9IHJvdW5kKHJlY3Qud2lkdGgpIC8gZWxlbWVudC5vZmZzZXRXaWR0aCB8fCAxO1xuICB2YXIgc2NhbGVZID0gcm91bmQocmVjdC5oZWlnaHQpIC8gZWxlbWVudC5vZmZzZXRIZWlnaHQgfHwgMTtcbiAgcmV0dXJuIHNjYWxlWCAhPT0gMSB8fCBzY2FsZVkgIT09IDE7XG59IC8vIFJldHVybnMgdGhlIGNvbXBvc2l0ZSByZWN0IG9mIGFuIGVsZW1lbnQgcmVsYXRpdmUgdG8gaXRzIG9mZnNldFBhcmVudC5cbi8vIENvbXBvc2l0ZSBtZWFucyBpdCB0YWtlcyBpbnRvIGFjY291bnQgdHJhbnNmb3JtcyBhcyB3ZWxsIGFzIGxheW91dC5cblxuXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbiBnZXRDb21wb3NpdGVSZWN0KGVsZW1lbnRPclZpcnR1YWxFbGVtZW50LCBvZmZzZXRQYXJlbnQsIGlzRml4ZWQpIHtcbiAgaWYgKGlzRml4ZWQgPT09IHZvaWQgMCkge1xuICAgIGlzRml4ZWQgPSBmYWxzZTtcbiAgfVxuXG4gIHZhciBpc09mZnNldFBhcmVudEFuRWxlbWVudCA9IGlzSFRNTEVsZW1lbnQob2Zmc2V0UGFyZW50KTtcbiAgdmFyIG9mZnNldFBhcmVudElzU2NhbGVkID0gaXNIVE1MRWxlbWVudChvZmZzZXRQYXJlbnQpICYmIGlzRWxlbWVudFNjYWxlZChvZmZzZXRQYXJlbnQpO1xuICB2YXIgZG9jdW1lbnRFbGVtZW50ID0gZ2V0RG9jdW1lbnRFbGVtZW50KG9mZnNldFBhcmVudCk7XG4gIHZhciByZWN0ID0gZ2V0Qm91bmRpbmdDbGllbnRSZWN0KGVsZW1lbnRPclZpcnR1YWxFbGVtZW50LCBvZmZzZXRQYXJlbnRJc1NjYWxlZCk7XG4gIHZhciBzY3JvbGwgPSB7XG4gICAgc2Nyb2xsTGVmdDogMCxcbiAgICBzY3JvbGxUb3A6IDBcbiAgfTtcbiAgdmFyIG9mZnNldHMgPSB7XG4gICAgeDogMCxcbiAgICB5OiAwXG4gIH07XG5cbiAgaWYgKGlzT2Zmc2V0UGFyZW50QW5FbGVtZW50IHx8ICFpc09mZnNldFBhcmVudEFuRWxlbWVudCAmJiAhaXNGaXhlZCkge1xuICAgIGlmIChnZXROb2RlTmFtZShvZmZzZXRQYXJlbnQpICE9PSAnYm9keScgfHwgLy8gaHR0cHM6Ly9naXRodWIuY29tL3BvcHBlcmpzL3BvcHBlci1jb3JlL2lzc3Vlcy8xMDc4XG4gICAgaXNTY3JvbGxQYXJlbnQoZG9jdW1lbnRFbGVtZW50KSkge1xuICAgICAgc2Nyb2xsID0gZ2V0Tm9kZVNjcm9sbChvZmZzZXRQYXJlbnQpO1xuICAgIH1cblxuICAgIGlmIChpc0hUTUxFbGVtZW50KG9mZnNldFBhcmVudCkpIHtcbiAgICAgIG9mZnNldHMgPSBnZXRCb3VuZGluZ0NsaWVudFJlY3Qob2Zmc2V0UGFyZW50LCB0cnVlKTtcbiAgICAgIG9mZnNldHMueCArPSBvZmZzZXRQYXJlbnQuY2xpZW50TGVmdDtcbiAgICAgIG9mZnNldHMueSArPSBvZmZzZXRQYXJlbnQuY2xpZW50VG9wO1xuICAgIH0gZWxzZSBpZiAoZG9jdW1lbnRFbGVtZW50KSB7XG4gICAgICBvZmZzZXRzLnggPSBnZXRXaW5kb3dTY3JvbGxCYXJYKGRvY3VtZW50RWxlbWVudCk7XG4gICAgfVxuICB9XG5cbiAgcmV0dXJuIHtcbiAgICB4OiByZWN0LmxlZnQgKyBzY3JvbGwuc2Nyb2xsTGVmdCAtIG9mZnNldHMueCxcbiAgICB5OiByZWN0LnRvcCArIHNjcm9sbC5zY3JvbGxUb3AgLSBvZmZzZXRzLnksXG4gICAgd2lkdGg6IHJlY3Qud2lkdGgsXG4gICAgaGVpZ2h0OiByZWN0LmhlaWdodFxuICB9O1xufSIsICJpbXBvcnQgeyBtb2RpZmllclBoYXNlcyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiOyAvLyBzb3VyY2U6IGh0dHBzOi8vc3RhY2tvdmVyZmxvdy5jb20vcXVlc3Rpb25zLzQ5ODc1MjU1XG5cbmZ1bmN0aW9uIG9yZGVyKG1vZGlmaWVycykge1xuICB2YXIgbWFwID0gbmV3IE1hcCgpO1xuICB2YXIgdmlzaXRlZCA9IG5ldyBTZXQoKTtcbiAgdmFyIHJlc3VsdCA9IFtdO1xuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBtYXAuc2V0KG1vZGlmaWVyLm5hbWUsIG1vZGlmaWVyKTtcbiAgfSk7IC8vIE9uIHZpc2l0aW5nIG9iamVjdCwgY2hlY2sgZm9yIGl0cyBkZXBlbmRlbmNpZXMgYW5kIHZpc2l0IHRoZW0gcmVjdXJzaXZlbHlcblxuICBmdW5jdGlvbiBzb3J0KG1vZGlmaWVyKSB7XG4gICAgdmlzaXRlZC5hZGQobW9kaWZpZXIubmFtZSk7XG4gICAgdmFyIHJlcXVpcmVzID0gW10uY29uY2F0KG1vZGlmaWVyLnJlcXVpcmVzIHx8IFtdLCBtb2RpZmllci5yZXF1aXJlc0lmRXhpc3RzIHx8IFtdKTtcbiAgICByZXF1aXJlcy5mb3JFYWNoKGZ1bmN0aW9uIChkZXApIHtcbiAgICAgIGlmICghdmlzaXRlZC5oYXMoZGVwKSkge1xuICAgICAgICB2YXIgZGVwTW9kaWZpZXIgPSBtYXAuZ2V0KGRlcCk7XG5cbiAgICAgICAgaWYgKGRlcE1vZGlmaWVyKSB7XG4gICAgICAgICAgc29ydChkZXBNb2RpZmllcik7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9KTtcbiAgICByZXN1bHQucHVzaChtb2RpZmllcik7XG4gIH1cblxuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBpZiAoIXZpc2l0ZWQuaGFzKG1vZGlmaWVyLm5hbWUpKSB7XG4gICAgICAvLyBjaGVjayBmb3IgdmlzaXRlZCBvYmplY3RcbiAgICAgIHNvcnQobW9kaWZpZXIpO1xuICAgIH1cbiAgfSk7XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIG9yZGVyTW9kaWZpZXJzKG1vZGlmaWVycykge1xuICAvLyBvcmRlciBiYXNlZCBvbiBkZXBlbmRlbmNpZXNcbiAgdmFyIG9yZGVyZWRNb2RpZmllcnMgPSBvcmRlcihtb2RpZmllcnMpOyAvLyBvcmRlciBiYXNlZCBvbiBwaGFzZVxuXG4gIHJldHVybiBtb2RpZmllclBoYXNlcy5yZWR1Y2UoZnVuY3Rpb24gKGFjYywgcGhhc2UpIHtcbiAgICByZXR1cm4gYWNjLmNvbmNhdChvcmRlcmVkTW9kaWZpZXJzLmZpbHRlcihmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICAgIHJldHVybiBtb2RpZmllci5waGFzZSA9PT0gcGhhc2U7XG4gICAgfSkpO1xuICB9LCBbXSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGRlYm91bmNlKGZuKSB7XG4gIHZhciBwZW5kaW5nO1xuICByZXR1cm4gZnVuY3Rpb24gKCkge1xuICAgIGlmICghcGVuZGluZykge1xuICAgICAgcGVuZGluZyA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgIFByb21pc2UucmVzb2x2ZSgpLnRoZW4oZnVuY3Rpb24gKCkge1xuICAgICAgICAgIHBlbmRpbmcgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgcmVzb2x2ZShmbigpKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcGVuZGluZztcbiAgfTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gZm9ybWF0KHN0cikge1xuICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG4gICAgYXJnc1tfa2V5IC0gMV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICByZXR1cm4gW10uY29uY2F0KGFyZ3MpLnJlZHVjZShmdW5jdGlvbiAocCwgYykge1xuICAgIHJldHVybiBwLnJlcGxhY2UoLyVzLywgYyk7XG4gIH0sIHN0cik7XG59IiwgImltcG9ydCBmb3JtYXQgZnJvbSBcIi4vZm9ybWF0LmpzXCI7XG5pbXBvcnQgeyBtb2RpZmllclBoYXNlcyB9IGZyb20gXCIuLi9lbnVtcy5qc1wiO1xudmFyIElOVkFMSURfTU9ESUZJRVJfRVJST1IgPSAnUG9wcGVyOiBtb2RpZmllciBcIiVzXCIgcHJvdmlkZWQgYW4gaW52YWxpZCAlcyBwcm9wZXJ0eSwgZXhwZWN0ZWQgJXMgYnV0IGdvdCAlcyc7XG52YXIgTUlTU0lOR19ERVBFTkRFTkNZX0VSUk9SID0gJ1BvcHBlcjogbW9kaWZpZXIgXCIlc1wiIHJlcXVpcmVzIFwiJXNcIiwgYnV0IFwiJXNcIiBtb2RpZmllciBpcyBub3QgYXZhaWxhYmxlJztcbnZhciBWQUxJRF9QUk9QRVJUSUVTID0gWyduYW1lJywgJ2VuYWJsZWQnLCAncGhhc2UnLCAnZm4nLCAnZWZmZWN0JywgJ3JlcXVpcmVzJywgJ29wdGlvbnMnXTtcbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHZhbGlkYXRlTW9kaWZpZXJzKG1vZGlmaWVycykge1xuICBtb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICBbXS5jb25jYXQoT2JqZWN0LmtleXMobW9kaWZpZXIpLCBWQUxJRF9QUk9QRVJUSUVTKSAvLyBJRTExLWNvbXBhdGlibGUgcmVwbGFjZW1lbnQgZm9yIGBuZXcgU2V0KGl0ZXJhYmxlKWBcbiAgICAuZmlsdGVyKGZ1bmN0aW9uICh2YWx1ZSwgaW5kZXgsIHNlbGYpIHtcbiAgICAgIHJldHVybiBzZWxmLmluZGV4T2YodmFsdWUpID09PSBpbmRleDtcbiAgICB9KS5mb3JFYWNoKGZ1bmN0aW9uIChrZXkpIHtcbiAgICAgIHN3aXRjaCAoa2V5KSB7XG4gICAgICAgIGNhc2UgJ25hbWUnOlxuICAgICAgICAgIGlmICh0eXBlb2YgbW9kaWZpZXIubmFtZSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIFN0cmluZyhtb2RpZmllci5uYW1lKSwgJ1wibmFtZVwiJywgJ1wic3RyaW5nXCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5uYW1lKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAnZW5hYmxlZCc6XG4gICAgICAgICAgaWYgKHR5cGVvZiBtb2RpZmllci5lbmFibGVkICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcImVuYWJsZWRcIicsICdcImJvb2xlYW5cIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLmVuYWJsZWQpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdwaGFzZSc6XG4gICAgICAgICAgaWYgKG1vZGlmaWVyUGhhc2VzLmluZGV4T2YobW9kaWZpZXIucGhhc2UpIDwgMCkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wicGhhc2VcIicsIFwiZWl0aGVyIFwiICsgbW9kaWZpZXJQaGFzZXMuam9pbignLCAnKSwgXCJcXFwiXCIgKyBTdHJpbmcobW9kaWZpZXIucGhhc2UpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdmbic6XG4gICAgICAgICAgaWYgKHR5cGVvZiBtb2RpZmllci5mbiAhPT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wiZm5cIicsICdcImZ1bmN0aW9uXCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5mbikgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ2VmZmVjdCc6XG4gICAgICAgICAgaWYgKG1vZGlmaWVyLmVmZmVjdCAhPSBudWxsICYmIHR5cGVvZiBtb2RpZmllci5lZmZlY3QgIT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZm9ybWF0KElOVkFMSURfTU9ESUZJRVJfRVJST1IsIG1vZGlmaWVyLm5hbWUsICdcImVmZmVjdFwiJywgJ1wiZnVuY3Rpb25cIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLmZuKSArIFwiXFxcIlwiKSk7XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSAncmVxdWlyZXMnOlxuICAgICAgICAgIGlmIChtb2RpZmllci5yZXF1aXJlcyAhPSBudWxsICYmICFBcnJheS5pc0FycmF5KG1vZGlmaWVyLnJlcXVpcmVzKSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wicmVxdWlyZXNcIicsICdcImFycmF5XCInLCBcIlxcXCJcIiArIFN0cmluZyhtb2RpZmllci5yZXF1aXJlcykgKyBcIlxcXCJcIikpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgJ3JlcXVpcmVzSWZFeGlzdHMnOlxuICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheShtb2RpZmllci5yZXF1aXJlc0lmRXhpc3RzKSkge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoSU5WQUxJRF9NT0RJRklFUl9FUlJPUiwgbW9kaWZpZXIubmFtZSwgJ1wicmVxdWlyZXNJZkV4aXN0c1wiJywgJ1wiYXJyYXlcIicsIFwiXFxcIlwiICsgU3RyaW5nKG1vZGlmaWVyLnJlcXVpcmVzSWZFeGlzdHMpICsgXCJcXFwiXCIpKTtcbiAgICAgICAgICB9XG5cbiAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlICdvcHRpb25zJzpcbiAgICAgICAgY2FzZSAnZGF0YSc6XG4gICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBjb25zb2xlLmVycm9yKFwiUG9wcGVySlM6IGFuIGludmFsaWQgcHJvcGVydHkgaGFzIGJlZW4gcHJvdmlkZWQgdG8gdGhlIFxcXCJcIiArIG1vZGlmaWVyLm5hbWUgKyBcIlxcXCIgbW9kaWZpZXIsIHZhbGlkIHByb3BlcnRpZXMgYXJlIFwiICsgVkFMSURfUFJPUEVSVElFUy5tYXAoZnVuY3Rpb24gKHMpIHtcbiAgICAgICAgICAgIHJldHVybiBcIlxcXCJcIiArIHMgKyBcIlxcXCJcIjtcbiAgICAgICAgICB9KS5qb2luKCcsICcpICsgXCI7IGJ1dCBcXFwiXCIgKyBrZXkgKyBcIlxcXCIgd2FzIHByb3ZpZGVkLlwiKTtcbiAgICAgIH1cblxuICAgICAgbW9kaWZpZXIucmVxdWlyZXMgJiYgbW9kaWZpZXIucmVxdWlyZXMuZm9yRWFjaChmdW5jdGlvbiAocmVxdWlyZW1lbnQpIHtcbiAgICAgICAgaWYgKG1vZGlmaWVycy5maW5kKGZ1bmN0aW9uIChtb2QpIHtcbiAgICAgICAgICByZXR1cm4gbW9kLm5hbWUgPT09IHJlcXVpcmVtZW50O1xuICAgICAgICB9KSA9PSBudWxsKSB7XG4gICAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXQoTUlTU0lOR19ERVBFTkRFTkNZX0VSUk9SLCBTdHJpbmcobW9kaWZpZXIubmFtZSksIHJlcXVpcmVtZW50LCByZXF1aXJlbWVudCkpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfSk7XG59IiwgImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIHVuaXF1ZUJ5KGFyciwgZm4pIHtcbiAgdmFyIGlkZW50aWZpZXJzID0gbmV3IFNldCgpO1xuICByZXR1cm4gYXJyLmZpbHRlcihmdW5jdGlvbiAoaXRlbSkge1xuICAgIHZhciBpZGVudGlmaWVyID0gZm4oaXRlbSk7XG5cbiAgICBpZiAoIWlkZW50aWZpZXJzLmhhcyhpZGVudGlmaWVyKSkge1xuICAgICAgaWRlbnRpZmllcnMuYWRkKGlkZW50aWZpZXIpO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICB9KTtcbn0iLCAiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gbWVyZ2VCeU5hbWUobW9kaWZpZXJzKSB7XG4gIHZhciBtZXJnZWQgPSBtb2RpZmllcnMucmVkdWNlKGZ1bmN0aW9uIChtZXJnZWQsIGN1cnJlbnQpIHtcbiAgICB2YXIgZXhpc3RpbmcgPSBtZXJnZWRbY3VycmVudC5uYW1lXTtcbiAgICBtZXJnZWRbY3VycmVudC5uYW1lXSA9IGV4aXN0aW5nID8gT2JqZWN0LmFzc2lnbih7fSwgZXhpc3RpbmcsIGN1cnJlbnQsIHtcbiAgICAgIG9wdGlvbnM6IE9iamVjdC5hc3NpZ24oe30sIGV4aXN0aW5nLm9wdGlvbnMsIGN1cnJlbnQub3B0aW9ucyksXG4gICAgICBkYXRhOiBPYmplY3QuYXNzaWduKHt9LCBleGlzdGluZy5kYXRhLCBjdXJyZW50LmRhdGEpXG4gICAgfSkgOiBjdXJyZW50O1xuICAgIHJldHVybiBtZXJnZWQ7XG4gIH0sIHt9KTsgLy8gSUUxMSBkb2VzIG5vdCBzdXBwb3J0IE9iamVjdC52YWx1ZXNcblxuICByZXR1cm4gT2JqZWN0LmtleXMobWVyZ2VkKS5tYXAoZnVuY3Rpb24gKGtleSkge1xuICAgIHJldHVybiBtZXJnZWRba2V5XTtcbiAgfSk7XG59IiwgImltcG9ydCBnZXRDb21wb3NpdGVSZWN0IGZyb20gXCIuL2RvbS11dGlscy9nZXRDb21wb3NpdGVSZWN0LmpzXCI7XG5pbXBvcnQgZ2V0TGF5b3V0UmVjdCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0TGF5b3V0UmVjdC5qc1wiO1xuaW1wb3J0IGxpc3RTY3JvbGxQYXJlbnRzIGZyb20gXCIuL2RvbS11dGlscy9saXN0U2Nyb2xsUGFyZW50cy5qc1wiO1xuaW1wb3J0IGdldE9mZnNldFBhcmVudCBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0T2Zmc2V0UGFyZW50LmpzXCI7XG5pbXBvcnQgZ2V0Q29tcHV0ZWRTdHlsZSBmcm9tIFwiLi9kb20tdXRpbHMvZ2V0Q29tcHV0ZWRTdHlsZS5qc1wiO1xuaW1wb3J0IG9yZGVyTW9kaWZpZXJzIGZyb20gXCIuL3V0aWxzL29yZGVyTW9kaWZpZXJzLmpzXCI7XG5pbXBvcnQgZGVib3VuY2UgZnJvbSBcIi4vdXRpbHMvZGVib3VuY2UuanNcIjtcbmltcG9ydCB2YWxpZGF0ZU1vZGlmaWVycyBmcm9tIFwiLi91dGlscy92YWxpZGF0ZU1vZGlmaWVycy5qc1wiO1xuaW1wb3J0IHVuaXF1ZUJ5IGZyb20gXCIuL3V0aWxzL3VuaXF1ZUJ5LmpzXCI7XG5pbXBvcnQgZ2V0QmFzZVBsYWNlbWVudCBmcm9tIFwiLi91dGlscy9nZXRCYXNlUGxhY2VtZW50LmpzXCI7XG5pbXBvcnQgbWVyZ2VCeU5hbWUgZnJvbSBcIi4vdXRpbHMvbWVyZ2VCeU5hbWUuanNcIjtcbmltcG9ydCBkZXRlY3RPdmVyZmxvdyBmcm9tIFwiLi91dGlscy9kZXRlY3RPdmVyZmxvdy5qc1wiO1xuaW1wb3J0IHsgaXNFbGVtZW50IH0gZnJvbSBcIi4vZG9tLXV0aWxzL2luc3RhbmNlT2YuanNcIjtcbmltcG9ydCB7IGF1dG8gfSBmcm9tIFwiLi9lbnVtcy5qc1wiO1xudmFyIElOVkFMSURfRUxFTUVOVF9FUlJPUiA9ICdQb3BwZXI6IEludmFsaWQgcmVmZXJlbmNlIG9yIHBvcHBlciBhcmd1bWVudCBwcm92aWRlZC4gVGhleSBtdXN0IGJlIGVpdGhlciBhIERPTSBlbGVtZW50IG9yIHZpcnR1YWwgZWxlbWVudC4nO1xudmFyIElORklOSVRFX0xPT1BfRVJST1IgPSAnUG9wcGVyOiBBbiBpbmZpbml0ZSBsb29wIGluIHRoZSBtb2RpZmllcnMgY3ljbGUgaGFzIGJlZW4gZGV0ZWN0ZWQhIFRoZSBjeWNsZSBoYXMgYmVlbiBpbnRlcnJ1cHRlZCB0byBwcmV2ZW50IGEgYnJvd3NlciBjcmFzaC4nO1xudmFyIERFRkFVTFRfT1BUSU9OUyA9IHtcbiAgcGxhY2VtZW50OiAnYm90dG9tJyxcbiAgbW9kaWZpZXJzOiBbXSxcbiAgc3RyYXRlZ3k6ICdhYnNvbHV0ZSdcbn07XG5cbmZ1bmN0aW9uIGFyZVZhbGlkRWxlbWVudHMoKSB7XG4gIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4pLCBfa2V5ID0gMDsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuICAgIGFyZ3NbX2tleV0gPSBhcmd1bWVudHNbX2tleV07XG4gIH1cblxuICByZXR1cm4gIWFyZ3Muc29tZShmdW5jdGlvbiAoZWxlbWVudCkge1xuICAgIHJldHVybiAhKGVsZW1lbnQgJiYgdHlwZW9mIGVsZW1lbnQuZ2V0Qm91bmRpbmdDbGllbnRSZWN0ID09PSAnZnVuY3Rpb24nKTtcbiAgfSk7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwb3BwZXJHZW5lcmF0b3IoZ2VuZXJhdG9yT3B0aW9ucykge1xuICBpZiAoZ2VuZXJhdG9yT3B0aW9ucyA9PT0gdm9pZCAwKSB7XG4gICAgZ2VuZXJhdG9yT3B0aW9ucyA9IHt9O1xuICB9XG5cbiAgdmFyIF9nZW5lcmF0b3JPcHRpb25zID0gZ2VuZXJhdG9yT3B0aW9ucyxcbiAgICAgIF9nZW5lcmF0b3JPcHRpb25zJGRlZiA9IF9nZW5lcmF0b3JPcHRpb25zLmRlZmF1bHRNb2RpZmllcnMsXG4gICAgICBkZWZhdWx0TW9kaWZpZXJzID0gX2dlbmVyYXRvck9wdGlvbnMkZGVmID09PSB2b2lkIDAgPyBbXSA6IF9nZW5lcmF0b3JPcHRpb25zJGRlZixcbiAgICAgIF9nZW5lcmF0b3JPcHRpb25zJGRlZjIgPSBfZ2VuZXJhdG9yT3B0aW9ucy5kZWZhdWx0T3B0aW9ucyxcbiAgICAgIGRlZmF1bHRPcHRpb25zID0gX2dlbmVyYXRvck9wdGlvbnMkZGVmMiA9PT0gdm9pZCAwID8gREVGQVVMVF9PUFRJT05TIDogX2dlbmVyYXRvck9wdGlvbnMkZGVmMjtcbiAgcmV0dXJuIGZ1bmN0aW9uIGNyZWF0ZVBvcHBlcihyZWZlcmVuY2UsIHBvcHBlciwgb3B0aW9ucykge1xuICAgIGlmIChvcHRpb25zID09PSB2b2lkIDApIHtcbiAgICAgIG9wdGlvbnMgPSBkZWZhdWx0T3B0aW9ucztcbiAgICB9XG5cbiAgICB2YXIgc3RhdGUgPSB7XG4gICAgICBwbGFjZW1lbnQ6ICdib3R0b20nLFxuICAgICAgb3JkZXJlZE1vZGlmaWVyczogW10sXG4gICAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX09QVElPTlMsIGRlZmF1bHRPcHRpb25zKSxcbiAgICAgIG1vZGlmaWVyc0RhdGE6IHt9LFxuICAgICAgZWxlbWVudHM6IHtcbiAgICAgICAgcmVmZXJlbmNlOiByZWZlcmVuY2UsXG4gICAgICAgIHBvcHBlcjogcG9wcGVyXG4gICAgICB9LFxuICAgICAgYXR0cmlidXRlczoge30sXG4gICAgICBzdHlsZXM6IHt9XG4gICAgfTtcbiAgICB2YXIgZWZmZWN0Q2xlYW51cEZucyA9IFtdO1xuICAgIHZhciBpc0Rlc3Ryb3llZCA9IGZhbHNlO1xuICAgIHZhciBpbnN0YW5jZSA9IHtcbiAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgIHNldE9wdGlvbnM6IGZ1bmN0aW9uIHNldE9wdGlvbnMoc2V0T3B0aW9uc0FjdGlvbikge1xuICAgICAgICB2YXIgb3B0aW9ucyA9IHR5cGVvZiBzZXRPcHRpb25zQWN0aW9uID09PSAnZnVuY3Rpb24nID8gc2V0T3B0aW9uc0FjdGlvbihzdGF0ZS5vcHRpb25zKSA6IHNldE9wdGlvbnNBY3Rpb247XG4gICAgICAgIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKTtcbiAgICAgICAgc3RhdGUub3B0aW9ucyA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRPcHRpb25zLCBzdGF0ZS5vcHRpb25zLCBvcHRpb25zKTtcbiAgICAgICAgc3RhdGUuc2Nyb2xsUGFyZW50cyA9IHtcbiAgICAgICAgICByZWZlcmVuY2U6IGlzRWxlbWVudChyZWZlcmVuY2UpID8gbGlzdFNjcm9sbFBhcmVudHMocmVmZXJlbmNlKSA6IHJlZmVyZW5jZS5jb250ZXh0RWxlbWVudCA/IGxpc3RTY3JvbGxQYXJlbnRzKHJlZmVyZW5jZS5jb250ZXh0RWxlbWVudCkgOiBbXSxcbiAgICAgICAgICBwb3BwZXI6IGxpc3RTY3JvbGxQYXJlbnRzKHBvcHBlcilcbiAgICAgICAgfTsgLy8gT3JkZXJzIHRoZSBtb2RpZmllcnMgYmFzZWQgb24gdGhlaXIgZGVwZW5kZW5jaWVzIGFuZCBgcGhhc2VgXG4gICAgICAgIC8vIHByb3BlcnRpZXNcblxuICAgICAgICB2YXIgb3JkZXJlZE1vZGlmaWVycyA9IG9yZGVyTW9kaWZpZXJzKG1lcmdlQnlOYW1lKFtdLmNvbmNhdChkZWZhdWx0TW9kaWZpZXJzLCBzdGF0ZS5vcHRpb25zLm1vZGlmaWVycykpKTsgLy8gU3RyaXAgb3V0IGRpc2FibGVkIG1vZGlmaWVyc1xuXG4gICAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMgPSBvcmRlcmVkTW9kaWZpZXJzLmZpbHRlcihmdW5jdGlvbiAobSkge1xuICAgICAgICAgIHJldHVybiBtLmVuYWJsZWQ7XG4gICAgICAgIH0pOyAvLyBWYWxpZGF0ZSB0aGUgcHJvdmlkZWQgbW9kaWZpZXJzIHNvIHRoYXQgdGhlIGNvbnN1bWVyIHdpbGwgZ2V0IHdhcm5lZFxuICAgICAgICAvLyBpZiBvbmUgb2YgdGhlIG1vZGlmaWVycyBpcyBpbnZhbGlkIGZvciBhbnkgcmVhc29uXG5cbiAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgIHZhciBtb2RpZmllcnMgPSB1bmlxdWVCeShbXS5jb25jYXQob3JkZXJlZE1vZGlmaWVycywgc3RhdGUub3B0aW9ucy5tb2RpZmllcnMpLCBmdW5jdGlvbiAoX3JlZikge1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBfcmVmLm5hbWU7XG4gICAgICAgICAgICByZXR1cm4gbmFtZTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgICB2YWxpZGF0ZU1vZGlmaWVycyhtb2RpZmllcnMpO1xuXG4gICAgICAgICAgaWYgKGdldEJhc2VQbGFjZW1lbnQoc3RhdGUub3B0aW9ucy5wbGFjZW1lbnQpID09PSBhdXRvKSB7XG4gICAgICAgICAgICB2YXIgZmxpcE1vZGlmaWVyID0gc3RhdGUub3JkZXJlZE1vZGlmaWVycy5maW5kKGZ1bmN0aW9uIChfcmVmMikge1xuICAgICAgICAgICAgICB2YXIgbmFtZSA9IF9yZWYyLm5hbWU7XG4gICAgICAgICAgICAgIHJldHVybiBuYW1lID09PSAnZmxpcCc7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgaWYgKCFmbGlwTW9kaWZpZXIpIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihbJ1BvcHBlcjogXCJhdXRvXCIgcGxhY2VtZW50cyByZXF1aXJlIHRoZSBcImZsaXBcIiBtb2RpZmllciBiZScsICdwcmVzZW50IGFuZCBlbmFibGVkIHRvIHdvcmsuJ10uam9pbignICcpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG5cbiAgICAgICAgICB2YXIgX2dldENvbXB1dGVkU3R5bGUgPSBnZXRDb21wdXRlZFN0eWxlKHBvcHBlciksXG4gICAgICAgICAgICAgIG1hcmdpblRvcCA9IF9nZXRDb21wdXRlZFN0eWxlLm1hcmdpblRvcCxcbiAgICAgICAgICAgICAgbWFyZ2luUmlnaHQgPSBfZ2V0Q29tcHV0ZWRTdHlsZS5tYXJnaW5SaWdodCxcbiAgICAgICAgICAgICAgbWFyZ2luQm90dG9tID0gX2dldENvbXB1dGVkU3R5bGUubWFyZ2luQm90dG9tLFxuICAgICAgICAgICAgICBtYXJnaW5MZWZ0ID0gX2dldENvbXB1dGVkU3R5bGUubWFyZ2luTGVmdDsgLy8gV2Ugbm8gbG9uZ2VyIHRha2UgaW50byBhY2NvdW50IGBtYXJnaW5zYCBvbiB0aGUgcG9wcGVyLCBhbmQgaXQgY2FuXG4gICAgICAgICAgLy8gY2F1c2UgYnVncyB3aXRoIHBvc2l0aW9uaW5nLCBzbyB3ZSdsbCB3YXJuIHRoZSBjb25zdW1lclxuXG5cbiAgICAgICAgICBpZiAoW21hcmdpblRvcCwgbWFyZ2luUmlnaHQsIG1hcmdpbkJvdHRvbSwgbWFyZ2luTGVmdF0uc29tZShmdW5jdGlvbiAobWFyZ2luKSB7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VGbG9hdChtYXJnaW4pO1xuICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICBjb25zb2xlLndhcm4oWydQb3BwZXI6IENTUyBcIm1hcmdpblwiIHN0eWxlcyBjYW5ub3QgYmUgdXNlZCB0byBhcHBseSBwYWRkaW5nJywgJ2JldHdlZW4gdGhlIHBvcHBlciBhbmQgaXRzIHJlZmVyZW5jZSBlbGVtZW50IG9yIGJvdW5kYXJ5LicsICdUbyByZXBsaWNhdGUgbWFyZ2luLCB1c2UgdGhlIGBvZmZzZXRgIG1vZGlmaWVyLCBhcyB3ZWxsIGFzJywgJ3RoZSBgcGFkZGluZ2Agb3B0aW9uIGluIHRoZSBgcHJldmVudE92ZXJmbG93YCBhbmQgYGZsaXBgJywgJ21vZGlmaWVycy4nXS5qb2luKCcgJykpO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJ1bk1vZGlmaWVyRWZmZWN0cygpO1xuICAgICAgICByZXR1cm4gaW5zdGFuY2UudXBkYXRlKCk7XG4gICAgICB9LFxuICAgICAgLy8gU3luYyB1cGRhdGUgXHUyMDEzIGl0IHdpbGwgYWx3YXlzIGJlIGV4ZWN1dGVkLCBldmVuIGlmIG5vdCBuZWNlc3NhcnkuIFRoaXNcbiAgICAgIC8vIGlzIHVzZWZ1bCBmb3IgbG93IGZyZXF1ZW5jeSB1cGRhdGVzIHdoZXJlIHN5bmMgYmVoYXZpb3Igc2ltcGxpZmllcyB0aGVcbiAgICAgIC8vIGxvZ2ljLlxuICAgICAgLy8gRm9yIGhpZ2ggZnJlcXVlbmN5IHVwZGF0ZXMgKGUuZy4gYHJlc2l6ZWAgYW5kIGBzY3JvbGxgIGV2ZW50cyksIGFsd2F5c1xuICAgICAgLy8gcHJlZmVyIHRoZSBhc3luYyBQb3BwZXIjdXBkYXRlIG1ldGhvZFxuICAgICAgZm9yY2VVcGRhdGU6IGZ1bmN0aW9uIGZvcmNlVXBkYXRlKCkge1xuICAgICAgICBpZiAoaXNEZXN0cm95ZWQpIHtcbiAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgX3N0YXRlJGVsZW1lbnRzID0gc3RhdGUuZWxlbWVudHMsXG4gICAgICAgICAgICByZWZlcmVuY2UgPSBfc3RhdGUkZWxlbWVudHMucmVmZXJlbmNlLFxuICAgICAgICAgICAgcG9wcGVyID0gX3N0YXRlJGVsZW1lbnRzLnBvcHBlcjsgLy8gRG9uJ3QgcHJvY2VlZCBpZiBgcmVmZXJlbmNlYCBvciBgcG9wcGVyYCBhcmUgbm90IHZhbGlkIGVsZW1lbnRzXG4gICAgICAgIC8vIGFueW1vcmVcblxuICAgICAgICBpZiAoIWFyZVZhbGlkRWxlbWVudHMocmVmZXJlbmNlLCBwb3BwZXIpKSB7XG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgICAgY29uc29sZS5lcnJvcihJTlZBTElEX0VMRU1FTlRfRVJST1IpO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSAvLyBTdG9yZSB0aGUgcmVmZXJlbmNlIGFuZCBwb3BwZXIgcmVjdHMgdG8gYmUgcmVhZCBieSBtb2RpZmllcnNcblxuXG4gICAgICAgIHN0YXRlLnJlY3RzID0ge1xuICAgICAgICAgIHJlZmVyZW5jZTogZ2V0Q29tcG9zaXRlUmVjdChyZWZlcmVuY2UsIGdldE9mZnNldFBhcmVudChwb3BwZXIpLCBzdGF0ZS5vcHRpb25zLnN0cmF0ZWd5ID09PSAnZml4ZWQnKSxcbiAgICAgICAgICBwb3BwZXI6IGdldExheW91dFJlY3QocG9wcGVyKVxuICAgICAgICB9OyAvLyBNb2RpZmllcnMgaGF2ZSB0aGUgYWJpbGl0eSB0byByZXNldCB0aGUgY3VycmVudCB1cGRhdGUgY3ljbGUuIFRoZVxuICAgICAgICAvLyBtb3N0IGNvbW1vbiB1c2UgY2FzZSBmb3IgdGhpcyBpcyB0aGUgYGZsaXBgIG1vZGlmaWVyIGNoYW5naW5nIHRoZVxuICAgICAgICAvLyBwbGFjZW1lbnQsIHdoaWNoIHRoZW4gbmVlZHMgdG8gcmUtcnVuIGFsbCB0aGUgbW9kaWZpZXJzLCBiZWNhdXNlIHRoZVxuICAgICAgICAvLyBsb2dpYyB3YXMgcHJldmlvdXNseSByYW4gZm9yIHRoZSBwcmV2aW91cyBwbGFjZW1lbnQgYW5kIGlzIHRoZXJlZm9yZVxuICAgICAgICAvLyBzdGFsZS9pbmNvcnJlY3RcblxuICAgICAgICBzdGF0ZS5yZXNldCA9IGZhbHNlO1xuICAgICAgICBzdGF0ZS5wbGFjZW1lbnQgPSBzdGF0ZS5vcHRpb25zLnBsYWNlbWVudDsgLy8gT24gZWFjaCB1cGRhdGUgY3ljbGUsIHRoZSBgbW9kaWZpZXJzRGF0YWAgcHJvcGVydHkgZm9yIGVhY2ggbW9kaWZpZXJcbiAgICAgICAgLy8gaXMgZmlsbGVkIHdpdGggdGhlIGluaXRpYWwgZGF0YSBzcGVjaWZpZWQgYnkgdGhlIG1vZGlmaWVyLiBUaGlzIG1lYW5zXG4gICAgICAgIC8vIGl0IGRvZXNuJ3QgcGVyc2lzdCBhbmQgaXMgZnJlc2ggb24gZWFjaCB1cGRhdGUuXG4gICAgICAgIC8vIFRvIGVuc3VyZSBwZXJzaXN0ZW50IGRhdGEsIHVzZSBgJHtuYW1lfSNwZXJzaXN0ZW50YFxuXG4gICAgICAgIHN0YXRlLm9yZGVyZWRNb2RpZmllcnMuZm9yRWFjaChmdW5jdGlvbiAobW9kaWZpZXIpIHtcbiAgICAgICAgICByZXR1cm4gc3RhdGUubW9kaWZpZXJzRGF0YVttb2RpZmllci5uYW1lXSA9IE9iamVjdC5hc3NpZ24oe30sIG1vZGlmaWVyLmRhdGEpO1xuICAgICAgICB9KTtcbiAgICAgICAgdmFyIF9fZGVidWdfbG9vcHNfXyA9IDA7XG5cbiAgICAgICAgZm9yICh2YXIgaW5kZXggPSAwOyBpbmRleCA8IHN0YXRlLm9yZGVyZWRNb2RpZmllcnMubGVuZ3RoOyBpbmRleCsrKSB7XG4gICAgICAgICAgaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSBcInByb2R1Y3Rpb25cIikge1xuICAgICAgICAgICAgX19kZWJ1Z19sb29wc19fICs9IDE7XG5cbiAgICAgICAgICAgIGlmIChfX2RlYnVnX2xvb3BzX18gPiAxMDApIHtcbiAgICAgICAgICAgICAgY29uc29sZS5lcnJvcihJTkZJTklURV9MT09QX0VSUk9SKTtcbiAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuXG4gICAgICAgICAgaWYgKHN0YXRlLnJlc2V0ID09PSB0cnVlKSB7XG4gICAgICAgICAgICBzdGF0ZS5yZXNldCA9IGZhbHNlO1xuICAgICAgICAgICAgaW5kZXggPSAtMTtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgIH1cblxuICAgICAgICAgIHZhciBfc3RhdGUkb3JkZXJlZE1vZGlmaWUgPSBzdGF0ZS5vcmRlcmVkTW9kaWZpZXJzW2luZGV4XSxcbiAgICAgICAgICAgICAgZm4gPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUuZm4sXG4gICAgICAgICAgICAgIF9zdGF0ZSRvcmRlcmVkTW9kaWZpZTIgPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUub3B0aW9ucyxcbiAgICAgICAgICAgICAgX29wdGlvbnMgPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUyID09PSB2b2lkIDAgPyB7fSA6IF9zdGF0ZSRvcmRlcmVkTW9kaWZpZTIsXG4gICAgICAgICAgICAgIG5hbWUgPSBfc3RhdGUkb3JkZXJlZE1vZGlmaWUubmFtZTtcblxuICAgICAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHN0YXRlID0gZm4oe1xuICAgICAgICAgICAgICBzdGF0ZTogc3RhdGUsXG4gICAgICAgICAgICAgIG9wdGlvbnM6IF9vcHRpb25zLFxuICAgICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgICBpbnN0YW5jZTogaW5zdGFuY2VcbiAgICAgICAgICAgIH0pIHx8IHN0YXRlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIC8vIEFzeW5jIGFuZCBvcHRpbWlzdGljYWxseSBvcHRpbWl6ZWQgdXBkYXRlIFx1MjAxMyBpdCB3aWxsIG5vdCBiZSBleGVjdXRlZCBpZlxuICAgICAgLy8gbm90IG5lY2Vzc2FyeSAoZGVib3VuY2VkIHRvIHJ1biBhdCBtb3N0IG9uY2UtcGVyLXRpY2spXG4gICAgICB1cGRhdGU6IGRlYm91bmNlKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlKSB7XG4gICAgICAgICAgaW5zdGFuY2UuZm9yY2VVcGRhdGUoKTtcbiAgICAgICAgICByZXNvbHZlKHN0YXRlKTtcbiAgICAgICAgfSk7XG4gICAgICB9KSxcbiAgICAgIGRlc3Ryb3k6IGZ1bmN0aW9uIGRlc3Ryb3koKSB7XG4gICAgICAgIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKTtcbiAgICAgICAgaXNEZXN0cm95ZWQgPSB0cnVlO1xuICAgICAgfVxuICAgIH07XG5cbiAgICBpZiAoIWFyZVZhbGlkRWxlbWVudHMocmVmZXJlbmNlLCBwb3BwZXIpKSB7XG4gICAgICBpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoSU5WQUxJRF9FTEVNRU5UX0VSUk9SKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIGluc3RhbmNlO1xuICAgIH1cblxuICAgIGluc3RhbmNlLnNldE9wdGlvbnMob3B0aW9ucykudGhlbihmdW5jdGlvbiAoc3RhdGUpIHtcbiAgICAgIGlmICghaXNEZXN0cm95ZWQgJiYgb3B0aW9ucy5vbkZpcnN0VXBkYXRlKSB7XG4gICAgICAgIG9wdGlvbnMub25GaXJzdFVwZGF0ZShzdGF0ZSk7XG4gICAgICB9XG4gICAgfSk7IC8vIE1vZGlmaWVycyBoYXZlIHRoZSBhYmlsaXR5IHRvIGV4ZWN1dGUgYXJiaXRyYXJ5IGNvZGUgYmVmb3JlIHRoZSBmaXJzdFxuICAgIC8vIHVwZGF0ZSBjeWNsZSBydW5zLiBUaGV5IHdpbGwgYmUgZXhlY3V0ZWQgaW4gdGhlIHNhbWUgb3JkZXIgYXMgdGhlIHVwZGF0ZVxuICAgIC8vIGN5Y2xlLiBUaGlzIGlzIHVzZWZ1bCB3aGVuIGEgbW9kaWZpZXIgYWRkcyBzb21lIHBlcnNpc3RlbnQgZGF0YSB0aGF0XG4gICAgLy8gb3RoZXIgbW9kaWZpZXJzIG5lZWQgdG8gdXNlLCBidXQgdGhlIG1vZGlmaWVyIGlzIHJ1biBhZnRlciB0aGUgZGVwZW5kZW50XG4gICAgLy8gb25lLlxuXG4gICAgZnVuY3Rpb24gcnVuTW9kaWZpZXJFZmZlY3RzKCkge1xuICAgICAgc3RhdGUub3JkZXJlZE1vZGlmaWVycy5mb3JFYWNoKGZ1bmN0aW9uIChfcmVmMykge1xuICAgICAgICB2YXIgbmFtZSA9IF9yZWYzLm5hbWUsXG4gICAgICAgICAgICBfcmVmMyRvcHRpb25zID0gX3JlZjMub3B0aW9ucyxcbiAgICAgICAgICAgIG9wdGlvbnMgPSBfcmVmMyRvcHRpb25zID09PSB2b2lkIDAgPyB7fSA6IF9yZWYzJG9wdGlvbnMsXG4gICAgICAgICAgICBlZmZlY3QgPSBfcmVmMy5lZmZlY3Q7XG5cbiAgICAgICAgaWYgKHR5cGVvZiBlZmZlY3QgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICB2YXIgY2xlYW51cEZuID0gZWZmZWN0KHtcbiAgICAgICAgICAgIHN0YXRlOiBzdGF0ZSxcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBpbnN0YW5jZTogaW5zdGFuY2UsXG4gICAgICAgICAgICBvcHRpb25zOiBvcHRpb25zXG4gICAgICAgICAgfSk7XG5cbiAgICAgICAgICB2YXIgbm9vcEZuID0gZnVuY3Rpb24gbm9vcEZuKCkge307XG5cbiAgICAgICAgICBlZmZlY3RDbGVhbnVwRm5zLnB1c2goY2xlYW51cEZuIHx8IG5vb3BGbik7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIGNsZWFudXBNb2RpZmllckVmZmVjdHMoKSB7XG4gICAgICBlZmZlY3RDbGVhbnVwRm5zLmZvckVhY2goZnVuY3Rpb24gKGZuKSB7XG4gICAgICAgIHJldHVybiBmbigpO1xuICAgICAgfSk7XG4gICAgICBlZmZlY3RDbGVhbnVwRm5zID0gW107XG4gICAgfVxuXG4gICAgcmV0dXJuIGluc3RhbmNlO1xuICB9O1xufVxuZXhwb3J0IHZhciBjcmVhdGVQb3BwZXIgPSAvKiNfX1BVUkVfXyovcG9wcGVyR2VuZXJhdG9yKCk7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBpbXBvcnQvbm8tdW51c2VkLW1vZHVsZXNcblxuZXhwb3J0IHsgZGV0ZWN0T3ZlcmZsb3cgfTsiLCAiaW1wb3J0IHsgcG9wcGVyR2VuZXJhdG9yLCBkZXRlY3RPdmVyZmxvdyB9IGZyb20gXCIuL2NyZWF0ZVBvcHBlci5qc1wiO1xuaW1wb3J0IGV2ZW50TGlzdGVuZXJzIGZyb20gXCIuL21vZGlmaWVycy9ldmVudExpc3RlbmVycy5qc1wiO1xuaW1wb3J0IHBvcHBlck9mZnNldHMgZnJvbSBcIi4vbW9kaWZpZXJzL3BvcHBlck9mZnNldHMuanNcIjtcbmltcG9ydCBjb21wdXRlU3R5bGVzIGZyb20gXCIuL21vZGlmaWVycy9jb21wdXRlU3R5bGVzLmpzXCI7XG5pbXBvcnQgYXBwbHlTdHlsZXMgZnJvbSBcIi4vbW9kaWZpZXJzL2FwcGx5U3R5bGVzLmpzXCI7XG5pbXBvcnQgb2Zmc2V0IGZyb20gXCIuL21vZGlmaWVycy9vZmZzZXQuanNcIjtcbmltcG9ydCBmbGlwIGZyb20gXCIuL21vZGlmaWVycy9mbGlwLmpzXCI7XG5pbXBvcnQgcHJldmVudE92ZXJmbG93IGZyb20gXCIuL21vZGlmaWVycy9wcmV2ZW50T3ZlcmZsb3cuanNcIjtcbmltcG9ydCBhcnJvdyBmcm9tIFwiLi9tb2RpZmllcnMvYXJyb3cuanNcIjtcbmltcG9ydCBoaWRlIGZyb20gXCIuL21vZGlmaWVycy9oaWRlLmpzXCI7XG52YXIgZGVmYXVsdE1vZGlmaWVycyA9IFtldmVudExpc3RlbmVycywgcG9wcGVyT2Zmc2V0cywgY29tcHV0ZVN0eWxlcywgYXBwbHlTdHlsZXMsIG9mZnNldCwgZmxpcCwgcHJldmVudE92ZXJmbG93LCBhcnJvdywgaGlkZV07XG52YXIgY3JlYXRlUG9wcGVyID0gLyojX19QVVJFX18qL3BvcHBlckdlbmVyYXRvcih7XG4gIGRlZmF1bHRNb2RpZmllcnM6IGRlZmF1bHRNb2RpZmllcnNcbn0pOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCB7IGNyZWF0ZVBvcHBlciwgcG9wcGVyR2VuZXJhdG9yLCBkZWZhdWx0TW9kaWZpZXJzLCBkZXRlY3RPdmVyZmxvdyB9OyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgaW1wb3J0L25vLXVudXNlZC1tb2R1bGVzXG5cbmV4cG9ydCB7IGNyZWF0ZVBvcHBlciBhcyBjcmVhdGVQb3BwZXJMaXRlIH0gZnJvbSBcIi4vcG9wcGVyLWxpdGUuanNcIjsgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGltcG9ydC9uby11bnVzZWQtbW9kdWxlc1xuXG5leHBvcnQgKiBmcm9tIFwiLi9tb2RpZmllcnMvaW5kZXguanNcIjsiLCAiaW1wb3J0IHtcbiAgICBBcHAsXG4gICAgbm9ybWFsaXplUGF0aCxcbiAgICBUQWJzdHJhY3RGaWxlLFxuICAgIFRGaWxlLFxuICAgIFRGb2xkZXIsXG4gICAgVmF1bHQsXG59IGZyb20gXCJvYnNpZGlhblwiO1xuXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZV90ZmlsZShhcHA6IEFwcCwgZmlsZV9zdHI6IHN0cmluZyk6IFRGaWxlIHtcbiAgICBmaWxlX3N0ciA9IG5vcm1hbGl6ZVBhdGgoZmlsZV9zdHIpO1xuXG4gICAgY29uc3QgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZV9zdHIpO1xuICAgIGlmICghZmlsZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpbGUgXCIke2ZpbGVfc3RyfVwiIGRvZXNuJ3QgZXhpc3RgKTtcbiAgICB9XG4gICAgaWYgKCEoZmlsZSBpbnN0YW5jZW9mIFRGaWxlKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYCR7ZmlsZV9zdHJ9IGlzIGEgZm9sZGVyLCBub3QgYSBmaWxlYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZpbGU7XG59XG5cblxuZXhwb3J0IGZ1bmN0aW9uIHJlc29sdmVfdGZvbGRlcihhcHA6IEFwcCwgZm9sZGVyX3N0cjogc3RyaW5nKTogVEZvbGRlciB7XG4gICAgZm9sZGVyX3N0ciA9IG5vcm1hbGl6ZVBhdGgoZm9sZGVyX3N0cik7XG5cbiAgICBjb25zdCBmb2xkZXIgPSBhcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGZvbGRlcl9zdHIpO1xuICAgIGlmICghZm9sZGVyKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgRm9sZGVyIFwiJHtmb2xkZXJfc3RyfVwiIGRvZXNuJ3QgZXhpc3RgKTtcbiAgICB9XG4gICAgaWYgKCEoZm9sZGVyIGluc3RhbmNlb2YgVEZvbGRlcikpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGAke2ZvbGRlcl9zdHJ9IGlzIGEgZmlsZSwgbm90IGEgZm9sZGVyYCk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGZvbGRlcjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldF90ZmlsZXNfZnJvbV9mb2xkZXIoXG4gICAgYXBwOiBBcHAsXG4gICAgZm9sZGVyX3N0cjogc3RyaW5nXG4pOiBBcnJheTxURmlsZT4ge1xuICAgIGNvbnN0IGZvbGRlciA9IHJlc29sdmVfdGZvbGRlcihhcHAsIGZvbGRlcl9zdHIpO1xuXG4gICAgY29uc3QgZmlsZXM6IEFycmF5PFRGaWxlPiA9IFtdO1xuICAgIFZhdWx0LnJlY3Vyc2VDaGlsZHJlbihmb2xkZXIsIChmaWxlOiBUQWJzdHJhY3RGaWxlKSA9PiB7XG4gICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgICAgIGZpbGVzLnB1c2goZmlsZSk7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIGZpbGVzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgICAgcmV0dXJuIGEuYmFzZW5hbWUubG9jYWxlQ29tcGFyZShiLmJhc2VuYW1lKTtcbiAgICB9KTtcblxuICAgIHJldHVybiBmaWxlcztcbn0iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgRHJvcGRvd25Db21wb25lbnQsIFRGaWxlLCBCdXR0b25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgdmFsdWVTZWxlY3RNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XG4gICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nO1xuICAgIHByaXZhdGUgZmllbGQ6IEZpZWxkO1xuICAgIHByaXZhdGUgbmV3VmFsdWU6IHN0cmluZyB8IG51bGw7XG4gICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuO1xuICAgIHByaXZhdGUgdG9wOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCB2YWx1ZTogc3RyaW5nLCBmaWVsZDogRmllbGQsIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLCBpbkZyb250TWF0dGVyOiBib29sZWFuID0gZmFsc2UsIHRvcDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIHRoaXMudmFsdWUgPSB2YWx1ZTtcbiAgICAgICAgdGhpcy5uZXdWYWx1ZSA9IG51bGw7XG4gICAgICAgIHRoaXMubGluZU51bWJlciA9IGxpbmVOdW1iZXI7XG4gICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlciA9IGluRnJvbnRNYXR0ZXI7XG4gICAgICAgIHRoaXMudG9wID0gdG9wO1xuICAgIH07XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpO1xuICAgICAgICBjb25zdCBpbnB1dERpdiA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW1vZGFsLXZhbHVlXCIgfSk7XG4gICAgICAgIGF3YWl0IHRoaXMuYnVpbGRJbnB1dEVsKGlucHV0RGl2KTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhc3luYyBidWlsZElucHV0RWwoaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IHNlbGVjdEVsID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KGlucHV0RGl2KTtcbiAgICAgICAgc2VsZWN0RWwuc2VsZWN0RWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXNlbGVjdFwiKTtcblxuICAgICAgICBjb25zdCBvcHRpb25zID0gdGhpcy5maWVsZC5vcHRpb25zO1xuICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oXCJcIiwgXCItLUVtcHR5LS1cIik7XG4gICAgICAgIGNvbnN0IGxpc3ROb3RlVmFsdWVzID0gYXdhaXQgRmllbGRTZXR0aW5nLmdldFZhbHVlc0xpc3RGcm9tTm90ZSh0aGlzLmZpZWxkLnZhbHVlc0xpc3ROb3RlUGF0aCwgdGhpcy5hcHApXG4gICAgICAgIGxpc3ROb3RlVmFsdWVzLmZvckVhY2godmFsdWUgPT4gc2VsZWN0RWwuYWRkT3B0aW9uKHZhbHVlLCB2YWx1ZSkpO1xuICAgICAgICBpZiAobGlzdE5vdGVWYWx1ZXMuaW5jbHVkZXModGhpcy52YWx1ZSkpIHtcbiAgICAgICAgICAgIHNlbGVjdEVsLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgICAgICB9O1xuICAgICAgICBpZiAobGlzdE5vdGVWYWx1ZXMubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhvcHRpb25zKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZWN0RWwuYWRkT3B0aW9uKG9wdGlvbnNba2V5XSwgb3B0aW9uc1trZXldKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaWYgKE9iamVjdC52YWx1ZXMob3B0aW9ucykuaW5jbHVkZXModGhpcy52YWx1ZSkpIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RFbC5zZXRWYWx1ZSh0aGlzLnZhbHVlKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgc2VsZWN0RWwub25DaGFuZ2UodmFsdWUgPT4gdGhpcy5uZXdWYWx1ZSA9IHZhbHVlICE9IFwiLS1FbXB0eS0tXCIgPyB2YWx1ZSA6IFwiXCIpO1xuICAgICAgICBjb25zdCBzdWJtaXRCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGlucHV0RGl2KTtcbiAgICAgICAgc3VibWl0QnV0dG9uLnNldFRvb2x0aXAoXCJTYXZlXCIpXG4gICAgICAgICAgICAuc2V0SWNvbihcImNoZWNrbWFya1wiKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMubmV3VmFsdWUgfHwgdGhpcy5uZXdWYWx1ZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXBsYWNlVmFsdWVzKHRoaXMuYXBwLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgdGhpcy5uZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgaW5zZXJ0VmFsdWVzKHRoaXMuYXBwLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgc2VsZWN0RWwuZ2V0VmFsdWUoKSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59OyIsICJpbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCIuL0Fic3RyYWN0TGlzdEJhc2VkRmllbGRcIjtcbmltcG9ydCB7IEFwcCwgTWVudSwgVEZpbGUsIFRleHRDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBTZWxlY3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9TZWxlY3RNb2RhbFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHZhbHVlU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvdmFsdWVTZWxlY3RNb2RhbFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBTZWxlY3RGaWVsZCBleHRlbmRzIEFic3RyYWN0TGlzdEJhc2VkRmllbGQge1xuXG4gICAgdmFsdWVzUHJvbXB0Q29tcG9uZW50czogQXJyYXk8VGV4dENvbXBvbmVudD4gPSBbXTtcbiAgICBwcmVzZXRWYWx1ZXNGaWVsZHM6IEhUTUxEaXZFbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKGZpZWxkLCBGaWVsZFR5cGUuU2VsZWN0KVxuICAgIH1cblxuICAgIGFkZE1lbnVPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGNhdGVnb3J5OiBNZW51IHwgU2VsZWN0TW9kYWwpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgdmFsdWVTZWxlY3RNb2RhbChhcHAsIGZpbGUsIHZhbHVlLCB0aGlzLmZpZWxkKTtcbiAgICAgICAgbW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlXCIpO1xuICAgICAgICBpZiAoU2VsZWN0RmllbGQuaXNNZW51KGNhdGVnb3J5KSkge1xuICAgICAgICAgICAgY2F0ZWdvcnkuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSAke25hbWV9YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKCdyaWdodC10cmlhbmdsZScpO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiBtb2RhbC5vcGVuKCkpO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcInRhcmdldC1tZXRhZGF0YVwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKFNlbGVjdEZpZWxkLmlzU2VsZWN0KGNhdGVnb3J5KSkge1xuICAgICAgICAgICAgY2F0ZWdvcnkuYWRkT3B0aW9uKGB1cGRhdGVfJHtuYW1lfWAsIGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICBjYXRlZ29yeS5tb2RhbHNbYHVwZGF0ZV8ke25hbWV9YF0gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIHRvcD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyB2YWx1ZVNlbGVjdE1vZGFsKGFwcCwgZmlsZSwgXCJcIiwgdGhpcy5maWVsZCwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgdG9wKTtcbiAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNlbGVjdCBvcHRpb24gZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuXG4gICAgYXN5bmMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCB2YWx1ZUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7O1xuICAgICAgICBjb25zdCB2YWx1ZUxhYmVsID0gZHYuZWwoXCJzcGFuXCIsIHBbdGhpcy5maWVsZC5uYW1lXSB8fCBcIlwiKTtcbiAgICAgICAgdmFsdWVDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVMYWJlbCk7XG4gICAgICAgIGNvbnN0IGRyb3BEb3duQnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKTtcbiAgICAgICAgZHJvcERvd25CdXR0b24uc2V0VGV4dChcIlx1RDgzRFx1REQzRFwiKTtcbiAgICAgICAgZHJvcERvd25CdXR0b24uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgdmFsdWVDb250YWluZXIuYXBwZW5kQ2hpbGQoZHJvcERvd25CdXR0b24pO1xuXG5cbiAgICAgICAgY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNlbGVjdFwiKTtcbiAgICAgICAgc2VsZWN0LnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtc2VsZWN0XCIpO1xuICAgICAgICBzZWxlY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VsZWN0KTtcbiAgICAgICAgY29uc3QgZGlzbWlzc0J0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIGRpc21pc3NCdG4uc2V0VGV4dChcIlx1Mjc0Q1wiKTtcbiAgICAgICAgZGlzbWlzc0J0bi5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpO1xuICAgICAgICBzZWxlY3RDb250YWluZXIuYXBwZW5kQ2hpbGQoZGlzbWlzc0J0bik7XG4gICAgICAgIGNvbnN0IG51bGxPcHRpb24gPSBuZXcgT3B0aW9uKFwiLS1zZWxlY3QtLVwiLCB1bmRlZmluZWQpO1xuICAgICAgICBzZWxlY3QuYWRkKG51bGxPcHRpb24pO1xuICAgICAgICBjb25zdCBsaXN0Tm90ZVZhbHVlcyA9IGF3YWl0IEZpZWxkU2V0dGluZy5nZXRWYWx1ZXNMaXN0RnJvbU5vdGUodGhpcy5maWVsZC52YWx1ZXNMaXN0Tm90ZVBhdGgsIHBsdWdpbi5hcHApXG4gICAgICAgIGlmIChsaXN0Tm90ZVZhbHVlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIGxpc3ROb3RlVmFsdWVzLmZvckVhY2gobyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uID0gbmV3IE9wdGlvbihvLCBvKTtcbiAgICAgICAgICAgICAgICBpZiAocFt0aGlzLmZpZWxkLm5hbWVdID09PSBvIHx8XG4gICAgICAgICAgICAgICAgICAgIHBbdGhpcy5maWVsZC5uYW1lXSAmJlxuICAgICAgICAgICAgICAgICAgICBPYmplY3Qua2V5cyhwW3RoaXMuZmllbGQubmFtZV0pLmluY2x1ZGVzKFwicGF0aFwiKSAmJlxuICAgICAgICAgICAgICAgICAgICBgW1ske3BbdGhpcy5maWVsZC5uYW1lXS5wYXRoLnJlcGxhY2UoXCIubWRcIiwgXCJcIil9XV1gID09PSBvXG4gICAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbi5zZWxlY3RlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHNlbGVjdC5hZGQob3B0aW9uKTtcbiAgICAgICAgICAgICAgICBzZWxlY3Qub25jaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGxldCBuZXdWYWx1ZSA9IFwiXCI7XG4gICAgICAgICAgICAgICAgICAgIGlmIChzZWxlY3QudmFsdWUgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3VmFsdWUgPSBzZWxlY3QudmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc2VsZWN0Q29udGFpbmVyKVxuICAgICAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZUNvbnRhaW5lcilcbiAgICAgICAgICAgICAgICAgICAgU2VsZWN0RmllbGQucmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBwW1wiZmlsZVwiXVtcInBhdGhcIl0sIHRoaXMuZmllbGQubmFtZSwgbmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zKS5mb3JFYWNoKG8gPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IG9wdGlvbiA9IG5ldyBPcHRpb24odGhpcy5maWVsZC5vcHRpb25zW29dLCBvKTtcbiAgICAgICAgICAgICAgICBpZiAocFt0aGlzLmZpZWxkLm5hbWVdID09PSB0aGlzLmZpZWxkLm9wdGlvbnNbb10gfHxcbiAgICAgICAgICAgICAgICAgICAgcFt0aGlzLmZpZWxkLm5hbWVdICYmXG4gICAgICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKHBbdGhpcy5maWVsZC5uYW1lXSkuaW5jbHVkZXMoXCJwYXRoXCIpICYmXG4gICAgICAgICAgICAgICAgICAgIGBbWyR7cFt0aGlzLmZpZWxkLm5hbWVdLnBhdGgucmVwbGFjZShcIi5tZFwiLCBcIlwiKX1dXWAgPT09IHRoaXMuZmllbGQub3B0aW9uc1tvXVxuICAgICAgICAgICAgICAgICkge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxlY3QuYWRkKG9wdGlvbik7XG4gICAgICAgICAgICAgICAgc2VsZWN0Lm9uY2hhbmdlID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgbmV3VmFsdWUgPSBcIlwiO1xuICAgICAgICAgICAgICAgICAgICBpZiAoc2VsZWN0LnZhbHVlICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld1ZhbHVlID0gdGhpcy5maWVsZC5vcHRpb25zW3NlbGVjdC52YWx1ZV1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZChzZWxlY3RDb250YWluZXIpXG4gICAgICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHZhbHVlQ29udGFpbmVyKVxuICAgICAgICAgICAgICAgICAgICBTZWxlY3RGaWVsZC5yZXBsYWNlVmFsdWVzKHBsdWdpbi5hcHAsIHBbXCJmaWxlXCJdW1wicGF0aFwiXSwgdGhpcy5maWVsZC5uYW1lLCBuZXdWYWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuXG4gICAgICAgIGRyb3BEb3duQnV0dG9uLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgZGlzbWlzc0J0bi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc2VsZWN0Q29udGFpbmVyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHZhbHVlQ29udGFpbmVyKVxuICAgICAgICB9XG5cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgfVxufSIsICJpbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCIuL0Fic3RyYWN0TGlzdEJhc2VkRmllbGRcIjtcbmltcG9ydCB7IEFwcCwgTWVudSwgVEZpbGUsIFRleHRDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBTZWxlY3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9TZWxlY3RNb2RhbFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHZhbHVlU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvdmFsdWVTZWxlY3RNb2RhbFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBDeWNsZUZpZWxkIGV4dGVuZHMgQWJzdHJhY3RMaXN0QmFzZWRGaWVsZCB7XG5cbiAgICB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PiA9IFtdO1xuICAgIHByZXNldFZhbHVlc0ZpZWxkczogSFRNTERpdkVsZW1lbnQ7XG5cbiAgICBjb25zdHJ1Y3RvcihmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIoZmllbGQsIEZpZWxkVHlwZS5DeWNsZSlcbiAgICB9XG5cbiAgICBhZGRNZW51T3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBjYXRlZ29yeTogTWVudSB8IFNlbGVjdE1vZGFsKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhvcHRpb25zKTtcbiAgICAgICAgY29uc3Qga2V5Rm9yVmFsdWUgPSBrZXlzLmZpbmQoa2V5ID0+IG9wdGlvbnNba2V5XSA9PT0gdmFsdWUpO1xuICAgICAgICBsZXQgbmV4dE9wdGlvbjogc3RyaW5nO1xuICAgICAgICBpZiAoa2V5Rm9yVmFsdWUpIHtcbiAgICAgICAgICAgIGNvbnN0IG5leHRLZXkgPSBrZXlzWyhrZXlzLmluZGV4T2Yoa2V5Rm9yVmFsdWUpICsgMSkgJSBrZXlzLmxlbmd0aF07XG4gICAgICAgICAgICBuZXh0T3B0aW9uID0gb3B0aW9uc1tuZXh0S2V5XTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5leHRPcHRpb24gPSBvcHRpb25zW09iamVjdC5rZXlzKG9wdGlvbnMpWzBdXTtcbiAgICAgICAgfTtcbiAgICAgICAgaWYgKEN5Y2xlRmllbGQuaXNNZW51KGNhdGVnb3J5KSkge1xuICAgICAgICAgICAgY2F0ZWdvcnkuYWRkSXRlbSgoaXRlbSkgPT4ge1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0VGl0bGUoYCR7bmFtZX0gOiAke3ZhbHVlfSBcdTI1QjcgJHtuZXh0T3B0aW9ufWApO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0SWNvbignc3dpdGNoJyk7XG4gICAgICAgICAgICAgICAgaXRlbS5vbkNsaWNrKCgpID0+IHJlcGxhY2VWYWx1ZXMoYXBwLCBmaWxlLCBuYW1lLCBuZXh0T3B0aW9uKSk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRTZWN0aW9uKFwidGFyZ2V0LW1ldGFkYXRhXCIpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSBpZiAoQ3ljbGVGaWVsZC5pc1NlbGVjdChjYXRlZ29yeSkpIHtcbiAgICAgICAgICAgIGNhdGVnb3J5LmFkZE9wdGlvbihgJHtuYW1lfV8ke3ZhbHVlfV8ke25leHRPcHRpb259YCwgYCR7bmFtZX0gOiAke3ZhbHVlfSBcdTI1QjcgJHtuZXh0T3B0aW9ufWApO1xuICAgICAgICAgICAgY2F0ZWdvcnkubW9kYWxzW2Ake25hbWV9XyR7dmFsdWV9XyR7bmV4dE9wdGlvbn1gXSA9ICgpID0+XG4gICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhhcHAsIGZpbGUsIG5hbWUsIG5leHRPcHRpb24pO1xuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBjcmVhdGVBbmRPcGVuRmllbGRNb2RhbChhcHA6IEFwcCwgZmlsZTogVEZpbGUsIHNlbGVjdGVkRmllbGROYW1lOiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCB0b3A/OiBib29sZWFuKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgdmFsdWVTZWxlY3RNb2RhbChhcHAsIGZpbGUsIFwiXCIsIHRoaXMuZmllbGQsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIHRvcCk7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3Qgb3B0aW9uIGZvciAke3NlbGVjdGVkRmllbGROYW1lfWApO1xuICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICB9XG5cbiAgICBhc3luYyBjcmVhdGVEdkZpZWxkKFxuICAgICAgICBwbHVnaW46IE1ldGFkYXRhTWVudSxcbiAgICAgICAgZHY6IGFueSxcbiAgICAgICAgcDogYW55LFxuICAgICAgICBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQsXG4gICAgICAgIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4gICAgKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IG9wdGlvbnMgPSB0aGlzLmZpZWxkLm9wdGlvbnM7XG4gICAgICAgIGNvbnN0IGtleXMgPSBPYmplY3Qua2V5cyhvcHRpb25zKTtcbiAgICAgICAgY29uc3Qga2V5Rm9yVmFsdWUgPSBrZXlzLmZpbmQoa2V5ID0+IG9wdGlvbnNba2V5XSA9PT0gcFt0aGlzLmZpZWxkLm5hbWVdKTtcbiAgICAgICAgbGV0IG5leHRPcHRpb246IHN0cmluZztcbiAgICAgICAgaWYgKGtleUZvclZhbHVlKSB7XG4gICAgICAgICAgICBjb25zdCBuZXh0S2V5ID0ga2V5c1soa2V5cy5pbmRleE9mKGtleUZvclZhbHVlKSArIDEpICUga2V5cy5sZW5ndGhdO1xuICAgICAgICAgICAgbmV4dE9wdGlvbiA9IG9wdGlvbnNbbmV4dEtleV07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXh0T3B0aW9uID0gb3B0aW9uc1tPYmplY3Qua2V5cyhvcHRpb25zKVswXV07XG4gICAgICAgIH07XG5cbiAgICAgICAgY29uc3QgZmllbGRWYWx1ZSA9IGR2LmVsKCdzcGFuJywgcFt0aGlzLmZpZWxkLm5hbWVdLCBhdHRycyk7XG4gICAgICAgIC8qIGVuZCBzcGFjZXIgKi9cbiAgICAgICAgY29uc3Qgc3BhY2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgc3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtc3BhY2VyXCIpO1xuICAgICAgICAvKiBidXR0b24gdG8gZGlzcGxheSBpbnB1dCAqL1xuICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICBidXR0b24uc2V0VGV4dChcIlx1MjVCNlx1RkUwRlwiKTtcbiAgICAgICAgYnV0dG9uLnNldEF0dHIoJ2NsYXNzJywgXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgYnV0dG9uLmhpZGUoKTtcbiAgICAgICAgc3BhY2VyLnNob3coKTtcbiAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICBidXR0b24uc2hvdygpO1xuICAgICAgICAgICAgc3BhY2VyLmhpZGUoKTtcbiAgICAgICAgfVxuICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3V0ID0gKCkgPT4ge1xuICAgICAgICAgICAgYnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIHNwYWNlci5zaG93KCk7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBidXR0b24gb24gY2xpY2sgOiBnbyB0byBuZXh0IHZlcnNpb24qL1xuICAgICAgICBidXR0b24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgICAgICBDeWNsZUZpZWxkLnJlcGxhY2VWYWx1ZXMocGx1Z2luLmFwcCwgcFtcImZpbGVcIl1bXCJwYXRoXCJdLCB0aGlzLmZpZWxkLm5hbWUsIG5leHRPcHRpb24pO1xuICAgICAgICAgICAgYnV0dG9uLmhpZGUoKTtcbiAgICAgICAgICAgIHNwYWNlci5zaG93KCk7XG4gICAgICAgIH1cblxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChidXR0b24pO1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKTtcbiAgICB9XG59IiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIFRvZ2dsZUNvbXBvbmVudCwgVEZpbGUsIEJ1dHRvbkNvbXBvbmVudCwgRXh0cmFCdXR0b25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgdmFsdWVNdWx0aVNlbGVjdE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIGZpZWxkOiBGaWVsZDtcbiAgICBwcml2YXRlIG9wdGlvbnM6IEFycmF5PHN0cmluZz47XG4gICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuO1xuICAgIHByaXZhdGUgdG9wOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBmaWVsZDogRmllbGQsIGluaXRpYWxPcHRpb25zOiBzdHJpbmcsIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLCBpbkZyb250TWF0dGVyOiBib29sZWFuID0gZmFsc2UsIHRvcDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLmZpZWxkID0gZmllbGQ7XG4gICAgICAgIGlmIChpbml0aWFsT3B0aW9ucykge1xuICAgICAgICAgICAgaWYgKGluaXRpYWxPcHRpb25zLnRvU3RyaW5nKCkuc3RhcnRzV2l0aChcIltbXCIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gaW5pdGlhbE9wdGlvbnMuc3BsaXQoXCIsXCIpLm1hcChpdGVtID0+IGl0ZW0udHJpbSgpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gaW5pdGlhbE9wdGlvbnMudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxbKC4qKVxcXSQvLCBcIiQxXCIpLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gW107XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMubGluZU51bWJlciA9IGxpbmVOdW1iZXI7XG4gICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlciA9IGluRnJvbnRNYXR0ZXI7XG4gICAgICAgIHRoaXMudG9wID0gdG9wO1xuICAgIH07XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51XCIpO1xuXG4gICAgICAgIGNvbnN0IHZhbHVlR3JpZCA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7XG4gICAgICAgICAgICBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1ncmlkXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGxpc3ROb3RlVmFsdWVzID0gYXdhaXQgRmllbGRTZXR0aW5nLmdldFZhbHVlc0xpc3RGcm9tTm90ZSh0aGlzLmZpZWxkLnZhbHVlc0xpc3ROb3RlUGF0aCwgdGhpcy5hcHApXG4gICAgICAgIGF3YWl0IHRoaXMucG9wdWxhdGVWYWx1ZXNHcmlkKHZhbHVlR3JpZCwgbGlzdE5vdGVWYWx1ZXMpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGFzeW5jIHBvcHVsYXRlVmFsdWVzR3JpZCh2YWx1ZUdyaWQ6IEhUTUxEaXZFbGVtZW50LCBsaXN0Tm90ZVZhbHVlczogc3RyaW5nW10pOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKGxpc3ROb3RlVmFsdWVzLmxlbmd0aCA9PT0gMCkge1xuICAgICAgICAgICAgT2JqZWN0LmtleXModGhpcy5maWVsZC5vcHRpb25zKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJlc2V0VmFsdWUgPSB0aGlzLmZpZWxkLm9wdGlvbnNba2V5XTtcbiAgICAgICAgICAgICAgICB0aGlzLmJ1aWxkVmFsdWVUb2dnbGVyKHZhbHVlR3JpZCwgcHJlc2V0VmFsdWUpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfTtcbiAgICAgICAgbGlzdE5vdGVWYWx1ZXMuZm9yRWFjaCh2YWx1ZSA9PiB7XG4gICAgICAgICAgICB0aGlzLmJ1aWxkVmFsdWVUb2dnbGVyKHZhbHVlR3JpZCwgdmFsdWUpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgZm9vdGVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZC1mb290ZXJcIiB9KTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnV0dG9uLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgaWYgKHRoaXMubGluZU51bWJlciA9PSAtMSkge1xuICAgICAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXModGhpcy5hcHAsIHRoaXMuZmlsZSwgdGhpcy5maWVsZC5uYW1lLCB0aGlzLm9wdGlvbnMuam9pbihcIixcIikpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBjb25zdCByZW5kZXJlZFZhbHVlcyA9ICF0aGlzLmluRnJvbnRtYXR0ZXIgPyB0aGlzLm9wdGlvbnMuam9pbihcIixcIikgOiB0aGlzLm9wdGlvbnMubGVuZ3RoID4gMSA/IGBbJHt0aGlzLm9wdGlvbnMuam9pbihcIiwgXCIpfV1gIDogdGhpcy5vcHRpb25zWzBdXG4gICAgICAgICAgICAgICAgaW5zZXJ0VmFsdWVzKHRoaXMuYXBwLCB0aGlzLmZpbGUsIHRoaXMuZmllbGQubmFtZSwgcmVuZGVyZWRWYWx1ZXMsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLnRvcCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEV4dHJhQnV0dG9uQ29tcG9uZW50KGZvb3Rlcik7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIik7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYnVpbGRWYWx1ZVRvZ2dsZXIodmFsdWVHcmlkOiBIVE1MRGl2RWxlbWVudCwgcHJlc2V0T3B0aW9uOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgdmFsdWVTZWxlY3RvckNvbnRhaW5lciA9IHZhbHVlR3JpZC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0b3ItY29udGFpbmVyXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlVG9nZ2xlckNvbnRhaW5lciA9IHZhbHVlU2VsZWN0b3JDb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLXRvZ2dsZXJcIlxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgdmFsdWVUb2dnbGVyID0gbmV3IFRvZ2dsZUNvbXBvbmVudCh2YWx1ZVRvZ2dsZXJDb250YWluZXIpO1xuICAgICAgICB0aGlzLm9wdGlvbnMuZm9yRWFjaChvcHRpb25zID0+IHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zID09IHByZXNldE9wdGlvbikge1xuICAgICAgICAgICAgICAgIHZhbHVlVG9nZ2xlci5zZXRWYWx1ZSh0cnVlKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhbHVlVG9nZ2xlci5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgJiYgIXRoaXMub3B0aW9ucy5pbmNsdWRlcyhwcmVzZXRPcHRpb24pKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnB1c2gocHJlc2V0T3B0aW9uKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAoIXZhbHVlKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zLnJlbW92ZShwcmVzZXRPcHRpb24pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlTGFiZWwgPSB2YWx1ZVNlbGVjdG9yQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLWxhYmVsXCIgfSk7XG4gICAgICAgIHZhbHVlTGFiZWwuc2V0VGV4dChwcmVzZXRPcHRpb24pO1xuICAgIH07XG59OyIsICJpbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCBBYnN0cmFjdExpc3RCYXNlZEZpZWxkIGZyb20gXCIuL0Fic3RyYWN0TGlzdEJhc2VkRmllbGRcIjtcbmltcG9ydCB7IEFwcCwgTWVudSwgVEZpbGUsIFRleHRDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBTZWxlY3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9TZWxlY3RNb2RhbFwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHZhbHVlTXVsdGlTZWxlY3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy92YWx1ZU11bHRpU2VsZWN0TW9kYWxcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTXVsdGlGaWVsZCBleHRlbmRzIEFic3RyYWN0TGlzdEJhc2VkRmllbGQge1xuXG4gICAgdmFsdWVzUHJvbXB0Q29tcG9uZW50czogQXJyYXk8VGV4dENvbXBvbmVudD4gPSBbXTtcbiAgICBwcmVzZXRWYWx1ZXNGaWVsZHM6IEhUTUxEaXZFbGVtZW50O1xuXG4gICAgY29uc3RydWN0b3IoZmllbGQ6IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKGZpZWxkLCBGaWVsZFR5cGUuTXVsdGkpXG4gICAgfVxuXG4gICAgYWRkTWVudU9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGFwcDogQXBwLCBmaWxlOiBURmlsZSwgY2F0ZWdvcnk6IE1lbnUgfCBTZWxlY3RNb2RhbCk6IHZvaWQge1xuICAgICAgICBjb25zdCBtb2RhbCA9IG5ldyB2YWx1ZU11bHRpU2VsZWN0TW9kYWwoYXBwLCBmaWxlLCB0aGlzLmZpZWxkLCB2YWx1ZSk7XG4gICAgICAgIG1vZGFsLnRpdGxlRWwuc2V0VGV4dChcIlNlbGVjdCB2YWx1ZXNcIik7XG4gICAgICAgIGlmIChNdWx0aUZpZWxkLmlzTWVudShjYXRlZ29yeSkpIHtcbiAgICAgICAgICAgIGNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcbiAgICAgICAgICAgICAgICBpdGVtLnNldFRpdGxlKGBVcGRhdGUgPCR7bmFtZX0+YCk7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRJY29uKCdidWxsZXQtbGlzdCcpO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiBtb2RhbC5vcGVuKCkpO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcInRhcmdldC1tZXRhZGF0YVwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKE11bHRpRmllbGQuaXNTZWxlY3QoY2F0ZWdvcnkpKSB7XG4gICAgICAgICAgICBjYXRlZ29yeS5hZGRPcHRpb24oYHVwZGF0ZV8ke25hbWV9YCwgYFVwZGF0ZSA8JHtuYW1lfT5gKTtcbiAgICAgICAgICAgIGNhdGVnb3J5Lm1vZGFsc1tgdXBkYXRlXyR7bmFtZX1gXSA9ICgpID0+IG1vZGFsLm9wZW4oKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgY3JlYXRlQW5kT3BlbkZpZWxkTW9kYWwoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBzZWxlY3RlZEZpZWxkTmFtZTogc3RyaW5nLCBsaW5lTnVtYmVyPzogbnVtYmVyLCBpbkZyb250bWF0dGVyPzogYm9vbGVhbiwgdG9wPzogYm9vbGVhbik6IHZvaWQge1xuICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IHZhbHVlTXVsdGlTZWxlY3RNb2RhbChhcHAsIGZpbGUsIHRoaXMuZmllbGQsIFwiXCIsIGxpbmVOdW1iZXIsIGluRnJvbnRtYXR0ZXIsIHRvcCk7XG4gICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3Qgb3B0aW9ucyBmb3IgJHtzZWxlY3RlZEZpZWxkTmFtZX1gKTtcbiAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgfVxuXG4gICAgYXN5bmMgY3JlYXRlRHZGaWVsZChcbiAgICAgICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgICAgIGR2OiBhbnksXG4gICAgICAgIHA6IGFueSxcbiAgICAgICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgICAgICBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuICAgICk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICAvKiBcbiAgICAgICAgdGhpcyBjb250cm9sIGRpc3BsYXlzIGJ5IGRlZmF1bHQgdGhlIGxpc3Qgb2YgdmFsdWVcbiAgICAgICAgd2hlbiBtb3VzZW92ZXI6IHdlIGRpc3BsYXkgYSBcIitcIiBidXR0b24gYXQgdGhlIGJlZ2dpbmluZyBvZiB0aGUgZmllbGQgdG8gYWRkIGEgbmV3IHZhbHVlIGFuZCBhIFwieFwiIGJ1dHRvbiBhZnRlciB0aGUgdmFsdWUgaG92ZXJlZCB0byByZW1vdmUgaXQgZnJvbSBsaXN0XG4gICAgICAgIHdoZW4gdGhlIFwieFwiIGJ1dHRvbiBpcyBjbGlja2VkLCB3ZSByZW1vdmUgdGhlIGxpc3QgZnJvbSB2YWx1ZVxuICAgICAgICB3aGVuIHRoZSBcIitcIiBidXR0b24gaXMgY2xpY2tlZCwgd2UgZGlzcGxheSBhIHNlbGVjdCBkcm9wZG93biBmaWx0ZXJlZCB3aXRoIHJlbWFpbmluZyBvcHRpb25zLiB3aGVuIG9uZSBvcHRpb24gaXMgc2VsZWN0ZWQgd2UgYWRkIGl0IHRvIHRoZSBsaXN0IGFuZCByZW1vdmUgdGhlIGNvbnRyb2xcbiAgICAgICAgKi9cbiAgICAgICAgbGV0IHZhbHVlSG92ZXJlZCA9IGZhbHNlO1xuICAgICAgICBsZXQgY3VycmVudFZhbHVlczogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgaWYgKHBbdGhpcy5maWVsZC5uYW1lXSkge1xuICAgICAgICAgICAgaWYgKE9iamVjdC5rZXlzKHBbdGhpcy5maWVsZC5uYW1lXSkuaW5jbHVkZXMoXCJwYXRoXCIpKSB7XG4gICAgICAgICAgICAgICAgY3VycmVudFZhbHVlcyA9IFtgW1ske3BbdGhpcy5maWVsZC5uYW1lXS5wYXRoLnJlcGxhY2UoXCIubWRcIiwgXCJcIil9XV1gXVxuICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHBbdGhpcy5maWVsZC5uYW1lXSkpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWVzLnB1c2goLi4ucFt0aGlzLmZpZWxkLm5hbWVdLmxhc3QoKS5zcGxpdChcIixcIikubWFwKCh2OiBzdHJpbmcpID0+IHYudHJpbSgpKSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRWYWx1ZXMgPSBwW3RoaXMuZmllbGQubmFtZV0uc3BsaXQoXCIsXCIpLm1hcCgodjogc3RyaW5nKSA9PiB2LnRyaW0oKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICAvKiBzZWxlY3QgY29udGFpbmVyICovXG4gICAgICAgIGNvbnN0IHNlbGVjdENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIik7XG4gICAgICAgIHNlbGVjdC5zZXRBdHRyKFwiY2xhc3NcIiwgXCJtZXRhZGF0YS1tZW51LWR2LXNlbGVjdFwiKTtcbiAgICAgICAgc2VsZWN0Q29udGFpbmVyLmFwcGVuZENoaWxkKHNlbGVjdClcbiAgICAgICAgY29uc3QgbnVsbE9wdGlvbiA9IG5ldyBPcHRpb24oXCItLXNlbGVjdC0tXCIsIHVuZGVmaW5lZCk7XG4gICAgICAgIHNlbGVjdC5hZGQobnVsbE9wdGlvbik7XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMuZmllbGQub3B0aW9ucylcbiAgICAgICAgICAgIC5maWx0ZXIobyA9PiAhY3VycmVudFZhbHVlcy5jb250YWlucyh0aGlzLmZpZWxkLm9wdGlvbnNbb10pKVxuICAgICAgICAgICAgLmZvckVhY2gobyA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3Qgb3B0aW9uID0gbmV3IE9wdGlvbih0aGlzLmZpZWxkLm9wdGlvbnNbb10sIG8pO1xuICAgICAgICAgICAgICAgIGlmIChwW3RoaXMuZmllbGQubmFtZV0gPT09IHRoaXMuZmllbGQub3B0aW9uc1tvXSkge1xuICAgICAgICAgICAgICAgICAgICBvcHRpb24uc2VsZWN0ZWQgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzZWxlY3QuYWRkKG9wdGlvbik7XG4gICAgICAgICAgICB9KVxuICAgICAgICBzZWxlY3Qub25jaGFuZ2UgPSAoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBuZXdWYWx1ZXMgPSBbLi4uY3VycmVudFZhbHVlcywgdGhpcy5maWVsZC5vcHRpb25zW3NlbGVjdC52YWx1ZV1dLmpvaW4oXCIsIFwiKTtcbiAgICAgICAgICAgIE11bHRpRmllbGQucmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBwW1wiZmlsZVwiXVtcInBhdGhcIl0sIHRoaXMuZmllbGQubmFtZSwgbmV3VmFsdWVzKVxuICAgICAgICAgICAgc2luZ2xlU3BhY2VyLmhpZGUoKTtcbiAgICAgICAgICAgIGRvdWJsZVNwYWNlci5zaG93KCk7XG4gICAgICAgICAgICBhZGRCdG4uaGlkZSgpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVzQ29udGFpbmVyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNpbmdsZVNwYWNlcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkb3VibGVTcGFjZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc2VsZWN0Q29udGFpbmVyKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHNlbGVjdC5vbmtleWRvd24gPSAoZSkgPT4ge1xuICAgICAgICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHZhbHVlc0NvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc2luZ2xlU3BhY2VyKTtcbiAgICAgICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChkb3VibGVTcGFjZXIpO1xuICAgICAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKHNlbGVjdENvbnRhaW5lcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgY2xvc2VTZWxlY3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuICAgICAgICBjbG9zZVNlbGVjdC5zZXRUZXh0KFwiXFx1Mjc0Q1wiKTtcbiAgICAgICAgY2xvc2VTZWxlY3QuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgY2xvc2VTZWxlY3QuYWRkQ2xhc3MoXCJtdWx0aVwiKTtcbiAgICAgICAgY2xvc2VTZWxlY3Qub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHZhbHVlc0NvbnRhaW5lcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzaW5nbGVTcGFjZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZG91YmxlU3BhY2VyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKHNlbGVjdENvbnRhaW5lcik7XG4gICAgICAgIH07XG4gICAgICAgIHNlbGVjdENvbnRhaW5lci5hcHBlbmRDaGlsZChjbG9zZVNlbGVjdCk7XG5cbiAgICAgICAgLyogY3VycmVudCB2YWx1ZXMgY29udGFpbmVyICovXG4gICAgICAgIGNvbnN0IHZhbHVlc0NvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgIHZhbHVlc0NvbnRhaW5lci5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtbXVsdGktdmFsdWVzLWNvbnRhaW5lclwiKTtcblxuICAgICAgICAvKiBjdXJyZW50IHZhbHVlcyAqL1xuICAgICAgICBjdXJyZW50VmFsdWVzLmZvckVhY2godiA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZUNvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICB2YWx1ZUNvbnRhaW5lci5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtbXVsdGktdmFsdWVzLWNvbnRhaW5lclwiKTtcblxuXG4gICAgICAgICAgICBjb25zdCB2YWx1ZVJlbW92ZUJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5zZXRUZXh0KFwiXHUyNzRDXCIpO1xuICAgICAgICAgICAgdmFsdWVSZW1vdmVCdG4uYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LWR2LWZpZWxkLWJ1dHRvblwiKTtcbiAgICAgICAgICAgIHZhbHVlUmVtb3ZlQnRuLmFkZENsYXNzKFwibXVsdGlcIik7XG4gICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5vbmNsaWNrID0gKCkgPT4ge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlbWFpbmluZ1ZhbHVlcyA9IGN1cnJlbnRWYWx1ZXMuZmlsdGVyKGNWID0+IGNWICE9PSB2KS5qb2luKFwiLCBcIilcbiAgICAgICAgICAgICAgICBNdWx0aUZpZWxkLnJlcGxhY2VWYWx1ZXMocGx1Z2luLmFwcCwgcFtcImZpbGVcIl1bXCJwYXRoXCJdLCB0aGlzLmZpZWxkLm5hbWUsIHJlbWFpbmluZ1ZhbHVlcyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB2YWx1ZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZVJlbW92ZUJ0bik7XG5cbiAgICAgICAgICAgIGNvbnN0IHZhbHVlTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICAgICAgdmFsdWVMYWJlbC5zZXRUZXh0KHYpO1xuICAgICAgICAgICAgdmFsdWVMYWJlbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtbXVsdGktdmFsdWUtbGFiZWxcIik7XG4gICAgICAgICAgICB2YWx1ZUNvbnRhaW5lci5hcHBlbmRDaGlsZCh2YWx1ZUxhYmVsKTtcblxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW92ZXIgPSAoKSA9PiB7XG4gICAgICAgICAgICAgICAgdmFsdWVIb3ZlcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHNpbmdsZVNwYWNlci5oaWRlKCk7XG4gICAgICAgICAgICAgICAgdmFsdWVSZW1vdmVCdG4uc2hvdygpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwuYWRkQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWVDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgICAgICB2YWx1ZUhvdmVyZWQgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2YWx1ZVJlbW92ZUJ0bi5oaWRlKCk7XG4gICAgICAgICAgICAgICAgc2luZ2xlU3BhY2VyLnNob3coKTtcbiAgICAgICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgICAgIHZhbHVlTGFiZWwucmVtb3ZlQ2xhc3MoXCJob3ZlcmVkXCIpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YWx1ZXNDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVDb250YWluZXIpO1xuICAgICAgICB9KVxuXG4gICAgICAgIC8qIGJ1dHRvbiB0byBkaXNwbGF5IGlucHV0ICovXG4gICAgICAgIGNvbnN0IGFkZEJ0biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG4gICAgICAgIGFkZEJ0bi5zZXRUZXh0KFwiXHUyNzk1XCIpO1xuICAgICAgICBhZGRCdG4uc2V0QXR0cignY2xhc3MnLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpO1xuICAgICAgICBhZGRCdG4uaGlkZSgpO1xuICAgICAgICB2YWx1ZXNDb250YWluZXIuYXBwZW5kQ2hpbGQoYWRkQnRuKTtcbiAgICAgICAgYWRkQnRuLm9uY2xpY2sgPSAoKSA9PiB7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5yZW1vdmVDaGlsZCh2YWx1ZXNDb250YWluZXIpO1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc2luZ2xlU3BhY2VyKTtcbiAgICAgICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGRvdWJsZVNwYWNlcik7XG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICB9XG5cbiAgICAgICAgLyogZW5kIHNwYWNlciAqL1xuICAgICAgICBjb25zdCBzaW5nbGVTcGFjZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xuICAgICAgICBzaW5nbGVTcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1zcGFjZXJcIilcbiAgICAgICAgY29uc3QgZG91YmxlU3BhY2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcbiAgICAgICAgZG91YmxlU3BhY2VyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtZG91YmxlLXNwYWNlclwiKVxuICAgICAgICBmaWVsZENvbnRhaW5lci5vbm1vdXNlb3ZlciA9ICgpID0+IHtcbiAgICAgICAgICAgIGFkZEJ0bi5zaG93KCk7XG4gICAgICAgICAgICBkb3VibGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgaWYgKCF2YWx1ZUhvdmVyZWQpIHNpbmdsZVNwYWNlci5zaG93KCk7XG4gICAgICAgIH1cbiAgICAgICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgICAgIGFkZEJ0bi5oaWRlKCk7XG4gICAgICAgICAgICBzaW5nbGVTcGFjZXIuaGlkZSgpO1xuICAgICAgICAgICAgZG91YmxlU3BhY2VyLnNob3coKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8qIGluaXRpYWwgc3RhdGUgKi9cbiAgICAgICAgc2luZ2xlU3BhY2VyLmhpZGUoKTtcbiAgICAgICAgZG91YmxlU3BhY2VyLnNob3coKTtcbiAgICAgICAgYWRkQnRuLmhpZGUoKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQodmFsdWVzQ29udGFpbmVyKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc2luZ2xlU3BhY2VyKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZG91YmxlU3BhY2VyKTtcbiAgICB9XG59XG4iLCAiaW1wb3J0IHsgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIFNldHRpbmdMb2NhdGlvbiB9IGZyb20gXCIuLi9GaWVsZE1hbmFnZXJcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwiLi4vRmllbGRcIjtcbmltcG9ydCB7IEFwcCwgVEZpbGUsIE1lbnUsIFRleHRBcmVhQ29tcG9uZW50LCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBTZWxlY3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy9TZWxlY3RNb2RhbFwiO1xuaW1wb3J0IG1haW4gZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWxlRnV6enlTdWdnZXN0ZXIgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvZmlsZUZ1enp5U3VnZ2VzdE1vZGFsXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nc01vZGFsIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbGVGaWVsZCBleHRlbmRzIEZpZWxkTWFuYWdlciB7XG5cbiAgICBwcml2YXRlIGZpbGVWYWxpZGF0b3JGaWVsZDogSFRNTERpdkVsZW1lbnRcbiAgICBwcml2YXRlIGR2UXVlcnlTdHJpbmc6IFRleHRBcmVhQ29tcG9uZW50XG5cbiAgICBjb25zdHJ1Y3RvcihmaWVsZDogRmllbGQpIHtcbiAgICAgICAgc3VwZXIoZmllbGQsIEZpZWxkVHlwZS5GaWxlKVxuICAgIH1cblxuICAgIHN0YXRpYyBidWlsZE1hcmtEb3duTGluayhhcHA6IEFwcCwgZmlsZTogVEZpbGUsIHBhdGg6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgICAgIGNvbnN0IGRlc3RGaWxlID0gYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Rmlyc3RMaW5rcGF0aERlc3QocGF0aCwgZmlsZS5wYXRoKVxuICAgICAgICBpZiAoZGVzdEZpbGUpIHtcbiAgICAgICAgICAgIHJldHVybiBhcHAuZmlsZU1hbmFnZXIuZ2VuZXJhdGVNYXJrZG93bkxpbmsoXG4gICAgICAgICAgICAgICAgZGVzdEZpbGUsXG4gICAgICAgICAgICAgICAgZmlsZS5wYXRoLFxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBkZXN0RmlsZS5iYXNlbmFtZVxuICAgICAgICAgICAgKVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBcIlwiXG4gICAgfVxuXG4gICAgZ2V0RmlsZXMgPSAoKTogVEZpbGVbXSA9PiB7XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBnZXRSZXN1bHRzID0gKGFwaTogRGF0YXZpZXdQbHVnaW5bXCJhcGlcIl0pID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChuZXcgRnVuY3Rpb24oXCJkdlwiLCBgcmV0dXJuICR7dGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmd9YCkpKGFwaSlcbiAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgbmV3IE5vdGljZShgV3JvbmcgcXVlcnkgZm9yIGZpZWxkIDwke3RoaXMuZmllbGQubmFtZX0+XFxuY2hlY2sgeW91ciBzZXR0aW5nc2AsIDMwMDApXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IGRhdGF2aWV3ID0gYXBwLnBsdWdpbnMucGx1Z2luc1tcImRhdGF2aWV3XCJdXG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBpZiAodGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZURhdGF2aWV3SnMgJiYgZGF0YXZpZXc/LnNldHRpbmdzLmVuYWJsZUlubGluZURhdGF2aWV3SnMpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZXNQYXRoID0gZ2V0UmVzdWx0cyhkYXRhdmlldy5hcGkpLnZhbHVlcy5tYXAoKHY6IGFueSkgPT4gdi5maWxlLnBhdGgpXG4gICAgICAgICAgICAgICAgcmV0dXJuIGFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZmlsdGVyKGYgPT4gZmlsZXNQYXRoLmluY2x1ZGVzKGYucGF0aCkpO1xuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAoZXJyb3IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIGFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBhZGRNZW51T3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBjYXRlZ29yeTogTWVudSB8IFNlbGVjdE1vZGFsKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVGdXp6eVN1Z2dlc3RlcihhcHAsIGZpbGUsIHRoaXMuZmllbGQpXG4gICAgICAgIG1vZGFsLnRpdGxlRWwuc2V0VGV4dChcIlNlbGVjdCB2YWx1ZVwiKTtcbiAgICAgICAgaWYgKEZpbGVGaWVsZC5pc01lbnUoY2F0ZWdvcnkpKSB7XG4gICAgICAgICAgICBjYXRlZ29yeS5hZGRJdGVtKChpdGVtKSA9PiB7XG4gICAgICAgICAgICAgICAgaXRlbS5zZXRUaXRsZShgVXBkYXRlICR7bmFtZX1gKTtcbiAgICAgICAgICAgICAgICBpdGVtLnNldEljb24oJ3NlYXJjaCcpO1xuICAgICAgICAgICAgICAgIGl0ZW0ub25DbGljaygoKSA9PiBtb2RhbC5vcGVuKCkpO1xuICAgICAgICAgICAgICAgIGl0ZW0uc2V0U2VjdGlvbihcInRhcmdldC1tZXRhZGF0YVwiKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2UgaWYgKEZpbGVGaWVsZC5pc1NlbGVjdChjYXRlZ29yeSkpIHtcbiAgICAgICAgICAgIGNhdGVnb3J5LmFkZE9wdGlvbihgdXBkYXRlXyR7bmFtZX1gLCBgVXBkYXRlIDwke25hbWV9PmApO1xuICAgICAgICAgICAgY2F0ZWdvcnkubW9kYWxzW2B1cGRhdGVfJHtuYW1lfWBdID0gKCkgPT4gbW9kYWwub3BlbigpO1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGNyZWF0ZUFuZE9wZW5GaWVsZE1vZGFsKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgc2VsZWN0ZWRGaWVsZE5hbWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIHRvcD86IGJvb2xlYW4pOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyBGaWxlRnV6enlTdWdnZXN0ZXIoYXBwLCBmaWxlLCB0aGlzLmZpZWxkLCBsaW5lTnVtYmVyLCBpbkZyb250bWF0dGVyLCB0b3ApO1xuICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgRW50ZXIgdmFsdWUgZm9yICR7c2VsZWN0ZWRGaWVsZE5hbWV9YCk7XG4gICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgIH1cblxuICAgIGNyZWF0ZUR2RmllbGQocGx1Z2luOiBtYWluLCBkdjogYW55LCBwOiBhbnksIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCwgYXR0cnM/OiB7IGNsczogc3RyaW5nOyBhdHRyOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+OyB9KTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWVDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gICAgICAgIGNvbnN0IGZpZWxkVmFsdWUgPSBkdi5lbCgnc3BhbicsIHBbdGhpcy5maWVsZC5uYW1lXSwgYXR0cnMpO1xuICAgICAgICBjb25zdCBzZWFyY2hCdG4gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpXG4gICAgICAgIHNlYXJjaEJ0bi5zZXRUZXh0KFwiXHVEODNEXHVERDBFXCIpXG4gICAgICAgIHNlYXJjaEJ0bi5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpXG4gICAgICAgIGZpZWxkVmFsdWVDb250YWluZXIuYXBwZW5kQ2hpbGQoZmllbGRWYWx1ZSk7XG4gICAgICAgIGZpZWxkVmFsdWVDb250YWluZXIuYXBwZW5kQ2hpbGQoc2VhcmNoQnRuKTtcbiAgICAgICAgY29uc3QgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBsZXQgZmllbGRNb2RhbDogRmlsZUZ1enp5U3VnZ2VzdGVyO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmllbGRNb2RhbCA9IG5ldyBGaWxlRnV6enlTdWdnZXN0ZXIoYXBwLCBmaWxlLCB0aGlzLmZpZWxkKVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KFwicGF0aCBkb2Vzbid0IGNvcnJlc3BvbmQgdG8gYSBwcm9wZXIgZmlsZVwiKTtcbiAgICAgICAgfVxuICAgICAgICBzZWFyY2hCdG4ub25jbGljayA9ICgpID0+IHtcbiAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpXG4gICAgICAgIH1cbiAgICAgICAgLyogaW5pdGlhbCBzdGF0ZSAqL1xuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlQ29udGFpbmVyKVxuXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoKTtcbiAgICB9XG5cbiAgICBjcmVhdGVGaWxlQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgZHZRdWVyeVN0cmluZ0NvbnRhaW5lciA9IHBhcmVudENvbnRhaW5lci5jcmVhdGVEaXYoKTtcbiAgICAgICAgZHZRdWVyeVN0cmluZ0NvbnRhaW5lci5jcmVhdGVFbChcInNwYW5cIiwgeyB0ZXh0OiBcIkRhdGF2aWV3IFF1ZXJ5IChvcHRpb25hbClcIiwgY2xzOiAnbWV0YWRhdGEtbWVudS1maWVsZC1vcHRpb24nIH0pO1xuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcgPSBuZXcgVGV4dEFyZWFDb21wb25lbnQoZHZRdWVyeVN0cmluZ0NvbnRhaW5lcik7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5pbnB1dEVsLmNvbHMgPSA2MDtcbiAgICAgICAgdGhpcy5kdlF1ZXJ5U3RyaW5nLmlucHV0RWwucm93cyA9IDY7XG4gICAgICAgIHRoaXMuZHZRdWVyeVN0cmluZy5zZXRWYWx1ZSh0aGlzLmZpZWxkLm9wdGlvbnMuZHZRdWVyeVN0cmluZyB8fCBcIlwiKTtcblxuICAgICAgICB0aGlzLmR2UXVlcnlTdHJpbmcub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWVsZC5vcHRpb25zLmR2UXVlcnlTdHJpbmcgPSB2YWx1ZTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IodGhpcy5kdlF1ZXJ5U3RyaW5nKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBjcmVhdGVTZXR0aW5nQ29udGFpbmVyKHBhcmVudENvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQsIHBsdWdpbjogbWFpbiwgbG9jYXRpb24/OiBTZXR0aW5nTG9jYXRpb24pOiB2b2lkIHtcbiAgICAgICAgdGhpcy5maWxlVmFsaWRhdG9yRmllbGQgPSBwYXJlbnRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbnVtYmVyLW9wdGlvbnNcIiB9KVxuICAgICAgICB0aGlzLmNyZWF0ZUZpbGVDb250YWluZXIodGhpcy5maWxlVmFsaWRhdG9yRmllbGQpXG4gICAgICAgIHRoaXMuZmlsZVZhbGlkYXRvckZpZWxkLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuICAgIH1cblxuICAgIGdldE9wdGlvbnNTdHIoKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZmllbGQub3B0aW9ucy5kdlF1ZXJ5U3RyaW5nIHx8IFwiXCI7XG4gICAgfVxuXG4gICAgdmFsaWRhdGVPcHRpb25zKCk6IGJvb2xlYW4ge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICB2YWxpZGF0ZVZhbHVlKHZhbHVlOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICAgICAgY29uc3QgYmFzZW5hbWUgPSB2YWx1ZS50cmltKCkucmVwbGFjZSgvXlxcW1xcWy9nLCBcIlwiKS5yZXBsYWNlKC9cXF1cXF0kL2csIFwiXCIpXG4gICAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoISF0aGlzLmdldEZpbGVzKCkubWFwKGYgPT4gZi5iYXNlbmFtZSkuZmluZChpdGVtID0+IGl0ZW0gPT09IGJhc2VuYW1lKSlcbiAgICB9XG59IiwgImltcG9ydCB7IFRGaWxlLCBBcHAsIEZ1enp5U3VnZ2VzdE1vZGFsLCBOb3RpY2UgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9pbnNlcnRWYWx1ZXNcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IEZpbGVGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9maWVsZE1hbmFnZXJzL0ZpbGVGaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlRnV6enlTdWdnZXN0ZXIgZXh0ZW5kcyBGdXp6eVN1Z2dlc3RNb2RhbDxURmlsZT4ge1xuXG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIGZpZWxkOiBGaWVsZDtcbiAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlcjtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSB0b3A6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGZpZWxkOiBGaWVsZCwgbGluZU51bWJlcjogbnVtYmVyID0gLTEsIGluRnJvbnRNYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSwgdG9wOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgICAgIHRoaXMuZmllbGQgPSBmaWVsZDtcbiAgICAgICAgdGhpcy5saW5lTnVtYmVyID0gbGluZU51bWJlcjtcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gaW5Gcm9udE1hdHRlcjtcbiAgICAgICAgdGhpcy50b3AgPSB0b3A7XG4gICAgfVxuXG4gICAgZ2V0SXRlbXMoKTogVEZpbGVbXSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbdGhpcy5maWVsZC50eXBlXSh0aGlzLmZpZWxkKTtcbiAgICAgICAgICAgIHJldHVybiBmaWxlTWFuYWdlci5nZXRGaWxlcygpO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdldEl0ZW1UZXh0KGl0ZW06IFRGaWxlKTogc3RyaW5nIHtcbiAgICAgICAgcmV0dXJuIGl0ZW0uYmFzZW5hbWU7XG4gICAgfVxuXG4gICAgb25DaG9vc2VJdGVtKGl0ZW06IFRGaWxlKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXMoXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICAgICAgdGhpcy5maWxlLFxuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSxcbiAgICAgICAgICAgICAgICBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsodGhpcy5hcHAsIHRoaXMuZmlsZSwgaXRlbS5iYXNlbmFtZSlcbiAgICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpbnNlcnRWYWx1ZXMoXG4gICAgICAgICAgICAgICAgdGhpcy5hcHAsXG4gICAgICAgICAgICAgICAgdGhpcy5maWxlLFxuICAgICAgICAgICAgICAgIHRoaXMuZmllbGQubmFtZSxcbiAgICAgICAgICAgICAgICBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsodGhpcy5hcHAsIHRoaXMuZmlsZSwgaXRlbS5iYXNlbmFtZSksXG4gICAgICAgICAgICAgICAgdGhpcy5saW5lTnVtYmVyLFxuICAgICAgICAgICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlcixcbiAgICAgICAgICAgICAgICB0aGlzLnRvcFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfTtcbiAgICB9XG5cbn0iLCAiaW1wb3J0IElucHV0IGZyb20gJy4vSW5wdXRGaWVsZCdcbmltcG9ydCBCb29sZWFuIGZyb20gJy4vQm9vbGVhbkZpZWxkJ1xuaW1wb3J0IE51bWJlciBmcm9tICcuL051bWJlckZpZWxkJ1xuaW1wb3J0IFNlbGVjdCBmcm9tICcuL1NlbGVjdEZpZWxkJ1xuaW1wb3J0IEN5Y2xlIGZyb20gJy4vQ3ljbGVGaWVsZCdcbmltcG9ydCBNdWx0aSBmcm9tICcuL011bHRpRmllbGQnXG5pbXBvcnQgRmlsZSBmcm9tICcuL0ZpbGVGaWVsZCdcblxuY29uc3QgTWFuYWdlcnMgPSB7XG4gICAgSW5wdXQsXG4gICAgQm9vbGVhbixcbiAgICBOdW1iZXIsXG4gICAgU2VsZWN0LFxuICAgIEN5Y2xlLFxuICAgIE11bHRpLFxuICAgIEZpbGVcbn1cblxuZXhwb3J0IGRlZmF1bHQgTWFuYWdlcnMiLCAiaW1wb3J0IE1hbmFnZXJzIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvTWFuYWdlcnNcIjtcblxuZXhwb3J0IGNvbnN0IGVudW0gRmllbGRUeXBlIHtcbiAgICAnSW5wdXQnID0gXCJJbnB1dFwiLFxuICAgICdTZWxlY3QnID0gXCJTZWxlY3RcIixcbiAgICAnTXVsdGknID0gXCJNdWx0aVwiLFxuICAgICdDeWNsZScgPSBcIkN5Y2xlXCIsXG4gICAgJ0Jvb2xlYW4nID0gXCJCb29sZWFuXCIsXG4gICAgXCJOdW1iZXJcIiA9IFwiTnVtYmVyXCIsXG4gICAgXCJGaWxlXCIgPSBcIkZpbGVcIlxufVxuXG5leHBvcnQgY29uc3QgRmllbGRUeXBlTGFiZWxNYXBwaW5nOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgRmllbGRUeXBlPiA9IHtcbiAgICBcIklucHV0XCI6IEZpZWxkVHlwZS5JbnB1dCxcbiAgICBcIlNlbGVjdFwiOiBGaWVsZFR5cGUuU2VsZWN0LFxuICAgIFwiTXVsdGlcIjogRmllbGRUeXBlLk11bHRpLFxuICAgIFwiQ3ljbGVcIjogRmllbGRUeXBlLkN5Y2xlLFxuICAgIFwiQm9vbGVhblwiOiBGaWVsZFR5cGUuQm9vbGVhbixcbiAgICBcIk51bWJlclwiOiBGaWVsZFR5cGUuTnVtYmVyLFxuICAgIFwiRmlsZVwiOiBGaWVsZFR5cGUuRmlsZVxufTtcblxuZXhwb3J0IGNvbnN0IEZpZWxkVHlwZVRhZ0NsYXNzOiBSZWNvcmQ8a2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgc3RyaW5nPiA9IHtcbiAgICBcIklucHV0XCI6IFwic2luZ2xlXCIsXG4gICAgXCJTZWxlY3RcIjogXCJzZWxlY3RcIixcbiAgICBcIk11bHRpXCI6IFwibXVsdGlcIixcbiAgICBcIkN5Y2xlXCI6IFwiY3ljbGVcIixcbiAgICBcIkJvb2xlYW5cIjogXCJib29sZWFuXCIsXG4gICAgXCJOdW1iZXJcIjogXCJudW1iZXJcIixcbiAgICBcIkZpbGVcIjogXCJmaWxlXCJcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkVHlwZVRvb2x0aXA6IFJlY29yZDxrZXlvZiB0eXBlb2YgRmllbGRUeXBlLCBzdHJpbmc+ID0ge1xuICAgIFwiSW5wdXRcIjogXCJBY2NlcHQgYW55IHZhbHVlXCIsXG4gICAgXCJTZWxlY3RcIjogXCJBY2NlcHQgYSBzaW5nbGUgdmFsdWUgZnJvbSBhIGxpc3RcIixcbiAgICBcIk11bHRpXCI6IFwiQWNjZXB0IG11bHRpcGxlIHZhbHVlcyBmcm9tIGEgbGlzdFwiLFxuICAgIFwiQ3ljbGVcIjogXCJDeWNsZSB0aHJvdWdoIHZhbHVlcyBmcm9tIGEgbGlzdFwiLFxuICAgIFwiQm9vbGVhblwiOiBcIkFjY2VwdCB0cnVlIG9mIGZhbHNlXCIsXG4gICAgXCJOdW1iZXJcIjogXCJBY2NlcHQgYSBudW1iZXJcIixcbiAgICBcIkZpbGVcIjogXCJBY2NlcHQgYSBsaW5rIHRvIGEgZmlsZSBpbiB5b3VyIHZhdWx0XCJcbn1cblxuZXhwb3J0IGNvbnN0IEZpZWxkTWFuYWdlcjogUmVjb3JkPGtleW9mIHR5cGVvZiBGaWVsZFR5cGUsIGFueT4gPSB7XG4gICAgXCJJbnB1dFwiOiBNYW5hZ2Vycy5JbnB1dCxcbiAgICBcIlNlbGVjdFwiOiBNYW5hZ2Vycy5TZWxlY3QsXG4gICAgXCJNdWx0aVwiOiBNYW5hZ2Vycy5NdWx0aSxcbiAgICBcIkN5Y2xlXCI6IE1hbmFnZXJzLkN5Y2xlLFxuICAgIFwiQm9vbGVhblwiOiBNYW5hZ2Vycy5Cb29sZWFuLFxuICAgIFwiTnVtYmVyXCI6IE1hbmFnZXJzLk51bWJlcixcbiAgICBcIkZpbGVcIjogTWFuYWdlcnMuRmlsZVxufSIsICJpbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwiLi4vdHlwZXMvZmllbGRUeXBlc1wiXG5cbmludGVyZmFjZSBGaWVsZCB7XG4gICAgaWQ6IHN0cmluZztcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgb3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICB2YWx1ZXNMaXN0Tm90ZVBhdGg6IHN0cmluZztcbiAgICB0eXBlOiBGaWVsZFR5cGVcbn1cblxuY2xhc3MgRmllbGQge1xuXG4gICAgY29uc3RydWN0b3IobmFtZTogc3RyaW5nID0gXCJcIixcbiAgICAgICAgb3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9LFxuICAgICAgICBpZDogc3RyaW5nID0gXCJcIixcbiAgICAgICAgdmFsdWVzTGlzdE5vdGVQYXRoOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICB0eXBlOiBGaWVsZFR5cGUgPSBGaWVsZFR5cGUuSW5wdXRcbiAgICApIHtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5vcHRpb25zID0gb3B0aW9ucztcbiAgICAgICAgdGhpcy5pZCA9IGlkO1xuICAgICAgICB0aGlzLnZhbHVlc0xpc3ROb3RlUGF0aCA9IHZhbHVlc0xpc3ROb3RlUGF0aDtcbiAgICAgICAgdGhpcy50eXBlID0gdHlwZVxuICAgICAgICB0aGlzLmluc2VydE5ld1ZhbHVlLmJpbmQodGhpcyk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBhc3luYyBpbnNlcnROZXdWYWx1ZSh2YWx1ZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgbGV0IG5ld0tleSA9IDE7XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMub3B0aW9ucykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgaWYgKHBhcnNlSW50KGtleSkgJiYgcGFyc2VJbnQoa2V5KSA+PSBuZXdLZXkpIHtcbiAgICAgICAgICAgICAgICBuZXdLZXkgPSBwYXJzZUludChrZXkpICsgMTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICB0aGlzLm9wdGlvbnNbbmV3S2V5LnRvU3RyaW5nKCldID0gdmFsdWU7XG4gICAgICAgIHJldHVybiBuZXdLZXkudG9TdHJpbmcoKTtcbiAgICB9O1xuXG4gICAgc3RhdGljIGNvcHlQcm9wZXJ0eSh0YXJnZXQ6IEZpZWxkLCBzb3VyY2U6IEZpZWxkKSB7XG4gICAgICAgIHRhcmdldC5pZCA9IHNvdXJjZS5pZDtcbiAgICAgICAgdGFyZ2V0Lm5hbWUgPSBzb3VyY2UubmFtZTtcbiAgICAgICAgdGFyZ2V0LnZhbHVlc0xpc3ROb3RlUGF0aCA9IHNvdXJjZS52YWx1ZXNMaXN0Tm90ZVBhdGg7XG4gICAgICAgIHRhcmdldC50eXBlID0gc291cmNlLnR5cGVcbiAgICAgICAgT2JqZWN0LmtleXMoc291cmNlLm9wdGlvbnMpLmZvckVhY2goayA9PiB7XG4gICAgICAgICAgICB0YXJnZXQub3B0aW9uc1trXSA9IHNvdXJjZS5vcHRpb25zW2tdO1xuICAgICAgICB9KTtcbiAgICAgICAgT2JqZWN0LmtleXModGFyZ2V0Lm9wdGlvbnMpLmZvckVhY2goayA9PiB7XG4gICAgICAgICAgICBpZiAoIU9iamVjdC5rZXlzKHNvdXJjZS5vcHRpb25zKS5pbmNsdWRlcyhrKSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXQub3B0aW9uc1trXTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwdWJsaWMgc3RhdGljIGNyZWF0ZURlZmF1bHQobmFtZTogc3RyaW5nKTogRmllbGQge1xuICAgICAgICBjb25zdCBmaWVsZCA9IG5ldyBGaWVsZCgpO1xuICAgICAgICBmaWVsZC50eXBlID0gRmllbGRUeXBlLklucHV0O1xuICAgICAgICBmaWVsZC5uYW1lID0gbmFtZTtcbiAgICAgICAgcmV0dXJuIGZpZWxkO1xuICAgIH1cbn07XG5cbmV4cG9ydCBkZWZhdWx0IEZpZWxkOyIsICIvLyBDcmVkaXRzIGdvIHRvIExpYW0ncyBQZXJpb2RpYyBOb3RlcyBQbHVnaW46IGh0dHBzOi8vZ2l0aHViLmNvbS9saWFtY2Fpbi9vYnNpZGlhbi1wZXJpb2RpYy1ub3Rlc1xuXG5pbXBvcnQgeyBUQWJzdHJhY3RGaWxlLCBURm9sZGVyIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBUZXh0SW5wdXRTdWdnZXN0IH0gZnJvbSBcIi4vc3VnZ2VzdFwiO1xuXG5leHBvcnQgY2xhc3MgRm9sZGVyU3VnZ2VzdCBleHRlbmRzIFRleHRJbnB1dFN1Z2dlc3Q8VEZvbGRlcj4ge1xuICAgIGdldFN1Z2dlc3Rpb25zKGlucHV0U3RyOiBzdHJpbmcpOiBURm9sZGVyW10ge1xuICAgICAgICBjb25zdCBhYnN0cmFjdEZpbGVzID0gdGhpcy5hcHAudmF1bHQuZ2V0QWxsTG9hZGVkRmlsZXMoKTtcbiAgICAgICAgY29uc3QgZm9sZGVyczogVEZvbGRlcltdID0gW107XG4gICAgICAgIGNvbnN0IGxvd2VyQ2FzZUlucHV0U3RyID0gaW5wdXRTdHIudG9Mb3dlckNhc2UoKTtcblxuICAgICAgICBhYnN0cmFjdEZpbGVzLmZvckVhY2goKGZvbGRlcjogVEFic3RyYWN0RmlsZSkgPT4ge1xuICAgICAgICAgICAgaWYgKFxuICAgICAgICAgICAgICAgIGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIgJiZcbiAgICAgICAgICAgICAgICBmb2xkZXIucGF0aC50b0xvd2VyQ2FzZSgpLmNvbnRhaW5zKGxvd2VyQ2FzZUlucHV0U3RyKVxuICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgZm9sZGVycy5wdXNoKGZvbGRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBmb2xkZXJzO1xuICAgIH1cblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oZmlsZTogVEZvbGRlciwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLnNldFRleHQoZmlsZS5wYXRoKTtcbiAgICB9XG5cbiAgICBzZWxlY3RTdWdnZXN0aW9uKGZpbGU6IFRGb2xkZXIpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5pbnB1dEVsLnZhbHVlID0gZmlsZS5wYXRoO1xuICAgICAgICB0aGlzLmlucHV0RWwudHJpZ2dlcihcImlucHV0XCIpO1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgfVxufVxuIiwgImltcG9ydCBGaWVsZCBmcm9tIFwic3JjL2ZpZWxkcy9GaWVsZFwiO1xuXG5leHBvcnQgaW50ZXJmYWNlIE1ldGFkYXRhTWVudVNldHRpbmdzIHtcblx0cHJlc2V0RmllbGRzOiBBcnJheTxGaWVsZD47XG5cdGRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51OiBib29sZWFuO1xuXHRnbG9iYWxseUlnbm9yZWRGaWVsZHM6IEFycmF5PHN0cmluZz47XG5cdGNsYXNzRmlsZXNQYXRoOiBzdHJpbmc7XG5cdGlzQXV0b3N1Z2dlc3RFbmFibGVkOiBib29sZWFuO1xuXHRmaWxlQ2xhc3NBbGlhczogc3RyaW5nO1xuXHRzZXR0aW5nc1ZlcnNpb24/OiBudW1iZXI7XG5cdGdsb2JhbEZpbGVDbGFzcz86IHN0cmluZztcbn1cblxuZXhwb3J0IGNvbnN0IERFRkFVTFRfU0VUVElOR1M6IE1ldGFkYXRhTWVudVNldHRpbmdzID0ge1xuXHRwcmVzZXRGaWVsZHM6IFtdLFxuXHRkaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudTogdHJ1ZSxcblx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzOiBbXSxcblx0Y2xhc3NGaWxlc1BhdGg6IFwiXCIsXG5cdGlzQXV0b3N1Z2dlc3RFbmFibGVkOiB0cnVlLFxuXHRmaWxlQ2xhc3NBbGlhczogXCJmaWxlQ2xhc3NcIixcblx0c2V0dGluZ3NWZXJzaW9uOiB1bmRlZmluZWQsXG5cdGdsb2JhbEZpbGVDbGFzczogdW5kZWZpbmVkLFxufTsiLCAiaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgeyBpbmxpbmVGaWVsZFJlZ2V4LCBlbmNvZGVMaW5rLCBkZWNvZGVMaW5rIH0gZnJvbSBcInNyYy91dGlscy9wYXJzZXJcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGdldFZhbHVlcyhhcHA6IEFwcCwgZmlsZU9yZmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZyk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPcmZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPcmZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlT3JmaWxlUGF0aClcbiAgICAgICAgaWYgKF9maWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgX2ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmlsZSA9IF9maWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGNvbnRlbnQgPSAoYXdhaXQgYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSkpLnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcjtcbiAgICBjb25zdCB7IHBvc2l0aW9uOiB7IHN0YXJ0LCBlbmQgfSB9ID0gZnJvbnRtYXR0ZXIgPyBmcm9udG1hdHRlciA6IHsgcG9zaXRpb246IHsgc3RhcnQ6IHVuZGVmaW5lZCwgZW5kOiB1bmRlZmluZWQgfSB9O1xuICAgIGNvbnN0IHJlc3VsdDogc3RyaW5nW10gPSBbXTtcbiAgICBjb250ZW50Lm1hcCgobGluZSwgaSkgPT4ge1xuICAgICAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgaSA+PSBzdGFydC5saW5lICYmIGkgPD0gZW5kLmxpbmUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgJHthdHRyaWJ1dGV9OiguKilgLCAndScpO1xuICAgICAgICAgICAgY29uc3QgciA9IGxpbmUubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgaWYgKHIgJiYgci5sZW5ndGggPiAwKSByZXN1bHQucHVzaChyWzFdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGZ1bGxMaW5lUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtpbmxpbmVGaWVsZFJlZ2V4KGF0dHJpYnV0ZSl9YCwgXCJ1XCIpO1xuICAgICAgICAgICAgY29uc3QgZlIgPSBlbmNvZGVMaW5rKGxpbmUpLm1hdGNoKGZ1bGxMaW5lUmVnZXgpO1xuICAgICAgICAgICAgaWYgKGZSPy5ncm91cHMpIHsgcmVzdWx0LnB1c2goZGVjb2RlTGluayhmUi5ncm91cHMudmFsdWVzKSkgfTtcbiAgICAgICAgICAgIGNvbnN0IGluU2VudGVuY2VSZWdleEJyYWNrZXRzID0gbmV3IFJlZ0V4cChgXFxcXFske2lubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKX1cXFxcXWAsIFwiZ3VcIik7XG4gICAgICAgICAgICBjb25zdCBzUkIgPSBlbmNvZGVMaW5rKGxpbmUpLm1hdGNoQWxsKGluU2VudGVuY2VSZWdleEJyYWNrZXRzKTtcbiAgICAgICAgICAgIGxldCBuZXh0ID0gc1JCLm5leHQoKTtcbiAgICAgICAgICAgIHdoaWxlICghbmV4dC5kb25lKSB7XG4gICAgICAgICAgICAgICAgaWYgKG5leHQudmFsdWUuZ3JvdXBzKSB7IHJlc3VsdC5wdXNoKGRlY29kZUxpbmsobmV4dC52YWx1ZS5ncm91cHMudmFsdWVzKSkgfVxuICAgICAgICAgICAgICAgIG5leHQgPSBzUkIubmV4dCgpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjb25zdCBpblNlbnRlbmNlUmVnZXhQYXIgPSBuZXcgUmVnRXhwKGBcXFxcKCR7aW5saW5lRmllbGRSZWdleChhdHRyaWJ1dGUpfVxcXFwpYCwgXCJndVwiKTtcbiAgICAgICAgICAgIGNvbnN0IHNSUCA9IGVuY29kZUxpbmsobGluZSkubWF0Y2hBbGwoaW5TZW50ZW5jZVJlZ2V4UGFyKTtcbiAgICAgICAgICAgIG5leHQgPSBzUlAubmV4dCgpO1xuICAgICAgICAgICAgd2hpbGUgKCFuZXh0LmRvbmUpIHtcbiAgICAgICAgICAgICAgICBpZiAobmV4dC52YWx1ZS5ncm91cHMpIHsgcmVzdWx0LnB1c2goZGVjb2RlTGluayhuZXh0LnZhbHVlLmdyb3Vwcy52YWx1ZXMpKSB9XG4gICAgICAgICAgICAgICAgbmV4dCA9IHNSUC5uZXh0KClcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIHJlc3VsdDtcbn0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcblxuZXhwb3J0IGZ1bmN0aW9uIGdldEZpZWxkKHBsdWdpbjogTWV0YWRhdGFNZW51LCBwcm9wZXJ0eU5hbWU6IHN0cmluZywgZmlsZUNsYXNzPzogRmlsZUNsYXNzKTogRmllbGQgfCB1bmRlZmluZWQge1xuICAgIGNvbnN0IG1hdGNoaW5nU2V0dGluZ3MgPSBwbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLmZpbHRlcihwID0+IHAubmFtZSA9PSBwcm9wZXJ0eU5hbWUpO1xuICAgIGlmIChmaWxlQ2xhc3MpIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzQXR0cmlidXRlc1dpdGhOYW1lID0gZmlsZUNsYXNzLmF0dHJpYnV0ZXMuZmlsdGVyKGF0dHIgPT4gYXR0ci5uYW1lID09IHByb3BlcnR5TmFtZSk7XG4gICAgICAgIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQXR0cmlidXRlID0gZmlsZUNsYXNzQXR0cmlidXRlc1dpdGhOYW1lWzBdO1xuICAgICAgICAgICAgaWYgKGZpbGVDbGFzc0F0dHJpYnV0ZS50eXBlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZpbGVDbGFzc0F0dHJpYnV0ZS5nZXRGaWVsZCgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChtYXRjaGluZ1NldHRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gbWF0Y2hpbmdTZXR0aW5nc1swXTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICB9IGVsc2UgaWYgKG1hdGNoaW5nU2V0dGluZ3MubGVuZ3RoID4gMCkge1xuICAgICAgICByZXR1cm4gbWF0Y2hpbmdTZXR0aW5nc1swXTtcbiAgICB9O1xufTsiLCAiZXhwb3J0IGNvbnN0IGNhcGl0YWxpemUgPSAoczogc3RyaW5nKSA9PiB7XG4gICAgcmV0dXJuIHMgJiYgc1swXS50b1VwcGVyQ2FzZSgpICsgcy5zbGljZSgxKTtcbn0iLCAiaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUsIEZpZWxkVHlwZUxhYmVsTWFwcGluZyB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgY2FwaXRhbGl6ZSB9IGZyb20gXCJzcmMvdXRpbHMvdGV4dFV0aWxzXCI7XG5pbXBvcnQgeyBnZW5lcmljRmllbGRSZWdleCB9IGZyb20gXCJzcmMvdXRpbHMvcGFyc2VyXCI7XG5cbmludGVyZmFjZSBGaWxlQ2xhc3NBdHRyaWJ1dGUge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0eXBlOiBGaWVsZFR5cGU7XG4gICAgb3B0aW9uczogc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+O1xuICAgIG9yaWdpbjogc3RyaW5nO1xufVxuXG5jbGFzcyBGaWxlQ2xhc3NBdHRyaWJ1dGUge1xuXG4gICAgY29uc3RydWN0b3IocmF3OiBzdHJpbmcsIG9yaWdpbjogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMub3JpZ2luID0gb3JpZ2luXG4gICAgICAgIGNvbnN0IGNvbXBsZXRlUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH06Oig/PGZpZWxkU2V0dGluZ3M+LispP2AsIFwidVwiKTtcbiAgICAgICAgY29uc3QgbmFtZVJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9JGAsIFwidVwiKTtcbiAgICAgICAgbGV0IGZpZWxkTmFtZTogc3RyaW5nXG4gICAgICAgIGxldCB7IGF0dHJpYnV0ZSwgZmllbGRTZXR0aW5ncyB9ID0gcmF3Lm1hdGNoKGNvbXBsZXRlUmVnZXgpPy5ncm91cHMgfHwge31cbiAgICAgICAgaWYgKGF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgZmllbGROYW1lID0gYXR0cmlidXRlXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgeyBhdHRyaWJ1dGUgfSA9IHJhdy5tYXRjaChuYW1lUmVnZXgpPy5ncm91cHMgfHwge31cbiAgICAgICAgICAgIGZpZWxkTmFtZSA9IGF0dHJpYnV0ZVxuICAgICAgICB9XG4gICAgICAgIGlmIChmaWVsZE5hbWUpIHtcbiAgICAgICAgICAgIHRoaXMubmFtZSA9IGZpZWxkTmFtZS50cmltKCk7XG4gICAgICAgICAgICBpZiAoZmllbGRTZXR0aW5ncykge1xuICAgICAgICAgICAgICAgIGNvbnN0IHNldHRpbmdzID0gSlNPTi5wYXJzZShgJHtmaWVsZFNldHRpbmdzLnRyaW0oKX1gKTtcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBGaWVsZFR5cGVMYWJlbE1hcHBpbmdbY2FwaXRhbGl6ZShzZXR0aW5nc1sndHlwZSddKSBhcyBrZXlvZiB0eXBlb2YgRmllbGRUeXBlXTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBzZXR0aW5nc1snb3B0aW9ucyddO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICB0aGlzLnR5cGUgPSBGaWVsZFR5cGUuSW5wdXQgLy8gZGVmYXVsdCB0eXBlIHdoZW4gbm8gc2V0dGluZyBpcyBwcm92aWRlZFxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJJbXByb3BlciB2YWx1ZVwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldEZpZWxkKCkge1xuICAgICAgICBsZXQgb3B0aW9uczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheSh0aGlzLm9wdGlvbnMpKSB7XG4gICAgICAgICAgICB0aGlzLm9wdGlvbnM/LmZvckVhY2goKG9wdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgICAgICBvcHRpb25zW2luZGV4XSA9IG9wdGlvbjtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBvcHRpb25zID0gdGhpcy5vcHRpb25zXG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG5ldyBGaWVsZCh0aGlzLm5hbWUsIG9wdGlvbnMsIHRoaXMubmFtZSwgdW5kZWZpbmVkLCB0aGlzLnR5cGUpO1xuICAgIH1cbn1cblxuZXhwb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlIH07IiwgImltcG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZSB9IGZyb20gXCIuL2ZpbGVDbGFzc0F0dHJpYnV0ZVwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5pbnRlcmZhY2UgRmlsZUNsYXNzIHtcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgYXR0cmlidXRlczogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbiAgICBvYmplY3RzOiBGaWxlQ2xhc3NNYW5hZ2VyO1xuICAgIGVycm9yczogc3RyaW5nW107XG4gICAgcGFyZW50PzogRmlsZUNsYXNzO1xuICAgIGV4Y2x1ZGVzPzogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbn1cblxuY2xhc3MgRmlsZUNsYXNzTWFuYWdlciB7XG4gICAgcHVibGljIGluc3RhbmNlOiBGaWxlQ2xhc3M7XG5cbiAgICBjb25zdHJ1Y3RvcihpbnN0YW5jZTogRmlsZUNsYXNzKSB7XG4gICAgICAgIHRoaXMuaW5zdGFuY2UgPSBpbnN0YW5jZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgYWxsKCkge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhGaWxlQ2xhc3NOYW1lID0gdGhpcy5pbnN0YW5jZS5wbHVnaW4uYXBwLnZhdWx0LmdldE1hcmtkb3duRmlsZXMoKS5maWx0ZXIoZmlsZSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjYWNoZSA9IHRoaXMuaW5zdGFuY2UucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKTtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gdGhpcy5pbnN0YW5jZS5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG4gICAgICAgICAgICByZXR1cm4gY2FjaGU/LmZyb250bWF0dGVyXG4gICAgICAgICAgICAgICAgJiYgT2JqZWN0LmtleXMoY2FjaGUuZnJvbnRtYXR0ZXIpLmluY2x1ZGVzKGZpbGVDbGFzc0FsaWFzKVxuICAgICAgICAgICAgICAgICYmIGNhY2hlLmZyb250bWF0dGVyW2ZpbGVDbGFzc0FsaWFzXSA9PSB0aGlzLmluc3RhbmNlLm5hbWU7XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBmaWxlc1dpdGhGaWxlQ2xhc3NOYW1lO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXQobmFtZTogc3RyaW5nKSB7XG4gICAgICAgIGNvbnN0IGZpbGVzV2l0aE5hbWUgPSB0aGlzLmFsbCgpLmZpbHRlcihmaWxlID0+IGZpbGUuYmFzZW5hbWUgPT0gbmFtZSk7XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTW9yZSB0aGFuIG9uZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk5vIGZpbGUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoTmFtZVswXTtcblxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRQYXRoKHBhdGg6IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhOYW1lID0gdGhpcy5hbGwoKS5maWx0ZXIoZmlsZSA9PiBmaWxlLnBhdGggPT0gcGF0aCk7XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA+IDEpIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiTW9yZSB0aGFuIG9uZSB2YWx1ZSBmb3VuZFwiKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIGlmIChmaWxlc1dpdGhOYW1lLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk5vIGZpbGUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoTmFtZVswXTtcblxuICAgIH1cbn1cblxuY2xhc3MgRmlsZUNsYXNzIHtcbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgbmFtZTogc3RyaW5nKSB7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLm9iamVjdHMgPSBuZXcgRmlsZUNsYXNzTWFuYWdlcih0aGlzKTtcbiAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gW107XG4gICAgfVxuXG4gICAgcHVibGljIGdldENsYXNzRmlsZSgpOiBURmlsZSB7XG4gICAgICAgIGNvbnN0IGZpbGVzQ2xhc3NQYXRoID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGg7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGAke2ZpbGVzQ2xhc3NQYXRofSR7dGhpcy5uYW1lfS5tZGApO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgcmV0dXJuIGZpbGU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcbiAgICAgICAgICAgICAgICBgbm8gZmlsZSBuYW1lZCA8JHt0aGlzLm5hbWV9Lm1kPiBpbiA8JHtmaWxlc0NsYXNzUGF0aH0+IGZvbGRlciB0byBtYXRjaCA8JHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc306ICR7dGhpcy5uYW1lfT4gaW4gb25lIG9mIHRoZXNlIG5vdGVzYFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGdldFBhcmVudENsYXNzKCk6IEZpbGVDbGFzcyB8IHVuZGVmaW5lZCB7XG4gICAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyBnZXRBdHRyaWJ1dGVzKGV4Y2x1ZGVQYXJlbnRzOiBib29sZWFuID0gZmFsc2UpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXM6IEFycmF5PEZpbGVDbGFzc0F0dHJpYnV0ZT4gPSBbXTtcbiAgICAgICAgICAgIGxldCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKVxuICAgICAgICAgICAgY29uc3QgcGFyZW50ID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcj8uZXh0ZW5kc1xuICAgICAgICAgICAgY29uc3QgZXhjbHVkZWRGaWVsZHMgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyPy5leGNsdWRlc1xuICAgICAgICAgICAgaWYgKHBhcmVudCAmJiAhZXhjbHVkZVBhcmVudHMpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBwYXJlbnRGaWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIHBhcmVudCk7XG4gICAgICAgICAgICAgICAgICAgIGF3YWl0IHBhcmVudEZpbGVDbGFzcy5nZXRBdHRyaWJ1dGVzKCk7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMgPSBbLi4ucGFyZW50RmlsZUNsYXNzLmF0dHJpYnV0ZXNdXG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goZXJyb3IpXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGUobGluZSwgdGhpcy5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy5wdXNoKGF0dHJpYnV0ZSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3JzLnB1c2goZXJyb3IpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB0aGlzLmF0dHJpYnV0ZXMgPSBBcnJheS5pc0FycmF5KGV4Y2x1ZGVkRmllbGRzKSA/IGF0dHJpYnV0ZXMuZmlsdGVyKGF0dHIgPT4gIWV4Y2x1ZGVkRmllbGRzLmluY2x1ZGVzKGF0dHIubmFtZSkpIDogYXR0cmlidXRlcztcbiAgICAgICAgICAgIHRoaXMuZXJyb3JzID0gZXJyb3JzO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyB1cGRhdGVBdHRyaWJ1dGUobmV3VHlwZToga2V5b2YgdHlwZW9mIEZpZWxkVHlwZSwgbmV3TmFtZTogc3RyaW5nLCBuZXdPcHRpb25zPzogc3RyaW5nW10gfCBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+LCBhdHRyPzogRmlsZUNsYXNzQXR0cmlidXRlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgaWYgKGF0dHIpIHtcbiAgICAgICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoYXR0ci5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3VHlwZSA9PSBcIklucHV0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHtuZXdOYW1lfTo6IHtcInR5cGVcIjogXCJJbnB1dFwifWApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHNldHRpbmdzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge307XG4gICAgICAgICAgICAgICAgICAgICAgICBzZXR0aW5nc1tcInR5cGVcIl0gPSBuZXdUeXBlO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKG5ld09wdGlvbnMpIHNldHRpbmdzW1wib3B0aW9uc1wiXSA9IG5ld09wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7bmV3TmFtZX06OiAke0pTT04uc3RyaW5naWZ5KHNldHRpbmdzKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBzZXR0aW5nczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgc2V0dGluZ3NbXCJ0eXBlXCJdID0gbmV3VHlwZTtcbiAgICAgICAgICAgIGlmIChuZXdPcHRpb25zKSBzZXR0aW5nc1tcIm9wdGlvbnNcIl0gPSBuZXdPcHRpb25zO1xuICAgICAgICAgICAgcmVzdWx0ICs9IChgXFxuJHtuZXdOYW1lfTo6ICR7SlNPTi5zdHJpbmdpZnkoc2V0dGluZ3MpfWApO1xuICAgICAgICAgICAgYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCByZXN1bHQpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcHVibGljIGFzeW5jIHJlbW92ZUF0dHJpYnV0ZShhdHRyOiBGaWxlQ2xhc3NBdHRyaWJ1dGUpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZmlsZSA9IHRoaXMuZ2V0Q2xhc3NGaWxlKCk7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICByZXN1bHQuc3BsaXQoJ1xcbicpLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgICAgICBpZiAoIWxpbmUuc3RhcnRzV2l0aChhdHRyLm5hbWUpKSB7XG4gICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xuICAgIH1cbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlRmlsZUNsYXNzKHBsdWdpbjogTWV0YWRhdGFNZW51LCBuYW1lOiBzdHJpbmcsIGV4Y2x1ZGVQYXJlbnQ6IGJvb2xlYW4gPSBmYWxzZSk6IFByb21pc2U8RmlsZUNsYXNzPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gbmV3IEZpbGVDbGFzcyhwbHVnaW4sIG5hbWUpO1xuICAgICAgICBmaWxlQ2xhc3MuZ2V0QXR0cmlidXRlcyhleGNsdWRlUGFyZW50KS50aGVuKCgpID0+IHtcbiAgICAgICAgICAgIHJlc29sdmUoZmlsZUNsYXNzKTtcbiAgICAgICAgfSkuY2F0Y2goKGVycm9yKSA9PiB7XG4gICAgICAgICAgICByZWplY3QoZXJyb3IpO1xuICAgICAgICB9KVxuICAgIH0pXG59XG5cbmV4cG9ydCB7IGNyZWF0ZUZpbGVDbGFzcywgRmlsZUNsYXNzIH07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IGdldEZpZWxkIH0gZnJvbSBcInNyYy9jb21tYW5kcy9nZXRGaWVsZFwiO1xuaW1wb3J0IHsgY3JlYXRlRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciBhcyBGIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBmaWVsZE1vZGlmaWVyKHBsdWdpbjogTWV0YWRhdGFNZW51LCBkdjogYW55LCBwOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nLCBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSk6IFByb21pc2U8SFRNTEVsZW1lbnQ+IHtcblxuICAgIC8qIGZpZWxkQ29udGFpbmVyKi9cbiAgICBjb25zdCBmaWVsZENvbnRhaW5lcjogSFRNTEVsZW1lbnQgPSBkdi5lbChcImRpdlwiLCBcIlwiKVxuICAgIGZpZWxkQ29udGFpbmVyLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtY29udGFpbmVyXCIpXG5cbiAgICAvKiBjcmVhdGUgZmllbGRNb2RpZmllciBkZXBlbmRpbmcgb24gZmlsZUNsYXNzIHR5cGUgb3IgcHJlc2V0IHZhbHVlKi9cblxuICAgIGlmIChwW2ZpZWxkTmFtZV0gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zdCBlbXB0eUZpZWxkID0gZHYuZWwoXCJzcGFuXCIsIG51bGwsIGF0dHJzKTtcbiAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoZW1wdHlGaWVsZCk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzQWxpYXMgPSBwbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG4gICAgICAgIGlmIChwW2ZpbGVDbGFzc0FsaWFzXSB8fCBwbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NOYW1lID0gcFtmaWxlQ2xhc3NBbGlhc10gfHwgcGx1Z2luLnNldHRpbmdzLmdsb2JhbEZpbGVDbGFzcyAvLyBpbm5lciBmaWxlQ2xhc3MgaGFzIHRoZSBwcmlvcml0eSBvdmVyIGdsb2JhbCBmaWxlQ2xhc3NcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IGF3YWl0IGNyZWF0ZUZpbGVDbGFzcyhwbHVnaW4sIGZpbGVDbGFzc05hbWUpO1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZChwbHVnaW4sIGZpZWxkTmFtZSwgZmlsZUNsYXNzKTtcbiAgICAgICAgICAgIGlmIChmaWVsZD8udHlwZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0oZmllbGQpO1xuICAgICAgICAgICAgICAgIGF3YWl0IGZpZWxkTWFuYWdlci5jcmVhdGVEdkZpZWxkKHBsdWdpbiwgZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IEYuY3JlYXRlRGVmYXVsdChmaWVsZE5hbWUpO1xuICAgICAgICAgICAgICAgIGF3YWl0IGZpZWxkTWFuYWdlci5jcmVhdGVEdkZpZWxkKHBsdWdpbiwgZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maWx0ZXIoYXR0ciA9PiBhdHRyLm5hbWUgPT0gZmllbGROYW1lKSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZChwbHVnaW4sIGZpZWxkTmFtZSlcbiAgICAgICAgICAgIGlmIChmaWVsZD8udHlwZSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0oZmllbGQpO1xuICAgICAgICAgICAgICAgIGF3YWl0IGZpZWxkTWFuYWdlci5jcmVhdGVEdkZpZWxkKHBsdWdpbiwgZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IEYuY3JlYXRlRGVmYXVsdChmaWVsZE5hbWUpO1xuICAgICAgICAgICAgICAgIGF3YWl0IGZpZWxkTWFuYWdlci5jcmVhdGVEdkZpZWxkKHBsdWdpbiwgZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXIgPSBGLmNyZWF0ZURlZmF1bHQoZmllbGROYW1lKTtcbiAgICAgICAgICAgIGF3YWl0IGZpZWxkTWFuYWdlci5jcmVhdGVEdkZpZWxkKHBsdWdpbiwgZHYsIHAsIGZpZWxkQ29udGFpbmVyLCBhdHRycyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGZpZWxkQ29udGFpbmVyXG59OyAiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IHsgY3JlYXRlRmlsZUNsYXNzLCBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcbmltcG9ydCB7IEZpZWxkTWFuYWdlciwgRmllbGRUeXBlIH0gZnJvbSBcInNyYy90eXBlcy9maWVsZFR5cGVzXCI7XG5pbXBvcnQgeyBnZXRMaW5lRmllbGRzIH0gZnJvbSBcInNyYy91dGlscy9wYXJzZXJcIjtcbmltcG9ydCB7IGdldEZpZWxkIH0gZnJvbSBcIi4vZ2V0RmllbGRcIjtcblxuZXhwb3J0IGNsYXNzIEZpZWxkSW5mbyB7XG4gICAgdHlwZT86IEZpZWxkVHlwZSA9IHVuZGVmaW5lZDtcbiAgICBzb3VyY2VUeXBlPzogXCJmaWxlQ2xhc3NcIiB8IFwic2V0dGluZ3NcIiA9IHVuZGVmaW5lZDtcbiAgICBmaWxlQ2xhc3M/OiBzdHJpbmcgPSB1bmRlZmluZWQ7XG4gICAgb3B0aW9ucz86IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfCBzdHJpbmdbXSA9IHVuZGVmaW5lZDtcbiAgICBpc1ZhbGlkPzogYm9vbGVhbiA9IHVuZGVmaW5lZDtcbiAgICBpZ25vcmVJbk1lbnU6IGJvb2xlYW5cbiAgICB2YWx1ZTogc3RyaW5nID0gXCJcIjtcbiAgICB2YWx1ZXNMaXN0Tm90ZVBhdGg/OiBzdHJpbmcgPSB1bmRlZmluZWQ7XG4gICAgdW5pcXVlOiBib29sZWFuID0gdHJ1ZVxuXG4gICAgYXN5bmMgc2V0SW5mb3MocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpZWxkTmFtZTogc3RyaW5nLCB2YWx1ZTogc3RyaW5nLCBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3MpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmlnbm9yZUluTWVudSA9IHBsdWdpbi5zZXR0aW5ncy5nbG9iYWxseUlnbm9yZWRGaWVsZHMuaW5jbHVkZXMoZmllbGROYW1lKTtcbiAgICAgICAgaWYgKGZpbGVDbGFzcykge1xuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzRmllbGRzID0gZmlsZUNsYXNzLmF0dHJpYnV0ZXMubWFwKGF0dHIgPT4gYXR0ci5uYW1lKTtcbiAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NGaWVsZHMuaW5jbHVkZXMoZmllbGROYW1lKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGQocGx1Z2luLCBmaWVsZE5hbWUsIGZpbGVDbGFzcyk7XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0oZmllbGQpO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmlzVmFsaWQgPSBhd2FpdCBmaWVsZE1hbmFnZXIudmFsaWRhdGVWYWx1ZSh2YWx1ZSlcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5zb3VyY2VUeXBlID0gXCJmaWxlQ2xhc3NcIjtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgYXR0cmlidXRlID0gZmlsZUNsYXNzLmF0dHJpYnV0ZXMuZmlsdGVyKGEgPT4gYS5uYW1lID09PSBmaWVsZE5hbWUpWzBdO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmZpbGVDbGFzcyA9IGF0dHJpYnV0ZS5vcmlnaW47XG4gICAgICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IGF0dHJpYnV0ZS50eXBlO1xuICAgICAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBhdHRyaWJ1dGUub3B0aW9ucztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5tYXAoZiA9PiBmLm5hbWUpLmluY2x1ZGVzKGZpZWxkTmFtZSkpIHtcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGQocGx1Z2luLCBmaWVsZE5hbWUpO1xuICAgICAgICAgICAgaWYgKGZpZWxkKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlcltmaWVsZC50eXBlXShmaWVsZCk7XG4gICAgICAgICAgICAgICAgdGhpcy5pc1ZhbGlkID0gYXdhaXQgZmllbGRNYW5hZ2VyLnZhbGlkYXRlVmFsdWUodmFsdWUpXG4gICAgICAgICAgICAgICAgdGhpcy50eXBlID0gZmllbGQudHlwZTtcbiAgICAgICAgICAgICAgICB0aGlzLm9wdGlvbnMgPSBmaWVsZC5vcHRpb25zO1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVzTGlzdE5vdGVQYXRoID0gZmllbGQudmFsdWVzTGlzdE5vdGVQYXRoO1xuICAgICAgICAgICAgICAgIHRoaXMuc291cmNlVHlwZSA9IFwic2V0dGluZ3NcIjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpbGVGaWVsZHMocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGVPcmZpbGVQYXRoOiBURmlsZSB8IHN0cmluZyk6IFByb21pc2U8UmVjb3JkPHN0cmluZywgRmllbGRJbmZvPj4ge1xuICAgIC8qXG4gICAgcmV0dXJucyBhbGwgZmllbGRzIHdpdGggc291cmNlLCB0eXBlLCBvcHRpb25zLCBpc1ZhbGlkLCBpZ25vcmVkXG4gICAgKi9cbiAgICBsZXQgZmlsZTogVEZpbGU7XG4gICAgaWYgKGZpbGVPcmZpbGVQYXRoIGluc3RhbmNlb2YgVEZpbGUpIHtcbiAgICAgICAgZmlsZSA9IGZpbGVPcmZpbGVQYXRoO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnN0IF9maWxlID0gYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChmaWxlT3JmaWxlUGF0aClcbiAgICAgICAgaWYgKF9maWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgX2ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgZmlsZSA9IF9maWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhyb3cgRXJyb3IoXCJwYXRoIGRvZXNuJ3QgY29ycmVzcG9uZCB0byBhIHByb3BlciBmaWxlXCIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IGZyb250bWF0dGVyID0gcGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKGZpbGUucGF0aCk/LmZyb250bWF0dGVyO1xuICAgIGNvbnN0IGZpZWxkczogUmVjb3JkPHN0cmluZywgRmllbGRJbmZvPiA9IHt9XG4gICAgbGV0IGZpbGVDbGFzczogRmlsZUNsYXNzIHwgdW5kZWZpbmVkO1xuICAgIGlmIChwbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmaWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luLCBwbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzKVxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgZmlsZUNsYXNzID0gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChmcm9udG1hdHRlcikge1xuICAgICAgICBjb25zdCB7IHBvc2l0aW9uLCAuLi5hdHRyaWJ1dGVzIH0gPSBmcm9udG1hdHRlcjtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlcmUncyBhIGZpbGVDbGFzc1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3NBbGlhcyA9IHBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcztcbiAgICAgICAgaWYgKE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmluY2x1ZGVzKGZpbGVDbGFzc0FsaWFzKSkge1xuICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzTmFtZSA9IGF0dHJpYnV0ZXNbZmlsZUNsYXNzQWxpYXNdO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBmaWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luLCBmaWxlQ2xhc3NOYW1lKVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBmaWxlQ2xhc3MgPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gdGhlbiBleHBsb3JlIGZyb250bWF0dGVyIGZpZWxkcyBha2EgYXR0cmlidXRlc1xuICAgICAgICBPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGFzeW5jIGtleSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZEluZm8gPSBuZXcgRmllbGRJbmZvO1xuICAgICAgICAgICAgZmllbGRJbmZvLnVuaXF1ZSA9ICFPYmplY3Qua2V5cyhmaWVsZHMpLmluY2x1ZGVzKGtleSk7XG4gICAgICAgICAgICBmaWVsZHNba2V5XSA9IGZpZWxkSW5mbztcbiAgICAgICAgICAgIGF3YWl0IGZpZWxkSW5mby5zZXRJbmZvcyhwbHVnaW4sIGtleSwgYXR0cmlidXRlc1trZXldLCBmaWxlQ2xhc3MpO1xuICAgICAgICB9KTtcbiAgICB9XG4gICAgLy8gbGV0J3MgZXhwbG9yZSB0aGUgcmVzdCBvZiB0aGUgZmlsZTogZ2V0IGlubGluZSBmaWVsZHNcblxuICAgIGNvbnN0IHJlc3VsdDogc3RyaW5nID0gYXdhaXQgcGx1Z2luLmFwcC52YXVsdC5yZWFkKGZpbGUpXG4gICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5tYXAoYXN5bmMgbGluZSA9PiB7XG4gICAgICAgIGNvbnN0IGxpbmVGaWVsZHMgPSBnZXRMaW5lRmllbGRzKGxpbmUpXG4gICAgICAgIGxpbmVGaWVsZHMuZm9yRWFjaChhc3luYyAoeyBhdHRyaWJ1dGUsIHZhbHVlcyB9KSA9PiB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE5hbWUgPSBhdHRyaWJ1dGUudHJpbSgpXG4gICAgICAgICAgICBjb25zdCBmaWVsZEluZm8gPSBuZXcgRmllbGRJbmZvO1xuICAgICAgICAgICAgZmllbGRJbmZvLnVuaXF1ZSA9ICFPYmplY3Qua2V5cyhmaWVsZHMpLmluY2x1ZGVzKGZpZWxkTmFtZSk7XG4gICAgICAgICAgICBmaWVsZHNbZmllbGROYW1lXSA9IGZpZWxkSW5mbztcbiAgICAgICAgICAgIGF3YWl0IGZpZWxkSW5mby5zZXRJbmZvcyhwbHVnaW4sIGZpZWxkTmFtZSwgdmFsdWVzLCBmaWxlQ2xhc3MpO1xuICAgICAgICB9KVxuICAgIH0pO1xuICAgIHJldHVybiBmaWVsZHM7XG59IiwgImltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIlxuaW1wb3J0IHsgZ2V0VmFsdWVzIH0gZnJvbSBcIi4vY29tbWFuZHMvZ2V0VmFsdWVzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcIi4vY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IHsgaW5zZXJ0VmFsdWVzIH0gZnJvbSBcIi4vY29tbWFuZHMvaW5zZXJ0VmFsdWVzXCI7XG5pbXBvcnQgeyBmaWVsZE1vZGlmaWVyIH0gZnJvbSBcIi4vY29tbWFuZHMvZmllbGRNb2RpZmllclwiO1xuaW1wb3J0IHsgZmlsZUZpZWxkcywgRmllbGRJbmZvIH0gZnJvbSBcIi4vY29tbWFuZHMvZmlsZUZpZWxkc1wiO1xuXG5leHBvcnQgaW50ZXJmYWNlIElNZXRhZGF0YU1lbnVBcGkge1xuICAgIGdldFZhbHVlczogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcpID0+IFByb21pc2U8c3RyaW5nW10+O1xuICAgIHJlcGxhY2VWYWx1ZXM6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nLCBpbnB1dDogc3RyaW5nKSA9PiBQcm9taXNlPHZvaWQ+O1xuICAgIGluc2VydFZhbHVlczogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgZmllbGROYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCB0b3A/OiBib29sZWFuKSA9PiBQcm9taXNlPHZvaWQ+XG4gICAgZmlsZUZpZWxkczogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZykgPT4gUHJvbWlzZTxSZWNvcmQ8c3RyaW5nLCBGaWVsZEluZm8+PjtcbiAgICBmaWVsZE1vZGlmaWVyOiAoZHY6IGFueSwgcDogYW55LCBmaWVsZE5hbWU6IHN0cmluZywgYXR0cnM/OiB7IGNsczogc3RyaW5nLCBhdHRyOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0pID0+IFByb21pc2U8SFRNTEVsZW1lbnQ+O1xufVxuXG5leHBvcnQgY2xhc3MgTWV0YWRhdGFNZW51QXBpIHtcblxuICAgIGNvbnN0cnVjdG9yKHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICB9XG5cbiAgICBwdWJsaWMgbWFrZSgpOiBJTWV0YWRhdGFNZW51QXBpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGdldFZhbHVlczogdGhpcy5nZXRWYWx1ZXMoKSxcbiAgICAgICAgICAgIHJlcGxhY2VWYWx1ZXM6IHRoaXMucmVwbGFjZVZhbHVlcygpLFxuICAgICAgICAgICAgaW5zZXJ0VmFsdWVzOiB0aGlzLmluc2VydFZhbHVlcygpLFxuICAgICAgICAgICAgZmllbGRNb2RpZmllcjogdGhpcy5maWVsZE1vZGlmaWVyKCksXG4gICAgICAgICAgICBmaWxlRmllbGRzOiB0aGlzLmZpbGVGaWVsZHMoKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0VmFsdWVzKCk6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcsIGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBhdHRyaWJ1dGU6IHN0cmluZykgPT4gZ2V0VmFsdWVzKHRoaXMucGx1Z2luLmFwcCwgZmlsZU9yRmlsZVBhdGgsIGF0dHJpYnV0ZSlcbiAgICB9XG5cbiAgICBwcml2YXRlIHJlcGxhY2VWYWx1ZXMoKTogKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcsIGlucHV0OiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gYXN5bmMgKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgYXR0cmlidXRlOiBzdHJpbmcsIGlucHV0OiBzdHJpbmcpID0+IHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4uYXBwLCBmaWxlT3JGaWxlUGF0aCwgYXR0cmlidXRlLCBpbnB1dClcbiAgICB9XG5cbiAgICBwcml2YXRlIGluc2VydFZhbHVlcygpOiAoZmlsZU9yRmlsZVBhdGg6IFRGaWxlIHwgc3RyaW5nLCBmaWVsZE5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgbGluZU51bWJlcj86IG51bWJlciwgaW5Gcm9udG1hdHRlcj86IGJvb2xlYW4sIHRvcD86IGJvb2xlYW4pID0+IFByb21pc2U8dm9pZD4ge1xuICAgICAgICByZXR1cm4gYXN5bmMgKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZywgZmllbGROYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGxpbmVOdW1iZXI/OiBudW1iZXIsIGluRnJvbnRtYXR0ZXI/OiBib29sZWFuLCB0b3A/OiBib29sZWFuKSA9PiBpbnNlcnRWYWx1ZXModGhpcy5wbHVnaW4uYXBwLCBmaWxlT3JGaWxlUGF0aCwgZmllbGROYW1lLCB2YWx1ZSwgbGluZU51bWJlciwgaW5Gcm9udG1hdHRlciwgdG9wKVxuICAgIH1cblxuICAgIHByaXZhdGUgZmllbGRNb2RpZmllcigpOiAoZHY6IGFueSwgcDogYW55LCBmaWVsZE5hbWU6IHN0cmluZywgYXR0cnM/OiB7IGNsczogc3RyaW5nLCBhdHRyOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+IH0pID0+IFByb21pc2U8SFRNTEVsZW1lbnQ+IHtcbiAgICAgICAgcmV0dXJuIChkdjogYW55LCBwOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nLCBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSkgPT4gZmllbGRNb2RpZmllcih0aGlzLnBsdWdpbiwgZHYsIHAsIGZpZWxkTmFtZSwgYXR0cnMpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmaWxlRmllbGRzKCk6IChmaWxlT3JGaWxlUGF0aDogVEZpbGUgfCBzdHJpbmcpID0+IFByb21pc2U8UmVjb3JkPHN0cmluZywgRmllbGRJbmZvPj4ge1xuICAgICAgICByZXR1cm4gYXN5bmMgKGZpbGVPckZpbGVQYXRoOiBURmlsZSB8IHN0cmluZykgPT4gZmlsZUZpZWxkcyh0aGlzLnBsdWdpbiwgZmlsZU9yRmlsZVBhdGgpXG4gICAgfVxufSIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IE9wdGlvbnNMaXN0IGZyb20gXCJzcmMvb3B0aW9ucy9PcHRpb25zTGlzdFwiO1xuaW1wb3J0IEZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsIGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsXCI7XG5pbXBvcnQgTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWwgZnJvbSBcIi4vTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWxcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgbGlua0NvbnRleHRNZW51IHtcblx0cHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcblx0cHJpdmF0ZSBmaWxlOiBURmlsZTtcblx0cHJpdmF0ZSBvcHRpb25zTGlzdDogT3B0aW9uc0xpc3Q7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmNyZWF0ZUNvbnRleHRNZW51KCk7XG5cdH07XG5cblx0cHJpdmF0ZSBjcmVhdGVDb250ZXh0TWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignZmlsZS1tZW51JywgKG1lbnUsIGFic3RyYWN0RmlsZSwgc291cmNlKSA9PiB7XG5cblx0XHRcdFx0Y29uc3QgZmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoYWJzdHJhY3RGaWxlLnBhdGgpO1xuXG5cdFx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcblx0XHRcdFx0XHR0aGlzLmZpbGUgPSBmaWxlO1xuXG5cdFx0XHRcdFx0Ly9JZiBmaWxlQ2xhc3Ncblx0XHRcdFx0XHRpZiAoZmlsZS5wYXJlbnQucGF0aCArIFwiL1wiID09IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoKSB7XG5cdFx0XHRcdFx0XHRtZW51LmFkZFNlcGFyYXRvcigpO1xuXHRcdFx0XHRcdFx0bWVudS5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcImdlYXJcIik7XG5cdFx0XHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYE1hbmFnZSA8JHtmaWxlLmJhc2VuYW1lfT4gZmllbGRzYCk7XG5cdFx0XHRcdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0KSA9PiB7XG5cdFx0XHRcdFx0XHRcdFx0Y29uc3QgZmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUpO1xuXHRcdFx0XHRcdFx0XHRcdGZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsLm9wZW4oKTtcblx0XHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRcdFx0Ly9JZiBkaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudSB0cnVlLCBzaG93IGFsbCBmaWVsZHMgaW4gbm90ZVxuXHRcdFx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51KSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMub3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgbWVudSk7XG5cdFx0XHRcdFx0XHRcdHRoaXMub3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG5cdFx0XHRcdFx0XHR9IGVsc2Uge1xuXG5cdFx0XHRcdFx0XHRcdC8vTmV3IEZpZWxkXG5cdFx0XHRcdFx0XHRcdHRoaXMub3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgbWVudSk7XG5cblx0XHRcdFx0XHRcdFx0Ly9GaWVsZCBPcHRpb25zXG5cdFx0XHRcdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcImJ1bGxldC1saXN0XCIpLFxuXHRcdFx0XHRcdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShgRmllbGQgT3B0aW9uc2ApLFxuXHRcdFx0XHRcdFx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgZmllbGRPcHRpb25zID0gbmV3IE5vdGVGaWVsZHNDb21tYW5kc01vZGFsKGFwcCwgdGhpcy5wbHVnaW4sIGZpbGUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0XHRmaWVsZE9wdGlvbnMub3BlbigpO1xuXHRcdFx0XHRcdFx0XHRcdFx0fSlcblx0XHRcdFx0XHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJ0YXJnZXQtbWV0YWRhdGFcIik7XG5cdFx0XHRcdFx0XHRcdH0pXG5cdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0fTtcblx0XHRcdFx0fTtcblx0XHRcdH0pXG5cdFx0KTtcblx0fTtcbn07IiwgImltcG9ydCB7IE1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBmaWVsZFNlbGVjdE1vZGFsIGZyb20gXCIuL2ZpZWxkU2VsZWN0TW9kYWxcIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBjaG9vc2VTZWN0aW9uTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XG4gICAgcHJpdmF0ZSBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3NcblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlOiBURmlsZSwgZmlsZUNsYXNzPzogRmlsZUNsYXNzKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3MgPSBmaWxlQ2xhc3NcbiAgICB9O1xuXG4gICAgYXN5bmMgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChcIkFkZCBhIGZpZWxkIGluIHRoaXMgbm90ZSBhZnRlcjpcIik7XG4gICAgICAgIGNvbnN0IGlucHV0RGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbW9kYWwtdmFsdWVcIiB9KTtcblxuICAgICAgICBjb25zdCBzZWxlY3RFbCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChpbnB1dERpdik7XG4gICAgICAgIHNlbGVjdEVsLnNlbGVjdEVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1zZWxlY3RcIik7XG4gICAgICAgIHNlbGVjdEVsLmFkZE9wdGlvbihcIlwiLCBcIlNlbGVjdCBsaW5lXCIpO1xuICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oXCJ0b3BfMFwiLCBcInRvcFwiKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZCh0aGlzLmZpbGUpXG4gICAgICAgIGxldCBmb3JlSGVhZFRleHQgPSBmYWxzZTtcbiAgICAgICAgbGV0IGZyb250bWF0dGVyU3RhcnQgPSBmYWxzZTtcbiAgICAgICAgbGV0IGZyb250bWF0dGVyRW5kID0gZmFsc2U7XG4gICAgICAgIGxldCBpbkZyb250bWF0dGVyID0gZmFsc2U7XG4gICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBsaW5lTnVtYmVyKSA9PiB7XG4gICAgICAgICAgICBpZiAobGluZSAhPSBcIi0tLVwiICYmICFmb3JlSGVhZFRleHQgJiYgIWZyb250bWF0dGVyU3RhcnQpIHtcbiAgICAgICAgICAgICAgICBmb3JlSGVhZFRleHQgPSB0cnVlO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmIChsaW5lID09IFwiLS0tXCIgJiYgIWZvcmVIZWFkVGV4dCkge1xuICAgICAgICAgICAgICAgIGlmICghZnJvbnRtYXR0ZXJTdGFydCkge1xuICAgICAgICAgICAgICAgICAgICBmcm9udG1hdHRlclN0YXJ0ID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICghZnJvbnRtYXR0ZXJFbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJFbmQgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICBpbkZyb250bWF0dGVyID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChpbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0RWwuYWRkT3B0aW9uKGBmcm9udG1hdHRlcl8ke2xpbmVOdW1iZXJ9YCwgYCR7bGluZS5zdWJzdHJpbmcoMCwgMzApfSR7bGluZS5sZW5ndGggPiAzMCA/IFwiLi4uXCIgOiBcIlwifWApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oYGJvZHlfJHtsaW5lTnVtYmVyfWAsIGAke2xpbmUuc3Vic3RyaW5nKDAsIDMwKX0ke2xpbmUubGVuZ3RoID4gMzAgPyBcIi4uLlwiIDogXCJcIn1gKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgICBzZWxlY3RFbC5vbkNoYW5nZSgoKSA9PiB7XG4gICAgICAgICAgICBjb25zdCB2YWx1ZUFycmF5ID0gc2VsZWN0RWwuZ2V0VmFsdWUoKS5tYXRjaCgvKFxcdyspXyhcXGQrKS8pO1xuICAgICAgICAgICAgY29uc3QgcG9zaXRpb24gPSB2YWx1ZUFycmF5ICYmIHZhbHVlQXJyYXkubGVuZ3RoID4gMCA/IHZhbHVlQXJyYXlbMV0gOiAwO1xuICAgICAgICAgICAgY29uc3QgbGluZU51bWJlciA9IE51bWJlcih2YWx1ZUFycmF5ICYmIHZhbHVlQXJyYXkubGVuZ3RoID4gMSA/IHZhbHVlQXJyYXlbMl0gOiAwKTtcbiAgICAgICAgICAgIGNvbnN0IGluRnJvbnRtYXR0ZXIgPSBwb3NpdGlvbiA9PSBcImZyb250bWF0dGVyXCIgPyB0cnVlIDogZmFsc2U7XG4gICAgICAgICAgICBjb25zdCB0b3AgPSBwb3NpdGlvbiA9PSBcInRvcFwiID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgZmllbGRTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCBsaW5lTnVtYmVyLCByZXN1bHQuc3BsaXQoJ1xcbicpW2xpbmVOdW1iZXJdLCBpbkZyb250bWF0dGVyLCB0b3AsIHRoaXMuZmlsZUNsYXNzKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07IiwgImltcG9ydCB7IE1vZGFsLCBEcm9wZG93bkNvbXBvbmVudCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBhZGROZXdGaWVsZE1vZGFsIGZyb20gXCIuL2FkZE5ld0ZpZWxkTW9kYWxcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBmaWVsZFNlbGVjdE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgLy8gY2hvb3NlIGEgZmllbGQgdHlwZSBhZnRlciBcImFkZCBmaWVsZCBhdCBzZWN0aW9uIGNvbW1hbmRcIlxuXG4gICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBsaW5lOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBwcml2YXRlIGZpbGU6IFRGaWxlO1xuICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbjtcbiAgICBwcml2YXRlIHRvcDogYm9vbGVhbjtcbiAgICBwcml2YXRlIGZpbGVDbGFzcz86IEZpbGVDbGFzc1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBsaW5lTnVtYmVyOiBudW1iZXIsIGxpbmU6IHN0cmluZywgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiwgdG9wOiBib29sZWFuLCBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3MpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMubGluZSA9IGxpbmU7XG4gICAgICAgIHRoaXMubGluZU51bWJlciA9IGxpbmVOdW1iZXI7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBpbkZyb250bWF0dGVyO1xuICAgICAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3MgPSBmaWxlQ2xhc3NcbiAgICB9O1xuXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgSW5zZXJ0IGZpZWxkIGFmdGVyID4gJHt0aGlzLmxpbmUuc3Vic3RyaW5nKDAsIDIwKX0ke3RoaXMubGluZS5sZW5ndGggPiAyMCA/IFwiLi4uXCIgOiBcIlwifWApO1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1zZWxlY3RcIiB9KTtcblxuICAgICAgICBjb25zdCBzZXR0aW5nc0Ryb3Bkb3duQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBzZXR0aW5nc1NlbGVjdG9yID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHNldHRpbmdzRHJvcGRvd25Db250YWluZXIpO1xuICAgICAgICBzZXR0aW5nc1NlbGVjdG9yLmFkZE9wdGlvbihcIi0tLVwiLCBcIkNob29zZSBGaWVsZFwiKTtcbiAgICAgICAgc2V0dGluZ3NTZWxlY3Rvci5hZGRPcHRpb24oXCIrK05ld1wiLCBcIk5ld1wiKTtcbiAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZvckVhY2goYXR0ciA9PiB7XG4gICAgICAgICAgICAgICAgc2V0dGluZ3NTZWxlY3Rvci5hZGRPcHRpb24oYXR0ci5uYW1lLCBhdHRyLm5hbWUpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5mb3JFYWNoKHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgICAgIHNldHRpbmdzU2VsZWN0b3IuYWRkT3B0aW9uKHNldHRpbmcubmFtZSwgc2V0dGluZy5uYW1lKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG5cbiAgICAgICAgc2V0dGluZ3NTZWxlY3Rvci5vbkNoYW5nZShzZWxlY3RlZEZpZWxkTmFtZSA9PiB7XG4gICAgICAgICAgICBpZiAoc2VsZWN0ZWRGaWVsZE5hbWUgPT0gXCIrK05ld1wiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RmllbGRNb2RhbCA9IG5ldyBhZGROZXdGaWVsZE1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuZmlsZSwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLnRvcCk7XG4gICAgICAgICAgICAgICAgbmV3RmllbGRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZXNXaXRoTmFtZSA9IHRoaXMuZmlsZUNsYXNzLmF0dHJpYnV0ZXMuZmlsdGVyKGF0dHIgPT4gYXR0ci5uYW1lID09IHNlbGVjdGVkRmllbGROYW1lKTtcbiAgICAgICAgICAgICAgICBsZXQgZmllbGQ6IEZpZWxkIHwgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgbGV0IHR5cGU6IEZpZWxkVHlwZSB8IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGUgPSBmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWVbMF07XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkID0gZmlsZUNsYXNzQXR0cmlidXRlLmdldEZpZWxkKCk7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlcltmaWVsZC50eXBlXShmaWVsZCk7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbCh0aGlzLmFwcCwgdGhpcy5maWxlLCBzZWxlY3RlZEZpZWxkTmFtZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzLmZpbHRlcihfZmllbGQgPT4gX2ZpZWxkLm5hbWUgPT0gc2VsZWN0ZWRGaWVsZE5hbWUpWzBdO1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTWFuYWdlciA9IG5ldyBGaWVsZE1hbmFnZXJbZmllbGQudHlwZV0oZmllbGQpO1xuICAgICAgICAgICAgICAgIGZpZWxkTWFuYWdlci5jcmVhdGVBbmRPcGVuRmllbGRNb2RhbCh0aGlzLmFwcCwgdGhpcy5maWxlLCBzZWxlY3RlZEZpZWxkTmFtZSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IHsgTW9kYWwsIFRleHRDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCwgRXh0cmFCdXR0b25Db21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBpbnNlcnRWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2luc2VydFZhbHVlc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBhZGROZXdGaWVsZE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSB0b3A6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgbGluZU51bWJlcjogbnVtYmVyLCBmaWxlOiBURmlsZSwgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiwgdG9wOiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyO1xuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBpbkZyb250bWF0dGVyO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KFwiSW5zZXJ0IG5ldyBmaWVsZFwiKTtcbiAgICAgICAgY29uc3QgYWRkTmV3RmllbGRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgbmFtZUlucHV0Q29udGFpbmVyID0gYWRkTmV3RmllbGRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIG5hbWVJbnB1dENvbnRhaW5lci5zZXRUZXh0KFwiRmllbGQgTmFtZTogXCIpO1xuICAgICAgICBjb25zdCBuYW1lSW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KG5hbWVJbnB1dENvbnRhaW5lcik7XG4gICAgICAgIG5hbWVJbnB1dEVsLnNldFBsYWNlaG9sZGVyKFwiRmllbGQgbmFtZVwiKTtcbiAgICAgICAgY29uc3QgdmFsdWVJbnB1dENvbnRhaW5lciA9IGFkZE5ld0ZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICB2YWx1ZUlucHV0Q29udGFpbmVyLnNldFRleHQoXCJGaWVsZCB2YWx1ZTogXCIpO1xuICAgICAgICBjb25zdCB2YWx1ZUlucHV0RWwgPSBuZXcgVGV4dENvbXBvbmVudCh2YWx1ZUlucHV0Q29udGFpbmVyKTtcbiAgICAgICAgdmFsdWVJbnB1dEVsLnNldFBsYWNlaG9sZGVyKFwiRmllbGQgdmFsdWVcIik7XG4gICAgICAgIGNvbnN0IGZvb3RlckJ1dHRvbnMgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiAnbWV0YWRhdGEtbWVudS10ZXh0YXJlYS1idXR0b25zJ1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyQnV0dG9ucyk7XG4gICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGluc2VydFZhbHVlcyh0aGlzLmFwcCwgdGhpcy5maWxlLCBuYW1lSW5wdXRFbC5nZXRWYWx1ZSgpLCB2YWx1ZUlucHV0RWwuZ2V0VmFsdWUoKSwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IG5ldyBFeHRyYUJ1dHRvbkNvbXBvbmVudChmb290ZXJCdXR0b25zKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcblxuXG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7IERyb3Bkb3duQ29tcG9uZW50LCBNb2RhbCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGNyZWF0ZUZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuICAgIGZpbGU6IFRGaWxlO1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICB9XG5cbiAgICBhc3luYyBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3QgdGhlIGZpZWxkIHRvIHVwZGF0ZWApO1xuICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIHRoaXMuZmlsZS5iYXNlbmFtZSwgdHJ1ZSkgLy8gbGltaXQgZmllbGRzIG1hbmFnZSB0byBjdXJyZW50IGZpbGVDbGFzc1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IHRoZSBmaWVsZCB0byB1cGRhdGUgaW4gJHtmaWxlQ2xhc3MubmFtZX1gKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICBzZWxlY3QuYWRkT3B0aW9uKFwic2VsZWN0IGFuIGF0dHJpYnV0ZVwiLCBcIi0tc2VsZWN0IGFuIGF0dHJpYnV0ZS0tXCIpO1xuICAgICAgICBmaWxlQ2xhc3MuYXR0cmlidXRlcy5mb3JFYWNoKGF0dHIgPT4ge1xuICAgICAgICAgICAgc2VsZWN0LmFkZE9wdGlvbihhdHRyLm5hbWUsIGF0dHIubmFtZSk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgc2VsZWN0LmFkZE9wdGlvbihcIisrbmV3QXR0cisrXCIsIFwiKytBZGQgYSBuZXcgYXR0cmlidXRlKytcIik7XG4gICAgICAgIHNlbGVjdC5vbkNoYW5nZSgoYXR0ck5hbWUpID0+IHtcbiAgICAgICAgICAgIGlmIChhdHRyTmFtZSA9PSBcIisrbmV3QXR0clwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGVDbGFzcyk7XG4gICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwodGhpcy5wbHVnaW4sIGZpbGVDbGFzcywgZmlsZUNsYXNzLmF0dHJpYnV0ZXMuZmlsdGVyKGF0dHIgPT4gYXR0ci5uYW1lID09IGF0dHJOYW1lKVswXSk7XG4gICAgICAgICAgICAgICAgbW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcbiAgICB9XG59IiwgImltcG9ydCB7IERyb3Bkb3duQ29tcG9uZW50LCBNb2RhbCwgVGV4dENvbXBvbmVudCwgQnV0dG9uQ29tcG9uZW50LCBFeHRyYUJ1dHRvbkNvbXBvbmVudCwgTm90aWNlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGVcIjtcbmltcG9ydCB7IEZpZWxkVHlwZVRvb2x0aXAsIEZpZWxkVHlwZSwgRmllbGRUeXBlTGFiZWxNYXBwaW5nLCBGaWVsZE1hbmFnZXIgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIgYXMgRiwgU2V0dGluZ0xvY2F0aW9uIH0gZnJvbSBcInNyYy9maWVsZHMvRmllbGRNYW5hZ2VyXCI7XG5cbmNsYXNzIEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBhdHRyPzogRmlsZUNsYXNzQXR0cmlidXRlO1xuICAgIHByaXZhdGUgZmlsZUNsYXNzOiBGaWxlQ2xhc3M7XG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudVxuICAgIHByaXZhdGUgbmFtZUlucHV0Q29udGFpbmVyOiBIVE1MRGl2RWxlbWVudDtcbiAgICBwcml2YXRlIG5hbWVJbnB1dDogVGV4dENvbXBvbmVudDtcbiAgICBwcml2YXRlIGF0dHJOYW1lOiBIVE1MRWxlbWVudDtcbiAgICBwcml2YXRlIHR5cGVTZWxlY3RDb250YWluZXI6IEhUTUxEaXZFbGVtZW50O1xuICAgIHByaXZhdGUgaW5pdGlhbEZpZWxkOiBGaWVsZDtcbiAgICBwcml2YXRlIGZpZWxkOiBGaWVsZDtcbiAgICBwcml2YXRlIGZpZWxkTWFuYWdlcjogRjtcbiAgICBwcml2YXRlIGZpZWxkT3B0aW9uc0NvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQ7XG5cblxuICAgIGNvbnN0cnVjdG9yKHBsdWdpbjogTWV0YWRhdGFNZW51LCBmaWxlQ2xhc3M6IEZpbGVDbGFzcywgYXR0cj86IEZpbGVDbGFzc0F0dHJpYnV0ZSkge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW5cbiAgICAgICAgdGhpcy5hdHRyID0gYXR0cjtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3MgPSBmaWxlQ2xhc3M7XG4gICAgICAgIHRoaXMuaW5pdGlhbEZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgIGlmICh0aGlzLmF0dHIpIHtcbiAgICAgICAgICAgIHRoaXMuZmllbGQgPSBhdHRyIS5nZXRGaWVsZCgpXG4gICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5pbml0aWFsRmllbGQsIHRoaXMuZmllbGQpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW3RoaXMuZmllbGQudHlwZV0odGhpcy5maWVsZCk7XG4gICAgICAgIHRoaXMubmFtZUlucHV0Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIHRoaXMudHlwZVNlbGVjdENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0b3ItY29udGFpbmVyJyB9KTtcbiAgICAgICAgdGhpcy5maWVsZE9wdGlvbnNDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKVxuICAgIH1cblxuICAgIGJ1aWxkTmFtZUlucHV0Q29udGFpbmVyKCk6IHZvaWQge1xuICAgICAgICB0aGlzLm5hbWVJbnB1dENvbnRhaW5lci5zZXRUZXh0KFwiTmFtZTogXCIpO1xuICAgICAgICB0aGlzLm5hbWVJbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHRoaXMubmFtZUlucHV0Q29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5hdHRyID8gdGhpcy5uYW1lSW5wdXQuc2V0VmFsdWUodGhpcy5maWVsZC5uYW1lKSA6IHRoaXMubmFtZUlucHV0LnNldFBsYWNlaG9sZGVyKFwiVHlwZSBhIG5hbWUgZm9yIHRoaXMgYXR0cmlidXRlXCIpO1xuICAgICAgICB0aGlzLm5hbWVJbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7IHRoaXMuZmllbGQubmFtZSA9IHZhbHVlOyB0aGlzLmF0dHJOYW1lLnNldFRleHQoYDwke3ZhbHVlfT5gKSB9KTtcbiAgICAgICAgdGhpcy50eXBlU2VsZWN0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuICAgIH1cblxuICAgIGJ1aWxkVHlwZVNlbGVjdENvbnRhaW5lcigpOiB2b2lkIHtcblxuICAgICAgICAvL2hlYWRlciBmb3Igc2VsZWN0XG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RIZWFkZXIgPSB0aGlzLnR5cGVTZWxlY3RDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGF0dHJMaW5lID0gdHlwZVNlbGVjdEhlYWRlci5jcmVhdGVFbChcImRpdlwiKTtcbiAgICAgICAgdGhpcy5hdHRyTmFtZSA9IGF0dHJMaW5lLmNyZWF0ZUVsKFwic3Ryb25nXCIpO1xuICAgICAgICB0aGlzLmF0dHJOYW1lLnNldFRleHQoYDwke3RoaXMuZmllbGQubmFtZX0+YCk7XG4gICAgICAgIGF0dHJMaW5lLmFwcGVuZChcIiBmaWVsZHMgaW4gZmlsZXMgd2l0aDpcIik7XG4gICAgICAgIFN0cmluZyhgLS0tXFxuJHt0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhc306ICR7dGhpcy5maWxlQ2xhc3MubmFtZX1cXG4uLi5cXG4tLS1gKS5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgIHR5cGVTZWxlY3RIZWFkZXIuY3JlYXRlRWwoXCJkaXZcIiwgXCJ5YW1sLW1ldGFkYXRhLW1lbnUtcmVkXCIpLnNldFRleHQobGluZSk7XG4gICAgICAgIH0pXG4gICAgICAgIC8vZHJvcGRvd25cbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdExhYmVsID0gdGhpcy50eXBlU2VsZWN0Q29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0b3ItaW5saW5lLWxhYmVsJyB9KTtcbiAgICAgICAgdHlwZVNlbGVjdExhYmVsLnNldFRleHQoXCJ3aWxsOiBcIik7XG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3REcm9wRG93biA9IHRoaXMudHlwZVNlbGVjdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLXRvZ2dsZXInIH0pO1xuXG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3QgPSBuZXcgRHJvcGRvd25Db21wb25lbnQodHlwZVNlbGVjdERyb3BEb3duKTtcblxuICAgICAgICBPYmplY3Qua2V5cyhGaWVsZFR5cGVUb29sdGlwKS5mb3JFYWNoKChrZXk6IGtleW9mIHR5cGVvZiBGaWVsZFR5cGUpID0+IHR5cGVTZWxlY3QuYWRkT3B0aW9uKGtleSwgRmllbGRUeXBlVG9vbHRpcFtrZXldKSlcbiAgICAgICAgdHlwZVNlbGVjdC5zZXRWYWx1ZSh0aGlzLmZpZWxkLnR5cGUpXG4gICAgICAgIHR5cGVTZWxlY3Qub25DaGFuZ2UoKHR5cGVMYWJlbDoga2V5b2YgdHlwZW9mIEZpZWxkVHlwZSkgPT4ge1xuXG4gICAgICAgICAgICB0aGlzLmZpZWxkID0gbmV3IEZpZWxkKCk7XG4gICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkodGhpcy5maWVsZCwgdGhpcy5pbml0aWFsRmllbGQpO1xuICAgICAgICAgICAgdGhpcy5maWVsZC5uYW1lID0gdGhpcy5uYW1lSW5wdXQuZ2V0VmFsdWUoKVxuICAgICAgICAgICAgdGhpcy5maWVsZC50eXBlID0gRmllbGRUeXBlTGFiZWxNYXBwaW5nW3R5cGVMYWJlbF07XG4gICAgICAgICAgICBpZiAodGhpcy5maWVsZC50eXBlICE9PSB0aGlzLmluaXRpYWxGaWVsZC50eXBlICYmXG4gICAgICAgICAgICAgICAgIVt0aGlzLmZpZWxkLnR5cGUsIHRoaXMuaW5pdGlhbEZpZWxkLnR5cGVdLmV2ZXJ5KGZpZWxkVHlwZSA9PlxuICAgICAgICAgICAgICAgICAgICBbRmllbGRUeXBlLk11bHRpLCBGaWVsZFR5cGUuU2VsZWN0LCBGaWVsZFR5cGUuQ3ljbGVdLmluY2x1ZGVzKGZpZWxkVHlwZSlcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICAgICApIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkLm9wdGlvbnMgPSB7fVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgd2hpbGUgKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLmZpcnN0Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICB0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5yZW1vdmVDaGlsZCh0aGlzLmZpZWxkT3B0aW9uc0NvbnRhaW5lci5maXJzdENoaWxkKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuZmllbGRNYW5hZ2VyID0gbmV3IEZpZWxkTWFuYWdlclt0aGlzLmZpZWxkLnR5cGVdKHRoaXMuZmllbGQpXG4gICAgICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci5jcmVhdGVTZXR0aW5nQ29udGFpbmVyKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLCB0aGlzLnBsdWdpbiwgU2V0dGluZ0xvY2F0aW9uLkZpbGVDbGFzc0F0dHJpYnV0ZVNldHRpbmdzKVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgdmFsaWRhdGVGaWVsZHMoKTogYm9vbGVhbiB7XG4gICAgICAgIHJldHVybiB0aGlzLmZpZWxkTWFuYWdlci52YWxpZGF0ZU5hbWUoXG4gICAgICAgICAgICB0aGlzLm5hbWVJbnB1dCxcbiAgICAgICAgICAgIHRoaXMubmFtZUlucHV0LmlucHV0RWxcbiAgICAgICAgKSAmJlxuICAgICAgICAgICAgdGhpcy5maWVsZE1hbmFnZXIudmFsaWRhdGVPcHRpb25zKCk7XG4gICAgfVxuXG4gICAgcHJpdmF0ZSBjcmVhdGVTYXZlQnRuKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29udGFpbmVyKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgbGV0IGVycm9yID0gIXRoaXMudmFsaWRhdGVGaWVsZHMoKTtcbiAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJGaXggZXJyb3JzIGJlZm9yZSBzYXZpbmcuXCIpO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzcy51cGRhdGVBdHRyaWJ1dGUodGhpcy5maWVsZC50eXBlLCB0aGlzLmZpZWxkLm5hbWUsIHRoaXMuZmllbGQub3B0aW9ucywgdGhpcy5hdHRyKTtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSlcbiAgICB9XG5cbiAgICBwcml2YXRlIGNyZWF0ZVJlbW92ZWxCdG4oY29udGFpbmVyOiBIVE1MRGl2RWxlbWVudCk6IHZvaWQge1xuICAgICAgICBjb25zdCByZW1vdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIHJlbW92ZUJ1dHRvbi5zZXRJY29uKFwidHJhc2hcIik7XG4gICAgICAgIHJlbW92ZUJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1Nb2RhbCA9IG5ldyBNb2RhbCh0aGlzLnBsdWdpbi5hcHApO1xuICAgICAgICAgICAgY29uZmlybU1vZGFsLnRpdGxlRWwuc2V0VGV4dChcIlBsZWFzZSBjb25maXJtXCIpO1xuICAgICAgICAgICAgY29uZmlybU1vZGFsLmNvbnRlbnRFbC5jcmVhdGVEaXYoKS5zZXRUZXh0KGBEbyB5b3UgcmVhbGx5IHdhbnQgdG8gcmVtb3ZlICR7dGhpcy5hdHRyPy5uYW1lfSBhdHRyaWJ1dGUgZnJvbSAke3RoaXMuZmlsZUNsYXNzLm5hbWV9P2ApO1xuICAgICAgICAgICAgY29uc3QgY29uZmlybUZvb3RlciA9IGNvbmZpcm1Nb2RhbC5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZC1mb290ZXJcIiB9KTtcbiAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1CdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGNvbmZpcm1Gb290ZXIpO1xuICAgICAgICAgICAgY29uZmlybUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICAgICAgY29uZmlybUJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5hdHRyKSB0aGlzLmZpbGVDbGFzcy5yZW1vdmVBdHRyaWJ1dGUodGhpcy5hdHRyKTtcbiAgICAgICAgICAgICAgICBjb25maXJtTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgY29uc3QgZGlzbWlzc0J1dHRvbiA9IG5ldyBFeHRyYUJ1dHRvbkNvbXBvbmVudChjb25maXJtRm9vdGVyKTtcbiAgICAgICAgICAgIGRpc21pc3NCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpO1xuICAgICAgICAgICAgZGlzbWlzc0J1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgICAgICAgICBjb25maXJtTW9kYWwub3BlbigpO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIHByaXZhdGUgY3JlYXRlQ2FuY2VsQnRuKGNvbnRhaW5lcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgY2FuY2VsQnV0dG9uID0gbmV3IEV4dHJhQnV0dG9uQ29tcG9uZW50KGNvbnRhaW5lcik7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIik7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbkNsaWNrKCgpID0+IHRoaXMuY2xvc2UoKSk7XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICAvL3RpdGxlXG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KHRoaXMuYXR0ciA/IGBNYW5hZ2UgJHt0aGlzLmF0dHIubmFtZX1gIDogYENyZWF0ZSBhIG5ldyBhdHRyaWJ1dGUgZm9yICR7dGhpcy5maWxlQ2xhc3MubmFtZX1gKTtcblxuICAgICAgICB0aGlzLmJ1aWxkTmFtZUlucHV0Q29udGFpbmVyKClcbiAgICAgICAgdGhpcy5idWlsZFR5cGVTZWxlY3RDb250YWluZXIoKVxuICAgICAgICB0aGlzLmZpZWxkTWFuYWdlci5jcmVhdGVTZXR0aW5nQ29udGFpbmVyKHRoaXMuZmllbGRPcHRpb25zQ29udGFpbmVyLCB0aGlzLnBsdWdpbiwgU2V0dGluZ0xvY2F0aW9uLkZpbGVDbGFzc0F0dHJpYnV0ZVNldHRpbmdzKVxuXG4gICAgICAgIC8vIGZvb3RlciBidXR0b25zXG4gICAgICAgIGNvbnN0IGZvb3RlciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLWdyaWQtZm9vdGVyXCIgfSk7XG4gICAgICAgIHRoaXMuY3JlYXRlU2F2ZUJ0bihmb290ZXIpO1xuICAgICAgICBpZiAodGhpcy5hdHRyKSB0aGlzLmNyZWF0ZVJlbW92ZWxCdG4oZm9vdGVyKTtcbiAgICAgICAgdGhpcy5jcmVhdGVDYW5jZWxCdG4oZm9vdGVyKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIH0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQXBwLCBURmlsZSwgTWVudSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvZmllbGRzL0ZpZWxkXCI7XG5pbXBvcnQgeyBGaWVsZFR5cGUsIEZpZWxkTWFuYWdlciB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IGNob29zZVNlY3Rpb25Nb2RhbCBmcm9tIFwiLi4vb3B0aW9uTW9kYWxzL2Nob29zZVNlY3Rpb25Nb2RhbFwiO1xuaW1wb3J0IFNlbGVjdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL1NlbGVjdE1vZGFsXCI7XG5pbXBvcnQgeyBjcmVhdGVGaWxlQ2xhc3MsIEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgZ2V0RmllbGQgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2dldEZpZWxkXCI7XG5pbXBvcnQgRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IGdldExpbmVGaWVsZHMgfSBmcm9tIFwiLi4vdXRpbHMvcGFyc2VyXCI7XG5pbXBvcnQgTWFuYWdlcnMgZnJvbSBcInNyYy9maWVsZHMvZmllbGRNYW5hZ2Vycy9NYW5hZ2Vyc1wiO1xuXG5mdW5jdGlvbiBpc01lbnUoY2F0ZWdvcnk6IE1lbnUgfCBTZWxlY3RNb2RhbCk6IGNhdGVnb3J5IGlzIE1lbnUge1xuXHRyZXR1cm4gKGNhdGVnb3J5IGFzIE1lbnUpLmFkZEl0ZW0gIT09IHVuZGVmaW5lZDtcbn07XG5cbmZ1bmN0aW9uIGlzU2VsZWN0KGNhdGVnb3J5OiBNZW51IHwgU2VsZWN0TW9kYWwpOiBjYXRlZ29yeSBpcyBTZWxlY3RNb2RhbCB7XG5cdHJldHVybiAoY2F0ZWdvcnkgYXMgU2VsZWN0TW9kYWwpLm1vZGFscyAhPT0gdW5kZWZpbmVkO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgT3B0aW9uc0xpc3Qge1xuXG5cdC8vIGFkZHMgb3B0aW9ucyB0byBjb250ZXh0IG1lbnUgb3IgdG8gYSBkcm9wZG93biBtb2RhbCB0cmlnZ2VyIHdpdGggXCJGaWVsZDogT3B0aW9uc1wiIGNvbW1hbmQgaW4gY29tbWFuZCBwYWxsZXR0ZVxuXG5cdGFwcDogQXBwO1xuXHRmaWxlOiBURmlsZTtcblx0cGx1Z2luOiBNZXRhZGF0YU1lbnU7XG5cdHBhdGg6IHN0cmluZztcblx0Y2F0ZWdvcnk6IE1lbnUgfCBTZWxlY3RNb2RhbDtcblx0ZmlsZUNsYXNzOiBGaWxlQ2xhc3M7XG5cdGF0dHJpYnV0ZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz47XG5cdGZpbGVDbGFzc0ZvckZpZWxkczogYm9vbGVhbjtcblx0ZmlsZUNsYXNzRmllbGRzOiBzdHJpbmdbXTtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZTogVEZpbGUsIGNhdGVnb3J5OiBNZW51IHwgU2VsZWN0TW9kYWwpIHtcblx0XHR0aGlzLmZpbGUgPSBmaWxlO1xuXHRcdHRoaXMucGx1Z2luID0gcGx1Z2luO1xuXHRcdHRoaXMuY2F0ZWdvcnkgPSBjYXRlZ29yeTtcblx0XHR0aGlzLmF0dHJpYnV0ZXMgPSB7fTtcblx0XHR0aGlzLmZpbGVDbGFzc0ZpZWxkcyA9IFtdO1xuXHRcdHRoaXMuZmlsZUNsYXNzRm9yRmllbGRzID0gZmFsc2U7XG5cdH07XG5cblx0cHJpdmF0ZSBhc3luYyBmZXRjaEZyb250bWF0dGVyRmllbGRzKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnN0IGZyb250bWF0dGVyID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUodGhpcy5maWxlLnBhdGgpPy5mcm9udG1hdHRlcjtcblx0XHRpZiAoZnJvbnRtYXR0ZXIpIHtcblx0XHRcdGNvbnN0IHsgcG9zaXRpb24sIC4uLmF0dHJpYnV0ZXMgfSA9IGZyb250bWF0dGVyO1xuXHRcdFx0T2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaChrZXkgPT4ge1xuXHRcdFx0XHRpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhrZXkpKSB7XG5cdFx0XHRcdFx0dGhpcy5hdHRyaWJ1dGVzW2tleV0gPSBhdHRyaWJ1dGVzW2tleV07XG5cdFx0XHRcdH07XG5cdFx0XHR9KTtcblx0XHRcdGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG5cdFx0XHRpZiAoT2JqZWN0LmtleXModGhpcy5hdHRyaWJ1dGVzKS5pbmNsdWRlcyhmaWxlQ2xhc3NBbGlhcykgfHwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzKSB7XG5cdFx0XHRcdGNvbnN0IGZpbGVDbGFzcyA9IHRoaXMuYXR0cmlidXRlc1tmaWxlQ2xhc3NBbGlhc10gfHwgdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsRmlsZUNsYXNzIGFzIHN0cmluZztcblx0XHRcdFx0dHJ5IHtcblx0XHRcdFx0XHRjb25zdCBfZmlsZUNsYXNzID0gYXdhaXQgY3JlYXRlRmlsZUNsYXNzKHRoaXMucGx1Z2luLCBmaWxlQ2xhc3MpXG5cdFx0XHRcdFx0dGhpcy5maWxlQ2xhc3MgPSBfZmlsZUNsYXNzO1xuXHRcdFx0XHRcdHRoaXMuZmlsZUNsYXNzRmllbGRzID0gX2ZpbGVDbGFzcy5hdHRyaWJ1dGVzLm1hcChhdHRyID0+IGF0dHIubmFtZSk7XG5cdFx0XHRcdFx0dGhpcy5maWxlQ2xhc3NGb3JGaWVsZHMgPSB0cnVlO1xuXHRcdFx0XHRcdE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goa2V5ID0+IHtcblx0XHRcdFx0XHRcdGlmICghdGhpcy5maWxlQ2xhc3NGaWVsZHMuaW5jbHVkZXMoa2V5KSAmJiBrZXkgIT0gZmlsZUNsYXNzQWxpYXMpIHtcblx0XHRcdFx0XHRcdFx0ZGVsZXRlIHRoaXMuYXR0cmlidXRlc1trZXldO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHQvL2RvIG5vdGhpbmdcblx0XHRcdFx0fVxuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYXN5bmMgZmV0Y2hJbmxpbmVGaWVsZHMoKTogUHJvbWlzZTx2b2lkPiB7XG5cdFx0Y29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQodGhpcy5maWxlKTtcblx0XHRyZXN1bHQuc3BsaXQoJ1xcbicpLm1hcChsaW5lID0+IHtcblx0XHRcdGNvbnN0IGxpbmVGaWVsZHMgPSBnZXRMaW5lRmllbGRzKGxpbmUpO1xuXHRcdFx0bGluZUZpZWxkcy5mb3JFYWNoKCh7IGF0dHJpYnV0ZSwgdmFsdWVzIH0pID0+IHtcblx0XHRcdFx0aWYgKGF0dHJpYnV0ZSAmJiAhdGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2xvYmFsbHlJZ25vcmVkRmllbGRzLmluY2x1ZGVzKGF0dHJpYnV0ZS50cmltKCkpKSB7XG5cdFx0XHRcdFx0aWYgKHRoaXMuZmlsZUNsYXNzRm9yRmllbGRzKSB7XG5cdFx0XHRcdFx0XHRpZiAodGhpcy5maWxlQ2xhc3NGaWVsZHMuaW5jbHVkZXMoYXR0cmlidXRlLnRyaW0oKSkpIHtcblx0XHRcdFx0XHRcdFx0dGhpcy5hdHRyaWJ1dGVzW2F0dHJpYnV0ZS50cmltKCldID0gdmFsdWVzID8gdmFsdWVzLnRyaW0oKSA6IFwiXCI7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHR0aGlzLmF0dHJpYnV0ZXNbYXR0cmlidXRlLnRyaW0oKV0gPSB2YWx1ZXMgPyB2YWx1ZXMudHJpbSgpIDogXCJcIjtcblx0XHRcdFx0XHR9O1xuXHRcdFx0XHR9O1xuXG5cdFx0XHR9KVxuXHRcdH0pO1xuXHR9XG5cblx0cHVibGljIGFzeW5jIGNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRhd2FpdCB0aGlzLmZldGNoRnJvbnRtYXR0ZXJGaWVsZHMoKTtcblx0XHRhd2FpdCB0aGlzLmZldGNoSW5saW5lRmllbGRzKCk7XG5cdFx0aWYgKHRoaXMuZmlsZUNsYXNzKSB7XG5cdFx0XHRjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCkpO1xuXHRcdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0XHR0aGlzLmNhdGVnb3J5LmFkZFNlcGFyYXRvcigpO1xuXHRcdFx0XHR0aGlzLmNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRpdGVtLnNldEljb24oXCJnZWFyXCIpO1xuXHRcdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYE1hbmFnZSA8JHt0aGlzLmZpbGVDbGFzcy5uYW1lfT4gZmllbGRzYCk7XG5cdFx0XHRcdFx0aXRlbS5vbkNsaWNrKCgpID0+IGZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsLm9wZW4oKSlcblx0XHRcdFx0fSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmNhdGVnb3J5LmFkZE9wdGlvbihcIm1hbmFnZV9maWxlQ2xhc3NfYXR0cmlidXRlc1wiLCBgTWFuYWdlIDwke3RoaXMuZmlsZUNsYXNzLm5hbWV9PiBmaWVsZHNgKTtcblx0XHRcdFx0dGhpcy5jYXRlZ29yeS5tb2RhbHNbXCJtYW5hZ2VfZmlsZUNsYXNzX2F0dHJpYnV0ZXNcIl0gPSAoKSA9PiBmaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbC5vcGVuKCk7XG5cdFx0XHR9O1xuXHRcdH1cblx0XHRpZiAoaXNNZW51KHRoaXMuY2F0ZWdvcnkpKSB7IHRoaXMuY2F0ZWdvcnkuYWRkU2VwYXJhdG9yKCk7IH07XG5cdFx0dGhpcy5idWlsZEZpZWxkT3B0aW9ucygpO1xuXHRcdHRoaXMuYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk7XG5cdH1cblxuXHRwcml2YXRlIGJ1aWxkRmllbGRPcHRpb25zKCk6IHZvaWQge1xuXHRcdE9iamVjdC5rZXlzKHRoaXMuYXR0cmlidXRlcykuZm9yRWFjaCgoa2V5OiBzdHJpbmcpID0+IHtcblx0XHRcdGNvbnN0IHZhbHVlID0gdGhpcy5hdHRyaWJ1dGVzW2tleV07XG5cdFx0XHRjb25zdCBmaWVsZCA9IGdldEZpZWxkKHRoaXMucGx1Z2luLCBrZXksIHRoaXMuZmlsZUNsYXNzKTtcblx0XHRcdGlmIChmaWVsZCkge1xuXHRcdFx0XHRjb25zdCBmaWVsZE1hbmFnZXIgPSBuZXcgRmllbGRNYW5hZ2VyW2ZpZWxkLnR5cGVdKGZpZWxkKTtcblx0XHRcdFx0ZmllbGRNYW5hZ2VyLmFkZE1lbnVPcHRpb24oa2V5LCB2YWx1ZSwgdGhpcy5wbHVnaW4uYXBwLCB0aGlzLmZpbGUsIHRoaXMuY2F0ZWdvcnkpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0Y29uc3QgZGVmYXVsdEZpZWxkID0gbmV3IEZpZWxkKGtleSlcblx0XHRcdFx0ZGVmYXVsdEZpZWxkLnR5cGUgPSBGaWVsZFR5cGUuSW5wdXRcblx0XHRcdFx0Y29uc3QgZmllbGRNYW5hZ2VyID0gbmV3IE1hbmFnZXJzLklucHV0KGRlZmF1bHRGaWVsZClcblx0XHRcdFx0ZmllbGRNYW5hZ2VyLmFkZE1lbnVPcHRpb24oa2V5LCB2YWx1ZSwgdGhpcy5wbHVnaW4uYXBwLCB0aGlzLmZpbGUsIHRoaXMuY2F0ZWdvcnkpXG5cdFx0XHR9XG5cdFx0fSk7XG5cdH1cblxuXHRwcml2YXRlIGFkZFNlY3Rpb25TZWxlY3RNb2RhbE9wdGlvbigpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IG5ldyBjaG9vc2VTZWN0aW9uTW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgdGhpcy5maWxlQ2xhc3MpO1xuXHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRpdGVtLnNldEljb24oXCJwZW5jaWxcIik7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoXCJBZGQgZmllbGQgYXQgc2VjdGlvbi4uLlwiKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdH0pO1xuXHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJ0YXJnZXQtbWV0YWRhdGFcIik7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2UgaWYgKGlzU2VsZWN0KHRoaXMuY2F0ZWdvcnkpKSB7XG5cdFx0XHR0aGlzLmNhdGVnb3J5LmFkZE9wdGlvbihcImFkZF9maWVsZF9hdF9zZWN0aW9uXCIsIFwiQWRkIGZpZWxkIGF0IHNlY3Rpb24uLi5cIik7XG5cdFx0XHR0aGlzLmNhdGVnb3J5Lm1vZGFsc1tcImFkZF9maWVsZF9hdF9zZWN0aW9uXCJdID0gKCkgPT4gbW9kYWwub3BlbigpO1xuXHRcdH07XG5cdH07XG59O1xuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgT3B0aW9uc0xpc3QgZnJvbSBcInNyYy9vcHRpb25zL09wdGlvbnNMaXN0XCI7XG5pbXBvcnQgU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvU2VsZWN0TW9kYWxcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHVibGljIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIHNlbGVjdDogU2VsZWN0TW9kYWw7XG4gICAgcHJpdmF0ZSBvcHRpb25zTGlzdDogT3B0aW9uc0xpc3Q7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICB9O1xuXG4gICAgYXN5bmMgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IHRoZSBmaWVsZCB0byBtYW5hZ2VgKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG4gICAgICAgIGNvbnN0IG9wdGlvbnNMaXN0Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLW9wdGlvbnNcIn0pO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0ID0gbmV3IFNlbGVjdE1vZGFsKG9wdGlvbnNMaXN0Q29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5zZWxlY3QuYWRkT3B0aW9uKFwiLS0tXCIsIFwiQ2hvb3NlIEZpZWxkXCIpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5vcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLnNlbGVjdCk7XG4gICAgICAgIGF3YWl0IHRoaXMub3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG4gICAgICAgIHRoaXMuc2VsZWN0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3QubW9kYWxzW3ZhbHVlXSgpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZWxlY3Quc2VsZWN0RWwuZm9jdXMoKTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IHsgRHJvcGRvd25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VsZWN0TW9kYWwgZXh0ZW5kcyBEcm9wZG93bkNvbXBvbmVudCB7XG4gICAgcHVibGljIG1vZGFsczogUmVjb3JkPHN0cmluZywgYW55PjtcblxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBzdXBlcihjb250YWluZXJFbCk7XG4gICAgICAgIHRoaXMubW9kYWxzID0ge307XG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7XG4gICAgQXBwLFxuICAgIEVkaXRvcixcbiAgICBFZGl0b3JQb3NpdGlvbixcbiAgICBFZGl0b3JTdWdnZXN0LFxuICAgIEVkaXRvclN1Z2dlc3RDb250ZXh0LFxuICAgIEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyxcbiAgICBNYXJrZG93blZpZXcsXG4gICAgVEZpbGUsXG4gICAgcGFyc2VZYW1sLFxuICAgIE5vdGljZVxufSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGNyZWF0ZUZpbGVDbGFzcywgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBGaWVsZE1hbmFnZXIsIEZpZWxkVHlwZSB9IGZyb20gXCJzcmMvdHlwZXMvZmllbGRUeXBlc1wiO1xuaW1wb3J0IHsgZ2VuZXJpY0ZpZWxkUmVnZXgsIGdldExpbmVGaWVsZHMsIGVuY29kZUxpbmsgfSBmcm9tIFwiLi4vdXRpbHMvcGFyc2VyXCI7XG5pbXBvcnQgRmlsZUZpZWxkIGZyb20gXCJzcmMvZmllbGRzL2ZpZWxkTWFuYWdlcnMvRmlsZUZpZWxkXCI7XG5cbmludGVyZmFjZSBJVmFsdWVDb21wbGV0aW9uIHtcbiAgICB2YWx1ZTogc3RyaW5nO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgVmFsdWVTdWdnZXN0IGV4dGVuZHMgRWRpdG9yU3VnZ2VzdDxJVmFsdWVDb21wbGV0aW9uPiB7XG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgZmlsZUNsYXNzOiBGaWxlQ2xhc3M7XG4gICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBpbkZ1bGxMaW5lOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBpblNlbnRlbmNlOiBib29sZWFuID0gZmFsc2U7XG4gICAgcHJpdmF0ZSBkaWRTZWxlY3Q6IGJvb2xlYW4gPSBmYWxzZVxuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHBsdWdpbjogTWV0YWRhdGFNZW51KSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5zZXRJbnN0cnVjdGlvbnMoW3sgY29tbWFuZDogXCJTaGlmdFwiLCBwdXJwb3NlOiBcInB1dCBhIHNwYWNlIGFmdGVyOjpcIiB9XSk7XG5cbiAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICB0aGlzLnNjb3BlLnJlZ2lzdGVyKFtcIlNoaWZ0XCJdLCBcIkVudGVyXCIsIChldnQ6IEtleWJvYXJkRXZlbnQpID0+IHtcbiAgICAgICAgICAgIC8vIEB0cy1pZ25vcmVcbiAgICAgICAgICAgIHRoaXMuc3VnZ2VzdGlvbnMudXNlU2VsZWN0ZWRJdGVtKGV2dCk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBvblRyaWdnZXIoXG4gICAgICAgIGN1cnNvcjogRWRpdG9yUG9zaXRpb24sXG4gICAgICAgIGVkaXRvcjogRWRpdG9yLFxuICAgICAgICBmaWxlOiBURmlsZVxuICAgICk6IEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyB8IG51bGwge1xuICAgICAgICBpZiAodGhpcy5kaWRTZWxlY3QpIHtcbiAgICAgICAgICAgIHRoaXMuZGlkU2VsZWN0ID0gZmFsc2VcbiAgICAgICAgICAgIHJldHVybiBudWxsXG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLnBsdWdpbi5zZXR0aW5ncy5pc0F1dG9zdWdnZXN0RW5hYmxlZCkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH07XG4gICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICBjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldEZpbGVDYWNoZShmaWxlKS5mcm9udG1hdHRlcjtcbiAgICAgICAgY29uc3QgZnVsbExpbmUgPSBlZGl0b3IuZ2V0TGluZShlZGl0b3IuZ2V0Q3Vyc29yKCkubGluZSlcbiAgICAgICAgdGhpcy5pbkZyb250bWF0dGVyID0gZnJvbnRtYXR0ZXIgIT09IHVuZGVmaW5lZCAmJiBmcm9udG1hdHRlci5wb3NpdGlvbi5zdGFydC5saW5lIDwgY3Vyc29yLmxpbmUgJiYgY3Vyc29yLmxpbmUgPCBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQubGluZVxuICAgICAgICBpZiAodGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICBjb25zdCByZWdleCA9IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTooPzx2YWx1ZXM+LiopYCwgXCJ1XCIpO1xuICAgICAgICAgICAgaWYgKCFyZWdleC50ZXN0KGZ1bGxMaW5lKSkgcmV0dXJuIG51bGw7XG4gICAgICAgIH0gZWxzZSBpZiAoZ2V0TGluZUZpZWxkcyhmdWxsTGluZSkubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgc3RhcnQ6IGN1cnNvcixcbiAgICAgICAgICAgIGVuZDogY3Vyc29yLFxuICAgICAgICAgICAgcXVlcnk6IGVkaXRvci5nZXRMaW5lKGN1cnNvci5saW5lKSxcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBmaWx0ZXJPcHRpb24gPSAoZmlyc3RWYWx1ZXM6IHN0cmluZ1tdIHwgdW5kZWZpbmVkLCBsYXN0VmFsdWU6IHN0cmluZyB8IHVuZGVmaW5lZCwgb3B0aW9uOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICAgICAgcmV0dXJuICFmaXJzdFZhbHVlcyB8fFxuICAgICAgICAgICAgIWZpcnN0VmFsdWVzPy5jb250YWlucyhlbmNvZGVMaW5rKG9wdGlvbikpICYmICghbGFzdFZhbHVlIHx8XG4gICAgICAgICAgICAgICAgISFsYXN0VmFsdWUgJiYgZW5jb2RlTGluayhvcHRpb24pLmNvbnRhaW5zKGxhc3RWYWx1ZSkpXG4gICAgfVxuXG4gICAgYXN5bmMgZ2V0U3VnZ2VzdGlvbnMoY29udGV4dDogRWRpdG9yU3VnZ2VzdENvbnRleHQpOiBQcm9taXNlPElWYWx1ZUNvbXBsZXRpb25bXT4ge1xuICAgICAgICBjb25zdCBzdWdnZXN0aW9ucyA9IGF3YWl0IHRoaXMuZ2V0VmFsdWVTdWdnZXN0aW9ucyhjb250ZXh0KTtcbiAgICAgICAgaWYgKHN1Z2dlc3Rpb25zLmxlbmd0aCkge1xuICAgICAgICAgICAgcmV0dXJuIHN1Z2dlc3Rpb25zO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuXG4gICAgYXN5bmMgZ2V0VmFsdWVTdWdnZXN0aW9ucyhjb250ZXh0OiBFZGl0b3JTdWdnZXN0Q29udGV4dCk6IFByb21pc2U8SVZhbHVlQ29tcGxldGlvbltdPiB7XG4gICAgICAgIGNvbnN0IGxpbmVOdW1iZXIgPSBjb250ZXh0LnN0YXJ0LmxpbmU7XG4gICAgICAgIGNvbnN0IG1hdGNoRmllbGQ6IHsgYXR0cmlidXRlPzogc3RyaW5nLCB2YWx1ZXM/OiBzdHJpbmcgfSA9IHsgYXR0cmlidXRlOiB1bmRlZmluZWQsIHZhbHVlczogXCJcIiB9XG4gICAgICAgIGlmICghdGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICBjb25zdCBsaW5lRmllbGRzID0gZ2V0TGluZUZpZWxkcyhlbmNvZGVMaW5rKGNvbnRleHQuZWRpdG9yLmdldExpbmUobGluZU51bWJlcikpKTtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gY29udGV4dC5lZGl0b3IuZ2V0Q3Vyc29yKCkuY2hcbiAgICAgICAgICAgIGNvbnN0IGFjdGl2ZUxpbmVGaWVsZCA9IGxpbmVGaWVsZHMuZmluZChsaW5lRmllbGQgPT4gbGluZUZpZWxkLmluZGV4IDw9IHBvc2l0aW9uICYmIGxpbmVGaWVsZC5pbmRleCArIGxpbmVGaWVsZC5sZW5ndGggPj0gcG9zaXRpb24pXG4gICAgICAgICAgICBpZiAoYWN0aXZlTGluZUZpZWxkKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5pblNlbnRlbmNlID0gYWN0aXZlTGluZUZpZWxkLmluZGV4ID4gMDtcbiAgICAgICAgICAgICAgICB0aGlzLmluRnVsbExpbmUgPSBhY3RpdmVMaW5lRmllbGQuaW5kZXggPT09IDA7XG4gICAgICAgICAgICAgICAgbWF0Y2hGaWVsZC5hdHRyaWJ1dGUgPSBhY3RpdmVMaW5lRmllbGQuYXR0cmlidXRlO1xuICAgICAgICAgICAgICAgIG1hdGNoRmllbGQudmFsdWVzID0gYWN0aXZlTGluZUZpZWxkLnZhbHVlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgXiR7Z2VuZXJpY0ZpZWxkUmVnZXh9Oig/PHZhbHVlcz4uKyk/YCwgXCJ1XCIpO1xuICAgICAgICAgICAgY29uc3QgcmVnZXhSZXN1bHQgPSBjb250ZXh0LmVkaXRvci5nZXRSYW5nZSh7IGxpbmU6IGxpbmVOdW1iZXIsIGNoOiAwIH0sIGNvbnRleHQuZW5kKS5tYXRjaChyZWdleCk7XG4gICAgICAgICAgICBpZiAocmVnZXhSZXN1bHQ/Lmdyb3Vwcykge1xuICAgICAgICAgICAgICAgIG1hdGNoRmllbGQuYXR0cmlidXRlID0gcmVnZXhSZXN1bHQuZ3JvdXBzLmF0dHJpYnV0ZTtcbiAgICAgICAgICAgICAgICBtYXRjaEZpZWxkLnZhbHVlcyA9IHJlZ2V4UmVzdWx0Lmdyb3Vwcy52YWx1ZXM7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG5cbiAgICAgICAgaWYgKG1hdGNoRmllbGQuYXR0cmlidXRlKSB7XG4gICAgICAgICAgICBjb25zdCBmaWVsZE5hbWUgPSBtYXRjaEZpZWxkLmF0dHJpYnV0ZTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSBtYXRjaEZpZWxkLnZhbHVlcz8ucmVwbGFjZSgvXlxcW3xeXFxzXFxbfF5cXCh8Xlxcc1xcKC8sICcnKVxuICAgICAgICAgICAgICAgIC5yZXBsYWNlKC9cXF0kfFxcKSQvLCAnJylcbiAgICAgICAgICAgICAgICAuc3BsaXQoXCIsXCIpLm1hcChvID0+IGVuY29kZUxpbmsoby50cmltKCkpKVxuICAgICAgICAgICAgY29uc3QgbGFzdFZhbHVlID0gdmFsdWVzTGlzdD8ubGFzdCgpXG4gICAgICAgICAgICBjb25zdCBmaXJzdFZhbHVlcyA9IHZhbHVlc0xpc3Q/LnNsaWNlKDAsIC0xKVxuICAgICAgICAgICAgLy90YWdzIHNwZWNpZmljIGNhc1xuICAgICAgICAgICAgaWYgKGZpZWxkTmFtZSA9PT0gXCJ0YWdzXCIgJiYgdGhpcy5pbkZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICAgICAgcmV0dXJuIE9iamVjdC5rZXlzKHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0VGFncygpKVxuICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKHQgPT4gbGFzdFZhbHVlID8gdC5jb250YWlucyhsYXN0VmFsdWUpIDogdClcbiAgICAgICAgICAgICAgICAgICAgLnNvcnQoKVxuICAgICAgICAgICAgICAgICAgICAubWFwKHRhZyA9PiBPYmplY3QoeyB2YWx1ZTogdGFnLnJlcGxhY2UoL14jLywgXCJcIikgfSkpXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAvL2lmIHRoaXMgbm90ZSBoYXMgYSBmaWxlQ2xhc3MsIGNoZWNrIGlmIGZpZWxkIG9wdGlvbnMgYXJlIGRlZmluZWQgaW4gdGhlIEZpbGVDbGFzc1xuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRDYWNoZShjb250ZXh0LmZpbGUucGF0aCk7XG4gICAgICAgICAgICBsZXQgdHJ5V2l0aFByZXNldEZpZWxkID0gIWNhY2hlPy5mcm9udG1hdHRlcjtcbiAgICAgICAgICAgIGlmIChjYWNoZT8uZnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHBvc2l0aW9uLCAuLi5hdHRyaWJ1dGVzIH0gPSBjYWNoZS5mcm9udG1hdHRlcjtcbiAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBbGlhcyA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzO1xuICAgICAgICAgICAgICAgIGlmIChPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5jb250YWlucyhmaWxlQ2xhc3NBbGlhcykpIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzVmFsdWUgPSBhdHRyaWJ1dGVzW2ZpbGVDbGFzc0FsaWFzXTtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IGF3YWl0IGNyZWF0ZUZpbGVDbGFzcyh0aGlzLnBsdWdpbiwgZmlsZUNsYXNzVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3MgPSBmaWxlQ2xhc3M7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVzID0gdGhpcy5maWxlQ2xhc3MuYXR0cmlidXRlcztcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGVzLm1hcChhdHRyID0+IGF0dHIubmFtZSkuY29udGFpbnMoZmllbGROYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZmlsZUNsYXNzQXR0cmlidXRlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmluZChhdHRyID0+IGF0dHIubmFtZSA9PSBmaWVsZE5hbWUpIS5nZXRGaWVsZCgpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKFtGaWVsZFR5cGUuQ3ljbGUsIEZpZWxkVHlwZS5NdWx0aSwgRmllbGRUeXBlLlNlbGVjdF0uY29udGFpbnMoZmllbGQudHlwZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsdGVyZWRPcHRpb25zID0gQXJyYXkuaXNBcnJheShmaWVsZC5vcHRpb25zKSA/XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZC5vcHRpb25zLmZpbHRlcihvcHRpb24gPT4gdGhpcy5maWx0ZXJPcHRpb24oZmlyc3RWYWx1ZXMsIGxhc3RWYWx1ZSwgb3B0aW9uKSkgOlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgT2JqZWN0LmtleXMoZmllbGQub3B0aW9ucylcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGsgPT4gZmllbGQub3B0aW9uc1trXSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG9wdGlvbiA9PiB0aGlzLmZpbHRlck9wdGlvbihmaXJzdFZhbHVlcywgbGFzdFZhbHVlLCBvcHRpb24pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsdGVyZWRPcHRpb25zLm1hcChvcHRpb24gPT4gT2JqZWN0KHsgdmFsdWU6IG9wdGlvbiB9KSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmIChmaWVsZC50eXBlID09PSBGaWVsZFR5cGUuRmlsZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gW11cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9UT0RPIGdldCBmaWxlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeVdpdGhQcmVzZXRGaWVsZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5V2l0aFByZXNldEZpZWxkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0cnlXaXRoUHJlc2V0RmllbGQpIHtcbiAgICAgICAgICAgICAgICAvL2Vsc2UgY2hlY2sgaWYgdGhlcmUgYXJlIGdsb2JhbCBwcmVzZXQgdm9wdGlvc2FsdWVzXG4gICAgICAgICAgICAgICAgY29uc3QgcHJlc2V0RmllbGQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmluZChmaWVsZCA9PiBmaWVsZC5uYW1lID09IGZpZWxkTmFtZSk7XG4gICAgICAgICAgICAgICAgaWYgKHByZXNldEZpZWxkKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChbRmllbGRUeXBlLkN5Y2xlLCBGaWVsZFR5cGUuTXVsdGksIEZpZWxkVHlwZS5TZWxlY3RdLmNvbnRhaW5zKHByZXNldEZpZWxkLnR5cGUpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAocHJlc2V0RmllbGQudmFsdWVzTGlzdE5vdGVQYXRoKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9vdmVycmlkZSBwcmVzZXRWYWx1ZXMgaWYgdGhlcmUgaXMgYSB2YWx1ZXNMaXN0XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocHJlc2V0RmllbGQudmFsdWVzTGlzdE5vdGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodmFsdWVzRmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIHZhbHVlc0ZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXM6IHsgdmFsdWU6IHN0cmluZyB9W10gPSBhd2FpdCAoYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQodmFsdWVzRmlsZSkpLnNwbGl0KFwiXFxuXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG9wdGlvbiA9PiB0aGlzLmZpbHRlck9wdGlvbihmaXJzdFZhbHVlcywgbGFzdFZhbHVlLCBvcHRpb24pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChfdmFsdWUgPT4gT2JqZWN0KHsgdmFsdWU6IF92YWx1ZSB9KSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHZhbHVlcyA9IE9iamVjdC5lbnRyaWVzKHByZXNldEZpZWxkLm9wdGlvbnMpLm1hcChvcHRpb24gPT4gb3B0aW9uWzFdKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5maWx0ZXIob3B0aW9uID0+IHRoaXMuZmlsdGVyT3B0aW9uKGZpcnN0VmFsdWVzLCBsYXN0VmFsdWUsIG9wdGlvbikpXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChfdmFsdWUgPT4gT2JqZWN0KHsgdmFsdWU6IF92YWx1ZSB9KSlcblxuICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHByZXNldEZpZWxkLnR5cGUgPT09IEZpZWxkVHlwZS5GaWxlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZE1hbmFnZXI6IEZpbGVGaWVsZCA9IG5ldyBGaWVsZE1hbmFnZXJbcHJlc2V0RmllbGQudHlwZV0ocHJlc2V0RmllbGQpXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlcyA9IGZpZWxkTWFuYWdlci5nZXRGaWxlcygpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGxhc3RWYWx1ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmaWxlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGYgPT4gZi5iYXNlbmFtZS5pbmNsdWRlcyhsYXN0VmFsdWUpKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKGYgPT4gT2JqZWN0KHsgdmFsdWU6IEZpbGVGaWVsZC5idWlsZE1hcmtEb3duTGluayhhcHAsIGNvbnRleHQuZmlsZSwgZi5iYXNlbmFtZSkgfSkpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmlsZXNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm1hcChmID0+IE9iamVjdCh7IHZhbHVlOiBGaWxlRmllbGQuYnVpbGRNYXJrRG93bkxpbmsoYXBwLCBjb250ZXh0LmZpbGUsIGYuYmFzZW5hbWUpIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBbXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuXG4gICAgcmVuZGVyU3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBJVmFsdWVDb21wbGV0aW9uLCBlbDogSFRNTEVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgZWwuc2V0VGV4dChzdWdnZXN0aW9uLnZhbHVlKTtcbiAgICB9O1xuXG4gICAgc2VsZWN0U3VnZ2VzdGlvbihzdWdnZXN0aW9uOiBJVmFsdWVDb21wbGV0aW9uLCBldmVudDogS2V5Ym9hcmRFdmVudCB8IE1vdXNlRXZlbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgYWN0aXZlVmlldyA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVWaWV3T2ZUeXBlKE1hcmtkb3duVmlldyk7XG4gICAgICAgIGlmICghYWN0aXZlVmlldykge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9O1xuICAgICAgICBjb25zdCBlZGl0b3IgPSBhY3RpdmVWaWV3LmVkaXRvcjtcbiAgICAgICAgY29uc3QgYWN0aXZlTGluZSA9IGVkaXRvci5nZXRMaW5lKHRoaXMuY29udGV4dCEuc3RhcnQubGluZSk7XG5cbiAgICAgICAgaWYgKHRoaXMuaW5Gcm9udG1hdHRlcikge1xuICAgICAgICAgICAgLy9mb3JtYXQgbGlzdCBpZiBpbiBmcm9udG1hdHRlclxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBsZXQgcGFyc2VkRmllbGQ6IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IHN0cmluZ1tdIHwgbnVsbD4gPSBwYXJzZVlhbWwoYWN0aXZlTGluZSlcbiAgICAgICAgICAgICAgICBsZXQgW2F0dHIsIHBhc3RWYWx1ZXNdID0gT2JqZWN0LmVudHJpZXMocGFyc2VkRmllbGQpWzBdXG4gICAgICAgICAgICAgICAgbGV0IG5ld0ZpZWxkOiBzdHJpbmdcbiAgICAgICAgICAgICAgICBpZiAoIXBhc3RWYWx1ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFwiICsgc3VnZ2VzdGlvbi52YWx1ZTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBwYXN0VmFsdWVzID09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghcGFzdFZhbHVlcy5jb250YWlucyhcIixcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBcIiArIHN1Z2dlc3Rpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogW1wiICsgcGFzdFZhbHVlcy5zcGxpdChcIixcIikubWFwKG8gPT4gby50cmltKCkpLnNsaWNlKDAsIC0xKS5qb2luKCcsICcpICsgXCIsIFwiICsgc3VnZ2VzdGlvbi52YWx1ZSArIFwiXVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHBhc3RWYWx1ZXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmIChhY3RpdmVMaW5lLmVuZHNXaXRoKFwiLF1cIikgfHwgYWN0aXZlTGluZS5lbmRzV2l0aChcIiwgXVwiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy92YWx1ZSBjYW4gYmUgZGlyZWN0bHkgYWRkZWQgc2luY2UgcGFyc2VZYW1sIHdvbnQgY3JlYXRlIGFuIGVtcHR5IGxhc3QgaXRlbSBpbiBwYXN0VmFsdWVzXG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogW1wiICsgWy4uLnBhc3RWYWx1ZXMsIHN1Z2dlc3Rpb24udmFsdWVdLmpvaW4oXCIsIFwiKSArIFwiXVwiO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgLy93ZSBoYXZlIHR5cGVkIHNvbWV0aGluZyB0aGF0IHdlIGFodmUgdG8gcmVtb3ZlIHRvIHJlcGxhY2Ugd2l0aCBzZWxlY3RlZCB2YWx1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIFsuLi5wYXN0VmFsdWVzLnNsaWNlKDAsIC0xKSwgc3VnZ2VzdGlvbi52YWx1ZV0uam9pbihcIiwgXCIpICsgXCJdXCI7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBbXCIgKyBbLi4ucGFzdFZhbHVlc10uam9pbihcIiwgXCIpICsgXCJdXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UobmV3RmllbGQsIHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogMCB9LCB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IGFjdGl2ZUxpbmUubGVuZ3RoIH0pO1xuICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHBhc3RWYWx1ZXMpIHx8IHR5cGVvZiBwYXN0VmFsdWVzID09PSAnc3RyaW5nJyAmJiBwYXN0VmFsdWVzLmNvbnRhaW5zKFwiLFwiKSkge1xuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogbmV3RmllbGQubGVuZ3RoIC0gMSB9KVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGVkaXRvci5zZXRDdXJzb3IoeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBuZXdGaWVsZC5sZW5ndGggfSlcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJGcm9udG1hdHRlciB3cm9uZ2x5IGZvcm1hdHRlZFwiLCAyMDAwKVxuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKVxuICAgICAgICAgICAgICAgIHJldHVyblxuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuaW5GdWxsTGluZSkge1xuICAgICAgICAgICAgbGV0IGNsZWFuZWRMaW5lID0gYWN0aXZlTGluZVxuICAgICAgICAgICAgd2hpbGUgKCFbJywnLCAnOiddLmNvbnRhaW5zKGNsZWFuZWRMaW5lLmNoYXJBdChjbGVhbmVkTGluZS5sZW5ndGggLSAxKSkpIHtcbiAgICAgICAgICAgICAgICBjbGVhbmVkTGluZSA9IGNsZWFuZWRMaW5lLnNsaWNlKDAsIC0xKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShgJHtjbGVhbmVkTGluZX0ke2V2ZW50LnNoaWZ0S2V5ID8gXCIgXCIgOiBcIlwifWAgKyBzdWdnZXN0aW9uLnZhbHVlLFxuICAgICAgICAgICAgICAgIHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogMCB9LCB0aGlzLmNvbnRleHQhLmVuZCk7XG4gICAgICAgIH0gZWxzZSBpZiAodGhpcy5pblNlbnRlbmNlKSB7XG4gICAgICAgICAgICBjb25zdCBwb3NpdGlvbiA9IHRoaXMuY29udGV4dD8uZWRpdG9yLmdldEN1cnNvcigpLmNoIHx8IDBcbiAgICAgICAgICAgIGxldCBiZWZvcmVDdXJzb3IgPSBhY3RpdmVMaW5lLnNsaWNlKDAsIHBvc2l0aW9uKVxuICAgICAgICAgICAgbGV0IGFmdGVyQ3Vyc29yID0gYWN0aXZlTGluZS5zbGljZShwb3NpdGlvbilcbiAgICAgICAgICAgIGxldCBzZXBhcmF0b3JQb3MgPSBwb3NpdGlvbjtcbiAgICAgICAgICAgIGxldCBjdXJyZW50VmFsdWVMZW5ndGggPSAwO1xuICAgICAgICAgICAgd2hpbGUgKCFiZWZvcmVDdXJzb3IuZW5kc1dpdGgoXCI6OlwiKSAmJiAhYmVmb3JlQ3Vyc29yLmVuZHNXaXRoKFwiLFwiKSAmJiBiZWZvcmVDdXJzb3IubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgc2VwYXJhdG9yUG9zID0gc2VwYXJhdG9yUG9zIC0gMTtcbiAgICAgICAgICAgICAgICBjdXJyZW50VmFsdWVMZW5ndGggPSBjdXJyZW50VmFsdWVMZW5ndGggKyAxXG4gICAgICAgICAgICAgICAgYmVmb3JlQ3Vyc29yID0gYmVmb3JlQ3Vyc29yLnNsaWNlKDAsIC0xKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGxldCBuZXh0QnJhY2tldFBvcyA9IHBvc2l0aW9uO1xuICAgICAgICAgICAgd2hpbGUgKCFlbmNvZGVMaW5rKGFmdGVyQ3Vyc29yKS5tYXRjaChcIihcXFxcXXxcXFxcKSkuKlwiKSAmJiBhZnRlckN1cnNvci5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICBuZXh0QnJhY2tldFBvcyA9IG5leHRCcmFja2V0UG9zICsgMTtcbiAgICAgICAgICAgICAgICBhZnRlckN1cnNvciA9IGFmdGVyQ3Vyc29yLnNsaWNlKG5leHRCcmFja2V0UG9zIC0gcG9zaXRpb24pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWRpdG9yLnJlcGxhY2VSYW5nZShcbiAgICAgICAgICAgICAgICBzdWdnZXN0aW9uLnZhbHVlLFxuICAgICAgICAgICAgICAgIHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogc2VwYXJhdG9yUG9zIH0sXG4gICAgICAgICAgICAgICAgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBuZXh0QnJhY2tldFBvcyB9XG4gICAgICAgICAgICApXG4gICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogbmV4dEJyYWNrZXRQb3MgLSBjdXJyZW50VmFsdWVMZW5ndGggKyBzdWdnZXN0aW9uLnZhbHVlLmxlbmd0aCB9KVxuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlkU2VsZWN0ID0gdHJ1ZVxuICAgICAgICB0aGlzLmNsb3NlKClcbiAgICB9O1xufTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiXG5pbXBvcnQgRmllbGQgZnJvbSBcIi4uL2ZpZWxkcy9GaWVsZFwiXG5pbXBvcnQgeyBGaWVsZFR5cGUgfSBmcm9tIFwic3JjL3R5cGVzL2ZpZWxkVHlwZXNcIlxuXG5pbnRlcmZhY2UgT2xkRmllbGQgZXh0ZW5kcyBGaWVsZCB7XG4gICAgaXNNdWx0aT86IGJvb2xlYW4sXG4gICAgaXNDeWNsZT86IGJvb2xlYW4sXG4gICAgaXNCb29sZWFuPzogYm9vbGVhbixcbiAgICB2YWx1ZXM/OiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG59XG5cbmV4cG9ydCBjb25zdCBtaWdyYXRlU2V0dGluZ3NWMXRvVjIgPSBhc3luYyAocGx1Z2luOiBNZXRhZGF0YU1lbnUpID0+IHtcbiAgICBjb25zdCBwcmVzZXRGaWVsZHMgPSBwbHVnaW4uc2V0dGluZ3MucHJlc2V0RmllbGRzXG4gICAgcHJlc2V0RmllbGRzLmZvckVhY2goKHA6IE9sZEZpZWxkKSA9PiB7XG4gICAgICAgIGlmICghT2JqZWN0LmtleXMocCkuY29udGFpbnMoXCJ0eXBlXCIpKSB7XG4gICAgICAgICAgICBpZiAocC5pc011bHRpKSBwLnR5cGUgPSBGaWVsZFR5cGUuTXVsdGlcbiAgICAgICAgICAgIGVsc2UgaWYgKHAuaXNDeWNsZSkgcC50eXBlID0gRmllbGRUeXBlLkN5Y2xlXG4gICAgICAgICAgICBlbHNlIGlmIChwLmlzQm9vbGVhbikgcC50eXBlID0gRmllbGRUeXBlLkJvb2xlYW5cbiAgICAgICAgICAgIGVsc2UgaWYgKHAub3B0aW9ucyAmJiBPYmplY3Qua2V5cyhwLm9wdGlvbnMpLmxlbmd0aCA+IDApIHAudHlwZSA9IEZpZWxkVHlwZS5TZWxlY3RcbiAgICAgICAgICAgIGVsc2UgcC50eXBlID0gRmllbGRUeXBlLklucHV0XG4gICAgICAgIH1cbiAgICAgICAgLy9lcmFzZSBpc011bHRpLCBpc0N5Y2xlLCBpc0Jvb2xlYW4gaWYgZXhpc3RzXG4gICAgICAgIGRlbGV0ZSBwLmlzTXVsdGk7XG4gICAgICAgIGRlbGV0ZSBwLmlzQ3ljbGU7XG4gICAgICAgIGRlbGV0ZSBwLmlzQm9vbGVhblxuICAgICAgICAvL3JlbmFtZSBcInZhbHVlc1wiIGluIFwib3B0aW9uXCJcbiAgICAgICAgaWYgKE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocCwgXCJ2YWx1ZXNcIikgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHAsIFwib3B0aW9uc1wiLFxuICAgICAgICAgICAgICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IocCwgXCJ2YWx1ZXNcIikhKTtcbiAgICAgICAgICAgIGRlbGV0ZSBwW1widmFsdWVzXCJdO1xuICAgICAgICB9XG4gICAgfSlcbiAgICBwbHVnaW4uc2V0dGluZ3Muc2V0dGluZ3NWZXJzaW9uID0gMlxuICAgIGF3YWl0IHBsdWdpbi5zYXZlRGF0YShwbHVnaW4uc2V0dGluZ3MpXG4gICAgY29uc29sZS5sb2coXCJNZXRhZGF0YSBtZW51IHNldHRpbmdzIG1pZ3JhdGVkXCIpXG59Il0sCiAgIm1hcHBpbmdzIjogIjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQSx3QkFBcUM7OztBQ0FyQyx3QkFBd0Y7OztBQ0N4Rix3QkFBd0k7OztBQ0R4SSx1QkFBZ0Q7OztBQ0FoRCxzQkFBMkI7OztBQ0FwQixJQUFNLGtCQUFrQixDQUFDLFVBQVUsY0FBYyxhQUFhLFlBQVkseUJBQXlCLHdCQUF3QixRQUFRO0FBRW5JLElBQU0sb0JBQW9CO0FBRTFCLElBQU0sbUJBQW1CLENBQUMsY0FBc0IsdURBQXVEO0FBRXZHLElBQU0sZ0JBQWdCLElBQUksT0FBTyxJQUFJLHVDQUF3QyxHQUFHO0FBR2hGLElBQU0sMEJBQTBCLElBQUksT0FBTyxNQUFNLCtDQUFnRCxJQUFJO0FBQ3JHLElBQU0scUJBQXFCLElBQUksT0FBTyxNQUFNLCtDQUFnRCxJQUFJO0FBRWhHLElBQU0sYUFBYSxDQUFDLFVBQTBCO0FBRWpELFNBQU8sUUFBUSxNQUNWLFFBQVEsU0FBUyxvQkFBTSxFQUN2QixRQUFRLFNBQVMsb0JBQU0sSUFBSTtBQUNwQztBQUVPLElBQU0sYUFBYSxDQUFDLFVBQTBCO0FBRWpELFNBQU8sUUFBUSxNQUNWLFFBQVEsVUFBVSxJQUFJ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
