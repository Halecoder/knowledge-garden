/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __defProp = Object.defineProperty;
var __defProps = Object.defineProperties;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropDescs = Object.getOwnPropertyDescriptors;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getOwnPropSymbols = Object.getOwnPropertySymbols;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __propIsEnum = Object.prototype.propertyIsEnumerable;
var __defNormalProp = (obj, key, value) => key in obj ? __defProp(obj, key, { enumerable: true, configurable: true, writable: true, value }) : obj[key] = value;
var __spreadValues = (a, b) => {
  for (var prop in b || (b = {}))
    if (__hasOwnProp.call(b, prop))
      __defNormalProp(a, prop, b[prop]);
  if (__getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(b)) {
      if (__propIsEnum.call(b, prop))
        __defNormalProp(a, prop, b[prop]);
    }
  return a;
};
var __spreadProps = (a, b) => __defProps(a, __getOwnPropDescs(b));
var __objRest = (source, exclude) => {
  var target = {};
  for (var prop in source)
    if (__hasOwnProp.call(source, prop) && exclude.indexOf(prop) < 0)
      target[prop] = source[prop];
  if (source != null && __getOwnPropSymbols)
    for (var prop of __getOwnPropSymbols(source)) {
      if (exclude.indexOf(prop) < 0 && __propIsEnum.call(source, prop))
        target[prop] = source[prop];
    }
  return target;
};
var __export = (target, all) => {
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from))
      if (!__hasOwnProp.call(to, key) && key !== except)
        __defProp(to, key, { get: () => from[key], enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable });
  }
  return to;
};
var __toCommonJS = (mod) => __copyProps(__defProp({}, "__esModule", { value: true }), mod);
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// main.ts
var main_exports = {};
__export(main_exports, {
  default: () => MetadataMenu
});
module.exports = __toCommonJS(main_exports);
var import_obsidian19 = require("obsidian");

// src/settings/MetadataMenuSettingTab.ts
var import_obsidian3 = require("obsidian");

// src/settings/FieldSettingsModal.ts
var import_obsidian2 = require("obsidian");

// src/Field.ts
var Field = class {
  constructor(name = "", values = {}, id = "", isMulti = false, isCycle = false, isBoolean2 = false, valuesListNotePath = "") {
    this.name = name;
    this.values = values;
    this.id = id;
    this.isBoolean = isBoolean2;
    this.isCycle = isCycle;
    this.isMulti = isMulti;
    this.valuesListNotePath = valuesListNotePath;
    this.insertNewValue.bind(this);
  }
  insertNewValue(value) {
    return __async(this, null, function* () {
      let newKey = 1;
      Object.keys(this.values).forEach((key) => {
        if (parseInt(key) && parseInt(key) >= newKey) {
          newKey = parseInt(key) + 1;
        }
        ;
      });
      this.values[newKey.toString()] = value;
      return newKey.toString();
    });
  }
  static copyProperty(target, source) {
    target.id = source.id;
    target.name = source.name;
    target.isBoolean = source.isBoolean;
    target.isCycle = source.isCycle;
    target.isMulti = source.isMulti;
    target.valuesListNotePath = source.valuesListNotePath;
    Object.keys(source.values).forEach((k) => {
      target.values[k] = source.values[k];
    });
    Object.keys(target.values).forEach((k) => {
      if (!Object.keys(source.values).includes(k)) {
        delete target.values[k];
      }
      ;
    });
  }
};
var Field_default = Field;

// src/settings/FieldSetting.ts
var import_obsidian = require("obsidian");
var FieldSetting = class extends import_obsidian.Setting {
  constructor(containerEl, property, app2, plugin) {
    super(containerEl);
    this.containerEl = containerEl;
    this.property = property;
    this.app = app2;
    this.plugin = plugin;
    this.setTextContentWithname();
    this.addEditButton();
    this.addDeleteButton();
  }
  setTextContentWithname() {
    const values = !this.property.isBoolean ? `[${Object.keys(this.property.values).map((k) => this.property.values[k]).join(", ")}]` : "";
    let type = "single";
    if (this.property.isBoolean)
      type = "boolean";
    if (this.property.isMulti)
      type = "multi";
    if (this.property.isCycle)
      type = "cycle";
    this.infoEl.textContent = `${this.property.name}: ${values}`;
    const typeContainer = this.infoEl.createEl("span", `metadata-menu-setting-item-info-type ${type}`);
    typeContainer.setText(type);
  }
  addEditButton() {
    this.addButton((b) => {
      b.setIcon("pencil").setTooltip("Edit").onClick(() => {
        let modal = new FieldSettingsModal(this.app, this.plugin, this.containerEl, this, this.property);
        modal.open();
      });
    });
  }
  addDeleteButton() {
    this.addButton((b) => {
      b.setIcon("trash").setTooltip("Delete").onClick(() => {
        var _a;
        const currentExistingProperty = this.plugin.initialProperties.filter((p) => p.id == this.property.id)[0];
        if (currentExistingProperty) {
          this.plugin.initialProperties.remove(currentExistingProperty);
        }
        ;
        (_a = this.settingEl.parentElement) == null ? void 0 : _a.removeChild(this.settingEl);
        this.plugin.saveSettings();
      });
    });
  }
  static getValuesListFromNote(notePath, app2) {
    return __async(this, null, function* () {
      let values = [];
      const file = app2.vault.getAbstractFileByPath(notePath);
      if (file instanceof import_obsidian.TFile && file.extension == "md") {
        const result = yield app2.vault.read(file);
        result.split("\n").forEach((line) => {
          if (/^(.*)$/.test(line)) {
            values.push(line.trim());
          }
          ;
        });
        return values;
      } else {
        return [];
      }
      ;
    });
  }
};

// src/settings/FieldSettingsModal.ts
var FieldSettingsModal = class extends import_obsidian2.Modal {
  constructor(app2, plugin, parentSettingContainer, parentSetting, property) {
    super(app2);
    this.valuesPromptComponents = [];
    this.saved = false;
    this.new = true;
    this.plugin = plugin;
    this.parentSetting = parentSetting;
    this.initialProperty = new Field_default();
    this.parentSettingContainer = parentSettingContainer;
    if (property) {
      this.new = false;
      this.property = property;
      this.initialProperty.name = property.name;
      this.initialProperty.id = property.id;
      Object.keys(property.values).forEach((k) => {
        this.initialProperty.values[k] = property.values[k];
      });
    } else {
      let newId = 1;
      this.plugin.initialProperties.forEach((prop) => {
        if (parseInt(prop.id) && parseInt(prop.id) >= newId) {
          newId = parseInt(prop.id) + 1;
        }
        ;
      });
      this.property = new Field_default();
      this.property.id = newId.toString();
      this.initialProperty.id = newId.toString();
    }
    ;
  }
  onOpen() {
    return __async(this, null, function* () {
      if (this.property.name == "") {
        this.titleEl.setText(`Add a property and set predefined`);
      } else {
        this.titleEl.setText(`Manage settings values for ${this.property.name}`);
      }
      ;
      yield this.createForm();
    });
  }
  onClose() {
    Object.assign(this.property, this.initialProperty);
    if (!this.new && this.parentSetting) {
      this.parentSetting.infoEl.textContent = `${this.property.name}: [${Object.keys(this.property.values).map((k) => this.property.values[k]).join(", ")}]`;
    } else if (this.saved) {
      new FieldSetting(this.parentSettingContainer, this.property, this.app, this.plugin);
    }
    ;
  }
  setValueListText(header) {
    header.setText(`Preset values: ${Object.values(this.property.values).join(", ")}`);
  }
  createnameInputContainer(parentNode) {
    const propertyNameContainerLabel = parentNode.createDiv();
    propertyNameContainerLabel.setText(`Property Name:`);
    const input = new import_obsidian2.TextComponent(parentNode);
    const name = this.property.name;
    input.setValue(name);
    input.setPlaceholder("Name of the property");
    input.onChange((value) => {
      this.property.name = value;
      this.titleEl.setText(`Manage predefined values for ${this.property.name}`);
      FieldSettingsModal.removeValidationError(input);
    });
    return input;
  }
  createTogglerContainer(parentNode, label) {
    parentNode.addClass("metadata-menu-toggle");
    const propertyContainerLabel = parentNode.createDiv({ cls: "frontmatter-checkbox-toggler" });
    propertyContainerLabel.setText(label);
    const toggler = new import_obsidian2.ToggleComponent(parentNode);
    return toggler;
  }
  createListNoteContainer(parentNode) {
    const listNoteContainerLabel = parentNode.createDiv({ cls: "metadata-menu-input" });
    listNoteContainerLabel.setText(`Path of the note containing the values:`);
    const input = new import_obsidian2.TextComponent(listNoteContainerLabel);
    const listNotePath = this.property.valuesListNotePath;
    input.setValue(listNotePath);
    input.setPlaceholder("Path/of/the/note.md");
    input.onChange((value) => this.property.valuesListNotePath = value);
    return input;
  }
  removePresetValue(key) {
    let newValues = {};
    for (let _key in this.property.values) {
      if (key !== _key) {
        newValues[_key] = this.property.values[_key];
      }
      ;
    }
    ;
    this.property.values = newValues;
  }
  createValueContainer(parentNode, header, key) {
    const values = this.property.values;
    const presetValue = values[key];
    const valueContainer = parentNode.createDiv({
      cls: "metadata-menu-prompt-container"
    });
    const input = new import_obsidian2.TextComponent(valueContainer);
    input.setValue(presetValue);
    input.onChange((value) => {
      this.property.values[key] = value;
      this.setValueListText(header);
      FieldSettingsModal.removeValidationError(input);
    });
    const valueRemoveButton = new import_obsidian2.ButtonComponent(valueContainer);
    valueRemoveButton.setIcon("trash").onClick((evt) => {
      evt.preventDefault;
      this.removePresetValue(key);
      this.setValueListText(header);
      parentNode.removeChild(valueContainer);
      this.valuesPromptComponents.remove(input);
    });
    if (key != Object.keys(this.property.values)[0]) {
      const valueUpgradeButton = new import_obsidian2.ButtonComponent(valueContainer);
      valueUpgradeButton.setButtonText("\u25B2");
      valueUpgradeButton.onClick((evt) => {
        const thisValue = values[key];
        const inputIndex = this.valuesPromptComponents.indexOf(input);
        const upperComponent = inputIndex !== -1 ? this.valuesPromptComponents[inputIndex - 1] : this.valuesPromptComponents.last();
        if (upperComponent) {
          const upperValue = upperComponent.inputEl.value;
          const upperKey = Object.keys(values).filter((k) => values[k] == upperValue)[0];
          if (upperKey) {
            upperComponent.setValue(thisValue);
            values[upperKey] = thisValue;
            input.setValue(upperValue);
            values[key] = upperValue;
          }
          ;
        }
        ;
      });
    }
    ;
    return input;
  }
  createForm() {
    return __async(this, null, function* () {
      const div = this.contentEl.createDiv({
        cls: "metadata-menu-prompt-div"
      });
      const mainDiv = div.createDiv({
        cls: "metadata-menu-prompt-form"
      });
      const nameContainer = mainDiv.createDiv();
      this.namePromptComponent = this.createnameInputContainer(nameContainer);
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const booleanContainer = mainDiv.createDiv({ cls: "metadata-menu-toggle" });
      this.isBooleanTogglerComponent = this.createTogglerContainer(booleanContainer, "Is Boolean: ");
      this.isBooleanTogglerComponent.setValue(this.property.isBoolean);
      this.isBooleanTogglerComponent.setTooltip("Is this property true or false only?");
      this.isBooleanTogglerComponent.onChange((value) => {
        this.property.isBoolean = value;
        if ((this.property.isMulti || this.property.isCycle) && this.property.isBoolean) {
          this.property.isMulti = false;
          this.isMultiTogglerComponent.setValue(false);
          this.property.isCycle = false;
          this.isCycleTogglerComponent.setValue(false);
        }
      });
      const multiContainer = mainDiv.createDiv({ cls: "metadata-menu-toggle" });
      this.isMultiTogglerComponent = this.createTogglerContainer(multiContainer, "Is Multi: ");
      this.isMultiTogglerComponent.setValue(this.property.isMulti);
      this.isMultiTogglerComponent.setTooltip("Can this property have multiple values?");
      this.isMultiTogglerComponent.onChange((value) => {
        this.property.isMulti = value;
        if (this.property.isCycle && this.property.isMulti) {
          this.property.isCycle = false;
          this.isCycleTogglerComponent.setValue(false);
        }
        ;
      });
      const cycleContainer = mainDiv.createDiv();
      this.isCycleTogglerComponent = this.createTogglerContainer(cycleContainer, "Is Cycle: ");
      this.isCycleTogglerComponent.setValue(this.property.isCycle);
      this.isCycleTogglerComponent.setTooltip("Is this property's values set in cycle mode?");
      this.isCycleTogglerComponent.onChange((value) => {
        this.property.isCycle = value;
        if (this.property.isCycle && this.property.isMulti) {
          this.property.isMulti = false;
          this.isMultiTogglerComponent.setValue(false);
        }
        ;
      });
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const listNotePathContainer = mainDiv.createDiv();
      this.createListNoteContainer(listNotePathContainer);
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const valuesList = mainDiv.createDiv();
      const valuesListHeader = valuesList.createDiv();
      valuesListHeader.createEl("h2");
      valuesListHeader.setText(`Preset values: ${Object.values(this.property.values).join(", ")}`);
      const valuesListBody = valuesList.createDiv();
      Object.keys(this.property.values).forEach((key) => {
        this.valuesPromptComponents.push(this.createValueContainer(valuesListBody, valuesListHeader, key));
      });
      const valuesListFooter = valuesList.createDiv();
      const addValue = valuesListFooter.createEl("button");
      addValue.type = "button";
      addValue.textContent = "Add";
      addValue.onClickEvent((evt) => __async(this, null, function* () {
        evt.preventDefault;
        const newKey = yield this.property.insertNewValue("");
        this.createValueContainer(valuesListBody, valuesListHeader, newKey);
      }));
      mainDiv.createDiv({ cls: "metadata-menu-separator" }).createEl("hr");
      const footerEl = this.contentEl.createDiv();
      const footerButtons = new import_obsidian2.Setting(footerEl);
      footerButtons.addButton((b) => this.createSaveButton(b));
      footerButtons.addExtraButton((b) => this.createCancelButton(b));
    });
  }
  createSaveButton(b) {
    b.setTooltip("Save").setIcon("checkmark").onClick(() => __async(this, null, function* () {
      let error = false;
      if (/^[#>-]/.test(this.property.name)) {
        FieldSettingsModal.setValidationError(this.namePromptComponent, this.namePromptComponent.inputEl, "Property name cannot start with #, >, -");
        error = true;
      }
      ;
      if (this.property.name == "") {
        FieldSettingsModal.setValidationError(this.namePromptComponent, this.namePromptComponent.inputEl, "Property name can not be Empty");
        error = true;
      }
      ;
      this.valuesPromptComponents.forEach((input) => {
        var _a, _b, _c;
        if (/^[#>-]/.test(input.inputEl.value) && ((_a = input.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
          FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values cannot cannot start with #, >, -");
          error = true;
        }
        ;
        if (/[,]/gu.test(input.inputEl.value) && ((_b = input.inputEl.parentElement) == null ? void 0 : _b.lastElementChild)) {
          FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values cannot contain a comma");
          error = true;
        }
        ;
        if (input.inputEl.value == "" && ((_c = input.inputEl.parentElement) == null ? void 0 : _c.lastElementChild)) {
          FieldSettingsModal.setValidationError(input, input.inputEl.parentElement.lastElementChild, "Values can't be null.");
          error = true;
        }
        ;
      });
      if (error) {
        new import_obsidian2.Notice("Fix errors before saving.");
        return;
      }
      ;
      this.saved = true;
      const currentExistingProperty = this.plugin.initialProperties.filter((p) => p.id == this.property.id)[0];
      if (currentExistingProperty) {
        Field_default.copyProperty(currentExistingProperty, this.property);
      } else {
        this.plugin.initialProperties.push(this.property);
      }
      ;
      this.initialProperty = this.property;
      this.plugin.saveSettings();
      this.close();
    }));
    return b;
  }
  createCancelButton(b) {
    b.setIcon("cross").setTooltip("Cancel").onClick(() => {
      this.saved = false;
      if (this.initialProperty.name != "") {
        Object.assign(this.property, this.initialProperty);
      }
      ;
      this.close();
    });
    return b;
  }
  static setValidationError(textInput, insertAfter, message) {
    var _a;
    textInput.inputEl.addClass("is-invalid");
    if (message && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      let mDiv = textInput.inputEl.parentElement.querySelector(".invalid-feedback");
      if (!mDiv) {
        mDiv = createDiv({ cls: "invalid-feedback" });
      }
      mDiv.innerText = message;
      mDiv.insertAfter(insertAfter);
    }
  }
  static removeValidationError(textInput) {
    var _a;
    if (textInput.inputEl.hasClass("is-invalid") && ((_a = textInput.inputEl.parentElement) == null ? void 0 : _a.lastElementChild)) {
      textInput.inputEl.removeClass("is-invalid");
      textInput.inputEl.parentElement.removeChild(textInput.inputEl.parentElement.lastElementChild);
    }
    ;
  }
};

// src/settings/MetadataMenuSettingTab.ts
var SettingsMigrationConfirmModal = class extends import_obsidian3.Modal {
  constructor(plugin, tab) {
    super(plugin.app);
    this.plugin = plugin;
    this.tab = tab;
  }
  onOpen() {
    this.titleEl.setText("Confirm");
    const body = this.contentEl.createDiv({
      cls: "modal-text-danger"
    });
    body.setText("This will erase current settings. Are you sure?");
    const confirmButton = new import_obsidian3.ButtonComponent(this.contentEl);
    confirmButton.setIcon("check");
    confirmButton.onClick(() => {
      if (this.app.plugins.plugins.hasOwnProperty("supercharged-links-obsidian")) {
        let settings = this.app.plugins.plugins["supercharged-links-obsidian"].settings;
        let _settings = this.plugin.settings;
        _settings.classFilesPath = settings.classFilesPath;
        _settings.displayFieldsInContextMenu = settings.displayFieldsInContextMenu;
        _settings.getFromInlineField = settings.getFromInlineField;
        _settings.globallyIgnoredFields = settings.globallyIgnoredFields;
        this.plugin.initialProperties = [];
        settings.presetFields.forEach((prop) => {
          const property = new Field_default();
          Object.assign(property, prop);
          this.plugin.initialProperties.push(property);
        });
        this.plugin.saveSettings();
        this.close();
      }
      ;
    });
  }
  onClose() {
    this.tab.display();
  }
};
var MetadataMenuSettingTab = class extends import_obsidian3.PluginSettingTab {
  constructor(app2, plugin) {
    super(app2, plugin);
    this.plugin = plugin;
  }
  display() {
    let { containerEl } = this;
    containerEl.empty();
    const globalSettings = containerEl.createEl("div");
    globalSettings.createEl("h4", { text: "Global settings", cls: "metadata-menu-setting-section-header" });
    globalSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Global settings to apply to your whole vault"
    });
    new import_obsidian3.Setting(globalSettings).setName("Search for attribute in Inline fields like <field::>").setDesc("Sets the `data-link-<field>`-attribute to the value of inline fields").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.getFromInlineField);
      toggle.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.getFromInlineField = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian3.Setting(globalSettings).setName("Display field options in context menu").setDesc("Choose to show or hide fields options in the context menu of a link or a file").addToggle((toggle) => {
      toggle.setValue(this.plugin.settings.displayFieldsInContextMenu);
      toggle.onChange((value) => __async(this, null, function* () {
        this.plugin.settings.displayFieldsInContextMenu = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian3.Setting(globalSettings).setName("Globally ignored fields").setDesc("Fields to be ignored by the plugin when adding options to the context menu").addTextArea((text) => {
      text.setPlaceholder("Enter fields as string, comma separated").setValue(this.plugin.settings.globallyIgnoredFields.join(", ")).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.globallyIgnoredFields = value.replace(/\s/g, "").split(",");
        yield this.plugin.saveSettings();
      }));
      text.inputEl.rows = 6;
      text.inputEl.cols = 25;
    });
    const presetFieldsSettings = containerEl.createEl("div");
    presetFieldsSettings.createEl("h4", { text: "Preset Fields settings", cls: "metadata-menu-setting-section-header" });
    presetFieldsSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage globally predefined type and values for a field throughout your whole vault"
    });
    new import_obsidian3.Setting(presetFieldsSettings).setName("Add New Property Manager").setDesc("Add a new Frontmatter property for which you want preset values.").addButton((button) => {
      return button.setTooltip("Add New Property Manager").setButtonText("+").onClick(() => __async(this, null, function* () {
        let modal = new FieldSettingsModal(this.app, this.plugin, presetFieldsSettings);
        modal.open();
      }));
    });
    this.plugin.initialProperties.forEach((prop) => {
      const property = new Field_default();
      Object.assign(property, prop);
      new FieldSetting(presetFieldsSettings, property, this.app, this.plugin);
    });
    const classFilesSettings = containerEl.createEl("div");
    classFilesSettings.createEl("h4", { text: "FileClass settings", cls: "metadata-menu-setting-section-header" });
    classFilesSettings.createEl("div", {
      cls: "setting-item-description metadata-menu-setting-section-desc",
      text: "Manage fileClass folder and alias. When a note has a fielClass defined, fileClass field properties will override global preset fields settings for the same field name"
    });
    new import_obsidian3.Setting(classFilesSettings).setName("class Files path").setDesc("Path to the files containing the authorized fields for a type of note").addText((text) => {
      text.setPlaceholder("Path/").setValue(this.plugin.settings.classFilesPath).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.classFilesPath = value;
        yield this.plugin.saveSettings();
      }));
    });
    new import_obsidian3.Setting(classFilesSettings).setName("fileClass field alias").setDesc("Choose another name for fileClass field in frontmatter (example: Category, type, ...").addText((text) => {
      text.setValue(this.plugin.settings.fileClassAlias).onChange((value) => __async(this, null, function* () {
        this.plugin.settings.fileClassAlias = value;
        yield this.plugin.saveSettings();
      }));
    });
    const migrateSettings = containerEl.createEl("div");
    migrateSettings.createEl("h4", { text: "Migrate" });
    new import_obsidian3.Setting(migrateSettings).setName("Copy settings from supercharged links plugin").setDesc("Copy settings from supercharged links plugin").addButton((button) => {
      return button.setTooltip("Get settings from supercharged links").setButtonText("Copy").onClick(() => __async(this, null, function* () {
        let modal = new SettingsMigrationConfirmModal(this.plugin, this);
        modal.open();
      }));
    });
  }
};

// src/settings/MetadataMenuSettings.ts
var DEFAULT_SETTINGS = {
  presetFields: [],
  displayFieldsInContextMenu: true,
  globallyIgnoredFields: [],
  classFilesPath: "",
  getFromInlineField: true,
  isAutosuggestEnabled: true,
  fileClassAlias: "fileClass"
};

// src/utils/parser.ts
var fieldComponents = ["startStyle", "attribute", "endStyle", "beforeSeparatorSpacer", "afterSeparatorSpacer", "values"];
var genericFieldRegex = "(?<startStyle>[_\\*~`]*)(?<attribute>[0-9\\w\\p{Letter}\\p{Emoji_Presentation}][-0-9\\w\\p{Letter}\\p{Emoji_Presentation}\\s]*)(?<endStyle>[_\\*~`]*)(?<beforeSeparatorSpacer>\\s*)";
var inlineFieldRegex = (attribute) => new RegExp(`(?<startStyle>[_*~\`]*)(?<attribute>${attribute})(?<endStyle>[_*~\`]*)(?<beforeSeparatorSpacer>\\s*)::(?<afterSeparatorSpacer>\\s*)(?<values>.*)`, "u");

// src/commands/getValues.ts
function getValues(app2, file, attribute) {
  return __async(this, null, function* () {
    var _a;
    const content = yield (yield app2.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = this.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const { position: { start, end } } = frontmatter || null;
    const result = [];
    content.map((line, i) => {
      if (frontmatter && i >= start.line && i <= end.line) {
        const regex = new RegExp(`${attribute}:(.*)`, "u");
        const r = line.match(regex);
        if (r && r.length > 0)
          result.push(r[1]);
      } else {
        const regex = inlineFieldRegex(attribute);
        const r = line.match(regex);
        if (r == null ? void 0 : r.groups)
          result.push(r.groups.values);
      }
    });
    return result;
  });
}

// src/commands/replaceValues.ts
function replaceValues(app2, file, attribute, input) {
  return __async(this, null, function* () {
    var _a;
    const content = yield (yield app2.vault.cachedRead(file)).split("\n");
    const frontmatter = (_a = this.app.metadataCache.getFileCache(file)) == null ? void 0 : _a.frontmatter;
    const start = frontmatter ? frontmatter.position.start : null;
    const end = frontmatter ? frontmatter.position.end : null;
    const newContent = content.map((line, i) => {
      if (frontmatter && i >= start.line && i <= end.line) {
        const regex = new RegExp(`${attribute}:`, "u");
        const r = line.match(regex);
        if (r && r.length > 0) {
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `[${inputArray.join(", ")}]`;
          return `${attribute}: ${newValue}`;
        } else {
          return line;
        }
      } else {
        const regex = inlineFieldRegex(attribute);
        const r = line.match(regex);
        if ((r == null ? void 0 : r.groups) && Object.keys(r.groups).every((i2) => fieldComponents.includes(i2))) {
          const { startStyle, endStyle, beforeSeparatorSpacer, afterSeparatorSpacer, values } = r.groups;
          const inputArray = input ? input.replace(/(\,\s+)/g, ",").split(",") : [""];
          const newValue = inputArray.length == 1 ? inputArray[0] : `${inputArray.join(", ")}`;
          return `${startStyle}${attribute}${endStyle}${beforeSeparatorSpacer}::${afterSeparatorSpacer}${newValue}`;
        } else {
          return line;
        }
      }
    });
    app2.vault.modify(file, newContent.join("\n"));
  });
}

// src/commands/fieldModifier.ts
var import_obsidian5 = require("obsidian");

// src/fileClass/fileClassAttribute.ts
var types = {
  "input": "Accept any value",
  "select": "Accept a single value from a list",
  "multi": "Accept multiple values from a list",
  "cycle": "Cycle through values from a list",
  "boolean": "Accept true of false"
};
var FileClassAttribute = class {
  constructor(raw) {
    var _a, _b;
    const completeRegex = new RegExp(`^${genericFieldRegex}::(?<fieldSettings>.+)?`, "u");
    const nameRegex = new RegExp(`^${genericFieldRegex}$`, "u");
    let fieldName;
    let { attribute, fieldSettings } = ((_a = raw.match(completeRegex)) == null ? void 0 : _a.groups) || {};
    if (attribute) {
      fieldName = attribute;
    } else {
      let { attribute: attribute2 } = ((_b = raw.match(nameRegex)) == null ? void 0 : _b.groups) || {};
      fieldName = attribute2;
    }
    if (fieldName) {
      this.name = fieldName.trim();
      if (fieldSettings) {
        const settings = JSON.parse(`${fieldSettings.trim()}`);
        this.type = settings["type"];
        switch (this.type) {
          case "multi":
            this.isMulti = true;
            break;
          case "cycle":
            this.isCycle = true;
            break;
          case "boolean":
            this.isBoolean = true;
          default:
            break;
        }
        this.options = settings["options"];
      }
    } else {
      const error = new Error("Improper value");
      throw error;
    }
  }
  getField() {
    var _a;
    let values = {};
    (_a = this.options) == null ? void 0 : _a.forEach((option, index) => {
      values[index] = option;
    });
    return new Field_default(this.name, values, this.name, this.isMulti, this.isCycle, this.isBoolean);
  }
};

// src/fileClass/fileClass.ts
var import_obsidian4 = require("obsidian");
var FileClassManager = class {
  constructor(instance) {
    this.instance = instance;
  }
  all() {
    const filesWithFileClassName = this.instance.plugin.app.vault.getMarkdownFiles().filter((file) => {
      const cache = this.instance.plugin.app.metadataCache.getFileCache(file);
      const fileClassAlias = this.instance.plugin.settings.fileClassAlias;
      return (cache == null ? void 0 : cache.frontmatter) && Object.keys(cache.frontmatter).includes(fileClassAlias) && cache.frontmatter[fileClassAlias] == this.instance.name;
    });
    return filesWithFileClassName;
  }
  get(name) {
    const filesWithName = this.all().filter((file) => file.basename == name);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
  getPath(path) {
    const filesWithName = this.all().filter((file) => file.path == path);
    if (filesWithName.length > 1) {
      const error = new Error("More than one value found");
      throw error;
    }
    if (filesWithName.length == 0) {
      const error = new Error("No file value found");
      throw error;
    }
    return filesWithName[0];
  }
};
var FileClass = class {
  constructor(plugin, name) {
    this.plugin = plugin;
    this.name = name;
    this.objects = new FileClassManager(this);
    this.attributes = [];
  }
  getClassFile() {
    const filesClassPath = this.plugin.settings.classFilesPath;
    const file = this.plugin.app.vault.getAbstractFileByPath(`${filesClassPath}${this.name}.md`);
    if (file instanceof import_obsidian4.TFile && file.extension == "md") {
      return file;
    } else {
      const error = new Error("no such fileClass in fileClass folder");
      throw error;
    }
  }
  getAttributes() {
    return __async(this, null, function* () {
      try {
        const file = this.getClassFile();
        let attributes = [];
        let errors = [];
        const result = yield this.plugin.app.vault.cachedRead(file);
        result.split("\n").forEach((line) => {
          try {
            const attribute = new FileClassAttribute(line);
            attributes.push(attribute);
          } catch (error) {
            errors.push(error);
          }
        });
        this.attributes = attributes;
        this.errors = errors;
      } catch (error) {
        throw error;
      }
    });
  }
  updateAttribute(newType, newOptions, newName, attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      let result = yield this.plugin.app.vault.read(file);
      if (attr) {
        let newContent = [];
        result.split("\n").forEach((line) => {
          if (line.startsWith(attr.name)) {
            if (newType == "input") {
              newContent.push(newName);
            } else {
              let settings = {};
              settings["type"] = newType;
              settings["options"] = newOptions;
              newContent.push(`${newName}:: ${JSON.stringify(settings)}`);
            }
          } else {
            newContent.push(line);
          }
        });
        this.plugin.app.vault.modify(file, newContent.join("\n"));
      } else {
        let settings = {};
        settings["type"] = newType;
        settings["options"] = newOptions;
        result += `
${newName}:: ${JSON.stringify(settings)}`;
        yield this.plugin.app.vault.modify(file, result);
      }
    });
  }
  removeAttribute(attr) {
    return __async(this, null, function* () {
      const file = this.getClassFile();
      const result = yield this.plugin.app.vault.read(file);
      let newContent = [];
      result.split("\n").forEach((line) => {
        if (!line.startsWith(attr.name)) {
          newContent.push(line);
        }
      });
      yield this.plugin.app.vault.modify(file, newContent.join("\n"));
    });
  }
};
function createFileClass(plugin, name) {
  return __async(this, null, function* () {
    return new Promise((resolve, reject) => {
      const fileClass = new FileClass(plugin, name);
      fileClass.getAttributes().then(() => {
        resolve(fileClass);
      }).catch((error) => {
        reject(error);
      });
    });
  });
}

// src/commands/getPropertySettings.ts
function getPropertySettings(plugin, propertyName, fileClass) {
  const matchingSettings = plugin.settings.presetFields.filter((p) => p.name == propertyName);
  if (fileClass) {
    const fileClassAttributesWithName = fileClass.attributes.filter((attr) => attr.name == propertyName);
    if (fileClassAttributesWithName.length > 0) {
      const fileClassAttribute = fileClassAttributesWithName[0];
      if (fileClassAttribute.type) {
        return fileClassAttribute.getField();
      } else if (matchingSettings.length > 0) {
        return matchingSettings[0];
      }
      ;
    }
  } else if (matchingSettings.length > 0) {
    return matchingSettings[0];
  }
  ;
}

// src/commands/fieldModifier.ts
function createInputField(plugin, dv, p, fieldName, fieldContainer, attrs) {
  const fieldValue = dv.el("span", p[fieldName], attrs);
  const inputContainer = document.createElement("div");
  const input = document.createElement("input");
  input.setAttr("class", "metadata-menu-dv-input");
  inputContainer.appendChild(input);
  input.value = p[fieldName];
  const spacer = document.createElement("div");
  spacer.setAttr("class", "metadata-menu-dv-field-spacer");
  const button = document.createElement("button");
  button.setText("\u{1F58D}");
  button.setAttr("class", "metadata-menu-dv-field-button");
  button.hide();
  spacer.show();
  fieldContainer.onmouseover = () => {
    button.show();
    spacer.hide();
  };
  fieldContainer.onmouseout = () => {
    button.hide();
    spacer.show();
  };
  const validateIcon = document.createElement("a");
  validateIcon.textContent = "\u2705";
  validateIcon.setAttr("class", "metadata-menu-dv-field-button");
  validateIcon.onclick = (e) => {
    const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    if (file instanceof import_obsidian5.TFile && file.extension == "md") {
      replaceValues(plugin.app, file, fieldName, input.value);
    }
    fieldContainer.removeChild(inputContainer);
  };
  inputContainer == null ? void 0 : inputContainer.appendChild(validateIcon);
  const cancelIcon = document.createElement("a");
  cancelIcon.setAttr("class", "metadata-menu-dv-field-button");
  cancelIcon.textContent = "\u274C";
  cancelIcon.onclick = (e) => {
    fieldContainer.removeChild(inputContainer);
    fieldContainer.appendChild(button);
    fieldContainer.appendChild(fieldValue);
    fieldContainer.appendChild(spacer);
  };
  inputContainer.appendChild(cancelIcon);
  input.focus();
  input.onkeydown = (e) => {
    if (e.key === "Enter") {
      const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
      if (file instanceof import_obsidian5.TFile && file.extension == "md") {
        replaceValues(plugin.app, file, fieldName, input.value);
      }
      fieldContainer.removeChild(inputContainer);
    }
    if (e.key === "Escape") {
      fieldContainer.removeChild(inputContainer);
      fieldContainer.appendChild(button);
      fieldContainer.appendChild(fieldValue);
      fieldContainer.appendChild(spacer);
    }
  };
  button.onclick = (e) => {
    fieldContainer.removeChild(fieldValue);
    fieldContainer.removeChild(button);
    fieldContainer.removeChild(spacer);
    fieldContainer.appendChild(inputContainer);
    input.focus();
  };
  fieldContainer.appendChild(button);
  fieldContainer.appendChild(fieldValue);
  fieldContainer.appendChild(spacer);
}
function createBooleanField(plugin, dv, p, fieldName, fieldContainer, attrs) {
  const checkbox = dv.el("input", "", __spreadProps(__spreadValues({}, attrs), { "type": "checkbox" }));
  checkbox.checked = p[fieldName];
  fieldContainer.appendChild(checkbox);
  checkbox.onchange = (value) => {
    const file = plugin.app.vault.getAbstractFileByPath(p["file"]["path"]);
    if (file instanceof import_obsidian5.TFile && file.extension == "md") {
      replaceValues(plugin.app, file, fieldName, checkbox.checked.toString());
    }
  };
}
function fieldModifier(plugin, dv, p, fieldName, attrs) {
  return __async(this, null, function* () {
    const fieldContainer = dv.el("div", "");
    fieldContainer.setAttr("class", "metadata-menu-dv-field-container");
    if (p[fieldName] === void 0) {
      const emptyField = dv.el("span", null, attrs);
      fieldContainer.appendChild(emptyField);
    } else {
      const fileClassAlias = plugin.settings.fileClassAlias;
      if (p[fileClassAlias]) {
        const fileClass = yield createFileClass(plugin, p[fileClassAlias]);
        const field = getPropertySettings(plugin, fieldName, fileClass);
        if (field == null ? void 0 : field.isBoolean) {
          createBooleanField(plugin, dv, p, fieldName, fieldContainer, attrs);
        } else {
          createInputField(plugin, dv, p, fieldName, fieldContainer, attrs);
        }
      } else if (plugin.settings.presetFields.filter((attr) => attr.name == fieldName)) {
        const field = getPropertySettings(plugin, fieldName);
        if (field == null ? void 0 : field.isBoolean) {
          createBooleanField(plugin, dv, p, fieldName, fieldContainer, attrs);
        } else {
          createInputField(plugin, dv, p, fieldName, fieldContainer, attrs);
        }
      } else {
        createInputField(plugin, dv, p, fieldName, fieldContainer, attrs);
      }
    }
    return fieldContainer;
  });
}

// src/MetadataMenuApi.ts
var MetadataMenuApi = class {
  constructor(plugin) {
    this.plugin = plugin;
  }
  make() {
    return {
      getValues: this.getValues(),
      replaceValues: this.replaceValues(),
      fieldModifier: this.fieldModifier()
    };
  }
  getValues() {
    return (app2, file, attribute) => __async(this, null, function* () {
      return getValues(app2, file, attribute);
    });
  }
  replaceValues() {
    return (app2, file, attribute, input) => __async(this, null, function* () {
      return replaceValues(app2, file, attribute, input);
    });
  }
  fieldModifier() {
    return (dv, p, fieldName, attrs) => fieldModifier(this.plugin, dv, p, fieldName, attrs);
  }
};

// src/options/linkContextMenu.ts
var import_obsidian15 = require("obsidian");

// src/optionModals/valueMultiSelectModal.ts
var import_obsidian6 = require("obsidian");
var valueMultiSelectModal = class extends import_obsidian6.Modal {
  constructor(app2, file, name, initialValues, settings, lineNumber = -1, inFrontMatter = false, top = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.name = name;
    this.settings = settings;
    if (initialValues) {
      if (initialValues.toString().startsWith("[[")) {
        this.values = initialValues.split(",").map((item) => item.trim());
      } else {
        this.values = initialValues.toString().replace(/^\[(.*)\]$/, "$1").split(",").map((item) => item.trim());
      }
      ;
    } else {
      this.values = [];
    }
    ;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.containerEl.addClass("metadata-menu");
      const valueGrid = this.contentEl.createDiv({
        cls: "metadata-menu-value-grid"
      });
      const listNoteValues = yield FieldSetting.getValuesListFromNote(this.settings.valuesListNotePath, this.app);
      yield this.populateValuesGrid(valueGrid, listNoteValues);
    });
  }
  populateValuesGrid(valueGrid, listNoteValues) {
    return __async(this, null, function* () {
      if (listNoteValues.length === 0) {
        Object.keys(this.settings.values).forEach((key) => {
          const presetValue = this.settings.values[key];
          this.buildValueToggler(valueGrid, presetValue);
        });
      }
      ;
      listNoteValues.forEach((value) => {
        this.buildValueToggler(valueGrid, value);
      });
      const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
      const saveButton = new import_obsidian6.ButtonComponent(footer);
      saveButton.setIcon("checkmark");
      saveButton.onClick(() => __async(this, null, function* () {
        if (this.lineNumber == -1) {
          replaceValues(this.app, this.file, this.name, this.values.join(","));
        } else {
          const result = yield this.app.vault.read(this.file);
          let newContent = [];
          const renderedValues = !this.inFrontmatter ? this.values.join(",") : this.values.length > 1 ? `[${this.values.join(",")}]` : this.values;
          if (this.top) {
            newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${renderedValues}`);
            result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
          } else {
            result.split("\n").forEach((line, _lineNumber) => {
              newContent.push(line);
              if (_lineNumber == this.lineNumber) {
                newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${renderedValues}`);
              }
              ;
            });
          }
          ;
          this.app.vault.modify(this.file, newContent.join("\n"));
          this.close();
        }
        ;
        this.close();
      }));
      const cancelButton = new import_obsidian6.ExtraButtonComponent(footer);
      cancelButton.setIcon("cross");
      cancelButton.onClick(() => this.close());
    });
  }
  buildValueToggler(valueGrid, presetValue) {
    const valueSelectorContainer = valueGrid.createDiv({
      cls: "metadata-menu-value-selector-container"
    });
    const valueTogglerContainer = valueSelectorContainer.createDiv({
      cls: "metadata-menu-value-selector-toggler"
    });
    const valueToggler = new import_obsidian6.ToggleComponent(valueTogglerContainer);
    this.values.forEach((value) => {
      if (value == presetValue) {
        valueToggler.setValue(true);
      }
      ;
    });
    valueToggler.onChange((value) => {
      if (value && !this.values.includes(presetValue)) {
        this.values.push(presetValue);
      }
      ;
      if (!value) {
        this.values.remove(presetValue);
      }
      ;
    });
    const valueLabel = valueSelectorContainer.createDiv({ cls: "metadata-menu-value-selector-label" });
    valueLabel.setText(presetValue);
  }
};

// src/optionModals/valueTextInputModal.ts
var import_obsidian7 = require("obsidian");
var valueTextInputModal = class extends import_obsidian7.Modal {
  constructor(app2, file, name, value, lineNumber = -1, inFrontMatter = false, top = false) {
    super(app2);
    this.parseDate = false;
    this.app = app2;
    this.file = file;
    this.name = name;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top;
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
    this.buildInputEl(inputDiv);
  }
  buildDateParseToggler(container) {
    if (app.plugins.plugins.hasOwnProperty("nldates-obsidian")) {
      const nldates = app.plugins.plugins["nldates-obsidian"];
      const dateParserLabel = container.createDiv({
        cls: "metadata-menu-date-parser-label"
      });
      dateParserLabel.setText("\u{1F4C6}");
      const dateParserToggler = new import_obsidian7.ToggleComponent(container);
      dateParserToggler.onChange((value) => {
        this.parseDate = value;
      });
      dateParserLabel.onclick = () => dateParserToggler.setValue(!this.parseDate);
    }
    ;
  }
  buildInputEl(inputDiv) {
    this.buildDateParseToggler(inputDiv);
    const form = inputDiv.createEl("form");
    form.type = "submit";
    const inputEl = new import_obsidian7.TextComponent(form);
    inputEl.inputEl.focus();
    inputEl.setValue(this.value);
    inputEl.inputEl.addClass("metadata-menu-prompt-input");
    form.onsubmit = (e) => __async(this, null, function* () {
      e.preventDefault();
      let inputValue = inputEl.getValue();
      if (app.plugins.plugins.hasOwnProperty("nldates-obsidian") && this.parseDate) {
        const nldates = app.plugins.plugins["nldates-obsidian"];
        const format = nldates.settings.format;
        let textStart = "";
        let textEnd = "";
        let date = "";
        const selectionStart = inputEl.inputEl.selectionStart;
        const selectionEnd = inputEl.inputEl.selectionEnd;
        if (selectionEnd == selectionStart) {
          date = nldates.parseDate(inputEl.getValue()).moment.format(format);
        } else {
          textStart = inputEl.getValue().slice(0, selectionStart);
          date = nldates.parseDate(inputEl.getValue().slice(selectionStart, selectionEnd)).moment.format(format);
          textEnd = inputEl.getValue().slice(selectionEnd);
        }
        ;
        inputValue = textStart + "[[" + date + "]]" + textEnd;
      }
      if (this.lineNumber == -1) {
        replaceValues(this.app, this.file, this.name, inputValue);
      } else {
        const result = yield this.app.vault.read(this.file);
        let newContent = [];
        if (this.top) {
          newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${inputValue}`);
          result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
        } else {
          result.split("\n").forEach((line, _lineNumber) => {
            newContent.push(line);
            if (_lineNumber == this.lineNumber) {
              newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${inputValue}`);
            }
            ;
          });
        }
        ;
        this.app.vault.modify(this.file, newContent.join("\n"));
        this.close();
      }
      ;
      this.close();
    });
  }
};

// src/optionModals/valueSelectModal.ts
var import_obsidian8 = require("obsidian");
var valueSelectModal = class extends import_obsidian8.Modal {
  constructor(app2, file, name, value, settings, lineNumber = -1, inFrontMatter = false, top = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.name = name;
    this.value = value;
    this.settings = settings;
    this.newValue = null;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.containerEl.addClass("metadata-menu");
      const inputDiv = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
      yield this.buildInputEl(inputDiv);
    });
  }
  buildInputEl(inputDiv) {
    return __async(this, null, function* () {
      const selectEl = new import_obsidian8.DropdownComponent(inputDiv);
      selectEl.selectEl.addClass("metadata-menu-select");
      const values = this.settings.values;
      selectEl.addOption("", "--Empty--");
      const listNoteValues = yield FieldSetting.getValuesListFromNote(this.settings.valuesListNotePath, this.app);
      listNoteValues.forEach((value) => selectEl.addOption(value, value));
      if (listNoteValues.includes(this.value)) {
        selectEl.setValue(this.value);
      }
      ;
      if (listNoteValues.length === 0) {
        Object.keys(values).forEach((key) => {
          selectEl.addOption(values[key], values[key]);
        });
        if (Object.values(values).includes(this.value)) {
          selectEl.setValue(this.value);
        }
        ;
      }
      selectEl.onChange((value) => this.newValue = value != "--Empty--" ? value : "");
      const submitButton = new import_obsidian8.ButtonComponent(inputDiv);
      submitButton.setTooltip("Save").setIcon("checkmark").onClick(() => __async(this, null, function* () {
        if (this.lineNumber == -1) {
          if (this.newValue || this.newValue == "") {
            replaceValues(this.app, this.file, this.name, this.newValue);
          }
          ;
        } else {
          const result = yield this.app.vault.read(this.file);
          let newContent = [];
          if (this.top) {
            newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${selectEl.getValue()}`);
            result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
          } else {
            result.split("\n").forEach((line, _lineNumber) => {
              newContent.push(line);
              if (_lineNumber == this.lineNumber) {
                newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${selectEl.getValue()}`);
              }
              ;
            });
          }
          ;
          this.app.vault.modify(this.file, newContent.join("\n"));
          this.close();
        }
        ;
        this.close();
      }));
    });
  }
};

// src/optionModals/chooseSectionModal.ts
var import_obsidian12 = require("obsidian");

// src/optionModals/fieldSelectModal.ts
var import_obsidian11 = require("obsidian");

// src/optionModals/addNewFieldModal.ts
var import_obsidian9 = require("obsidian");
var addNewFieldModal = class extends import_obsidian9.Modal {
  constructor(plugin, lineNumber, file, inFrontmatter, top) {
    super(plugin.app);
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontmatter;
    this.file = file;
    this.top = top;
  }
  onOpen() {
    this.titleEl.setText("Insert new field");
    const addNewFieldContainer = this.contentEl.createDiv();
    const nameInputContainer = addNewFieldContainer.createDiv();
    nameInputContainer.setText("Field Name: ");
    const nameInputEl = new import_obsidian9.TextComponent(nameInputContainer);
    nameInputEl.setPlaceholder("Field name");
    const valueInputContainer = addNewFieldContainer.createDiv();
    valueInputContainer.setText("Field value: ");
    const valueInputEl = new import_obsidian9.TextComponent(valueInputContainer);
    valueInputEl.setPlaceholder("Field value");
    const footerButtons = this.contentEl.createDiv({
      cls: "metadata-menu-textarea-buttons"
    });
    const saveButton = new import_obsidian9.ButtonComponent(footerButtons);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      const result = yield this.app.vault.read(this.file);
      let newContent = [];
      if (this.top) {
        newContent.push(`${nameInputEl.getValue()}${this.inFrontmatter ? ":" : "::"} ${valueInputEl.getValue()}`);
        result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
      } else {
        result.split("\n").forEach((line, _lineNumber) => {
          newContent.push(line);
          if (_lineNumber == this.lineNumber) {
            newContent.push(`${nameInputEl.getValue()}${this.inFrontmatter ? ":" : "::"} ${valueInputEl.getValue()}`);
          }
        });
      }
      this.app.vault.modify(this.file, newContent.join("\n"));
      this.close();
    }));
    const cancelButton = new import_obsidian9.ExtraButtonComponent(footerButtons);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => {
      this.close();
    });
  }
};

// src/optionModals/valueToggleModal.ts
var import_obsidian10 = require("obsidian");
var valueToggleModal = class extends import_obsidian10.Modal {
  constructor(app2, file, name, value, lineNumber = -1, inFrontMatter = false, top = false) {
    super(app2);
    this.app = app2;
    this.file = file;
    this.name = name;
    this.value = value;
    this.lineNumber = lineNumber;
    this.inFrontmatter = inFrontMatter;
    this.top = top;
  }
  onOpen() {
    const inputDiv = this.contentEl.createDiv({
      cls: "metadata-menu-toggler"
    });
    this.buildToggleEl(inputDiv);
  }
  buildToggleEl(inputDiv) {
    const toggleEl = new import_obsidian10.ToggleComponent(inputDiv);
    toggleEl.setValue(this.value);
    toggleEl.onChange((value) => {
      this.value = value;
    });
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    const saveButton = new import_obsidian10.ButtonComponent(footer);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => __async(this, null, function* () {
      const value = this.value.toString();
      if (this.lineNumber == -1) {
        replaceValues(this.app, this.file, this.name, value);
      } else {
        const result = yield this.app.vault.read(this.file);
        let newContent = [];
        if (this.top) {
          newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${value}`);
          result.split("\n").forEach((line, _lineNumber) => newContent.push(line));
        } else {
          result.split("\n").forEach((line, _lineNumber) => {
            newContent.push(line);
            if (_lineNumber == this.lineNumber) {
              newContent.push(`${this.name}${this.inFrontmatter ? ":" : "::"} ${value}`);
            }
            ;
          });
        }
        ;
        this.app.vault.modify(this.file, newContent.join("\n"));
        this.close();
      }
      ;
      this.close();
    }));
  }
};

// src/optionModals/fieldSelectModal.ts
var fieldSelectModal = class extends import_obsidian11.Modal {
  constructor(plugin, file, lineNumber, line, inFrontmatter, top, fileClass) {
    super(plugin.app);
    this.line = line;
    this.lineNumber = lineNumber;
    this.plugin = plugin;
    this.file = file;
    this.inFrontmatter = inFrontmatter;
    this.top = top;
    this.fileClass = fileClass;
  }
  onOpen() {
    this.titleEl.setText(`Insert field after > ${this.line.substring(0, 20)}${this.line.length > 20 ? "..." : ""}`);
    const container = this.contentEl.createDiv({ cls: "metadata-menu-field-select" });
    const settingsDropdownContainer = container.createDiv();
    const settingsSelector = new import_obsidian11.DropdownComponent(settingsDropdownContainer);
    settingsSelector.addOption("---", "Choose Field");
    settingsSelector.addOption("++New", "New");
    if (this.fileClass) {
      this.fileClass.attributes.forEach((attr) => {
        settingsSelector.addOption(attr.name, attr.name);
      });
    } else {
      this.plugin.settings.presetFields.forEach((setting) => {
        settingsSelector.addOption(setting.name, setting.name);
      });
    }
    ;
    settingsSelector.onChange((value) => {
      if (value == "++New") {
        const newFieldModal = new addNewFieldModal(this.plugin, this.lineNumber, this.file, this.inFrontmatter, this.top);
        newFieldModal.open();
        this.close();
      } else if (this.fileClass) {
        const fileClassAttributesWithName = this.fileClass.attributes.filter((attr) => attr.name == value);
        let field;
        let type;
        if (fileClassAttributesWithName.length > 0) {
          const fileClassAttribute = fileClassAttributesWithName[0];
          field = fileClassAttribute.getField();
          type = fileClassAttribute.type;
        }
        if (field) {
          switch (type) {
            case "cycle":
            case "select": {
              const fieldModal = new valueSelectModal(this.app, this.file, field.name, "", field, this.lineNumber, this.inFrontmatter, this.top);
              fieldModal.titleEl.setText(`Select value for ${value}`);
              fieldModal.open();
              break;
            }
            case "multi": {
              const fieldModal = new valueMultiSelectModal(this.app, this.file, field.name, "", field, this.lineNumber, this.inFrontmatter, this.top);
              fieldModal.titleEl.setText(`Select values for ${value}`);
              fieldModal.open();
              break;
            }
            case "boolean": {
              const fieldModal = new valueToggleModal(this.app, this.file, field.name, false, this.lineNumber, this.inFrontmatter, this.top);
              fieldModal.titleEl.setText(`Set value for ${value}`);
              fieldModal.open();
              break;
            }
            default:
              {
                const fieldModal = new valueTextInputModal(this.app, this.file, value, "", this.lineNumber, this.inFrontmatter, this.top);
                fieldModal.titleEl.setText(`Enter value for ${value}`);
                fieldModal.open();
                "break";
              }
              ;
          }
        }
        this.close();
      } else {
        const field = this.plugin.settings.presetFields.filter((_field) => _field.name == value)[0];
        if (field.valuesListNotePath || field.values && Object.keys(field.values).length > 0) {
          if (field.isMulti) {
            const fieldModal = new valueMultiSelectModal(this.app, this.file, field.name, "", field, this.lineNumber, this.inFrontmatter, this.top);
            fieldModal.titleEl.setText(`Select values for ${value}`);
            fieldModal.open();
          } else {
            const fieldModal = new valueSelectModal(this.app, this.file, field.name, "", field, this.lineNumber, this.inFrontmatter, this.top);
            fieldModal.titleEl.setText(`Select value for ${value}`);
            fieldModal.open();
          }
          ;
        } else if (field.isBoolean) {
          const fieldModal = new valueToggleModal(this.app, this.file, field.name, false, this.lineNumber, this.inFrontmatter, this.top);
          fieldModal.titleEl.setText(`Set value for ${value}`);
          fieldModal.open();
        } else {
          const fieldModal = new valueTextInputModal(this.app, this.file, value, "", this.lineNumber, this.inFrontmatter, this.top);
          fieldModal.titleEl.setText(`Enter value for ${value}`);
          fieldModal.open();
        }
        ;
        this.close();
      }
      ;
    });
  }
};

// src/optionModals/chooseSectionModal.ts
var chooseSectionModal = class extends import_obsidian12.Modal {
  constructor(plugin, file, fileClass) {
    super(plugin.app);
    this.file = file;
    this.plugin = plugin;
    this.fileClass = fileClass;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.titleEl.setText("Add a field in this note after:");
      const inputDiv = this.contentEl.createDiv({ cls: "metadata-menu-modal-value" });
      const selectEl = new import_obsidian12.DropdownComponent(inputDiv);
      selectEl.selectEl.addClass("metadata-menu-select");
      selectEl.addOption("", "Select line");
      selectEl.addOption("top_0", "top");
      const result = yield this.app.vault.read(this.file);
      let foreHeadText = false;
      let frontmatterStart = false;
      let frontmatterEnd = false;
      let inFrontmatter = false;
      result.split("\n").forEach((line, lineNumber) => {
        if (line != "---" && !foreHeadText && !frontmatterStart) {
          foreHeadText = true;
        }
        ;
        if (line == "---" && !foreHeadText) {
          if (!frontmatterStart) {
            frontmatterStart = true;
            inFrontmatter = true;
          } else if (!frontmatterEnd) {
            frontmatterEnd = true;
            inFrontmatter = false;
          }
          ;
        }
        if (inFrontmatter) {
          selectEl.addOption(`frontmatter_${lineNumber}`, `${line.substring(0, 30)}${line.length > 30 ? "..." : ""}`);
        } else {
          selectEl.addOption(`body_${lineNumber}`, `${line.substring(0, 30)}${line.length > 30 ? "..." : ""}`);
        }
        ;
      });
      selectEl.onChange(() => {
        const valueArray = selectEl.getValue().match(/(\w+)_(\d+)/);
        const position = valueArray && valueArray.length > 0 ? valueArray[1] : 0;
        const lineNumber = Number(valueArray && valueArray.length > 1 ? valueArray[2] : 0);
        const inFrontmatter2 = position == "frontmatter" ? true : false;
        const top = position == "top" ? true : false;
        const modal = new fieldSelectModal(this.plugin, this.file, lineNumber, result.split("\n")[lineNumber], inFrontmatter2, top, this.fileClass);
        this.close();
        modal.open();
      });
    });
  }
};

// src/fileClass/FileClassAttributeSelectModal.ts
var import_obsidian14 = require("obsidian");

// src/fileClass/FileClassAttributeModal.ts
var import_obsidian13 = require("obsidian");
var FileClassAttributeModal = class extends import_obsidian13.Modal {
  constructor(app2, fileClass, attr) {
    super(app2);
    this.attr = attr;
    this.fileClass = fileClass;
    if (this.attr) {
      this.type = this.attr.type || "input";
      this.options = this.attr.options;
      this.name = this.attr.name;
    }
  }
  onOpen() {
    this.titleEl.setText(this.attr ? `Manage ${this.attr.name}` : `Create a new attribute for ${this.fileClass.name}`);
    const nameInputContainer = this.contentEl.createDiv();
    nameInputContainer.setText("name");
    const nameInput = new import_obsidian13.TextComponent(nameInputContainer);
    this.attr ? nameInput.setValue(this.attr.name) : nameInput.setPlaceholder("Type a name for this attribute");
    const typeSelectHeader = this.contentEl.createDiv();
    const attrLine = typeSelectHeader.createEl("div");
    const attrName = attrLine.createEl("strong");
    attrName.setText(`<${this.name}>`);
    attrLine.append(" fields in files with:");
    String(`---
fileClass: ${this.fileClass.name}
...
---`).split("\n").forEach((line) => {
      typeSelectHeader.createEl("div", "yaml-metadata-menu-red").setText(line);
    });
    const typeSelectContainer = this.contentEl.createDiv({ cls: "metadata-menu-value-selector-container" });
    const typeSelectLabel = typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-inline-label" });
    typeSelectLabel.setText("will: ");
    const typeSelectDropDown = typeSelectContainer.createDiv({ cls: "metadata-menu-value-selector-toggler" });
    const typeSelect = new import_obsidian13.DropdownComponent(typeSelectDropDown);
    Object.keys(types).forEach((key) => {
      typeSelect.addOption(key, types[key]);
    });
    if (this.attr) {
      typeSelect.setValue(this.type);
    }
    const optionsInputContainer = this.contentEl.createDiv({ cls: "metadata-menu-value-selector-container" });
    const optionsInputLabel = optionsInputContainer.createDiv({ cls: "metadata-menu-value-selector-inline-label-top" });
    optionsInputLabel.setText("Values");
    const optionsInput = new import_obsidian13.TextAreaComponent(optionsInputContainer);
    optionsInput.inputEl.rows = 3;
    optionsInput.inputEl.cols = 26;
    this.attr ? optionsInput.setValue(this.type == "input" || this.type == "boolean" ? "" : this.options.join(", ")) : optionsInput.setPlaceholder("insert values, comma separated");
    !this.attr || this.type == "input" || this.type == "boolean" ? optionsInputContainer.hide() : optionsInputContainer.show();
    typeSelect.onChange((type) => {
      type == "input" || type == "boolean" ? optionsInputContainer.hide() : optionsInputContainer.show();
      this.type = type;
    });
    optionsInput.onChange((value) => this.options = value.split(",").map((item) => item.trim()));
    nameInput.onChange((value) => {
      this.name = value;
      attrName.setText(`<${value}>`);
    });
    const footer = this.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
    const saveButton = new import_obsidian13.ButtonComponent(footer);
    saveButton.setIcon("checkmark");
    saveButton.onClick(() => {
      this.fileClass.updateAttribute(this.type, this.options, this.name, this.attr);
      this.close();
    });
    if (this.attr) {
      const removeButton = new import_obsidian13.ButtonComponent(footer);
      removeButton.setIcon("trash");
      removeButton.onClick(() => {
        var _a;
        const confirmModal = new import_obsidian13.Modal(this.app);
        confirmModal.titleEl.setText("Please confirm");
        confirmModal.contentEl.createDiv().setText(`Do you really want to remove ${(_a = this.attr) == null ? void 0 : _a.name} attribute from ${this.fileClass.name}?`);
        const confirmFooter = confirmModal.contentEl.createDiv({ cls: "metadata-menu-value-grid-footer" });
        const confirmButton = new import_obsidian13.ButtonComponent(confirmFooter);
        confirmButton.setIcon("checkmark");
        confirmButton.onClick(() => {
          if (this.attr)
            this.fileClass.removeAttribute(this.attr);
          confirmModal.close();
          this.close();
        });
        const dismissButton = new import_obsidian13.ExtraButtonComponent(confirmFooter);
        dismissButton.setIcon("cross");
        dismissButton.onClick(() => this.close());
        confirmModal.open();
      });
    }
    const cancelButton = new import_obsidian13.ExtraButtonComponent(footer);
    cancelButton.setIcon("cross");
    cancelButton.onClick(() => this.close());
  }
};

// src/fileClass/FileClassAttributeSelectModal.ts
var FileClassAttributeSelectModal = class extends import_obsidian14.Modal {
  constructor(plugin, file) {
    super(plugin.app);
    this.file = file;
    this.plugin = plugin;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.titleEl.setText(`Select the field to update`);
      const fileClass = yield createFileClass(this.plugin, this.file.basename);
      this.titleEl.setText(`Select the field to update in ${fileClass.name}`);
      const selectContainer = this.contentEl.createDiv();
      const select = new import_obsidian14.DropdownComponent(selectContainer);
      select.addOption("select an attribute", "--select an attribute--");
      fileClass.attributes.forEach((attr) => {
        select.addOption(attr.name, attr.name);
      });
      select.addOption("++newAttr++", "++Add a new attribute++");
      select.onChange((attrName) => {
        if (attrName == "++newAttr") {
          const modal = new FileClassAttributeModal(this.plugin.app, fileClass);
          modal.open();
          this.close();
        } else {
          const modal = new FileClassAttributeModal(this.plugin.app, fileClass, fileClass.attributes.filter((attr) => attr.name == attrName)[0]);
          modal.open();
          this.close();
        }
      });
    });
  }
};

// src/options/OptionsList.ts
function isMenu(category) {
  return category.addItem !== void 0;
}
function isSelect(category) {
  return category.modals !== void 0;
}
var OptionsList = class {
  constructor(plugin, file, category) {
    this.file = file;
    this.plugin = plugin;
    this.category = category;
  }
  createExtraOptionList() {
    return __async(this, null, function* () {
      var _a;
      const frontmatter = (_a = this.plugin.app.metadataCache.getCache(this.file.path)) == null ? void 0 : _a.frontmatter;
      if (frontmatter) {
        const _b = frontmatter, { position } = _b, attributes = __objRest(_b, ["position"]);
        Object.keys(attributes).forEach((key) => {
          if (this.plugin.settings.globallyIgnoredFields.includes(key)) {
            delete attributes[key];
          }
          ;
        });
        if (isMenu(this.category)) {
          this.category.addSeparator();
        }
        ;
        let fileClassForFields = false;
        let fileClassFields = [];
        const fileClassAlias = this.plugin.settings.fileClassAlias;
        if (Object.keys(attributes).includes(fileClassAlias)) {
          const fileClass = attributes[fileClassAlias];
          try {
            const _fileClass = yield createFileClass(this.plugin, fileClass);
            this.fileClass = _fileClass;
            fileClassFields = _fileClass.attributes.map((attr) => attr.name);
            fileClassForFields = true;
            Object.keys(attributes).forEach((key) => {
              if (!fileClassFields.includes(key) && key != fileClassAlias) {
                delete attributes[key];
              }
              ;
            });
            const fileClassAttributeSelectModal = new FileClassAttributeSelectModal(this.plugin, this.fileClass.getClassFile());
            if (isMenu(this.category)) {
              this.category.addSeparator();
              this.category.addItem((item) => {
                item.setIcon("gear");
                item.setTitle(`Manage <${this.fileClass.name}> fields`);
                item.onClick((evt) => {
                  fileClassAttributeSelectModal.open();
                });
              });
            } else {
              this.category.addOption("manage_fileClass_attributes", "Manage fileClass attributes");
              this.category.modals["add_field_at_section"] = () => fileClassAttributeSelectModal.open();
            }
            ;
            yield this.createExtraOptionsListForFrontmatter(attributes);
            yield this.createExtraOptionsListForInlineFields(this.file, fileClassForFields, fileClassFields);
            if (isMenu(this.category)) {
              this.category.addSeparator();
            }
            ;
            this.addSectionSelectModalOption();
          } catch (error) {
            yield this.createExtraOptionsListForFrontmatter(attributes);
            yield this.createExtraOptionsListForInlineFields(this.file);
            if (isMenu(this.category)) {
              this.category.addSeparator();
            }
            ;
            this.addSectionSelectModalOption();
          }
          ;
        } else {
          yield this.createExtraOptionsListForFrontmatter(attributes);
          yield this.createExtraOptionsListForInlineFields(this.file);
          if (isMenu(this.category)) {
            this.category.addSeparator();
          }
          ;
          this.addSectionSelectModalOption();
        }
        ;
      } else {
        yield this.createExtraOptionsListForInlineFields(this.file);
        if (isMenu(this.category)) {
          this.category.addSeparator();
        }
        ;
        this.addSectionSelectModalOption();
      }
      ;
    });
  }
  createExtraOptionsListForInlineFields(_0) {
    return __async(this, arguments, function* (file, fileClassForFields = false, fileClassFields = []) {
      let attributes = {};
      const regex = new RegExp(`^${genericFieldRegex}::s*(?<values>.+)?`, "u");
      const result = yield this.plugin.app.vault.read(file);
      result.split("\n").map((line) => {
        const regexResult = line.match(regex);
        const { attribute, values } = (regexResult == null ? void 0 : regexResult.groups) || {};
        if (attribute && !this.plugin.settings.globallyIgnoredFields.includes(attribute.trim())) {
          if (fileClassForFields) {
            if (fileClassFields.includes(attribute.trim())) {
              attributes[attribute.trim()] = values ? values.trim() : "";
            }
            ;
          } else {
            attributes[attribute.trim()] = values ? values.trim() : "";
          }
          ;
        }
        ;
      });
      if (Object.keys(attributes).length > 0) {
        if (isMenu(this.category)) {
          this.category.addSeparator();
        }
        ;
        this.buildExtraOptionsList(attributes);
      }
      ;
    });
  }
  createExtraOptionsListForFrontmatter(attributes) {
    return __async(this, null, function* () {
      this.buildExtraOptionsList(attributes);
    });
  }
  buildExtraOptionsList(attributes) {
    Object.keys(attributes).forEach((key) => {
      const value = attributes[key];
      const propertySettings = getPropertySettings(this.plugin, key, this.fileClass);
      if ((propertySettings == null ? void 0 : propertySettings.values) && !(propertySettings == null ? void 0 : propertySettings.isBoolean)) {
        if (propertySettings.isCycle) {
          this.addCycleMenuOption(key, value, propertySettings);
        } else if (propertySettings.isMulti) {
          this.addMultiMenuOption(key, value, propertySettings);
        } else {
          this.addSelectMenuOption(key, value, propertySettings);
        }
        ;
      } else if (propertySettings == null ? void 0 : propertySettings.isBoolean) {
        let toBooleanValue = false;
        if (isBoolean(value)) {
          toBooleanValue = value;
        } else if (/true/i.test(value)) {
          toBooleanValue = true;
        } else if (/false/i.test(value)) {
          toBooleanValue = false;
        }
        ;
        this.addToggleMenuOption(key, toBooleanValue);
      } else {
        this.addTextInputMenuOption(key, value ? value.toString() : "");
      }
      ;
    });
  }
  addSectionSelectModalOption() {
    const modal = new chooseSectionModal(this.plugin, this.file, this.fileClass);
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setIcon("pencil");
        item.setTitle("Add field at section...");
        item.onClick((evt) => {
          modal.open();
        });
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption("add_field_at_section", "Add field at section...");
      this.category.modals["add_field_at_section"] = () => modal.open();
    }
    ;
  }
  addCycleMenuOption(name, value, propertySettings) {
    const values = propertySettings.values;
    const keys = Object.keys(values);
    const keyForValue = keys.find((key) => values[key] === value);
    let nextValue;
    if (keyForValue) {
      const nextKey = keys[(keys.indexOf(keyForValue) + 1) % keys.length];
      nextValue = values[nextKey];
    } else {
      nextValue = values[Object.keys(values)[0]];
    }
    ;
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`${name} : ${value} \u25B7 ${nextValue}`);
        item.setIcon("switch");
        item.onClick((evt) => {
          replaceValues(this.plugin.app, this.file, name, nextValue);
        });
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`${name}_${value}_${nextValue}`, `${name} : ${value} \u25B7 ${nextValue}`);
      this.category.modals[`${name}_${value}_${nextValue}`] = () => replaceValues(this.plugin.app, this.file, name, nextValue);
    }
    ;
  }
  addMultiMenuOption(name, value, propertySettings) {
    const modal = new valueMultiSelectModal(this.plugin.app, this.file, name, value, propertySettings);
    modal.titleEl.setText("Select values");
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon("bullet-list");
        item.onClick((evt) => {
          modal.open();
        });
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`update_${name}`, `Update <${name}>`);
      this.category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
  addSelectMenuOption(name, value, propertySettings) {
    const modal = new valueSelectModal(this.plugin.app, this.file, name, value, propertySettings);
    modal.titleEl.setText("Select value");
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`Update ${name}`);
        item.setIcon("right-triangle");
        item.onClick((evt) => modal.open());
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`update_${name}`, `Update <${name}>`);
      this.category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
  addToggleMenuOption(name, value) {
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`<${name}> ${value ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
        item.setIcon("checkmark");
        item.onClick((evt) => {
          replaceValues(this.plugin.app, this.file, name, (!value).toString());
        });
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`update_${name}`, `<${name}> ${value ? "\u2705 \u25B7 \u274C" : "\u274C \u25B7 \u2705"}`);
      this.category.modals[`update_${name}`] = () => replaceValues(this.plugin.app, this.file, name, (!value).toString());
      ;
    }
    ;
  }
  addTextInputMenuOption(name, value) {
    const modal = new valueTextInputModal(this.plugin.app, this.file, name, value);
    modal.titleEl.setText(`Change Value for <${name}>`);
    if (isMenu(this.category)) {
      this.category.addItem((item) => {
        item.setTitle(`Update <${name}>`);
        item.setIcon("pencil");
        item.onClick((evt) => modal.open());
        item.setSection("target-metadata");
      });
    } else if (isSelect(this.category)) {
      this.category.addOption(`update_${name}`, `Update <${name}>`);
      this.category.modals[`update_${name}`] = () => modal.open();
    }
    ;
  }
};

// src/options/linkContextMenu.ts
var linkContextMenu = class {
  constructor(plugin) {
    this.plugin = plugin;
    this.createContextMenu();
  }
  createContextMenu() {
    this.plugin.registerEvent(this.plugin.app.workspace.on("file-menu", (menu, abstractFile, source) => {
      if (this.plugin.settings.displayFieldsInContextMenu) {
        const file = this.plugin.app.vault.getAbstractFileByPath(abstractFile.path);
        if (file instanceof import_obsidian15.TFile && file.extension === "md") {
          this.file = file;
          if (file.parent.path + "/" == this.plugin.settings.classFilesPath) {
            menu.addSeparator();
            menu.addItem((item) => {
              item.setIcon("gear");
              item.setTitle(`Manage <${file.basename}> fields`);
              item.onClick((evt) => {
                const fileClassAttributeSelectModal = new FileClassAttributeSelectModal(this.plugin, file);
                fileClassAttributeSelectModal.open();
              });
            });
          } else {
            this.optionsList = new OptionsList(this.plugin, this.file, menu);
            this.optionsList.createExtraOptionList();
          }
          ;
        }
        ;
      }
      ;
    }));
  }
};

// src/options/NoteFieldsCommandsModal.ts
var import_obsidian17 = require("obsidian");

// src/optionModals/SelectModal.ts
var import_obsidian16 = require("obsidian");
var SelectModal = class extends import_obsidian16.DropdownComponent {
  constructor(containerEl) {
    super(containerEl);
    this.modals = {};
  }
};

// src/options/NoteFieldsCommandsModal.ts
var NoteFieldsCommandsModal = class extends import_obsidian17.Modal {
  constructor(app2, plugin, file) {
    super(app2);
    this.app = app2;
    this.plugin = plugin;
    this.file = file;
  }
  onOpen() {
    return __async(this, null, function* () {
      this.titleEl.setText(`Select the field to manage`);
      this.containerEl.addClass("metadata-menu");
      const optionsListContainer = this.contentEl.createDiv({ cls: "field-options" });
      this.select = new SelectModal(optionsListContainer);
      this.select.addOption("---", "Choose Field");
      this.optionsList = new OptionsList(this.plugin, this.file, this.select);
      yield this.optionsList.createExtraOptionList();
      this.select.onChange((value) => {
        this.select.modals[value]();
        this.close();
      });
      this.select.selectEl.focus();
    });
  }
};

// src/suggester/MetadataSuggester.ts
var import_obsidian18 = require("obsidian");
var ValueSuggest = class extends import_obsidian18.EditorSuggest {
  constructor(app2, plugin) {
    super(app2);
    this.inFrontmatter = false;
    this.didSelect = false;
    this.filterOption = (firstValues, lastValue, option) => {
      return !firstValues || !(firstValues == null ? void 0 : firstValues.contains(option)) && (!lastValue || !!lastValue && option.contains(lastValue));
    };
    this.app = app2;
    this.plugin = plugin;
    this.setInstructions([{ command: "Shift", purpose: "put a space after::" }]);
    this.scope.register(["Shift"], "Enter", (evt) => {
      this.suggestions.useSelectedItem(evt);
      return false;
    });
  }
  onTrigger(cursor, editor, file) {
    if (this.didSelect) {
      this.didSelect = false;
      return null;
    }
    if (!this.plugin.settings.isAutosuggestEnabled) {
      return null;
    }
    ;
    const frontmatter = this.plugin.app.metadataCache.getFileCache(file).frontmatter;
    this.inFrontmatter = frontmatter !== void 0 && frontmatter.position.start.line < cursor.line && cursor.line < frontmatter.position.end.line;
    const regex = this.inFrontmatter ? new RegExp(`^${genericFieldRegex}:(?<values>.*)`, "u") : new RegExp(`^${genericFieldRegex}::(?<values>.*)`, "u");
    const fullLine = editor.getLine(editor.getCursor().line);
    if (!regex.test(fullLine)) {
      return null;
    }
    return {
      start: cursor,
      end: cursor,
      query: editor.getLine(cursor.line)
    };
  }
  getSuggestions(context) {
    return __async(this, null, function* () {
      const suggestions = yield this.getValueSuggestions(context);
      if (suggestions.length) {
        return suggestions;
      }
      return [];
    });
  }
  getValueSuggestions(context) {
    return __async(this, null, function* () {
      var _a, _b;
      const line = context.start.line;
      let regex;
      if (!this.inFrontmatter) {
        regex = new RegExp(`^${genericFieldRegex}::(?<values>.+)?`, "u");
      } else {
        regex = new RegExp(`^${genericFieldRegex}:(?<values>.+)?`, "u");
      }
      ;
      const regexResult = context.editor.getRange({ line, ch: 0 }, context.end).match(regex);
      if (regexResult && ((_a = regexResult.groups) == null ? void 0 : _a.attribute)) {
        const fieldName = regexResult.groups.attribute;
        const valuesList = (_b = regexResult.groups.values) == null ? void 0 : _b.replace(/^\[|^\s\[/, "").replace(/\]$/, "").split(",").map((o) => o.trim());
        const lastValue = valuesList == null ? void 0 : valuesList.last();
        const firstValues = valuesList == null ? void 0 : valuesList.slice(0, -1);
        if (fieldName === "tags" && this.inFrontmatter) {
          return Object.keys(this.app.metadataCache.getTags()).filter((t) => lastValue ? t.contains(lastValue) : t).sort().map((tag) => Object({ value: tag.replace(/^#/, "") }));
        }
        const cache = this.plugin.app.metadataCache.getCache(context.file.path);
        let tryWithPresetField = !(cache == null ? void 0 : cache.frontmatter);
        if (cache == null ? void 0 : cache.frontmatter) {
          const _c = cache.frontmatter, { position } = _c, attributes = __objRest(_c, ["position"]);
          const fileClassAlias = this.plugin.settings.fileClassAlias;
          if (Object.keys(attributes).contains(fileClassAlias)) {
            const fileClassValue = attributes[fileClassAlias];
            try {
              const fileClass = yield createFileClass(this.plugin, fileClassValue);
              this.fileClass = fileClass;
              const fileClassAttributes = this.fileClass.attributes;
              if (fileClassAttributes.map((attr) => attr.name).contains(fieldName)) {
                const options = fileClassAttributes.filter((attr) => attr.name == fieldName)[0].options.filter((option) => this.filterOption(firstValues, lastValue, option));
                return options.map((option) => Object({ value: option }));
              }
            } catch (error) {
              tryWithPresetField = true;
            }
            ;
          } else {
            tryWithPresetField = true;
          }
          ;
        }
        ;
        if (tryWithPresetField) {
          const presetFieldMatch = this.plugin.settings.presetFields.filter((field) => field.name == fieldName);
          if (presetFieldMatch.length > 0) {
            const presetField = presetFieldMatch[0];
            if (presetField.valuesListNotePath) {
              const valuesFile = this.plugin.app.vault.getAbstractFileByPath(presetField.valuesListNotePath);
              if (valuesFile instanceof import_obsidian18.TFile && valuesFile.extension == "md") {
                const values2 = yield (yield this.plugin.app.vault.read(valuesFile)).split("\n").filter((option) => this.filterOption(firstValues, lastValue, option)).map((_value) => Object({ value: _value }));
                return values2;
              }
              ;
            }
            ;
            const values = Object.entries(presetFieldMatch[0].values).map((option) => option[1]).filter((option) => this.filterOption(firstValues, lastValue, option));
            return values.map((_value) => Object({ value: _value }));
          }
          ;
        }
        ;
      }
      ;
      return [];
    });
  }
  renderSuggestion(suggestion, el) {
    el.setText(suggestion.value);
  }
  selectSuggestion(suggestion, event) {
    const activeView = this.app.workspace.getActiveViewOfType(import_obsidian18.MarkdownView);
    if (!activeView) {
      return;
    }
    ;
    const editor = activeView.editor;
    const activeLine = editor.getLine(this.context.start.line);
    if (this.inFrontmatter) {
      try {
        let parsedField = (0, import_obsidian18.parseYaml)(activeLine);
        let [attr, pastValues] = Object.entries(parsedField)[0];
        let newField;
        if (!pastValues) {
          newField = attr + ": " + suggestion.value;
        } else if (typeof pastValues == "string") {
          if (!pastValues.contains(",")) {
            newField = attr + ": " + suggestion.value;
          } else {
            newField = attr + ": [" + pastValues.split(",").map((o) => o.trim()).slice(0, -1).join(", ") + ", " + suggestion.value + "]";
          }
        } else if (Array.isArray(pastValues)) {
          if (activeLine.endsWith(",]") || activeLine.endsWith(", ]")) {
            newField = attr + ": [" + [...pastValues, suggestion.value].join(", ") + "]";
          } else {
            newField = attr + ": [" + [...pastValues.slice(0, -1), suggestion.value].join(", ") + "]";
          }
        } else {
          newField = attr + ": [" + [...pastValues].join(", ") + "]";
        }
        editor.replaceRange(newField, { line: this.context.start.line, ch: 0 }, { line: this.context.start.line, ch: activeLine.length });
        if (Array.isArray(pastValues) || typeof pastValues === "string" && pastValues.contains(",")) {
          editor.setCursor({ line: this.context.start.line, ch: newField.length - 1 });
        } else {
          editor.setCursor({ line: this.context.start.line, ch: newField.length });
        }
      } catch (error) {
        new import_obsidian18.Notice("Frontmatter wrongly formatted", 2e3);
        this.close();
        return;
      }
    } else {
      let cleanedLine = activeLine;
      while (![",", ":"].contains(cleanedLine.charAt(cleanedLine.length - 1))) {
        cleanedLine = cleanedLine.slice(0, -1);
      }
      editor.replaceRange(`${cleanedLine}${event.shiftKey ? " " : ""}` + suggestion.value, { line: this.context.start.line, ch: 0 }, this.context.end);
    }
    this.didSelect = true;
    this.close();
  }
};

// main.ts
var MetadataMenu = class extends import_obsidian19.Plugin {
  constructor() {
    super(...arguments);
    this.initialProperties = [];
  }
  onload() {
    return __async(this, null, function* () {
      console.log("Metadata Menu loaded");
      yield this.loadSettings();
      this.registerEditorSuggest(new ValueSuggest(this.app, this));
      this.settings.presetFields.forEach((prop) => {
        const property = new Field_default();
        Object.assign(property, prop);
        this.initialProperties.push(property);
      });
      this.addSettingTab(new MetadataMenuSettingTab(this.app, this));
      this.api = new MetadataMenuApi(this).make();
      this.addCommand({
        id: "field_options",
        name: "field options",
        checkCallback: (checking) => {
          const view = this.app.workspace.getActiveViewOfType(import_obsidian19.MarkdownView);
          if (checking) {
            return !!(view == null ? void 0 : view.file);
          }
          const fieldsOptionsModal = new NoteFieldsCommandsModal(this.app, this, view.file);
          fieldsOptionsModal.open();
        }
      });
      this.addCommand({
        id: "fileClassAttr_options",
        name: "fileClass attributes options",
        checkCallback: (checking) => {
          const view = this.app.workspace.getActiveViewOfType(import_obsidian19.MarkdownView);
          if (checking) {
            return !!(view == null ? void 0 : view.file) && `${view.file.parent.path}/` == this.settings.classFilesPath;
          }
          const modal = new FileClassAttributeSelectModal(this, view.file);
          modal.open();
        }
      });
      new linkContextMenu(this);
    });
  }
  onunload() {
    console.log("Metadata Menu unloaded");
  }
  loadSettings() {
    return __async(this, null, function* () {
      this.settings = Object.assign({}, DEFAULT_SETTINGS, yield this.loadData());
    });
  }
  saveSettings() {
    return __async(this, null, function* () {
      this.settings.presetFields = this.initialProperties;
      yield this.saveData(this.settings);
    });
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibWFpbi50cyIsICJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYi50cyIsICJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nc01vZGFsLnRzIiwgInNyYy9GaWVsZC50cyIsICJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nLnRzIiwgInNyYy9zZXR0aW5ncy9NZXRhZGF0YU1lbnVTZXR0aW5ncy50cyIsICJzcmMvdXRpbHMvcGFyc2VyLnRzIiwgInNyYy9jb21tYW5kcy9nZXRWYWx1ZXMudHMiLCAic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXMudHMiLCAic3JjL2NvbW1hbmRzL2ZpZWxkTW9kaWZpZXIudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NBdHRyaWJ1dGUudHMiLCAic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3MudHMiLCAic3JjL2NvbW1hbmRzL2dldFByb3BlcnR5U2V0dGluZ3MudHMiLCAic3JjL01ldGFkYXRhTWVudUFwaS50cyIsICJzcmMvb3B0aW9ucy9saW5rQ29udGV4dE1lbnUudHMiLCAic3JjL29wdGlvbk1vZGFscy92YWx1ZU11bHRpU2VsZWN0TW9kYWwudHMiLCAic3JjL29wdGlvbk1vZGFscy92YWx1ZVRleHRJbnB1dE1vZGFsLnRzIiwgInNyYy9vcHRpb25Nb2RhbHMvdmFsdWVTZWxlY3RNb2RhbC50cyIsICJzcmMvb3B0aW9uTW9kYWxzL2Nob29zZVNlY3Rpb25Nb2RhbC50cyIsICJzcmMvb3B0aW9uTW9kYWxzL2ZpZWxkU2VsZWN0TW9kYWwudHMiLCAic3JjL29wdGlvbk1vZGFscy9hZGROZXdGaWVsZE1vZGFsLnRzIiwgInNyYy9vcHRpb25Nb2RhbHMvdmFsdWVUb2dnbGVNb2RhbC50cyIsICJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsLnRzIiwgInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwudHMiLCAic3JjL29wdGlvbnMvT3B0aW9uc0xpc3QudHMiLCAic3JjL29wdGlvbnMvTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWwudHMiLCAic3JjL29wdGlvbk1vZGFscy9TZWxlY3RNb2RhbC50cyIsICJzcmMvc3VnZ2VzdGVyL01ldGFkYXRhU3VnZ2VzdGVyLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgeyBQbHVnaW4sIE1hcmtkb3duVmlldyB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiIGZyb20gXCJzcmMvc2V0dGluZ3MvTWV0YWRhdGFNZW51U2V0dGluZ1RhYlwiO1xuaW1wb3J0IHsgTWV0YWRhdGFNZW51U2V0dGluZ3MsIERFRkFVTFRfU0VUVElOR1MgfSBmcm9tIFwic3JjL3NldHRpbmdzL01ldGFkYXRhTWVudVNldHRpbmdzXCI7XG5pbXBvcnQgdHlwZSB7IElNZXRhZGF0YU1lbnVBcGkgfSBmcm9tICdzcmMvTWV0YWRhdGFNZW51QXBpJztcbmltcG9ydCB7IE1ldGFkYXRhTWVudUFwaSB9IGZyb20gJ3NyYy9NZXRhZGF0YU1lbnVBcGknO1xuaW1wb3J0IEZpZWxkIGZyb20gJ3NyYy9GaWVsZCc7XG5pbXBvcnQgbGlua0NvbnRleHRNZW51IGZyb20gXCJzcmMvb3B0aW9ucy9saW5rQ29udGV4dE1lbnVcIjtcbmltcG9ydCBOb3RlRmllbGRzQ29tbWFuZHNNb2RhbCBmcm9tIFwic3JjL29wdGlvbnMvTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWxcIjtcbmltcG9ydCBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCBmcm9tICdzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsJztcbmltcG9ydCBWYWx1ZVN1Z2dlc3QgZnJvbSBcInNyYy9zdWdnZXN0ZXIvTWV0YWRhdGFTdWdnZXN0ZXJcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWV0YWRhdGFNZW51IGV4dGVuZHMgUGx1Z2luIHtcblx0cHVibGljIGFwaTogSU1ldGFkYXRhTWVudUFwaTtcblx0cHVibGljIHNldHRpbmdzOiBNZXRhZGF0YU1lbnVTZXR0aW5ncztcblx0cHVibGljIGluaXRpYWxQcm9wZXJ0aWVzOiBBcnJheTxGaWVsZD4gPSBbXTtcblx0cHVibGljIHNldHRpbmdUYWI6IE1ldGFkYXRhTWVudVNldHRpbmdUYWI7XG5cblx0YXN5bmMgb25sb2FkKCk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGNvbnNvbGUubG9nKCdNZXRhZGF0YSBNZW51IGxvYWRlZCcpO1xuXHRcdGF3YWl0IHRoaXMubG9hZFNldHRpbmdzKCk7XG5cdFx0dGhpcy5yZWdpc3RlckVkaXRvclN1Z2dlc3QobmV3IFZhbHVlU3VnZ2VzdCh0aGlzLmFwcCwgdGhpcykpO1xuXG5cdFx0dGhpcy5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZm9yRWFjaChwcm9wID0+IHtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRPYmplY3QuYXNzaWduKHByb3BlcnR5LCBwcm9wKTtcblx0XHRcdHRoaXMuaW5pdGlhbFByb3BlcnRpZXMucHVzaChwcm9wZXJ0eSk7XG5cdFx0fSk7XG5cdFx0dGhpcy5hZGRTZXR0aW5nVGFiKG5ldyBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiKHRoaXMuYXBwLCB0aGlzKSk7XG5cdFx0dGhpcy5hcGkgPSBuZXcgTWV0YWRhdGFNZW51QXBpKHRoaXMpLm1ha2UoKTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogXCJmaWVsZF9vcHRpb25zXCIsXG5cdFx0XHRuYW1lOiBcImZpZWxkIG9wdGlvbnNcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdFx0XHRpZiAoY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEodmlldz8uZmlsZSlcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBmaWVsZHNPcHRpb25zTW9kYWwgPSBuZXcgTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWwodGhpcy5hcHAsIHRoaXMsIHZpZXchLmZpbGUpXG5cdFx0XHRcdGZpZWxkc09wdGlvbnNNb2RhbC5vcGVuKClcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHQvKiBUT0RPIDogYWRkIGEgY29udGV4dCBtZW51IGZvciBmaWxlQ2xhc3MgZmlsZXMgdG8gc2hvdyB0aGUgc2FtZSBvcHRpb25zIGFzIGluIEZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsKi9cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiZmlsZUNsYXNzQXR0cl9vcHRpb25zXCIsXG5cdFx0XHRuYW1lOiBcImZpbGVDbGFzcyBhdHRyaWJ1dGVzIG9wdGlvbnNcIixcblx0XHRcdGNoZWNrQ2FsbGJhY2s6IChjaGVja2luZzogYm9vbGVhbikgPT4ge1xuXHRcdFx0XHRjb25zdCB2aWV3ID0gdGhpcy5hcHAud29ya3NwYWNlLmdldEFjdGl2ZVZpZXdPZlR5cGUoTWFya2Rvd25WaWV3KVxuXHRcdFx0XHRpZiAoY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRyZXR1cm4gISEodmlldz8uZmlsZSkgJiYgYCR7dmlldy5maWxlLnBhcmVudC5wYXRofS9gID09IHRoaXMuc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGhcblx0XHRcdFx0fVxuXHRcdFx0XHRjb25zdCBtb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCh0aGlzLCB2aWV3IS5maWxlKVxuXHRcdFx0XHRtb2RhbC5vcGVuKClcblx0XHRcdH0sXG5cdFx0fSk7XG5cblx0XHRuZXcgbGlua0NvbnRleHRNZW51KHRoaXMpO1xuXHR9O1xuXG5cdG9udW5sb2FkKCkge1xuXHRcdGNvbnNvbGUubG9nKCdNZXRhZGF0YSBNZW51IHVubG9hZGVkJyk7XG5cdH07XG5cblx0YXN5bmMgbG9hZFNldHRpbmdzKCkge1xuXHRcdHRoaXMuc2V0dGluZ3MgPSBPYmplY3QuYXNzaWduKHt9LCBERUZBVUxUX1NFVFRJTkdTLCBhd2FpdCB0aGlzLmxvYWREYXRhKCkpO1xuXHR9O1xuXG5cdGFzeW5jIHNhdmVTZXR0aW5ncygpIHtcblx0XHR0aGlzLnNldHRpbmdzLnByZXNldEZpZWxkcyA9IHRoaXMuaW5pdGlhbFByb3BlcnRpZXM7XG5cdFx0YXdhaXQgdGhpcy5zYXZlRGF0YSh0aGlzLnNldHRpbmdzKTtcblx0fTtcbn1cbiIsICJpbXBvcnQgeyBBcHAsIFBsdWdpblNldHRpbmdUYWIsIFNldHRpbmcsIEJ1dHRvbkNvbXBvbmVudCwgVG9nZ2xlQ29tcG9uZW50LCBNb2RhbCB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvRmllbGRcIjtcbmltcG9ydCBGaWVsZFNldHRpbmcgZnJvbSBcInNyYy9zZXR0aW5ncy9GaWVsZFNldHRpbmdcIjtcbmltcG9ydCB7IGNvcHlGaWxlU3luYyB9IGZyb20gXCJmc1wiO1xuXG5jbGFzcyBTZXR0aW5nc01pZ3JhdGlvbkNvbmZpcm1Nb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuXHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuXHRwcml2YXRlIHRhYjogTWV0YWRhdGFNZW51U2V0dGluZ1RhYjtcblxuXHRjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgdGFiOiBNZXRhZGF0YU1lbnVTZXR0aW5nVGFiKSB7XG5cdFx0c3VwZXIocGx1Z2luLmFwcCk7XG5cdFx0dGhpcy5wbHVnaW4gPSBwbHVnaW47XG5cdFx0dGhpcy50YWIgPSB0YWI7XG5cdH07XG5cblx0b25PcGVuKCk6IHZvaWQge1xuXG5cdFx0dGhpcy50aXRsZUVsLnNldFRleHQoXCJDb25maXJtXCIpO1xuXHRcdGNvbnN0IGJvZHkgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuXHRcdFx0Y2xzOiBcIm1vZGFsLXRleHQtZGFuZ2VyXCJcblx0XHR9KTtcblx0XHRib2R5LnNldFRleHQoXCJUaGlzIHdpbGwgZXJhc2UgY3VycmVudCBzZXR0aW5ncy4gQXJlIHlvdSBzdXJlP1wiKTtcblx0XHRjb25zdCBjb25maXJtQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh0aGlzLmNvbnRlbnRFbCk7XG5cdFx0Y29uZmlybUJ1dHRvbi5zZXRJY29uKFwiY2hlY2tcIik7XG5cdFx0Y29uZmlybUJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcblx0XHRcdC8vQHRzLWlnbm9yZVxuXHRcdFx0aWYgKHRoaXMuYXBwLnBsdWdpbnMucGx1Z2lucy5oYXNPd25Qcm9wZXJ0eShcInN1cGVyY2hhcmdlZC1saW5rcy1vYnNpZGlhblwiKSkge1xuXHRcdFx0XHQvL0B0cy1pZ25vcmVcblx0XHRcdFx0bGV0IHNldHRpbmdzID0gdGhpcy5hcHAucGx1Z2lucy5wbHVnaW5zW1wic3VwZXJjaGFyZ2VkLWxpbmtzLW9ic2lkaWFuXCJdLnNldHRpbmdzO1xuXHRcdFx0XHRsZXQgX3NldHRpbmdzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3M7XG5cdFx0XHRcdC8vY29weWluZyBzaW1wbGUgc2V0dGluZ3Ncblx0XHRcdFx0X3NldHRpbmdzLmNsYXNzRmlsZXNQYXRoID0gc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGg7XG5cdFx0XHRcdF9zZXR0aW5ncy5kaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudSA9IHNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51O1xuXHRcdFx0XHRfc2V0dGluZ3MuZ2V0RnJvbUlubGluZUZpZWxkID0gc2V0dGluZ3MuZ2V0RnJvbUlubGluZUZpZWxkO1xuXHRcdFx0XHRfc2V0dGluZ3MuZ2xvYmFsbHlJZ25vcmVkRmllbGRzID0gc2V0dGluZ3MuZ2xvYmFsbHlJZ25vcmVkRmllbGRzO1xuXHRcdFx0XHQvL2RlZXAgY29weWluZyBwcmVzZXRGaWVsZHMgaW4gaW5pdGlhbFByb3BlcnR5XG5cdFx0XHRcdHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzID0gW107XG5cdFx0XHRcdHNldHRpbmdzLnByZXNldEZpZWxkcy5mb3JFYWNoKChwcm9wOiBGaWVsZCkgPT4ge1xuXHRcdFx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRcdFx0T2JqZWN0LmFzc2lnbihwcm9wZXJ0eSwgcHJvcCk7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMucHVzaChwcm9wZXJ0eSk7XG5cdFx0XHRcdH0pXG5cblx0XHRcdFx0dGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdHRoaXMuY2xvc2UoKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH07XG5cblx0b25DbG9zZSgpOiB2b2lkIHtcblx0XHR0aGlzLnRhYi5kaXNwbGF5KCk7XG5cdH07XG59O1xuXG5cblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTWV0YWRhdGFNZW51U2V0dGluZ1RhYiBleHRlbmRzIFBsdWdpblNldHRpbmdUYWIge1xuXHRwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuXG5cdGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuXHRcdHN1cGVyKGFwcCwgcGx1Z2luKTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0fTtcblxuXHRkaXNwbGF5KCk6IHZvaWQge1xuXHRcdGxldCB7IGNvbnRhaW5lckVsIH0gPSB0aGlzO1xuXHRcdGNvbnRhaW5lckVsLmVtcHR5KCk7XG5cblx0XHQvKiBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdEdsb2JhbCBTZXR0aW5ncyBcblx0XHQtLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxuXHRcdCovXG5cdFx0Y29uc3QgZ2xvYmFsU2V0dGluZ3MgPSBjb250YWluZXJFbC5jcmVhdGVFbCgnZGl2Jylcblx0XHRnbG9iYWxTZXR0aW5ncy5jcmVhdGVFbCgnaDQnLCB7IHRleHQ6ICdHbG9iYWwgc2V0dGluZ3MnLCBjbHM6IFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24taGVhZGVyXCIgfSk7XG5cdFx0Z2xvYmFsU2V0dGluZ3MuY3JlYXRlRWwoJ2RpdicsIHtcblx0XHRcdGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24gbWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24tZGVzY1wiLFxuXHRcdFx0dGV4dDogXCJHbG9iYWwgc2V0dGluZ3MgdG8gYXBwbHkgdG8geW91ciB3aG9sZSB2YXVsdFwiXG5cdFx0fSlcblx0XHQvLyBNYW5hZ2luZyBjaG9pY2Ugd2hldGhlciB5b3UgZ2V0IGF0dHJpYnV0ZXMgZnJvbSBpbmxpbmUgZmllbGRzIGFuZCBmcm9udG1hdHRlciBvciBvbmx5IGZyb250bWF0ZXJcblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdTZWFyY2ggZm9yIGF0dHJpYnV0ZSBpbiBJbmxpbmUgZmllbGRzIGxpa2UgPGZpZWxkOjo+Jylcblx0XHRcdC5zZXREZXNjKCdTZXRzIHRoZSBgZGF0YS1saW5rLTxmaWVsZD5gLWF0dHJpYnV0ZSB0byB0aGUgdmFsdWUgb2YgaW5saW5lIGZpZWxkcycpXG5cdFx0XHQuYWRkVG9nZ2xlKHRvZ2dsZSA9PiB7XG5cdFx0XHRcdHRvZ2dsZS5zZXRWYWx1ZSh0aGlzLnBsdWdpbi5zZXR0aW5ncy5nZXRGcm9tSW5saW5lRmllbGQpXG5cdFx0XHRcdHRvZ2dsZS5vbkNoYW5nZShhc3luYyB2YWx1ZSA9PiB7XG5cdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuZ2V0RnJvbUlubGluZUZpZWxkID0gdmFsdWVcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0LyogTWFuYWdlIG1lbnUgb3B0aW9ucyBkaXNwbGF5Ki9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKFwiRGlzcGxheSBmaWVsZCBvcHRpb25zIGluIGNvbnRleHQgbWVudVwiKVxuXHRcdFx0LnNldERlc2MoXCJDaG9vc2UgdG8gc2hvdyBvciBoaWRlIGZpZWxkcyBvcHRpb25zIGluIHRoZSBjb250ZXh0IG1lbnUgb2YgYSBsaW5rIG9yIGEgZmlsZVwiKVxuXHRcdFx0LmFkZFRvZ2dsZSgodG9nZ2xlOiBUb2dnbGVDb21wb25lbnQpID0+IHtcblx0XHRcdFx0dG9nZ2xlLnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51KVxuXHRcdFx0XHR0b2dnbGUub25DaGFuZ2UoYXN5bmMgdmFsdWUgPT4ge1xuXHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51ID0gdmFsdWVcblx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKVxuXHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXHRcdC8qIEV4Y2x1ZGUgRmllbGRzIGZyb20gY29udGV4dCBtZW51Ki9cblx0XHRuZXcgU2V0dGluZyhnbG9iYWxTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdHbG9iYWxseSBpZ25vcmVkIGZpZWxkcycpXG5cdFx0XHQuc2V0RGVzYygnRmllbGRzIHRvIGJlIGlnbm9yZWQgYnkgdGhlIHBsdWdpbiB3aGVuIGFkZGluZyBvcHRpb25zIHRvIHRoZSBjb250ZXh0IG1lbnUnKVxuXHRcdFx0LmFkZFRleHRBcmVhKCh0ZXh0KSA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ0VudGVyIGZpZWxkcyBhcyBzdHJpbmcsIGNvbW1hIHNlcGFyYXRlZCcpXG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5qb2luKCcsICcpKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcyA9IHZhbHVlLnJlcGxhY2UoL1xccy9nLCAnJykuc3BsaXQoJywnKTtcblx0XHRcdFx0XHRcdGF3YWl0IHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0XHR0ZXh0LmlucHV0RWwucm93cyA9IDY7XG5cdFx0XHRcdHRleHQuaW5wdXRFbC5jb2xzID0gMjU7XG5cdFx0XHR9KTtcblxuXHRcdC8qIFxuXHRcdC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXG5cdFx0TWFuYWdpbmcgcHJlZGVmaW5lZCB2YWx1ZXMgZm9yIHByb3BlcnRpZXMgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdC8qIEFkZCBuZXcgcHJvcGVydHkgZm9yIHdoaWNoIHdlIHdhbnQgdG8gcHJlc2V0IHZhbHVlcyovXG5cdFx0Y29uc3QgcHJlc2V0RmllbGRzU2V0dGluZ3MgPSBjb250YWluZXJFbC5jcmVhdGVFbChcImRpdlwiKVxuXHRcdHByZXNldEZpZWxkc1NldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ1ByZXNldCBGaWVsZHMgc2V0dGluZ3MnLCBjbHM6IFwibWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24taGVhZGVyXCIgfSk7XG5cdFx0cHJlc2V0RmllbGRzU2V0dGluZ3MuY3JlYXRlRWwoJ2RpdicsIHtcblx0XHRcdGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24gbWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24tZGVzY1wiLFxuXHRcdFx0dGV4dDogXCJNYW5hZ2UgZ2xvYmFsbHkgcHJlZGVmaW5lZCB0eXBlIGFuZCB2YWx1ZXMgZm9yIGEgZmllbGQgdGhyb3VnaG91dCB5b3VyIHdob2xlIHZhdWx0XCJcblx0XHR9KVxuXHRcdG5ldyBTZXR0aW5nKHByZXNldEZpZWxkc1NldHRpbmdzKVxuXHRcdFx0LnNldE5hbWUoXCJBZGQgTmV3IFByb3BlcnR5IE1hbmFnZXJcIilcblx0XHRcdC5zZXREZXNjKFwiQWRkIGEgbmV3IEZyb250bWF0dGVyIHByb3BlcnR5IGZvciB3aGljaCB5b3Ugd2FudCBwcmVzZXQgdmFsdWVzLlwiKVxuXHRcdFx0LmFkZEJ1dHRvbigoYnV0dG9uOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQgPT4ge1xuXHRcdFx0XHRyZXR1cm4gYnV0dG9uXG5cdFx0XHRcdFx0LnNldFRvb2x0aXAoXCJBZGQgTmV3IFByb3BlcnR5IE1hbmFnZXJcIilcblx0XHRcdFx0XHQuc2V0QnV0dG9uVGV4dChcIitcIilcblx0XHRcdFx0XHQub25DbGljayhhc3luYyAoKSA9PiB7XG5cdFx0XHRcdFx0XHRsZXQgbW9kYWwgPSBuZXcgRmllbGRTZXR0aW5nc01vZGFsKHRoaXMuYXBwLCB0aGlzLnBsdWdpbiwgcHJlc2V0RmllbGRzU2V0dGluZ3MpO1xuXHRcdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdH0pO1xuXHRcdFx0fSk7XG5cblx0XHQvKiBNYW5hZ2VkIHByb3BlcnRpZXMgdGhhdCBjdXJyZW50bHkgaGF2ZSBwcmVzZXQgdmFsdWVzICovXG5cdFx0dGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZm9yRWFjaChwcm9wID0+IHtcblx0XHRcdGNvbnN0IHByb3BlcnR5ID0gbmV3IEZpZWxkKCk7XG5cdFx0XHRPYmplY3QuYXNzaWduKHByb3BlcnR5LCBwcm9wKTtcblx0XHRcdG5ldyBGaWVsZFNldHRpbmcocHJlc2V0RmllbGRzU2V0dGluZ3MsIHByb3BlcnR5LCB0aGlzLmFwcCwgdGhpcy5wbHVnaW4pO1xuXHRcdH0pO1xuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRNYW5hZ2luZyBmaWxlQ2xhc3MgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdC8qIFNldCBjbGFzc0ZpbGVzIFBhdGgqL1xuXHRcdGNvbnN0IGNsYXNzRmlsZXNTZXR0aW5ncyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIpXG5cdFx0Y2xhc3NGaWxlc1NldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ0ZpbGVDbGFzcyBzZXR0aW5ncycsIGNsczogXCJtZXRhZGF0YS1tZW51LXNldHRpbmctc2VjdGlvbi1oZWFkZXJcIiB9KTtcblx0XHRjbGFzc0ZpbGVzU2V0dGluZ3MuY3JlYXRlRWwoJ2RpdicsIHtcblx0XHRcdGNsczogXCJzZXR0aW5nLWl0ZW0tZGVzY3JpcHRpb24gbWV0YWRhdGEtbWVudS1zZXR0aW5nLXNlY3Rpb24tZGVzY1wiLFxuXHRcdFx0dGV4dDogXCJNYW5hZ2UgZmlsZUNsYXNzIGZvbGRlciBhbmQgYWxpYXMuIFwiICtcblx0XHRcdFx0XCJXaGVuIGEgbm90ZSBoYXMgYSBmaWVsQ2xhc3MgZGVmaW5lZCwgZmlsZUNsYXNzIGZpZWxkIHByb3BlcnRpZXMgd2lsbCBvdmVycmlkZSBnbG9iYWwgcHJlc2V0IGZpZWxkcyBzZXR0aW5ncyBmb3IgdGhlIHNhbWUgZmllbGQgbmFtZVwiXG5cdFx0fSlcblx0XHRuZXcgU2V0dGluZyhjbGFzc0ZpbGVzU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZSgnY2xhc3MgRmlsZXMgcGF0aCcpXG5cdFx0XHQuc2V0RGVzYygnUGF0aCB0byB0aGUgZmlsZXMgY29udGFpbmluZyB0aGUgYXV0aG9yaXplZCBmaWVsZHMgZm9yIGEgdHlwZSBvZiBub3RlJylcblx0XHRcdC5hZGRUZXh0KCh0ZXh0KSA9PiB7XG5cdFx0XHRcdHRleHRcblx0XHRcdFx0XHQuc2V0UGxhY2Vob2xkZXIoJ1BhdGgvJylcblx0XHRcdFx0XHQuc2V0VmFsdWUodGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGgpXG5cdFx0XHRcdFx0Lm9uQ2hhbmdlKGFzeW5jICh2YWx1ZSkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5wbHVnaW4uc2V0dGluZ3MuY2xhc3NGaWxlc1BhdGggPSB2YWx1ZVxuXHRcdFx0XHRcdFx0YXdhaXQgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblxuXHRcdC8qIFNldCBmaWxlQ2xhc3MgYWxpYXMqL1xuXHRcdG5ldyBTZXR0aW5nKGNsYXNzRmlsZXNTZXR0aW5ncylcblx0XHRcdC5zZXROYW1lKCdmaWxlQ2xhc3MgZmllbGQgYWxpYXMnKVxuXHRcdFx0LnNldERlc2MoJ0Nob29zZSBhbm90aGVyIG5hbWUgZm9yIGZpbGVDbGFzcyBmaWVsZCBpbiBmcm9udG1hdHRlciAoZXhhbXBsZTogQ2F0ZWdvcnksIHR5cGUsIC4uLicpXG5cdFx0XHQuYWRkVGV4dCgodGV4dCkgPT4ge1xuXHRcdFx0XHR0ZXh0XG5cdFx0XHRcdFx0LnNldFZhbHVlKHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzKVxuXHRcdFx0XHRcdC5vbkNoYW5nZShhc3luYyAodmFsdWUpID0+IHtcblx0XHRcdFx0XHRcdHRoaXMucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzID0gdmFsdWU7XG5cdFx0XHRcdFx0XHRhd2FpdCB0aGlzLnBsdWdpbi5zYXZlU2V0dGluZ3MoKTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdH0pO1xuXG5cdFx0LyogXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHRNaWdyYXRpb24gc2V0dGluZ3MgXG5cdFx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS1cblx0XHQqL1xuXHRcdGNvbnN0IG1pZ3JhdGVTZXR0aW5ncyA9IGNvbnRhaW5lckVsLmNyZWF0ZUVsKFwiZGl2XCIpXG5cdFx0bWlncmF0ZVNldHRpbmdzLmNyZWF0ZUVsKCdoNCcsIHsgdGV4dDogJ01pZ3JhdGUnIH0pO1xuXG5cdFx0LyogQWRkIG5ldyBwcm9wZXJ0eSBmb3Igd2hpY2ggd2Ugd2FudCB0byBwcmVzZXQgdmFsdWVzKi9cblx0XHRuZXcgU2V0dGluZyhtaWdyYXRlU2V0dGluZ3MpXG5cdFx0XHQuc2V0TmFtZShcIkNvcHkgc2V0dGluZ3MgZnJvbSBzdXBlcmNoYXJnZWQgbGlua3MgcGx1Z2luXCIpXG5cdFx0XHQuc2V0RGVzYyhcIkNvcHkgc2V0dGluZ3MgZnJvbSBzdXBlcmNoYXJnZWQgbGlua3MgcGx1Z2luXCIpXG5cdFx0XHQuYWRkQnV0dG9uKChidXR0b246IEJ1dHRvbkNvbXBvbmVudCk6IEJ1dHRvbkNvbXBvbmVudCA9PiB7XG5cdFx0XHRcdHJldHVybiBidXR0b25cblx0XHRcdFx0XHQuc2V0VG9vbHRpcChcIkdldCBzZXR0aW5ncyBmcm9tIHN1cGVyY2hhcmdlZCBsaW5rc1wiKVxuXHRcdFx0XHRcdC5zZXRCdXR0b25UZXh0KFwiQ29weVwiKVxuXHRcdFx0XHRcdC5vbkNsaWNrKGFzeW5jICgpID0+IHtcblx0XHRcdFx0XHRcdGxldCBtb2RhbCA9IG5ldyBTZXR0aW5nc01pZ3JhdGlvbkNvbmZpcm1Nb2RhbCh0aGlzLnBsdWdpbiwgdGhpcyk7XG5cdFx0XHRcdFx0XHRtb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9KTtcblx0fTtcbn07XG4iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgU2V0dGluZywgVGV4dENvbXBvbmVudCwgTm90aWNlLCBCdXR0b25Db21wb25lbnQsIEV4dHJhQnV0dG9uQ29tcG9uZW50LCBUb2dnbGVDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL0ZpZWxkXCI7XG5pbXBvcnQgRmllbGRTZXR0aW5nIGZyb20gXCJzcmMvc2V0dGluZ3MvRmllbGRTZXR0aW5nXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpZWxkU2V0dGluZ3NNb2RhbCBleHRlbmRzIE1vZGFsIHtcbiAgICBwcml2YXRlIG5hbWVQcm9tcHRDb21wb25lbnQ6IFRleHRDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSB2YWx1ZXNQcm9tcHRDb21wb25lbnRzOiBBcnJheTxUZXh0Q29tcG9uZW50PiA9IFtdO1xuICAgIHByaXZhdGUgaXNCb29sZWFuVG9nZ2xlckNvbXBvbmVudDogVG9nZ2xlQ29tcG9uZW50O1xuICAgIHByaXZhdGUgaXNNdWx0aVRvZ2dsZXJDb21wb25lbnQ6IFRvZ2dsZUNvbXBvbmVudDtcbiAgICBwcml2YXRlIGlzQ3ljbGVUb2dnbGVyQ29tcG9uZW50OiBUb2dnbGVDb21wb25lbnQ7XG4gICAgcHJpdmF0ZSBzYXZlZDogYm9vbGVhbiA9IGZhbHNlO1xuICAgIHByaXZhdGUgcHJvcGVydHk6IEZpZWxkO1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBpbml0aWFsUHJvcGVydHk6IEZpZWxkO1xuICAgIHByaXZhdGUgcGFyZW50U2V0dGluZz86IFNldHRpbmc7XG4gICAgcHJpdmF0ZSBuZXc6IGJvb2xlYW4gPSB0cnVlO1xuICAgIHByaXZhdGUgcGFyZW50U2V0dGluZ0NvbnRhaW5lcjogSFRNTEVsZW1lbnQ7XG5cblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSwgcGFyZW50U2V0dGluZ0NvbnRhaW5lcjogSFRNTEVsZW1lbnQsIHBhcmVudFNldHRpbmc/OiBTZXR0aW5nLCBwcm9wZXJ0eT86IEZpZWxkKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnBhcmVudFNldHRpbmcgPSBwYXJlbnRTZXR0aW5nO1xuICAgICAgICB0aGlzLmluaXRpYWxQcm9wZXJ0eSA9IG5ldyBGaWVsZCgpO1xuICAgICAgICB0aGlzLnBhcmVudFNldHRpbmdDb250YWluZXIgPSBwYXJlbnRTZXR0aW5nQ29udGFpbmVyO1xuICAgICAgICBpZiAocHJvcGVydHkpIHtcbiAgICAgICAgICAgIHRoaXMubmV3ID0gZmFsc2U7XG4gICAgICAgICAgICB0aGlzLnByb3BlcnR5ID0gcHJvcGVydHk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxQcm9wZXJ0eS5uYW1lID0gcHJvcGVydHkubmFtZTtcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhbFByb3BlcnR5LmlkID0gcHJvcGVydHkuaWQ7XG4gICAgICAgICAgICBPYmplY3Qua2V5cyhwcm9wZXJ0eS52YWx1ZXMpLmZvckVhY2goayA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5pbml0aWFsUHJvcGVydHkudmFsdWVzW2tdID0gcHJvcGVydHkudmFsdWVzW2tdO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsZXQgbmV3SWQgPSAxO1xuICAgICAgICAgICAgdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZm9yRWFjaChwcm9wID0+IHtcbiAgICAgICAgICAgICAgICBpZiAocGFyc2VJbnQocHJvcC5pZCkgJiYgcGFyc2VJbnQocHJvcC5pZCkgPj0gbmV3SWQpIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3SWQgPSBwYXJzZUludChwcm9wLmlkKSArIDE7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eSA9IG5ldyBGaWVsZCgpO1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgICAgICB0aGlzLmluaXRpYWxQcm9wZXJ0eS5pZCA9IG5ld0lkLnRvU3RyaW5nKCk7XG4gICAgICAgIH07XG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgaWYgKHRoaXMucHJvcGVydHkubmFtZSA9PSBcIlwiKSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgQWRkIGEgcHJvcGVydHkgYW5kIHNldCBwcmVkZWZpbmVkYCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlIHNldHRpbmdzIHZhbHVlcyBmb3IgJHt0aGlzLnByb3BlcnR5Lm5hbWV9YCk7XG4gICAgICAgIH07XG4gICAgICAgIGF3YWl0IHRoaXMuY3JlYXRlRm9ybSgpO1xuICAgIH07XG5cbiAgICBvbkNsb3NlKCk6IHZvaWQge1xuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMucHJvcGVydHksIHRoaXMuaW5pdGlhbFByb3BlcnR5KTtcbiAgICAgICAgaWYgKCF0aGlzLm5ldyAmJiB0aGlzLnBhcmVudFNldHRpbmcpIHtcbiAgICAgICAgICAgIHRoaXMucGFyZW50U2V0dGluZy5pbmZvRWwudGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgICAgIGAke3RoaXMucHJvcGVydHkubmFtZX06IFske09iamVjdC5rZXlzKHRoaXMucHJvcGVydHkudmFsdWVzKS5tYXAoayA9PiB0aGlzLnByb3BlcnR5LnZhbHVlc1trXSkuam9pbignLCAnKX1dYDtcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLnNhdmVkKSB7XG4gICAgICAgICAgICBuZXcgRmllbGRTZXR0aW5nKHRoaXMucGFyZW50U2V0dGluZ0NvbnRhaW5lciwgdGhpcy5wcm9wZXJ0eSwgdGhpcy5hcHAsIHRoaXMucGx1Z2luKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBzZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgaGVhZGVyLnNldFRleHQoYFByZXNldCB2YWx1ZXM6ICR7T2JqZWN0LnZhbHVlcyh0aGlzLnByb3BlcnR5LnZhbHVlcykuam9pbignLCAnKX1gKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBjcmVhdGVuYW1lSW5wdXRDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQpOiBUZXh0Q29tcG9uZW50IHtcbiAgICAgICAgY29uc3QgcHJvcGVydHlOYW1lQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdigpO1xuICAgICAgICBwcm9wZXJ0eU5hbWVDb250YWluZXJMYWJlbC5zZXRUZXh0KGBQcm9wZXJ0eSBOYW1lOmApO1xuICAgICAgICBjb25zdCBpbnB1dCA9IG5ldyBUZXh0Q29tcG9uZW50KHBhcmVudE5vZGUpO1xuICAgICAgICBjb25zdCBuYW1lID0gdGhpcy5wcm9wZXJ0eS5uYW1lO1xuICAgICAgICBpbnB1dC5zZXRWYWx1ZShuYW1lKTtcbiAgICAgICAgaW5wdXQuc2V0UGxhY2Vob2xkZXIoXCJOYW1lIG9mIHRoZSBwcm9wZXJ0eVwiKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5uYW1lID0gdmFsdWU7XG4gICAgICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgTWFuYWdlIHByZWRlZmluZWQgdmFsdWVzIGZvciAke3RoaXMucHJvcGVydHkubmFtZX1gKTtcbiAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5yZW1vdmVWYWxpZGF0aW9uRXJyb3IoaW5wdXQpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGlucHV0O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZVRvZ2dsZXJDb250YWluZXIocGFyZW50Tm9kZTogSFRNTERpdkVsZW1lbnQsIGxhYmVsOiBzdHJpbmcpOiBUb2dnbGVDb21wb25lbnQge1xuICAgICAgICBwYXJlbnROb2RlLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS10b2dnbGVcIilcbiAgICAgICAgY29uc3QgcHJvcGVydHlDb250YWluZXJMYWJlbCA9IHBhcmVudE5vZGUuY3JlYXRlRGl2KHsgY2xzOiAnZnJvbnRtYXR0ZXItY2hlY2tib3gtdG9nZ2xlcicgfSk7XG5cbiAgICAgICAgcHJvcGVydHlDb250YWluZXJMYWJlbC5zZXRUZXh0KGxhYmVsKTtcbiAgICAgICAgY29uc3QgdG9nZ2xlciA9IG5ldyBUb2dnbGVDb21wb25lbnQocGFyZW50Tm9kZSk7XG4gICAgICAgIHJldHVybiB0b2dnbGVyO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUxpc3ROb3RlQ29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50KTogVGV4dENvbXBvbmVudCB7XG4gICAgICAgIGNvbnN0IGxpc3ROb3RlQ29udGFpbmVyTGFiZWwgPSBwYXJlbnROb2RlLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LWlucHV0XCIgfSk7XG4gICAgICAgIGxpc3ROb3RlQ29udGFpbmVyTGFiZWwuc2V0VGV4dChgUGF0aCBvZiB0aGUgbm90ZSBjb250YWluaW5nIHRoZSB2YWx1ZXM6YCk7XG5cbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChsaXN0Tm90ZUNvbnRhaW5lckxhYmVsKTtcbiAgICAgICAgY29uc3QgbGlzdE5vdGVQYXRoID0gdGhpcy5wcm9wZXJ0eS52YWx1ZXNMaXN0Tm90ZVBhdGg7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKGxpc3ROb3RlUGF0aCk7XG4gICAgICAgIGlucHV0LnNldFBsYWNlaG9sZGVyKFwiUGF0aC9vZi90aGUvbm90ZS5tZFwiKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4gdGhpcy5wcm9wZXJ0eS52YWx1ZXNMaXN0Tm90ZVBhdGggPSB2YWx1ZSk7XG4gICAgICAgIHJldHVybiBpbnB1dDtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSByZW1vdmVQcmVzZXRWYWx1ZShrZXk6IHN0cmluZyk6IHZvaWQge1xuICAgICAgICBsZXQgbmV3VmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG4gICAgICAgIGZvciAobGV0IF9rZXkgaW4gdGhpcy5wcm9wZXJ0eS52YWx1ZXMpIHtcbiAgICAgICAgICAgIGlmIChrZXkgIT09IF9rZXkpIHtcbiAgICAgICAgICAgICAgICBuZXdWYWx1ZXNbX2tleV0gPSB0aGlzLnByb3BlcnR5LnZhbHVlc1tfa2V5XTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH07XG4gICAgICAgIHRoaXMucHJvcGVydHkudmFsdWVzID0gbmV3VmFsdWVzO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZVZhbHVlQ29udGFpbmVyKHBhcmVudE5vZGU6IEhUTUxEaXZFbGVtZW50LCBoZWFkZXI6IEhUTUxEaXZFbGVtZW50LCBrZXk6IHN0cmluZyk6IFRleHRDb21wb25lbnQge1xuICAgICAgICBjb25zdCB2YWx1ZXMgPSB0aGlzLnByb3BlcnR5LnZhbHVlcztcbiAgICAgICAgY29uc3QgcHJlc2V0VmFsdWUgPSB2YWx1ZXNba2V5XTtcbiAgICAgICAgY29uc3QgdmFsdWVDb250YWluZXIgPSBwYXJlbnROb2RlLmNyZWF0ZURpdih7XG4gICAgICAgICAgICBjbHM6ICdtZXRhZGF0YS1tZW51LXByb21wdC1jb250YWluZXInLFxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgaW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIGlucHV0LnNldFZhbHVlKHByZXNldFZhbHVlKTtcbiAgICAgICAgaW5wdXQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS52YWx1ZXNba2V5XSA9IHZhbHVlO1xuICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcik7XG4gICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwucmVtb3ZlVmFsaWRhdGlvbkVycm9yKGlucHV0KTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlUmVtb3ZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgIHZhbHVlUmVtb3ZlQnV0dG9uLnNldEljb24oXCJ0cmFzaFwiKVxuICAgICAgICAgICAgLm9uQ2xpY2soKGV2dDogTW91c2VFdmVudCkgPT4ge1xuICAgICAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdDtcbiAgICAgICAgICAgICAgICB0aGlzLnJlbW92ZVByZXNldFZhbHVlKGtleSk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZXRWYWx1ZUxpc3RUZXh0KGhlYWRlcik7XG4gICAgICAgICAgICAgICAgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLnJlbW92ZShpbnB1dCk7XG5cbiAgICAgICAgICAgIH0pO1xuICAgICAgICBpZiAoa2V5ICE9IE9iamVjdC5rZXlzKHRoaXMucHJvcGVydHkudmFsdWVzKVswXSkge1xuICAgICAgICAgICAgY29uc3QgdmFsdWVVcGdyYWRlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudCh2YWx1ZUNvbnRhaW5lcik7XG4gICAgICAgICAgICB2YWx1ZVVwZ3JhZGVCdXR0b24uc2V0QnV0dG9uVGV4dChcIlx1MjVCMlwiKTtcbiAgICAgICAgICAgIHZhbHVlVXBncmFkZUJ1dHRvbi5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCB0aGlzVmFsdWUgPSB2YWx1ZXNba2V5XTtcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEluZGV4ID0gdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmluZGV4T2YoaW5wdXQpXG4gICAgICAgICAgICAgICAgY29uc3QgdXBwZXJDb21wb25lbnQgPSBpbnB1dEluZGV4ICE9PSAtMSA/IHRoaXMudmFsdWVzUHJvbXB0Q29tcG9uZW50c1tpbnB1dEluZGV4IC0gMV0gOiB0aGlzLnZhbHVlc1Byb21wdENvbXBvbmVudHMubGFzdCgpO1xuICAgICAgICAgICAgICAgIGlmICh1cHBlckNvbXBvbmVudCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB1cHBlclZhbHVlID0gdXBwZXJDb21wb25lbnQuaW5wdXRFbC52YWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgdXBwZXJLZXkgPSBPYmplY3Qua2V5cyh2YWx1ZXMpLmZpbHRlcihrID0+IHZhbHVlc1trXSA9PSB1cHBlclZhbHVlKVswXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHVwcGVyS2V5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB1cHBlckNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW3VwcGVyS2V5XSA9IHRoaXNWYWx1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LnNldFZhbHVlKHVwcGVyVmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFsdWVzW2tleV0gPSB1cHBlclZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfTtcblxuICAgICAgICByZXR1cm4gaW5wdXQ7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYXN5bmMgY3JlYXRlRm9ybSgpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgY29uc3QgZGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LXByb21wdC1kaXZcIlxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgbWFpbkRpdiA9IGRpdi5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtcHJvbXB0LWZvcm1cIlxuICAgICAgICB9KTtcbiAgICAgICAgLyogUHJvcGVydHkgTmFtZSBTZWN0aW9uICovXG4gICAgICAgIGNvbnN0IG5hbWVDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQgPSB0aGlzLmNyZWF0ZW5hbWVJbnB1dENvbnRhaW5lcihuYW1lQ29udGFpbmVyKTtcblxuICAgICAgICBtYWluRGl2LmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtc2VwYXJhdG9yJyB9KS5jcmVhdGVFbChcImhyXCIpO1xuXG4gICAgICAgIC8qIFByb3BlcnR5IGlzIEJvb2xlYW4gc2VjdGlvbiAqL1xuICAgICAgICBjb25zdCBib29sZWFuQ29udGFpbmVyID0gbWFpbkRpdi5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS10b2dnbGVcIiB9KTtcbiAgICAgICAgdGhpcy5pc0Jvb2xlYW5Ub2dnbGVyQ29tcG9uZW50ID0gdGhpcy5jcmVhdGVUb2dnbGVyQ29udGFpbmVyKGJvb2xlYW5Db250YWluZXIsIFwiSXMgQm9vbGVhbjogXCIpO1xuICAgICAgICB0aGlzLmlzQm9vbGVhblRvZ2dsZXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy5wcm9wZXJ0eS5pc0Jvb2xlYW4pO1xuICAgICAgICB0aGlzLmlzQm9vbGVhblRvZ2dsZXJDb21wb25lbnQuc2V0VG9vbHRpcChcIklzIHRoaXMgcHJvcGVydHkgdHJ1ZSBvciBmYWxzZSBvbmx5P1wiKVxuICAgICAgICB0aGlzLmlzQm9vbGVhblRvZ2dsZXJDb21wb25lbnQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5pc0Jvb2xlYW4gPSB2YWx1ZTtcbiAgICAgICAgICAgIGlmICgodGhpcy5wcm9wZXJ0eS5pc011bHRpIHx8IHRoaXMucHJvcGVydHkuaXNDeWNsZSkgJiYgdGhpcy5wcm9wZXJ0eS5pc0Jvb2xlYW4pIHtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5LmlzTXVsdGkgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzTXVsdGlUb2dnbGVyQ29tcG9uZW50LnNldFZhbHVlKGZhbHNlKTtcbiAgICAgICAgICAgICAgICB0aGlzLnByb3BlcnR5LmlzQ3ljbGUgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB0aGlzLmlzQ3ljbGVUb2dnbGVyQ29tcG9uZW50LnNldFZhbHVlKGZhbHNlKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICAvKiBQcm9wZXJ0eSBpcyBNdWx0aSBzZWN0aW9uKi9cblxuICAgICAgICBjb25zdCBtdWx0aUNvbnRhaW5lciA9IG1haW5EaXYuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdG9nZ2xlXCIgfSk7XG4gICAgICAgIHRoaXMuaXNNdWx0aVRvZ2dsZXJDb21wb25lbnQgPSB0aGlzLmNyZWF0ZVRvZ2dsZXJDb250YWluZXIobXVsdGlDb250YWluZXIsIFwiSXMgTXVsdGk6IFwiKTtcbiAgICAgICAgdGhpcy5pc011bHRpVG9nZ2xlckNvbXBvbmVudC5zZXRWYWx1ZSh0aGlzLnByb3BlcnR5LmlzTXVsdGkpO1xuICAgICAgICB0aGlzLmlzTXVsdGlUb2dnbGVyQ29tcG9uZW50LnNldFRvb2x0aXAoXCJDYW4gdGhpcyBwcm9wZXJ0eSBoYXZlIG11bHRpcGxlIHZhbHVlcz9cIik7XG4gICAgICAgIHRoaXMuaXNNdWx0aVRvZ2dsZXJDb21wb25lbnQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5pc011bHRpID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eS5pc0N5Y2xlICYmIHRoaXMucHJvcGVydHkuaXNNdWx0aSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHkuaXNDeWNsZSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNDeWNsZVRvZ2dsZXJDb21wb25lbnQuc2V0VmFsdWUoZmFsc2UpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgLyogUHJvcGVydHkgaXMgQ3ljbGUgc2VjdGlvbiovXG5cbiAgICAgICAgY29uc3QgY3ljbGVDb250YWluZXIgPSBtYWluRGl2LmNyZWF0ZURpdigpO1xuICAgICAgICB0aGlzLmlzQ3ljbGVUb2dnbGVyQ29tcG9uZW50ID0gdGhpcy5jcmVhdGVUb2dnbGVyQ29udGFpbmVyKGN5Y2xlQ29udGFpbmVyLCBcIklzIEN5Y2xlOiBcIik7XG4gICAgICAgIHRoaXMuaXNDeWNsZVRvZ2dsZXJDb21wb25lbnQuc2V0VmFsdWUodGhpcy5wcm9wZXJ0eS5pc0N5Y2xlKTtcbiAgICAgICAgdGhpcy5pc0N5Y2xlVG9nZ2xlckNvbXBvbmVudC5zZXRUb29sdGlwKFwiSXMgdGhpcyBwcm9wZXJ0eSdzIHZhbHVlcyBzZXQgaW4gY3ljbGUgbW9kZT9cIik7XG4gICAgICAgIHRoaXMuaXNDeWNsZVRvZ2dsZXJDb21wb25lbnQub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgdGhpcy5wcm9wZXJ0eS5pc0N5Y2xlID0gdmFsdWU7XG4gICAgICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eS5pc0N5Y2xlICYmIHRoaXMucHJvcGVydHkuaXNNdWx0aSkge1xuICAgICAgICAgICAgICAgIHRoaXMucHJvcGVydHkuaXNNdWx0aSA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHRoaXMuaXNNdWx0aVRvZ2dsZXJDb21wb25lbnQuc2V0VmFsdWUoZmFsc2UpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbWFpbkRpdi5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICAvKiBQcm9wZXJ0eSdzIG5vdGUgZm9yIGxpc3Qgb2YgVmFsdWVzICovXG5cbiAgICAgICAgY29uc3QgbGlzdE5vdGVQYXRoQ29udGFpbmVyID0gbWFpbkRpdi5jcmVhdGVEaXYoKTtcbiAgICAgICAgdGhpcy5jcmVhdGVMaXN0Tm90ZUNvbnRhaW5lcihsaXN0Tm90ZVBhdGhDb250YWluZXIpO1xuXG4gICAgICAgIG1haW5EaXYuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS1zZXBhcmF0b3InIH0pLmNyZWF0ZUVsKFwiaHJcIik7XG5cbiAgICAgICAgLyogUHJvcGVydHkgVmFsdWVzICovXG4gICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSBtYWluRGl2LmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCB2YWx1ZXNMaXN0SGVhZGVyID0gdmFsdWVzTGlzdC5jcmVhdGVEaXYoKTtcbiAgICAgICAgdmFsdWVzTGlzdEhlYWRlci5jcmVhdGVFbChcImgyXCIpO1xuICAgICAgICB2YWx1ZXNMaXN0SGVhZGVyLnNldFRleHQoYFByZXNldCB2YWx1ZXM6ICR7T2JqZWN0LnZhbHVlcyh0aGlzLnByb3BlcnR5LnZhbHVlcykuam9pbignLCAnKX1gKTtcbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdEJvZHkgPSB2YWx1ZXNMaXN0LmNyZWF0ZURpdigpO1xuICAgICAgICBPYmplY3Qua2V5cyh0aGlzLnByb3BlcnR5LnZhbHVlcykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLnB1c2godGhpcy5jcmVhdGVWYWx1ZUNvbnRhaW5lcih2YWx1ZXNMaXN0Qm9keSwgdmFsdWVzTGlzdEhlYWRlciwga2V5KSk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIC8qIEFkZCBhIG5ldyBWYWx1ZXMgKi9cbiAgICAgICAgY29uc3QgdmFsdWVzTGlzdEZvb3RlciA9IHZhbHVlc0xpc3QuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGFkZFZhbHVlID0gdmFsdWVzTGlzdEZvb3Rlci5jcmVhdGVFbCgnYnV0dG9uJyk7XG4gICAgICAgIGFkZFZhbHVlLnR5cGUgPSAnYnV0dG9uJztcbiAgICAgICAgYWRkVmFsdWUudGV4dENvbnRlbnQgPSAnQWRkJztcbiAgICAgICAgYWRkVmFsdWUub25DbGlja0V2ZW50KGFzeW5jIChldnQ6IE1vdXNlRXZlbnQpID0+IHtcbiAgICAgICAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdDtcbiAgICAgICAgICAgIGNvbnN0IG5ld0tleSA9IGF3YWl0IHRoaXMucHJvcGVydHkuaW5zZXJ0TmV3VmFsdWUoXCJcIilcbiAgICAgICAgICAgIHRoaXMuY3JlYXRlVmFsdWVDb250YWluZXIodmFsdWVzTGlzdEJvZHksIHZhbHVlc0xpc3RIZWFkZXIsIG5ld0tleSlcbiAgICAgICAgfSk7XG5cbiAgICAgICAgbWFpbkRpdi5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXNlcGFyYXRvcicgfSkuY3JlYXRlRWwoXCJoclwiKTtcblxuICAgICAgICAvKiBmb290ZXIgYnV0dG9ucyovXG4gICAgICAgIGNvbnN0IGZvb3RlckVsID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IGZvb3RlckJ1dHRvbnMgPSBuZXcgU2V0dGluZyhmb290ZXJFbCk7XG4gICAgICAgIGZvb3RlckJ1dHRvbnMuYWRkQnV0dG9uKChiKSA9PiB0aGlzLmNyZWF0ZVNhdmVCdXR0b24oYikpO1xuICAgICAgICBmb290ZXJCdXR0b25zLmFkZEV4dHJhQnV0dG9uKChiKSA9PiB0aGlzLmNyZWF0ZUNhbmNlbEJ1dHRvbihiKSk7XG4gICAgfTtcblxuICAgIHByaXZhdGUgY3JlYXRlU2F2ZUJ1dHRvbihiOiBCdXR0b25Db21wb25lbnQpOiBCdXR0b25Db21wb25lbnQge1xuICAgICAgICBiLnNldFRvb2x0aXAoXCJTYXZlXCIpXG4gICAgICAgICAgICAuc2V0SWNvbihcImNoZWNrbWFya1wiKVxuICAgICAgICAgICAgLm9uQ2xpY2soYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgICAgIGxldCBlcnJvciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIGlmICgvXlsjPi1dLy50ZXN0KHRoaXMucHJvcGVydHkubmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgRmllbGRTZXR0aW5nc01vZGFsLnNldFZhbGlkYXRpb25FcnJvcihcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMubmFtZVByb21wdENvbXBvbmVudCwgdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50LmlucHV0RWwsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIlByb3BlcnR5IG5hbWUgY2Fubm90IHN0YXJ0IHdpdGggIywgPiwgLVwiXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGVycm9yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnByb3BlcnR5Lm5hbWUgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5uYW1lUHJvbXB0Q29tcG9uZW50LCB0aGlzLm5hbWVQcm9tcHRDb21wb25lbnQuaW5wdXRFbCxcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiUHJvcGVydHkgbmFtZSBjYW4gbm90IGJlIEVtcHR5XCJcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXNQcm9tcHRDb21wb25lbnRzLmZvckVhY2goaW5wdXQgPT4ge1xuICAgICAgICAgICAgICAgICAgICBpZiAoL15bIz4tXS8udGVzdChpbnB1dC5pbnB1dEVsLnZhbHVlKSAmJiBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIEZpZWxkU2V0dGluZ3NNb2RhbC5zZXRWYWxpZGF0aW9uRXJyb3IoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaW5wdXQsIGlucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5sYXN0RWxlbWVudENoaWxkLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiVmFsdWVzIGNhbm5vdCBjYW5ub3Qgc3RhcnQgd2l0aCAjLCA+LCAtXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmICgvWyxdL2d1LnRlc3QoaW5wdXQuaW5wdXRFbC52YWx1ZSkgJiYgaW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LCBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQubGFzdEVsZW1lbnRDaGlsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlZhbHVlcyBjYW5ub3QgY29udGFpbiBhIGNvbW1hXCJcbiAgICAgICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIGlmIChpbnB1dC5pbnB1dEVsLnZhbHVlID09IFwiXCIgJiYgaW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBGaWVsZFNldHRpbmdzTW9kYWwuc2V0VmFsaWRhdGlvbkVycm9yKFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlucHV0LCBpbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQubGFzdEVsZW1lbnRDaGlsZCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcIlZhbHVlcyBjYW4ndCBiZSBudWxsLlwiXG4gICAgICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIGlmIChlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiRml4IGVycm9ycyBiZWZvcmUgc2F2aW5nLlwiKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29uc3QgY3VycmVudEV4aXN0aW5nUHJvcGVydHkgPSB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5maWx0ZXIocCA9PiBwLmlkID09IHRoaXMucHJvcGVydHkuaWQpWzBdO1xuICAgICAgICAgICAgICAgIGlmIChjdXJyZW50RXhpc3RpbmdQcm9wZXJ0eSkge1xuICAgICAgICAgICAgICAgICAgICBGaWVsZC5jb3B5UHJvcGVydHkoY3VycmVudEV4aXN0aW5nUHJvcGVydHksIHRoaXMucHJvcGVydHkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLmluaXRpYWxQcm9wZXJ0aWVzLnB1c2godGhpcy5wcm9wZXJ0eSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmluaXRpYWxQcm9wZXJ0eSA9IHRoaXMucHJvcGVydHk7XG4gICAgICAgICAgICAgICAgdGhpcy5wbHVnaW4uc2F2ZVNldHRpbmdzKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiBiO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGNyZWF0ZUNhbmNlbEJ1dHRvbihiOiBFeHRyYUJ1dHRvbkNvbXBvbmVudCk6IEV4dHJhQnV0dG9uQ29tcG9uZW50IHtcbiAgICAgICAgYi5zZXRJY29uKFwiY3Jvc3NcIilcbiAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiQ2FuY2VsXCIpXG4gICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgdGhpcy5zYXZlZCA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIC8qIHJlc2V0IHZhbHVlcyBmcm9tIHNldHRpbmdzICovXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuaW5pdGlhbFByb3BlcnR5Lm5hbWUgIT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMucHJvcGVydHksIHRoaXMuaW5pdGlhbFByb3BlcnR5KTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gYjtcbiAgICB9O1xuXG4gICAgLyogdXRpbHMgZnVuY3Rpb25zICovXG5cbiAgICBwcml2YXRlIHN0YXRpYyBzZXRWYWxpZGF0aW9uRXJyb3IodGV4dElucHV0OiBUZXh0Q29tcG9uZW50LCBpbnNlcnRBZnRlcjogRWxlbWVudCwgbWVzc2FnZT86IHN0cmluZykge1xuICAgICAgICB0ZXh0SW5wdXQuaW5wdXRFbC5hZGRDbGFzcyhcImlzLWludmFsaWRcIik7XG4gICAgICAgIGlmIChtZXNzYWdlICYmIHRleHRJbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQ/Lmxhc3RFbGVtZW50Q2hpbGQpIHtcblxuICAgICAgICAgICAgbGV0IG1EaXYgPSB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICAgICAgICAgICAgXCIuaW52YWxpZC1mZWVkYmFja1wiXG4gICAgICAgICAgICApIGFzIEhUTUxEaXZFbGVtZW50O1xuXG4gICAgICAgICAgICBpZiAoIW1EaXYpIHtcbiAgICAgICAgICAgICAgICBtRGl2ID0gY3JlYXRlRGl2KHsgY2xzOiBcImludmFsaWQtZmVlZGJhY2tcIiB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIG1EaXYuaW5uZXJUZXh0ID0gbWVzc2FnZTtcbiAgICAgICAgICAgIG1EaXYuaW5zZXJ0QWZ0ZXIoaW5zZXJ0QWZ0ZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHByaXZhdGUgc3RhdGljIHJlbW92ZVZhbGlkYXRpb25FcnJvcih0ZXh0SW5wdXQ6IFRleHRDb21wb25lbnQpIHtcbiAgICAgICAgaWYgKHRleHRJbnB1dC5pbnB1dEVsLmhhc0NsYXNzKFwiaXMtaW52YWxpZFwiKSAmJiB0ZXh0SW5wdXQuaW5wdXRFbC5wYXJlbnRFbGVtZW50Py5sYXN0RWxlbWVudENoaWxkKSB7XG4gICAgICAgICAgICB0ZXh0SW5wdXQuaW5wdXRFbC5yZW1vdmVDbGFzcyhcImlzLWludmFsaWRcIilcbiAgICAgICAgICAgIHRleHRJbnB1dC5pbnB1dEVsLnBhcmVudEVsZW1lbnQucmVtb3ZlQ2hpbGQoXG4gICAgICAgICAgICAgICAgdGV4dElucHV0LmlucHV0RWwucGFyZW50RWxlbWVudC5sYXN0RWxlbWVudENoaWxkXG4gICAgICAgICAgICApO1xuICAgICAgICB9O1xuICAgIH07XG59OyIsICJpbnRlcmZhY2UgRmllbGQge1xuICAgIGlkOiBzdHJpbmc7XG4gICAgbmFtZTogc3RyaW5nO1xuICAgIHZhbHVlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPjtcbiAgICBpc0N5Y2xlOiBib29sZWFuO1xuICAgIGlzTXVsdGk6IGJvb2xlYW47XG4gICAgaXNCb29sZWFuOiBib29sZWFuO1xuICAgIHZhbHVlc0xpc3ROb3RlUGF0aDogc3RyaW5nO1xufVxuXG5jbGFzcyBGaWVsZCB7XG5cbiAgICBjb25zdHJ1Y3RvcihuYW1lOiBzdHJpbmcgPSBcIlwiLFxuICAgICAgICB2YWx1ZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7fSxcbiAgICAgICAgaWQ6IHN0cmluZyA9IFwiXCIsXG4gICAgICAgIGlzTXVsdGk6IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgaXNDeWNsZTogYm9vbGVhbiA9IGZhbHNlLFxuICAgICAgICBpc0Jvb2xlYW46IGJvb2xlYW4gPSBmYWxzZSxcbiAgICAgICAgdmFsdWVzTGlzdE5vdGVQYXRoOiBzdHJpbmcgPSBcIlwiKSB7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMudmFsdWVzID0gdmFsdWVzO1xuICAgICAgICB0aGlzLmlkID0gaWQ7XG4gICAgICAgIHRoaXMuaXNCb29sZWFuID0gaXNCb29sZWFuXG4gICAgICAgIHRoaXMuaXNDeWNsZSA9IGlzQ3ljbGU7XG4gICAgICAgIHRoaXMuaXNNdWx0aSA9IGlzTXVsdGk7XG4gICAgICAgIHRoaXMudmFsdWVzTGlzdE5vdGVQYXRoID0gdmFsdWVzTGlzdE5vdGVQYXRoO1xuICAgICAgICB0aGlzLmluc2VydE5ld1ZhbHVlLmJpbmQodGhpcyk7XG4gICAgfTtcblxuICAgIHB1YmxpYyBhc3luYyBpbnNlcnROZXdWYWx1ZSh2YWx1ZTogc3RyaW5nKTogUHJvbWlzZTxzdHJpbmc+IHtcbiAgICAgICAgbGV0IG5ld0tleSA9IDE7XG4gICAgICAgIE9iamVjdC5rZXlzKHRoaXMudmFsdWVzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICBpZiAocGFyc2VJbnQoa2V5KSAmJiBwYXJzZUludChrZXkpID49IG5ld0tleSkge1xuICAgICAgICAgICAgICAgIG5ld0tleSA9IHBhcnNlSW50KGtleSkgKyAxO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMudmFsdWVzW25ld0tleS50b1N0cmluZygpXSA9IHZhbHVlO1xuICAgICAgICByZXR1cm4gbmV3S2V5LnRvU3RyaW5nKCk7XG4gICAgfTtcblxuICAgIHN0YXRpYyBjb3B5UHJvcGVydHkodGFyZ2V0OiBGaWVsZCwgc291cmNlOiBGaWVsZCkge1xuICAgICAgICB0YXJnZXQuaWQgPSBzb3VyY2UuaWQ7XG4gICAgICAgIHRhcmdldC5uYW1lID0gc291cmNlLm5hbWU7XG4gICAgICAgIHRhcmdldC5pc0Jvb2xlYW4gPSBzb3VyY2UuaXNCb29sZWFuXG4gICAgICAgIHRhcmdldC5pc0N5Y2xlID0gc291cmNlLmlzQ3ljbGU7XG4gICAgICAgIHRhcmdldC5pc011bHRpID0gc291cmNlLmlzTXVsdGk7XG4gICAgICAgIHRhcmdldC52YWx1ZXNMaXN0Tm90ZVBhdGggPSBzb3VyY2UudmFsdWVzTGlzdE5vdGVQYXRoO1xuICAgICAgICBPYmplY3Qua2V5cyhzb3VyY2UudmFsdWVzKS5mb3JFYWNoKGsgPT4ge1xuICAgICAgICAgICAgdGFyZ2V0LnZhbHVlc1trXSA9IHNvdXJjZS52YWx1ZXNba107XG4gICAgICAgIH0pO1xuICAgICAgICBPYmplY3Qua2V5cyh0YXJnZXQudmFsdWVzKS5mb3JFYWNoKGsgPT4ge1xuICAgICAgICAgICAgaWYgKCFPYmplY3Qua2V5cyhzb3VyY2UudmFsdWVzKS5pbmNsdWRlcyhrKSkge1xuICAgICAgICAgICAgICAgIGRlbGV0ZSB0YXJnZXQudmFsdWVzW2tdO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IEZpZWxkOyIsICJpbXBvcnQgeyBBcHAsIFNldHRpbmcsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9GaWVsZFwiO1xuaW1wb3J0IEZpZWxkU2V0dGluZ3NNb2RhbCBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ3NNb2RhbFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBGaWVsZFNldHRpbmcgZXh0ZW5kcyBTZXR0aW5nIHtcbiAgICBwcml2YXRlIHByb3BlcnR5OiBGaWVsZDtcbiAgICBwcml2YXRlIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBjb250YWluZXJFbDogSFRNTEVsZW1lbnQ7XG4gICAgY29uc3RydWN0b3IoY29udGFpbmVyRWw6IEhUTUxFbGVtZW50LCBwcm9wZXJ0eTogRmllbGQsIGFwcDogQXBwLCBwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgICAgICBzdXBlcihjb250YWluZXJFbCk7XG4gICAgICAgIHRoaXMuY29udGFpbmVyRWwgPSBjb250YWluZXJFbDtcbiAgICAgICAgdGhpcy5wcm9wZXJ0eSA9IHByb3BlcnR5O1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuc2V0VGV4dENvbnRlbnRXaXRobmFtZSgpO1xuICAgICAgICB0aGlzLmFkZEVkaXRCdXR0b24oKTtcbiAgICAgICAgdGhpcy5hZGREZWxldGVCdXR0b24oKTtcblxuICAgIH07XG5cbiAgICBwcml2YXRlIHNldFRleHRDb250ZW50V2l0aG5hbWUoKTogdm9pZCB7XG4gICAgICAgIGNvbnN0IHZhbHVlcyA9ICF0aGlzLnByb3BlcnR5LmlzQm9vbGVhbiA/IGBbJHtPYmplY3Qua2V5cyh0aGlzLnByb3BlcnR5LnZhbHVlcykubWFwKGsgPT4gdGhpcy5wcm9wZXJ0eS52YWx1ZXNba10pLmpvaW4oJywgJyl9XWAgOiBcIlwiXG4gICAgICAgIGxldCB0eXBlID0gXCJzaW5nbGVcIlxuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eS5pc0Jvb2xlYW4pIHR5cGUgPSBcImJvb2xlYW5cIlxuICAgICAgICBpZiAodGhpcy5wcm9wZXJ0eS5pc011bHRpKSB0eXBlID0gXCJtdWx0aVwiXG4gICAgICAgIGlmICh0aGlzLnByb3BlcnR5LmlzQ3ljbGUpIHR5cGUgPSBcImN5Y2xlXCJcbiAgICAgICAgdGhpcy5pbmZvRWwudGV4dENvbnRlbnQgPVxuICAgICAgICAgICAgYCR7dGhpcy5wcm9wZXJ0eS5uYW1lfTogJHt2YWx1ZXN9YDtcbiAgICAgICAgY29uc3QgdHlwZUNvbnRhaW5lciA9IHRoaXMuaW5mb0VsLmNyZWF0ZUVsKFwic3BhblwiLCBgbWV0YWRhdGEtbWVudS1zZXR0aW5nLWl0ZW0taW5mby10eXBlICR7dHlwZX1gKVxuICAgICAgICB0eXBlQ29udGFpbmVyLnNldFRleHQodHlwZSlcblxuICAgIH07XG5cblxuICAgIHByaXZhdGUgYWRkRWRpdEJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInBlbmNpbFwiKVxuICAgICAgICAgICAgICAgIC5zZXRUb29sdGlwKFwiRWRpdFwiKVxuICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgbGV0IG1vZGFsID0gbmV3IEZpZWxkU2V0dGluZ3NNb2RhbCh0aGlzLmFwcCwgdGhpcy5wbHVnaW4sIHRoaXMuY29udGFpbmVyRWwsIHRoaXMsIHRoaXMucHJvcGVydHkpO1xuICAgICAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGFkZERlbGV0ZUJ1dHRvbigpOiB2b2lkIHtcbiAgICAgICAgdGhpcy5hZGRCdXR0b24oKGIpID0+IHtcbiAgICAgICAgICAgIGIuc2V0SWNvbihcInRyYXNoXCIpXG4gICAgICAgICAgICAgICAgLnNldFRvb2x0aXAoXCJEZWxldGVcIilcbiAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGN1cnJlbnRFeGlzdGluZ1Byb3BlcnR5ID0gdGhpcy5wbHVnaW4uaW5pdGlhbFByb3BlcnRpZXMuZmlsdGVyKHAgPT4gcC5pZCA9PSB0aGlzLnByb3BlcnR5LmlkKVswXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGN1cnJlbnRFeGlzdGluZ1Byb3BlcnR5KSB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnBsdWdpbi5pbml0aWFsUHJvcGVydGllcy5yZW1vdmUoY3VycmVudEV4aXN0aW5nUHJvcGVydHkpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB0aGlzLnNldHRpbmdFbC5wYXJlbnRFbGVtZW50Py5yZW1vdmVDaGlsZCh0aGlzLnNldHRpbmdFbCk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMucGx1Z2luLnNhdmVTZXR0aW5ncygpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9O1xuXG4gICAgcHVibGljIHN0YXRpYyBhc3luYyBnZXRWYWx1ZXNMaXN0RnJvbU5vdGUobm90ZVBhdGg6IHN0cmluZywgYXBwOiBBcHApOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIGxldCB2YWx1ZXM6IEFycmF5PHN0cmluZz4gPSBbXTtcbiAgICAgICAgY29uc3QgZmlsZSA9IGFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgobm90ZVBhdGgpO1xuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgICAgIHJlc3VsdC5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgICAgICBpZiAoL14oLiopJC8udGVzdChsaW5lKSkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaChsaW5lLnRyaW0oKSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvRmllbGRcIjtcblxuZXhwb3J0IGludGVyZmFjZSBNZXRhZGF0YU1lbnVTZXR0aW5ncyB7XG5cdHByZXNldEZpZWxkczogQXJyYXk8RmllbGQ+O1xuXHRkaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudTogYm9vbGVhbjtcblx0Z2xvYmFsbHlJZ25vcmVkRmllbGRzOiBBcnJheTxzdHJpbmc+O1xuXHRnZXRGcm9tSW5saW5lRmllbGQ6IGJvb2xlYW47XG5cdGNsYXNzRmlsZXNQYXRoOiBzdHJpbmc7XG5cdGlzQXV0b3N1Z2dlc3RFbmFibGVkOiBib29sZWFuO1xuXHRmaWxlQ2xhc3NBbGlhczogc3RyaW5nO1xufVxuXG5leHBvcnQgY29uc3QgREVGQVVMVF9TRVRUSU5HUzogTWV0YWRhdGFNZW51U2V0dGluZ3MgPSB7XG5cdHByZXNldEZpZWxkczogW10sXG5cdGRpc3BsYXlGaWVsZHNJbkNvbnRleHRNZW51OiB0cnVlLFxuXHRnbG9iYWxseUlnbm9yZWRGaWVsZHM6IFtdLFxuXHRjbGFzc0ZpbGVzUGF0aDogXCJcIixcblx0Z2V0RnJvbUlubGluZUZpZWxkOiB0cnVlLFxuXHRpc0F1dG9zdWdnZXN0RW5hYmxlZDogdHJ1ZSxcblx0ZmlsZUNsYXNzQWxpYXM6IFwiZmlsZUNsYXNzXCJcbn07IiwgImV4cG9ydCBjb25zdCBmaWVsZENvbXBvbmVudHMgPSBbJ3N0YXJ0U3R5bGUnLCAnYXR0cmlidXRlJywgJ2VuZFN0eWxlJywgJ2JlZm9yZVNlcGFyYXRvclNwYWNlcicsICdhZnRlclNlcGFyYXRvclNwYWNlcicsICd2YWx1ZXMnXVxuXG5leHBvcnQgY29uc3QgZ2VuZXJpY0ZpZWxkUmVnZXggPSBcIig/PHN0YXJ0U3R5bGU+W19cXFxcKn5gXSopKD88YXR0cmlidXRlPlswLTlcXFxcd1xcXFxwe0xldHRlcn1cXFxccHtFbW9qaV9QcmVzZW50YXRpb259XVstMC05XFxcXHdcXFxccHtMZXR0ZXJ9XFxcXHB7RW1vamlfUHJlc2VudGF0aW9ufVxcXFxzXSopKD88ZW5kU3R5bGU+W19cXFxcKn5gXSopKD88YmVmb3JlU2VwYXJhdG9yU3BhY2VyPlxcXFxzKilcIjtcblxuZXhwb3J0IGNvbnN0IGlubGluZUZpZWxkUmVnZXggPSAoYXR0cmlidXRlOiBzdHJpbmcpID0+IG5ldyBSZWdFeHAoYCg/PHN0YXJ0U3R5bGU+W19cXCp+XFxgXSopKD88YXR0cmlidXRlPiR7YXR0cmlidXRlfSkoPzxlbmRTdHlsZT5bX1xcKn5cXGBdKikoPzxiZWZvcmVTZXBhcmF0b3JTcGFjZXI+XFxcXHMqKTo6KD88YWZ0ZXJTZXBhcmF0b3JTcGFjZXI+XFxcXHMqKSg/PHZhbHVlcz4uKilgLCAndScpOyIsICJpbXBvcnQgeyBBcHAsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCJcbmltcG9ydCB7IGlubGluZUZpZWxkUmVnZXggfSBmcm9tIFwic3JjL3V0aWxzL3BhcnNlclwiO1xuXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0VmFsdWVzKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgYXR0cmlidXRlOiBzdHJpbmcpOiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgY29uc3QgY29udGVudCA9IGF3YWl0IChhd2FpdCBhcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKSkuc3BsaXQoJ1xcbicpO1xuICAgIGNvbnN0IGZyb250bWF0dGVyID0gdGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk/LmZyb250bWF0dGVyO1xuICAgIGNvbnN0IHsgcG9zaXRpb246IHsgc3RhcnQsIGVuZCB9IH0gPSBmcm9udG1hdHRlciB8fCBudWxsO1xuICAgIGNvbnN0IHJlc3VsdDogc3RyaW5nW10gPSBbXTtcbiAgICBjb250ZW50Lm1hcCgobGluZSwgaSkgPT4ge1xuICAgICAgICBpZiAoZnJvbnRtYXR0ZXIgJiYgaSA+PSBzdGFydC5saW5lICYmIGkgPD0gZW5kLmxpbmUpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgJHthdHRyaWJ1dGV9OiguKilgLCAndScpO1xuICAgICAgICAgICAgY29uc3QgciA9IGxpbmUubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgaWYgKHIgJiYgci5sZW5ndGggPiAwKSByZXN1bHQucHVzaChyWzFdKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IHJlZ2V4ID0gaW5saW5lRmllbGRSZWdleChhdHRyaWJ1dGUpO1xuICAgICAgICAgICAgY29uc3QgciA9IGxpbmUubWF0Y2gocmVnZXgpO1xuICAgICAgICAgICAgaWYgKHI/Lmdyb3VwcykgcmVzdWx0LnB1c2goci5ncm91cHMudmFsdWVzKTtcbiAgICAgICAgfVxuICAgIH0pXG4gICAgcmV0dXJuIHJlc3VsdDtcbn0iLCAiaW1wb3J0IHsgQXBwLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgZmllbGRDb21wb25lbnRzLCBpbmxpbmVGaWVsZFJlZ2V4IH0gZnJvbSBcInNyYy91dGlscy9wYXJzZXJcIjtcblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHJlcGxhY2VWYWx1ZXMoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgIGNvbnN0IGNvbnRlbnQgPSBhd2FpdCAoYXdhaXQgYXBwLnZhdWx0LmNhY2hlZFJlYWQoZmlsZSkpLnNwbGl0KCdcXG4nKTtcbiAgICBjb25zdCBmcm9udG1hdHRlciA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpPy5mcm9udG1hdHRlcjtcbiAgICBjb25zdCBzdGFydCA9IGZyb250bWF0dGVyID8gZnJvbnRtYXR0ZXIucG9zaXRpb24uc3RhcnQgOiBudWxsXG4gICAgY29uc3QgZW5kID0gZnJvbnRtYXR0ZXIgPyBmcm9udG1hdHRlci5wb3NpdGlvbi5lbmQgOiBudWxsXG4gICAgY29uc3QgbmV3Q29udGVudCA9IGNvbnRlbnQubWFwKChsaW5lLCBpKSA9PiB7XG4gICAgICAgIGlmIChmcm9udG1hdHRlciAmJiBpID49IHN0YXJ0LmxpbmUgJiYgaSA8PSBlbmQubGluZSkge1xuICAgICAgICAgICAgY29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGAke2F0dHJpYnV0ZX06YCwgJ3UnKTtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBsaW5lLm1hdGNoKHJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChyICYmIHIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGNvbnN0IGlucHV0QXJyYXkgPSBpbnB1dCA/IGlucHV0LnJlcGxhY2UoLyhcXCxcXHMrKS9nLCAnLCcpLnNwbGl0KCcsJykgOiBbXCJcIl07XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3VmFsdWUgPSBpbnB1dEFycmF5Lmxlbmd0aCA9PSAxID8gaW5wdXRBcnJheVswXSA6IGBbJHtpbnB1dEFycmF5LmpvaW4oJywgJyl9XWA7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGAke2F0dHJpYnV0ZX06ICR7bmV3VmFsdWV9YDtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpbmU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjb25zdCByZWdleCA9IGlubGluZUZpZWxkUmVnZXgoYXR0cmlidXRlKTtcbiAgICAgICAgICAgIGNvbnN0IHIgPSBsaW5lLm1hdGNoKHJlZ2V4KTtcbiAgICAgICAgICAgIGlmIChyPy5ncm91cHMgJiYgT2JqZWN0LmtleXMoci5ncm91cHMpLmV2ZXJ5KGkgPT4gZmllbGRDb21wb25lbnRzLmluY2x1ZGVzKGkpKSkge1xuICAgICAgICAgICAgICAgIGNvbnN0IHsgc3RhcnRTdHlsZSwgZW5kU3R5bGUsIGJlZm9yZVNlcGFyYXRvclNwYWNlciwgYWZ0ZXJTZXBhcmF0b3JTcGFjZXIsIHZhbHVlcyB9ID0gci5ncm91cHNcbiAgICAgICAgICAgICAgICBjb25zdCBpbnB1dEFycmF5ID0gaW5wdXQgPyBpbnB1dC5yZXBsYWNlKC8oXFwsXFxzKykvZywgJywnKS5zcGxpdCgnLCcpIDogW1wiXCJdO1xuICAgICAgICAgICAgICAgIGNvbnN0IG5ld1ZhbHVlID0gaW5wdXRBcnJheS5sZW5ndGggPT0gMSA/IGlucHV0QXJyYXlbMF0gOiBgJHtpbnB1dEFycmF5LmpvaW4oJywgJyl9YDtcbiAgICAgICAgICAgICAgICByZXR1cm4gYCR7c3RhcnRTdHlsZX0ke2F0dHJpYnV0ZX0ke2VuZFN0eWxlfSR7YmVmb3JlU2VwYXJhdG9yU3BhY2VyfTo6JHthZnRlclNlcGFyYXRvclNwYWNlcn0ke25ld1ZhbHVlfWA7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHJldHVybiBsaW5lO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfSlcbiAgICBhcHAudmF1bHQubW9kaWZ5KGZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xufSIsICJpbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiXG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcIi4vcmVwbGFjZVZhbHVlc1wiXG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCJcbmltcG9ydCB7IGNyZWF0ZUZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuaW1wb3J0IHsgZ2V0UHJvcGVydHlTZXR0aW5ncyB9IGZyb20gXCJzcmMvY29tbWFuZHMvZ2V0UHJvcGVydHlTZXR0aW5nc1wiO1xuXG5mdW5jdGlvbiBjcmVhdGVJbnB1dEZpZWxkKFxuICAgIHBsdWdpbjogTWV0YWRhdGFNZW51LFxuICAgIGR2OiBhbnksXG4gICAgcDogYW55LFxuICAgIGZpZWxkTmFtZTogc3RyaW5nLFxuICAgIGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCxcbiAgICBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfVxuKTogdm9pZCB7XG5cbiAgICBjb25zdCBmaWVsZFZhbHVlID0gZHYuZWwoJ3NwYW4nLCBwW2ZpZWxkTmFtZV0sIGF0dHJzKVxuICAgIGNvbnN0IGlucHV0Q29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKVxuICAgIGNvbnN0IGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpXG4gICAgaW5wdXQuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1pbnB1dFwiKVxuICAgIGlucHV0Q29udGFpbmVyLmFwcGVuZENoaWxkKGlucHV0KVxuICAgIGlucHV0LnZhbHVlID0gcFtmaWVsZE5hbWVdXG4gICAgLyogZW5kIHNwYWNlciAqL1xuICAgIGNvbnN0IHNwYWNlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIilcbiAgICBzcGFjZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1zcGFjZXJcIilcbiAgICAvKiBidXR0b24gdG8gZGlzcGxheSBpbnB1dCAqL1xuICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIilcbiAgICBidXR0b24uc2V0VGV4dChcIlx1RDgzRFx1REQ4RFwiKVxuICAgIGJ1dHRvbi5zZXRBdHRyKCdjbGFzcycsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICBidXR0b24uaGlkZSgpXG4gICAgc3BhY2VyLnNob3coKVxuICAgIGZpZWxkQ29udGFpbmVyLm9ubW91c2VvdmVyID0gKCkgPT4ge1xuICAgICAgICBidXR0b24uc2hvdygpXG4gICAgICAgIHNwYWNlci5oaWRlKClcbiAgICB9XG4gICAgZmllbGRDb250YWluZXIub25tb3VzZW91dCA9ICgpID0+IHtcbiAgICAgICAgYnV0dG9uLmhpZGUoKVxuICAgICAgICBzcGFjZXIuc2hvdygpXG4gICAgfVxuXG4gICAgY29uc3QgdmFsaWRhdGVJY29uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIilcbiAgICB2YWxpZGF0ZUljb24udGV4dENvbnRlbnQgPSBcIlx1MjcwNVwiXG4gICAgdmFsaWRhdGVJY29uLnNldEF0dHIoXCJjbGFzc1wiLCBcIm1ldGFkYXRhLW1lbnUtZHYtZmllbGQtYnV0dG9uXCIpXG4gICAgdmFsaWRhdGVJY29uLm9uY2xpY2sgPSAoZSkgPT4ge1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBmaWxlLCBmaWVsZE5hbWUsIGlucHV0LnZhbHVlKVxuICAgICAgICB9XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgIH1cbiAgICBpbnB1dENvbnRhaW5lcj8uYXBwZW5kQ2hpbGQodmFsaWRhdGVJY29uKVxuICAgIGNvbnN0IGNhbmNlbEljb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKVxuICAgIGNhbmNlbEljb24uc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1idXR0b25cIilcbiAgICBjYW5jZWxJY29uLnRleHRDb250ZW50ID0gXCJcdTI3NENcIlxuICAgIGNhbmNlbEljb24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGlucHV0Q29udGFpbmVyKVxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChidXR0b24pXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKHNwYWNlcilcbiAgICB9XG4gICAgaW5wdXRDb250YWluZXIuYXBwZW5kQ2hpbGQoY2FuY2VsSWNvbilcbiAgICBpbnB1dC5mb2N1cygpXG5cbiAgICBpbnB1dC5vbmtleWRvd24gPSAoZSkgPT4ge1xuICAgICAgICBpZiAoZS5rZXkgPT09IFwiRW50ZXJcIikge1xuICAgICAgICAgICAgY29uc3QgZmlsZSA9IHBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKHBbXCJmaWxlXCJdW1wicGF0aFwiXSlcbiAgICAgICAgICAgIGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBmaWxlLCBmaWVsZE5hbWUsIGlucHV0LnZhbHVlKVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGUua2V5ID09PSAnRXNjYXBlJykge1xuICAgICAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoaW5wdXRDb250YWluZXIpXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChidXR0b24pXG4gICAgICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChmaWVsZFZhbHVlKVxuICAgICAgICAgICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKVxuICAgICAgICB9XG4gICAgfVxuICAgIC8qIGJ1dHRvbiBvbiBjbGljayA6IHJlbW92ZSBidXR0b24gYW5kIGZpZWxkIGFuZCBkaXNwbGF5IGlucHV0IGZpZWxkKi9cbiAgICBidXR0b24ub25jbGljayA9IChlKSA9PiB7XG4gICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGZpZWxkVmFsdWUpXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLnJlbW92ZUNoaWxkKGJ1dHRvbilcbiAgICAgICAgZmllbGRDb250YWluZXIucmVtb3ZlQ2hpbGQoc3BhY2VyKVxuICAgICAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChpbnB1dENvbnRhaW5lcilcbiAgICAgICAgaW5wdXQuZm9jdXMoKVxuICAgIH1cbiAgICAvKiBpbml0aWFsIHN0YXRlICovXG4gICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoYnV0dG9uKVxuICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGZpZWxkVmFsdWUpXG4gICAgZmllbGRDb250YWluZXIuYXBwZW5kQ2hpbGQoc3BhY2VyKVxufVxuXG5mdW5jdGlvbiBjcmVhdGVCb29sZWFuRmllbGQoXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnUsXG4gICAgZHY6IGFueSxcbiAgICBwOiBhbnksXG4gICAgZmllbGROYW1lOiBzdHJpbmcsXG4gICAgZmllbGRDb250YWluZXI6IEhUTUxFbGVtZW50LFxuICAgIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9XG4pOiB2b2lkIHtcbiAgICBjb25zdCBjaGVja2JveDogSFRNTElucHV0RWxlbWVudCA9IGR2LmVsKFwiaW5wdXRcIiwgXCJcIiwgeyAuLi5hdHRycywgXCJ0eXBlXCI6IFwiY2hlY2tib3hcIiB9KVxuICAgIGNoZWNrYm94LmNoZWNrZWQgPSBwW2ZpZWxkTmFtZV1cbiAgICBmaWVsZENvbnRhaW5lci5hcHBlbmRDaGlsZChjaGVja2JveClcbiAgICBjaGVja2JveC5vbmNoYW5nZSA9ICh2YWx1ZSkgPT4ge1xuICAgICAgICBjb25zdCBmaWxlID0gcGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocFtcImZpbGVcIl1bXCJwYXRoXCJdKVxuICAgICAgICBpZiAoZmlsZSBpbnN0YW5jZW9mIFRGaWxlICYmIGZpbGUuZXh0ZW5zaW9uID09IFwibWRcIikge1xuICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyhwbHVnaW4uYXBwLCBmaWxlLCBmaWVsZE5hbWUsIGNoZWNrYm94LmNoZWNrZWQudG9TdHJpbmcoKSlcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZpZWxkTW9kaWZpZXIocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGR2OiBhbnksIHA6IGFueSwgZmllbGROYW1lOiBzdHJpbmcsIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KTogUHJvbWlzZTxIVE1MRWxlbWVudD4ge1xuXG4gICAgLyogZmllbGRDb250YWluZXIqL1xuICAgIGNvbnN0IGZpZWxkQ29udGFpbmVyOiBIVE1MRWxlbWVudCA9IGR2LmVsKFwiZGl2XCIsIFwiXCIpXG4gICAgZmllbGRDb250YWluZXIuc2V0QXR0cihcImNsYXNzXCIsIFwibWV0YWRhdGEtbWVudS1kdi1maWVsZC1jb250YWluZXJcIilcblxuICAgIC8qIGNyZWF0ZSBmaWVsZE1vZGlmaWVyIGRlcGVuZGluZyBvbiBmaWxlQ2xhc3MgdHlwZSBvciBwcmVzZXQgdmFsdWUqL1xuXG4gICAgaWYgKHBbZmllbGROYW1lXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGNvbnN0IGVtcHR5RmllbGQgPSBkdi5lbChcInNwYW5cIiwgbnVsbCwgYXR0cnMpXG4gICAgICAgIGZpZWxkQ29udGFpbmVyLmFwcGVuZENoaWxkKGVtcHR5RmllbGQpXG4gICAgfSBlbHNlIHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzQWxpYXMgPSBwbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXNcbiAgICAgICAgaWYgKHBbZmlsZUNsYXNzQWxpYXNdKSB7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luLCBwW2ZpbGVDbGFzc0FsaWFzXSlcbiAgICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0UHJvcGVydHlTZXR0aW5ncyhwbHVnaW4sIGZpZWxkTmFtZSwgZmlsZUNsYXNzKVxuICAgICAgICAgICAgaWYgKGZpZWxkPy5pc0Jvb2xlYW4pIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVCb29sZWFuRmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUlucHV0RmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSBpZiAocGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maWx0ZXIoYXR0ciA9PiBhdHRyLm5hbWUgPT0gZmllbGROYW1lKSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRQcm9wZXJ0eVNldHRpbmdzKHBsdWdpbiwgZmllbGROYW1lKVxuICAgICAgICAgICAgaWYgKGZpZWxkPy5pc0Jvb2xlYW4pIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVCb29sZWFuRmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNyZWF0ZUlucHV0RmllbGQocGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBmaWVsZENvbnRhaW5lciwgYXR0cnMpXG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjcmVhdGVJbnB1dEZpZWxkKHBsdWdpbiwgZHYsIHAsIGZpZWxkTmFtZSwgZmllbGRDb250YWluZXIsIGF0dHJzKVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmaWVsZENvbnRhaW5lclxufTsgIiwgImltcG9ydCBGaWVsZCBmcm9tIFwic3JjL0ZpZWxkXCI7XG5pbXBvcnQgeyBnZW5lcmljRmllbGRSZWdleCB9IGZyb20gXCJzcmMvdXRpbHMvcGFyc2VyXCI7XG5cbmludGVyZmFjZSBGaWxlQ2xhc3NBdHRyaWJ1dGUge1xuICAgIG5hbWU6IHN0cmluZztcbiAgICB0eXBlOiBzdHJpbmc7XG4gICAgb3B0aW9uczogc3RyaW5nW107XG4gICAgaXNNdWx0aTogYm9vbGVhbjtcbiAgICBpc0N5Y2xlOiBib29sZWFuO1xuICAgIGlzQm9vbGVhbjogYm9vbGVhbjtcbn1cblxuY29uc3QgdHlwZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gPSB7XG4gICAgXCJpbnB1dFwiOiBcIkFjY2VwdCBhbnkgdmFsdWVcIixcbiAgICBcInNlbGVjdFwiOiBcIkFjY2VwdCBhIHNpbmdsZSB2YWx1ZSBmcm9tIGEgbGlzdFwiLFxuICAgIFwibXVsdGlcIjogXCJBY2NlcHQgbXVsdGlwbGUgdmFsdWVzIGZyb20gYSBsaXN0XCIsXG4gICAgXCJjeWNsZVwiOiBcIkN5Y2xlIHRocm91Z2ggdmFsdWVzIGZyb20gYSBsaXN0XCIsXG4gICAgXCJib29sZWFuXCI6IFwiQWNjZXB0IHRydWUgb2YgZmFsc2VcIlxufVxuXG5jbGFzcyBGaWxlQ2xhc3NBdHRyaWJ1dGUge1xuXG4gICAgY29uc3RydWN0b3IocmF3OiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgY29tcGxldGVSZWdleCA9IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTo6KD88ZmllbGRTZXR0aW5ncz4uKyk/YCwgXCJ1XCIpO1xuICAgICAgICBjb25zdCBuYW1lUmVnZXggPSBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH0kYCwgXCJ1XCIpO1xuICAgICAgICBsZXQgZmllbGROYW1lOiBzdHJpbmdcbiAgICAgICAgbGV0IHsgYXR0cmlidXRlLCBmaWVsZFNldHRpbmdzIH0gPSByYXcubWF0Y2goY29tcGxldGVSZWdleCk/Lmdyb3VwcyB8fCB7fVxuICAgICAgICBpZiAoYXR0cmlidXRlKSB7XG4gICAgICAgICAgICBmaWVsZE5hbWUgPSBhdHRyaWJ1dGVcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCB7IGF0dHJpYnV0ZSB9ID0gcmF3Lm1hdGNoKG5hbWVSZWdleCk/Lmdyb3VwcyB8fCB7fVxuICAgICAgICAgICAgZmllbGROYW1lID0gYXR0cmlidXRlXG4gICAgICAgIH1cbiAgICAgICAgaWYgKGZpZWxkTmFtZSkge1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gZmllbGROYW1lLnRyaW0oKTtcbiAgICAgICAgICAgIGlmIChmaWVsZFNldHRpbmdzKSB7XG4gICAgICAgICAgICAgICAgY29uc3Qgc2V0dGluZ3MgPSBKU09OLnBhcnNlKGAke2ZpZWxkU2V0dGluZ3MudHJpbSgpfWApO1xuICAgICAgICAgICAgICAgIHRoaXMudHlwZSA9IHNldHRpbmdzWyd0eXBlJ107XG4gICAgICAgICAgICAgICAgc3dpdGNoICh0aGlzLnR5cGUpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBcIm11bHRpXCI6XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmlzTXVsdGkgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgXCJjeWNsZVwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0N5Y2xlID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYm9vbGVhblwiOlxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pc0Jvb2xlYW4gPSB0cnVlXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgdGhpcy5vcHRpb25zID0gc2V0dGluZ3NbJ29wdGlvbnMnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNvbnN0IGVycm9yID0gbmV3IEVycm9yKFwiSW1wcm9wZXIgdmFsdWVcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBnZXRGaWVsZCgpIHtcbiAgICAgICAgbGV0IHZhbHVlczogUmVjb3JkPHN0cmluZywgc3RyaW5nPiA9IHt9O1xuICAgICAgICB0aGlzLm9wdGlvbnM/LmZvckVhY2goKG9wdGlvbiwgaW5kZXgpID0+IHtcbiAgICAgICAgICAgIHZhbHVlc1tpbmRleF0gPSBvcHRpb247XG4gICAgICAgIH0pXG4gICAgICAgIHJldHVybiBuZXcgRmllbGQodGhpcy5uYW1lLCB2YWx1ZXMsIHRoaXMubmFtZSwgdGhpcy5pc011bHRpLCB0aGlzLmlzQ3ljbGUsIHRoaXMuaXNCb29sZWFuKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZSwgdHlwZXMgfTsiLCAiaW1wb3J0IHsgRmlsZUNsYXNzQXR0cmlidXRlIH0gZnJvbSBcIi4vZmlsZUNsYXNzQXR0cmlidXRlXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG5pbnRlcmZhY2UgRmlsZUNsYXNzIHtcbiAgICBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBuYW1lOiBzdHJpbmc7XG4gICAgYXR0cmlidXRlczogQXJyYXk8RmlsZUNsYXNzQXR0cmlidXRlPjtcbiAgICBvYmplY3RzOiBGaWxlQ2xhc3NNYW5hZ2VyO1xuICAgIGVycm9yczogc3RyaW5nW107XG59XG5cbmNsYXNzIEZpbGVDbGFzc01hbmFnZXIge1xuICAgIHB1YmxpYyBpbnN0YW5jZTogRmlsZUNsYXNzO1xuXG4gICAgY29uc3RydWN0b3IoaW5zdGFuY2U6IEZpbGVDbGFzcykge1xuICAgICAgICB0aGlzLmluc3RhbmNlID0gaW5zdGFuY2U7XG4gICAgfVxuXG4gICAgcHVibGljIGFsbCgpIHtcbiAgICAgICAgY29uc3QgZmlsZXNXaXRoRmlsZUNsYXNzTmFtZSA9IHRoaXMuaW5zdGFuY2UucGx1Z2luLmFwcC52YXVsdC5nZXRNYXJrZG93bkZpbGVzKCkuZmlsdGVyKGZpbGUgPT4ge1xuICAgICAgICAgICAgY29uc3QgY2FjaGUgPSB0aGlzLmluc3RhbmNlLnBsdWdpbi5hcHAubWV0YWRhdGFDYWNoZS5nZXRGaWxlQ2FjaGUoZmlsZSk7XG4gICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBbGlhcyA9IHRoaXMuaW5zdGFuY2UucGx1Z2luLnNldHRpbmdzLmZpbGVDbGFzc0FsaWFzO1xuICAgICAgICAgICAgcmV0dXJuIGNhY2hlPy5mcm9udG1hdHRlclxuICAgICAgICAgICAgICAgICYmIE9iamVjdC5rZXlzKGNhY2hlLmZyb250bWF0dGVyKS5pbmNsdWRlcyhmaWxlQ2xhc3NBbGlhcylcbiAgICAgICAgICAgICAgICAmJiBjYWNoZS5mcm9udG1hdHRlcltmaWxlQ2xhc3NBbGlhc10gPT0gdGhpcy5pbnN0YW5jZS5uYW1lO1xuICAgICAgICB9KVxuICAgICAgICByZXR1cm4gZmlsZXNXaXRoRmlsZUNsYXNzTmFtZTtcbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0KG5hbWU6IHN0cmluZykge1xuICAgICAgICBjb25zdCBmaWxlc1dpdGhOYW1lID0gdGhpcy5hbGwoKS5maWx0ZXIoZmlsZSA9PiBmaWxlLmJhc2VuYW1lID09IG5hbWUpO1xuICAgICAgICBpZiAoZmlsZXNXaXRoTmFtZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk1vcmUgdGhhbiBvbmUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsZXNXaXRoTmFtZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJObyBmaWxlIHZhbHVlIGZvdW5kXCIpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpbGVzV2l0aE5hbWVbMF07XG5cbiAgICB9XG5cbiAgICBwdWJsaWMgZ2V0UGF0aChwYXRoOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgZmlsZXNXaXRoTmFtZSA9IHRoaXMuYWxsKCkuZmlsdGVyKGZpbGUgPT4gZmlsZS5wYXRoID09IHBhdGgpO1xuICAgICAgICBpZiAoZmlsZXNXaXRoTmFtZS5sZW5ndGggPiAxKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBFcnJvcihcIk1vcmUgdGhhbiBvbmUgdmFsdWUgZm91bmRcIik7XG4gICAgICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgICAgfVxuICAgICAgICBpZiAoZmlsZXNXaXRoTmFtZS5sZW5ndGggPT0gMCkge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJObyBmaWxlIHZhbHVlIGZvdW5kXCIpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZpbGVzV2l0aE5hbWVbMF07XG5cbiAgICB9XG59XG5cbmNsYXNzIEZpbGVDbGFzcyB7XG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZykge1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy5vYmplY3RzID0gbmV3IEZpbGVDbGFzc01hbmFnZXIodGhpcyk7XG4gICAgICAgIHRoaXMuYXR0cmlidXRlcyA9IFtdO1xuICAgIH1cblxuICAgIHB1YmxpYyBnZXRDbGFzc0ZpbGUoKTogVEZpbGUge1xuICAgICAgICBjb25zdCBmaWxlc0NsYXNzUGF0aCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoO1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5wbHVnaW4uYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChgJHtmaWxlc0NsYXNzUGF0aH0ke3RoaXMubmFtZX0ubWRgKTtcbiAgICAgICAgaWYgKGZpbGUgaW5zdGFuY2VvZiBURmlsZSAmJiBmaWxlLmV4dGVuc2lvbiA9PSBcIm1kXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBmaWxlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY29uc3QgZXJyb3IgPSBuZXcgRXJyb3IoXCJubyBzdWNoIGZpbGVDbGFzcyBpbiBmaWxlQ2xhc3MgZm9sZGVyXCIpO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3I7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgZ2V0QXR0cmlidXRlcygpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICAgICAgbGV0IGF0dHJpYnV0ZXM6IEFycmF5PEZpbGVDbGFzc0F0dHJpYnV0ZT4gPSBbXTtcbiAgICAgICAgICAgIGxldCBlcnJvcnM6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQuY2FjaGVkUmVhZChmaWxlKVxuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGF0dHJpYnV0ZSA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGUobGluZSk7XG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMucHVzaChhdHRyaWJ1dGUpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgICAgICAgICAgIGVycm9ycy5wdXNoKGVycm9yKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgdGhpcy5hdHRyaWJ1dGVzID0gYXR0cmlidXRlcztcbiAgICAgICAgICAgIHRoaXMuZXJyb3JzID0gZXJyb3JzO1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgdGhyb3cgKGVycm9yKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHB1YmxpYyBhc3luYyB1cGRhdGVBdHRyaWJ1dGUobmV3VHlwZTogc3RyaW5nLCBuZXdPcHRpb25zOiBzdHJpbmdbXSwgbmV3TmFtZTogc3RyaW5nLCBhdHRyPzogRmlsZUNsYXNzQXR0cmlidXRlKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGNvbnN0IGZpbGUgPSB0aGlzLmdldENsYXNzRmlsZSgpO1xuICAgICAgICBsZXQgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgaWYgKGF0dHIpIHtcbiAgICAgICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgcmVzdWx0LnNwbGl0KCdcXG4nKS5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgIGlmIChsaW5lLnN0YXJ0c1dpdGgoYXR0ci5uYW1lKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAobmV3VHlwZSA9PSBcImlucHV0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChuZXdOYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxldCBzZXR0aW5nczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgICAgICAgICAgICAgc2V0dGluZ3NbXCJ0eXBlXCJdID0gbmV3VHlwZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHNldHRpbmdzW1wib3B0aW9uc1wiXSA9IG5ld09wdGlvbnM7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7bmV3TmFtZX06OiAke0pTT04uc3RyaW5naWZ5KHNldHRpbmdzKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgdGhpcy5wbHVnaW4uYXBwLnZhdWx0Lm1vZGlmeShmaWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxldCBzZXR0aW5nczogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9O1xuICAgICAgICAgICAgc2V0dGluZ3NbXCJ0eXBlXCJdID0gbmV3VHlwZTtcbiAgICAgICAgICAgIHNldHRpbmdzW1wib3B0aW9uc1wiXSA9IG5ld09wdGlvbnM7XG4gICAgICAgICAgICByZXN1bHQgKz0gKGBcXG4ke25ld05hbWV9OjogJHtKU09OLnN0cmluZ2lmeShzZXR0aW5ncyl9YCk7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQubW9kaWZ5KGZpbGUsIHJlc3VsdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBwdWJsaWMgYXN5bmMgcmVtb3ZlQXR0cmlidXRlKGF0dHI6IEZpbGVDbGFzc0F0dHJpYnV0ZSk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBmaWxlID0gdGhpcy5nZXRDbGFzc0ZpbGUoKTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5wbHVnaW4uYXBwLnZhdWx0LnJlYWQoZmlsZSlcbiAgICAgICAgbGV0IG5ld0NvbnRlbnQ6IHN0cmluZ1tdID0gW107XG4gICAgICAgIHJlc3VsdC5zcGxpdCgnXFxuJykuZm9yRWFjaChsaW5lID0+IHtcbiAgICAgICAgICAgIGlmICghbGluZS5zdGFydHNXaXRoKGF0dHIubmFtZSkpIHtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgICAgIGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5tb2RpZnkoZmlsZSwgbmV3Q29udGVudC5qb2luKCdcXG4nKSk7XG4gICAgfVxufVxuXG5hc3luYyBmdW5jdGlvbiBjcmVhdGVGaWxlQ2xhc3MocGx1Z2luOiBNZXRhZGF0YU1lbnUsIG5hbWU6IHN0cmluZyk6IFByb21pc2U8RmlsZUNsYXNzPiB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgICAgY29uc3QgZmlsZUNsYXNzID0gbmV3IEZpbGVDbGFzcyhwbHVnaW4sIG5hbWUpO1xuICAgICAgICBmaWxlQ2xhc3MuZ2V0QXR0cmlidXRlcygpLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgcmVzb2x2ZShmaWxlQ2xhc3MpO1xuICAgICAgICB9KS5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgICAgICAgIHJlamVjdChlcnJvcik7XG4gICAgICAgIH0pXG4gICAgfSlcbn1cblxuZXhwb3J0IHsgY3JlYXRlRmlsZUNsYXNzLCBGaWxlQ2xhc3MgfTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IEZpZWxkIGZyb20gXCJzcmMvRmllbGRcIjtcbmltcG9ydCB7IEZpbGVDbGFzcyB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL2ZpbGVDbGFzc1wiO1xuXG5leHBvcnQgZnVuY3Rpb24gZ2V0UHJvcGVydHlTZXR0aW5ncyhwbHVnaW46IE1ldGFkYXRhTWVudSwgcHJvcGVydHlOYW1lOiBzdHJpbmcsIGZpbGVDbGFzcz86IEZpbGVDbGFzcyk6IEZpZWxkIHwgdW5kZWZpbmVkIHtcbiAgICBjb25zdCBtYXRjaGluZ1NldHRpbmdzID0gcGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maWx0ZXIocCA9PiBwLm5hbWUgPT0gcHJvcGVydHlOYW1lKTtcbiAgICBpZiAoZmlsZUNsYXNzKSB7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZXNXaXRoTmFtZSA9IGZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZpbHRlcihhdHRyID0+IGF0dHIubmFtZSA9PSBwcm9wZXJ0eU5hbWUpO1xuICAgICAgICBpZiAoZmlsZUNsYXNzQXR0cmlidXRlc1dpdGhOYW1lLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZSA9IGZpbGVDbGFzc0F0dHJpYnV0ZXNXaXRoTmFtZVswXTtcbiAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBmaWxlQ2xhc3NBdHRyaWJ1dGUuZ2V0RmllbGQoKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAobWF0Y2hpbmdTZXR0aW5ncy5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG1hdGNoaW5nU2V0dGluZ3NbMF07XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmIChtYXRjaGluZ1NldHRpbmdzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgcmV0dXJuIG1hdGNoaW5nU2V0dGluZ3NbMF07XG4gICAgfTtcbn07IiwgImltcG9ydCB7IEFwcCwgVEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIlxuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiXG5pbXBvcnQgeyBnZXRWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9nZXRWYWx1ZXNcIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwiLi9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5pbXBvcnQgeyBmaWVsZE1vZGlmaWVyIH0gZnJvbSBcIi4vY29tbWFuZHMvZmllbGRNb2RpZmllclwiO1xuXG5cbmV4cG9ydCBpbnRlcmZhY2UgSU1ldGFkYXRhTWVudUFwaSB7XG4gICAgZ2V0VmFsdWVzOiAoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZykgPT4gUHJvbWlzZTxzdHJpbmdbXT47XG4gICAgcmVwbGFjZVZhbHVlczogKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgYXR0cmlidXRlOiBzdHJpbmcsIGlucHV0OiBzdHJpbmcpID0+IFByb21pc2U8dm9pZD47XG4gICAgZmllbGRNb2RpZmllcjogKGR2OiBhbnksIHA6IGFueSwgZmllbGROYW1lOiBzdHJpbmcsIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KSA9PiBQcm9taXNlPEhUTUxFbGVtZW50Pjtcbn1cblxuZXhwb3J0IGNsYXNzIE1ldGFkYXRhTWVudUFwaSB7XG4gICAgY29uc3RydWN0b3IocHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudSkge1xuICAgIH1cblxuICAgIHB1YmxpYyBtYWtlKCk6IElNZXRhZGF0YU1lbnVBcGkge1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZ2V0VmFsdWVzOiB0aGlzLmdldFZhbHVlcygpLFxuICAgICAgICAgICAgcmVwbGFjZVZhbHVlczogdGhpcy5yZXBsYWNlVmFsdWVzKCksXG4gICAgICAgICAgICBmaWVsZE1vZGlmaWVyOiB0aGlzLmZpZWxkTW9kaWZpZXIoKVxuICAgICAgICB9O1xuICAgIH1cblxuICAgIHByaXZhdGUgZ2V0VmFsdWVzKCk6IChhcHA6IEFwcCwgZmlsZTogVEZpbGUsIGF0dHJpYnV0ZTogc3RyaW5nKSA9PiBQcm9taXNlPHN0cmluZ1tdPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZykgPT4gZ2V0VmFsdWVzKGFwcCwgZmlsZSwgYXR0cmlidXRlKVxuICAgIH1cblxuICAgIHByaXZhdGUgcmVwbGFjZVZhbHVlcygpOiAoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZykgPT4gUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIHJldHVybiBhc3luYyAoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBhdHRyaWJ1dGU6IHN0cmluZywgaW5wdXQ6IHN0cmluZykgPT4gcmVwbGFjZVZhbHVlcyhhcHAsIGZpbGUsIGF0dHJpYnV0ZSwgaW5wdXQpXG4gICAgfVxuXG4gICAgcHJpdmF0ZSBmaWVsZE1vZGlmaWVyKCk6IChkdjogYW55LCBwOiBhbnksIGZpZWxkTmFtZTogc3RyaW5nLCBhdHRycz86IHsgY2xzOiBzdHJpbmcsIGF0dHI6IFJlY29yZDxzdHJpbmcsIHN0cmluZz4gfSkgPT4gUHJvbWlzZTxIVE1MRWxlbWVudD4ge1xuICAgICAgICByZXR1cm4gKGR2OiBhbnksIHA6IGFueSwgZmllbGROYW1lOiBzdHJpbmcsIGF0dHJzPzogeyBjbHM6IHN0cmluZywgYXR0cjogUmVjb3JkPHN0cmluZywgc3RyaW5nPiB9KSA9PiBmaWVsZE1vZGlmaWVyKHRoaXMucGx1Z2luLCBkdiwgcCwgZmllbGROYW1lLCBhdHRycylcbiAgICB9XG59IiwgImltcG9ydCB7IFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgT3B0aW9uc0xpc3QgZnJvbSBcInNyYy9vcHRpb25zL09wdGlvbnNMaXN0XCI7XG5pbXBvcnQgRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9maWxlQ2xhc3MvRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWxcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgbGlua0NvbnRleHRNZW51IHtcblx0cHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcblx0cHJpdmF0ZSBmaWxlOiBURmlsZTtcblx0cHJpdmF0ZSBvcHRpb25zTGlzdDogT3B0aW9uc0xpc3Q7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmNyZWF0ZUNvbnRleHRNZW51KCk7XG5cdH07XG5cblx0cHJpdmF0ZSBjcmVhdGVDb250ZXh0TWVudSgpOiB2b2lkIHtcblx0XHR0aGlzLnBsdWdpbi5yZWdpc3RlckV2ZW50KFxuXHRcdFx0dGhpcy5wbHVnaW4uYXBwLndvcmtzcGFjZS5vbignZmlsZS1tZW51JywgKG1lbnUsIGFic3RyYWN0RmlsZSwgc291cmNlKSA9PiB7XG5cdFx0XHRcdGlmICh0aGlzLnBsdWdpbi5zZXR0aW5ncy5kaXNwbGF5RmllbGRzSW5Db250ZXh0TWVudSkge1xuXHRcdFx0XHRcdGNvbnN0IGZpbGUgPSB0aGlzLnBsdWdpbi5hcHAudmF1bHQuZ2V0QWJzdHJhY3RGaWxlQnlQYXRoKGFic3RyYWN0RmlsZS5wYXRoKVxuXHRcdFx0XHRcdGlmIChmaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgZmlsZS5leHRlbnNpb24gPT09ICdtZCcpIHtcblx0XHRcdFx0XHRcdHRoaXMuZmlsZSA9IGZpbGU7XG5cdFx0XHRcdFx0XHRpZiAoZmlsZS5wYXJlbnQucGF0aCArIFwiL1wiID09IHRoaXMucGx1Z2luLnNldHRpbmdzLmNsYXNzRmlsZXNQYXRoKSB7XG5cdFx0XHRcdFx0XHRcdG1lbnUuYWRkU2VwYXJhdG9yKCk7XG5cdFx0XHRcdFx0XHRcdG1lbnUuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdGl0ZW0uc2V0SWNvbihcImdlYXJcIik7XG5cdFx0XHRcdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShgTWFuYWdlIDwke2ZpbGUuYmFzZW5hbWV9PiBmaWVsZHNgKTtcblx0XHRcdFx0XHRcdFx0XHRpdGVtLm9uQ2xpY2soKGV2dCkgPT4ge1xuXHRcdFx0XHRcdFx0XHRcdFx0Y29uc3QgZmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIGZpbGUpO1xuXHRcdFx0XHRcdFx0XHRcdFx0ZmlsZUNsYXNzQXR0cmlidXRlU2VsZWN0TW9kYWwub3BlbigpO1xuXHRcdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0XHRcdHRoaXMub3B0aW9uc0xpc3QgPSBuZXcgT3B0aW9uc0xpc3QodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgbWVudSk7XG5cdFx0XHRcdFx0XHRcdHRoaXMub3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG5cdFx0XHRcdFx0XHR9O1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH07XG5cdFx0XHR9KVxuXHRcdCk7XG5cdH07XG59OyIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBUb2dnbGVDb21wb25lbnQsIFRGaWxlLCBCdXR0b25Db21wb25lbnQsIEV4dHJhQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyB2YWx1ZU11bHRpU2VsZWN0TW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBwcml2YXRlIGZpbGU6IFRGaWxlO1xuICAgIHByaXZhdGUgbmFtZTogc3RyaW5nO1xuICAgIHByaXZhdGUgc2V0dGluZ3M6IEZpZWxkO1xuICAgIHByaXZhdGUgdmFsdWVzOiBBcnJheTxzdHJpbmc+O1xuICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyO1xuICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbjtcbiAgICBwcml2YXRlIHRvcDogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCBmaWxlOiBURmlsZSwgbmFtZTogc3RyaW5nLCBpbml0aWFsVmFsdWVzOiBzdHJpbmcsIHNldHRpbmdzOiBGaWVsZCwgbGluZU51bWJlcjogbnVtYmVyID0gLTEsIGluRnJvbnRNYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZSwgdG9wOiBib29sZWFuID0gZmFsc2UpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgICAgIHRoaXMubmFtZSA9IG5hbWU7XG4gICAgICAgIHRoaXMuc2V0dGluZ3MgPSBzZXR0aW5ncztcbiAgICAgICAgaWYgKGluaXRpYWxWYWx1ZXMpIHtcbiAgICAgICAgICAgIGlmIChpbml0aWFsVmFsdWVzLnRvU3RyaW5nKCkuc3RhcnRzV2l0aChcIltbXCIpKSB7XG4gICAgICAgICAgICAgICAgdGhpcy52YWx1ZXMgPSBpbml0aWFsVmFsdWVzLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVzID0gaW5pdGlhbFZhbHVlcy50b1N0cmluZygpLnJlcGxhY2UoL15cXFsoLiopXFxdJC8sIFwiJDFcIikuc3BsaXQoXCIsXCIpLm1hcChpdGVtID0+IGl0ZW0udHJpbSgpKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB0aGlzLnZhbHVlcyA9IFtdO1xuICAgICAgICB9O1xuICAgICAgICAvL3RoaXMudmFsdWVzID0gaW5pdGlhbFZhbHVlcyA/IGluaXRpYWxWYWx1ZXMudG9TdHJpbmcoKS5yZXBsYWNlKC9eXFxbKC4qKVxcXSQvLCBcIiQxXCIpLnNwbGl0KFwiLFwiKS5tYXAoaXRlbSA9PiBpdGVtLnRyaW0oKSkgOiBbXVxuICAgICAgICB0aGlzLmxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyO1xuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBpbkZyb250TWF0dGVyO1xuICAgICAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICB9O1xuXG4gICAgYXN5bmMgb25PcGVuKCkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKTtcblxuICAgICAgICBjb25zdCB2YWx1ZUdyaWQgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZFwiXG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBsaXN0Tm90ZVZhbHVlcyA9IGF3YWl0IEZpZWxkU2V0dGluZy5nZXRWYWx1ZXNMaXN0RnJvbU5vdGUodGhpcy5zZXR0aW5ncy52YWx1ZXNMaXN0Tm90ZVBhdGgsIHRoaXMuYXBwKVxuICAgICAgICBhd2FpdCB0aGlzLnBvcHVsYXRlVmFsdWVzR3JpZCh2YWx1ZUdyaWQsIGxpc3ROb3RlVmFsdWVzKTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBhc3luYyBwb3B1bGF0ZVZhbHVlc0dyaWQodmFsdWVHcmlkOiBIVE1MRGl2RWxlbWVudCwgbGlzdE5vdGVWYWx1ZXM6IHN0cmluZ1tdKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGlmIChsaXN0Tm90ZVZhbHVlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHRoaXMuc2V0dGluZ3MudmFsdWVzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgcHJlc2V0VmFsdWUgPSB0aGlzLnNldHRpbmdzLnZhbHVlc1trZXldO1xuICAgICAgICAgICAgICAgIHRoaXMuYnVpbGRWYWx1ZVRvZ2dsZXIodmFsdWVHcmlkLCBwcmVzZXRWYWx1ZSk7XG4gICAgICAgICAgICB9KVxuICAgICAgICB9O1xuICAgICAgICBsaXN0Tm90ZVZhbHVlcy5mb3JFYWNoKHZhbHVlID0+IHtcbiAgICAgICAgICAgIHRoaXMuYnVpbGRWYWx1ZVRvZ2dsZXIodmFsdWVHcmlkLCB2YWx1ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBmb290ZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS12YWx1ZS1ncmlkLWZvb3RlclwiIH0pO1xuICAgICAgICBjb25zdCBzYXZlQnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChmb290ZXIpO1xuICAgICAgICBzYXZlQnV0dG9uLnNldEljb24oXCJjaGVja21hcmtcIik7XG4gICAgICAgIHNhdmVCdXR0b24ub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyh0aGlzLmFwcCwgdGhpcy5maWxlLCB0aGlzLm5hbWUsIHRoaXMudmFsdWVzLmpvaW4oXCIsXCIpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZCh0aGlzLmZpbGUpXG4gICAgICAgICAgICAgICAgbGV0IG5ld0NvbnRlbnQ6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgY29uc3QgcmVuZGVyZWRWYWx1ZXMgPSAhdGhpcy5pbkZyb250bWF0dGVyID8gdGhpcy52YWx1ZXMuam9pbihcIixcIikgOiB0aGlzLnZhbHVlcy5sZW5ndGggPiAxID8gYFske3RoaXMudmFsdWVzLmpvaW4oXCIsXCIpfV1gIDogdGhpcy52YWx1ZXNcbiAgICAgICAgICAgICAgICBpZiAodGhpcy50b3ApIHtcbiAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGAke3RoaXMubmFtZX0ke3RoaXMuaW5Gcm9udG1hdHRlciA/IFwiOlwiIDogXCI6OlwifSAke3JlbmRlcmVkVmFsdWVzfWApO1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgX2xpbmVOdW1iZXIpID0+IG5ld0NvbnRlbnQucHVzaChsaW5lKSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIF9saW5lTnVtYmVyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2gobGluZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2xpbmVOdW1iZXIgPT0gdGhpcy5saW5lTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGAke3RoaXMubmFtZX0ke3RoaXMuaW5Gcm9udG1hdHRlciA/IFwiOlwiIDogXCI6OlwifSAke3JlbmRlcmVkVmFsdWVzfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgIHRoaXMuYXBwLnZhdWx0Lm1vZGlmeSh0aGlzLmZpbGUsIG5ld0NvbnRlbnQuam9pbignXFxuJykpO1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IGNhbmNlbEJ1dHRvbiA9IG5ldyBFeHRyYUJ1dHRvbkNvbXBvbmVudChmb290ZXIpO1xuICAgICAgICBjYW5jZWxCdXR0b24uc2V0SWNvbihcImNyb3NzXCIpO1xuICAgICAgICBjYW5jZWxCdXR0b24ub25DbGljaygoKSA9PiB0aGlzLmNsb3NlKCkpO1xuICAgIH07XG5cbiAgICBwcml2YXRlIGJ1aWxkVmFsdWVUb2dnbGVyKHZhbHVlR3JpZDogSFRNTERpdkVsZW1lbnQsIHByZXNldFZhbHVlOiBzdHJpbmcpIHtcbiAgICAgICAgY29uc3QgdmFsdWVTZWxlY3RvckNvbnRhaW5lciA9IHZhbHVlR3JpZC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0b3ItY29udGFpbmVyXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlVG9nZ2xlckNvbnRhaW5lciA9IHZhbHVlU2VsZWN0b3JDb250YWluZXIuY3JlYXRlRGl2KHtcbiAgICAgICAgICAgIGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLXRvZ2dsZXJcIlxuICAgICAgICB9KTtcbiAgICAgICAgY29uc3QgdmFsdWVUb2dnbGVyID0gbmV3IFRvZ2dsZUNvbXBvbmVudCh2YWx1ZVRvZ2dsZXJDb250YWluZXIpO1xuICAgICAgICB0aGlzLnZhbHVlcy5mb3JFYWNoKHZhbHVlID0+IHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSA9PSBwcmVzZXRWYWx1ZSkge1xuICAgICAgICAgICAgICAgIHZhbHVlVG9nZ2xlci5zZXRWYWx1ZSh0cnVlKVxuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIHZhbHVlVG9nZ2xlci5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgJiYgIXRoaXMudmFsdWVzLmluY2x1ZGVzKHByZXNldFZhbHVlKSkge1xuICAgICAgICAgICAgICAgIHRoaXMudmFsdWVzLnB1c2gocHJlc2V0VmFsdWUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICghdmFsdWUpIHtcbiAgICAgICAgICAgICAgICB0aGlzLnZhbHVlcy5yZW1vdmUocHJlc2V0VmFsdWUpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgICAgIGNvbnN0IHZhbHVlTGFiZWwgPSB2YWx1ZVNlbGVjdG9yQ29udGFpbmVyLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLWxhYmVsXCIgfSk7XG4gICAgICAgIHZhbHVlTGFiZWwuc2V0VGV4dChwcmVzZXRWYWx1ZSk7XG4gICAgfTtcbn07IiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIFRleHRDb21wb25lbnQsIFRGaWxlLCBUb2dnbGVDb21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IHJlcGxhY2VWYWx1ZXMgfSBmcm9tIFwic3JjL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgdmFsdWVUZXh0SW5wdXRNb2RhbCBleHRlbmRzIE1vZGFsIHtcblxuICAgIHByaXZhdGUgZmlsZTogVEZpbGU7XG4gICAgcHJpdmF0ZSBuYW1lOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSB2YWx1ZTogc3RyaW5nO1xuICAgIHByaXZhdGUgbGluZU51bWJlcjogbnVtYmVyO1xuICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbjtcbiAgICBwcml2YXRlIHRvcDogYm9vbGVhbjtcbiAgICBwcml2YXRlIHBhcnNlRGF0ZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIGxpbmVOdW1iZXI6IG51bWJlciA9IC0xLCBpbkZyb250TWF0dGVyOiBib29sZWFuID0gZmFsc2UsIHRvcDogYm9vbGVhbiA9IGZhbHNlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLm5hbWUgPSBuYW1lO1xuICAgICAgICB0aGlzLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIHRoaXMubGluZU51bWJlciA9IGxpbmVOdW1iZXI7XG4gICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlciA9IGluRnJvbnRNYXR0ZXI7XG4gICAgICAgIHRoaXMudG9wID0gdG9wO1xuICAgIH07XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IGlucHV0RGl2ID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtbW9kYWwtdmFsdWVcIiB9KTtcbiAgICAgICAgdGhpcy5idWlsZElucHV0RWwoaW5wdXREaXYpO1xuICAgIH07XG5cbiAgICBidWlsZERhdGVQYXJzZVRvZ2dsZXIoY29udGFpbmVyOiBIVE1MRWxlbWVudCkge1xuICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgaWYgKGFwcC5wbHVnaW5zLnBsdWdpbnMuaGFzT3duUHJvcGVydHkoJ25sZGF0ZXMtb2JzaWRpYW4nKSkge1xuICAgICAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgICAgICBjb25zdCBubGRhdGVzID0gYXBwLnBsdWdpbnMucGx1Z2luc1snbmxkYXRlcy1vYnNpZGlhbiddO1xuICAgICAgICAgICAgY29uc3QgZGF0ZVBhcnNlckxhYmVsID0gY29udGFpbmVyLmNyZWF0ZURpdih7XG4gICAgICAgICAgICAgICAgY2xzOiBcIm1ldGFkYXRhLW1lbnUtZGF0ZS1wYXJzZXItbGFiZWxcIlxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBkYXRlUGFyc2VyTGFiZWwuc2V0VGV4dChcIlx1RDgzRFx1RENDNlwiKTtcbiAgICAgICAgICAgIGNvbnN0IGRhdGVQYXJzZXJUb2dnbGVyID0gbmV3IFRvZ2dsZUNvbXBvbmVudChjb250YWluZXIpO1xuICAgICAgICAgICAgZGF0ZVBhcnNlclRvZ2dsZXIub25DaGFuZ2UodmFsdWUgPT4ge1xuICAgICAgICAgICAgICAgIHRoaXMucGFyc2VEYXRlID0gdmFsdWU7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGRhdGVQYXJzZXJMYWJlbC5vbmNsaWNrID0gKCkgPT4gZGF0ZVBhcnNlclRvZ2dsZXIuc2V0VmFsdWUoIXRoaXMucGFyc2VEYXRlKTtcbiAgICAgICAgfTtcbiAgICB9O1xuXG4gICAgcHJpdmF0ZSBidWlsZElucHV0RWwoaW5wdXREaXY6IEhUTUxEaXZFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIHRoaXMuYnVpbGREYXRlUGFyc2VUb2dnbGVyKGlucHV0RGl2KTtcbiAgICAgICAgY29uc3QgZm9ybSA9IGlucHV0RGl2LmNyZWF0ZUVsKFwiZm9ybVwiKTtcbiAgICAgICAgZm9ybS50eXBlID0gXCJzdWJtaXRcIjtcblxuICAgICAgICBjb25zdCBpbnB1dEVsID0gbmV3IFRleHRDb21wb25lbnQoZm9ybSk7XG4gICAgICAgIGlucHV0RWwuaW5wdXRFbC5mb2N1cygpO1xuICAgICAgICBpbnB1dEVsLnNldFZhbHVlKHRoaXMudmFsdWUpO1xuICAgICAgICBpbnB1dEVsLmlucHV0RWwuYWRkQ2xhc3MoXCJtZXRhZGF0YS1tZW51LXByb21wdC1pbnB1dFwiKTtcblxuICAgICAgICBmb3JtLm9uc3VibWl0ID0gYXN5bmMgKGU6IEV2ZW50KSA9PiB7XG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBsZXQgaW5wdXRWYWx1ZSA9IGlucHV0RWwuZ2V0VmFsdWUoKTtcbiAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgaWYgKGFwcC5wbHVnaW5zLnBsdWdpbnMuaGFzT3duUHJvcGVydHkoJ25sZGF0ZXMtb2JzaWRpYW4nKSAmJiB0aGlzLnBhcnNlRGF0ZSkge1xuICAgICAgICAgICAgICAgIC8vQHRzLWlnbm9yZVxuICAgICAgICAgICAgICAgIGNvbnN0IG5sZGF0ZXMgPSBhcHAucGx1Z2lucy5wbHVnaW5zWydubGRhdGVzLW9ic2lkaWFuJ107XG4gICAgICAgICAgICAgICAgY29uc3QgZm9ybWF0ID0gbmxkYXRlcy5zZXR0aW5ncy5mb3JtYXQ7XG4gICAgICAgICAgICAgICAgbGV0IHRleHRTdGFydCA9IFwiXCI7XG4gICAgICAgICAgICAgICAgbGV0IHRleHRFbmQgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGxldCBkYXRlID0gXCJcIjtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3Rpb25TdGFydCA9IGlucHV0RWwuaW5wdXRFbC5zZWxlY3Rpb25TdGFydDtcbiAgICAgICAgICAgICAgICBjb25zdCBzZWxlY3Rpb25FbmQgPSBpbnB1dEVsLmlucHV0RWwuc2VsZWN0aW9uRW5kO1xuICAgICAgICAgICAgICAgIGlmIChzZWxlY3Rpb25FbmQgPT0gc2VsZWN0aW9uU3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZGF0ZSA9IG5sZGF0ZXMucGFyc2VEYXRlKGlucHV0RWwuZ2V0VmFsdWUoKSkubW9tZW50LmZvcm1hdChmb3JtYXQpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHRleHRTdGFydCA9IGlucHV0RWwuZ2V0VmFsdWUoKS5zbGljZSgwLCBzZWxlY3Rpb25TdGFydCEpO1xuICAgICAgICAgICAgICAgICAgICBkYXRlID0gbmxkYXRlcy5wYXJzZURhdGUoaW5wdXRFbC5nZXRWYWx1ZSgpLnNsaWNlKHNlbGVjdGlvblN0YXJ0ISwgc2VsZWN0aW9uRW5kISkpLm1vbWVudC5mb3JtYXQoZm9ybWF0KTtcbiAgICAgICAgICAgICAgICAgICAgdGV4dEVuZCA9IGlucHV0RWwuZ2V0VmFsdWUoKS5zbGljZShzZWxlY3Rpb25FbmQhKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIGlucHV0VmFsdWUgPSB0ZXh0U3RhcnQgKyBcIltbXCIgKyBkYXRlICsgXCJdXVwiICsgdGV4dEVuZDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICh0aGlzLmxpbmVOdW1iZXIgPT0gLTEpIHtcbiAgICAgICAgICAgICAgICByZXBsYWNlVmFsdWVzKHRoaXMuYXBwLCB0aGlzLmZpbGUsIHRoaXMubmFtZSwgaW5wdXRWYWx1ZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQodGhpcy5maWxlKVxuICAgICAgICAgICAgICAgIGxldCBuZXdDb250ZW50OiBzdHJpbmdbXSA9IFtdO1xuICAgICAgICAgICAgICAgIGlmICh0aGlzLnRvcCkge1xuICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7dGhpcy5uYW1lfSR7dGhpcy5pbkZyb250bWF0dGVyID8gXCI6XCIgOiBcIjo6XCJ9ICR7aW5wdXRWYWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIF9saW5lTnVtYmVyKSA9PiBuZXdDb250ZW50LnB1c2gobGluZSkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9saW5lTnVtYmVyID09IHRoaXMubGluZU51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHt0aGlzLm5hbWV9JHt0aGlzLmluRnJvbnRtYXR0ZXIgPyBcIjpcIiA6IFwiOjpcIn0gJHtpbnB1dFZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5tb2RpZnkodGhpcy5maWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9O1xuXG4gICAgfTtcbn07IiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIERyb3Bkb3duQ29tcG9uZW50LCBURmlsZSwgQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9GaWVsZFwiO1xuaW1wb3J0IHsgcmVwbGFjZVZhbHVlcyB9IGZyb20gXCJzcmMvY29tbWFuZHMvcmVwbGFjZVZhbHVlc1wiO1xuaW1wb3J0IEZpZWxkU2V0dGluZyBmcm9tIFwic3JjL3NldHRpbmdzL0ZpZWxkU2V0dGluZ1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyB2YWx1ZVNlbGVjdE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIG5hbWU6IHN0cmluZztcbiAgICBwcml2YXRlIHZhbHVlOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBzZXR0aW5nczogRmllbGQ7XG4gICAgcHJpdmF0ZSBuZXdWYWx1ZTogc3RyaW5nIHwgbnVsbDtcbiAgICBwcml2YXRlIGxpbmVOdW1iZXI6IG51bWJlcjtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSB0b3A6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgZmlsZTogVEZpbGUsIG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgc2V0dGluZ3M6IEZpZWxkLCBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSwgaW5Gcm9udE1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLCB0b3A6IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLnNldHRpbmdzID0gc2V0dGluZ3M7XG4gICAgICAgIHRoaXMubmV3VmFsdWUgPSBudWxsO1xuICAgICAgICB0aGlzLmxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyO1xuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBpbkZyb250TWF0dGVyO1xuICAgICAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICB9O1xuXG4gICAgYXN5bmMgb25PcGVuKCkge1xuICAgICAgICB0aGlzLmNvbnRhaW5lckVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudVwiKTtcbiAgICAgICAgY29uc3QgaW5wdXREaXYgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1tb2RhbC12YWx1ZVwiIH0pO1xuICAgICAgICBhd2FpdCB0aGlzLmJ1aWxkSW5wdXRFbChpbnB1dERpdik7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYXN5bmMgYnVpbGRJbnB1dEVsKGlucHV0RGl2OiBIVE1MRGl2RWxlbWVudCk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzZWxlY3RFbCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChpbnB1dERpdik7XG4gICAgICAgIHNlbGVjdEVsLnNlbGVjdEVsLmFkZENsYXNzKFwibWV0YWRhdGEtbWVudS1zZWxlY3RcIik7XG5cbiAgICAgICAgY29uc3QgdmFsdWVzID0gdGhpcy5zZXR0aW5ncy52YWx1ZXM7XG4gICAgICAgIHNlbGVjdEVsLmFkZE9wdGlvbihcIlwiLCBcIi0tRW1wdHktLVwiKTtcbiAgICAgICAgY29uc3QgbGlzdE5vdGVWYWx1ZXMgPSBhd2FpdCBGaWVsZFNldHRpbmcuZ2V0VmFsdWVzTGlzdEZyb21Ob3RlKHRoaXMuc2V0dGluZ3MudmFsdWVzTGlzdE5vdGVQYXRoLCB0aGlzLmFwcClcbiAgICAgICAgbGlzdE5vdGVWYWx1ZXMuZm9yRWFjaCh2YWx1ZSA9PiBzZWxlY3RFbC5hZGRPcHRpb24odmFsdWUsIHZhbHVlKSk7XG4gICAgICAgIGlmIChsaXN0Tm90ZVZhbHVlcy5pbmNsdWRlcyh0aGlzLnZhbHVlKSkge1xuICAgICAgICAgICAgc2VsZWN0RWwuc2V0VmFsdWUodGhpcy52YWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChsaXN0Tm90ZVZhbHVlcy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgIE9iamVjdC5rZXlzKHZhbHVlcykuZm9yRWFjaChrZXkgPT4ge1xuICAgICAgICAgICAgICAgIHNlbGVjdEVsLmFkZE9wdGlvbih2YWx1ZXNba2V5XSwgdmFsdWVzW2tleV0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBpZiAoT2JqZWN0LnZhbHVlcyh2YWx1ZXMpLmluY2x1ZGVzKHRoaXMudmFsdWUpKSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0RWwuc2V0VmFsdWUodGhpcy52YWx1ZSk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICAgIHNlbGVjdEVsLm9uQ2hhbmdlKHZhbHVlID0+IHRoaXMubmV3VmFsdWUgPSB2YWx1ZSAhPSBcIi0tRW1wdHktLVwiID8gdmFsdWUgOiBcIlwiKTtcbiAgICAgICAgY29uc3Qgc3VibWl0QnV0dG9uID0gbmV3IEJ1dHRvbkNvbXBvbmVudChpbnB1dERpdik7XG4gICAgICAgIHN1Ym1pdEJ1dHRvbi5zZXRUb29sdGlwKFwiU2F2ZVwiKVxuICAgICAgICAgICAgLnNldEljb24oXCJjaGVja21hcmtcIilcbiAgICAgICAgICAgIC5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm5ld1ZhbHVlIHx8IHRoaXMubmV3VmFsdWUgPT0gXCJcIikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyh0aGlzLmFwcCwgdGhpcy5maWxlLCB0aGlzLm5hbWUsIHRoaXMubmV3VmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQodGhpcy5maWxlKVxuICAgICAgICAgICAgICAgICAgICBsZXQgbmV3Q29udGVudDogc3RyaW5nW10gPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMudG9wKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7dGhpcy5uYW1lfSR7dGhpcy5pbkZyb250bWF0dGVyID8gXCI6XCIgOiBcIjo6XCJ9ICR7c2VsZWN0RWwuZ2V0VmFsdWUoKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4gbmV3Q29udGVudC5wdXNoKGxpbmUpKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoX2xpbmVOdW1iZXIgPT0gdGhpcy5saW5lTnVtYmVyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHt0aGlzLm5hbWV9JHt0aGlzLmluRnJvbnRtYXR0ZXIgPyBcIjpcIiA6IFwiOjpcIn0gJHtzZWxlY3RFbC5nZXRWYWx1ZSgpfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQubW9kaWZ5KHRoaXMuZmlsZSwgbmV3Q29udGVudC5qb2luKCdcXG4nKSk7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgIH0pO1xuICAgIH07XG59OyIsICJpbXBvcnQgeyBNb2RhbCwgRHJvcGRvd25Db21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgZmllbGRTZWxlY3RNb2RhbCBmcm9tIFwiLi9maWVsZFNlbGVjdE1vZGFsXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgY2hvb3NlU2VjdGlvbk1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBwcml2YXRlIGZpbGU6IFRGaWxlO1xuICAgIHByaXZhdGUgZmlsZUNsYXNzPzogRmlsZUNsYXNzXG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZTogVEZpbGUsIGZpbGVDbGFzcz86IEZpbGVDbGFzcykge1xuICAgICAgICBzdXBlcihwbHVnaW4uYXBwKTtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgICAgdGhpcy5wbHVnaW4gPSBwbHVnaW47XG4gICAgICAgIHRoaXMuZmlsZUNsYXNzID0gZmlsZUNsYXNzXG4gICAgfTtcblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoXCJBZGQgYSBmaWVsZCBpbiB0aGlzIG5vdGUgYWZ0ZXI6XCIpO1xuICAgICAgICBjb25zdCBpbnB1dERpdiA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LW1vZGFsLXZhbHVlXCIgfSk7XG5cbiAgICAgICAgY29uc3Qgc2VsZWN0RWwgPSBuZXcgRHJvcGRvd25Db21wb25lbnQoaW5wdXREaXYpO1xuICAgICAgICBzZWxlY3RFbC5zZWxlY3RFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnUtc2VsZWN0XCIpO1xuICAgICAgICBzZWxlY3RFbC5hZGRPcHRpb24oXCJcIiwgXCJTZWxlY3QgbGluZVwiKTtcbiAgICAgICAgc2VsZWN0RWwuYWRkT3B0aW9uKFwidG9wXzBcIiwgXCJ0b3BcIik7XG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQodGhpcy5maWxlKVxuICAgICAgICBsZXQgZm9yZUhlYWRUZXh0ID0gZmFsc2U7XG4gICAgICAgIGxldCBmcm9udG1hdHRlclN0YXJ0ID0gZmFsc2U7XG4gICAgICAgIGxldCBmcm9udG1hdHRlckVuZCA9IGZhbHNlO1xuICAgICAgICBsZXQgaW5Gcm9udG1hdHRlciA9IGZhbHNlO1xuICAgICAgICByZXN1bHQuc3BsaXQoXCJcXG5cIikuZm9yRWFjaCgobGluZSwgbGluZU51bWJlcikgPT4ge1xuICAgICAgICAgICAgaWYgKGxpbmUgIT0gXCItLS1cIiAmJiAhZm9yZUhlYWRUZXh0ICYmICFmcm9udG1hdHRlclN0YXJ0KSB7XG4gICAgICAgICAgICAgICAgZm9yZUhlYWRUZXh0ID0gdHJ1ZTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBpZiAobGluZSA9PSBcIi0tLVwiICYmICFmb3JlSGVhZFRleHQpIHtcbiAgICAgICAgICAgICAgICBpZiAoIWZyb250bWF0dGVyU3RhcnQpIHtcbiAgICAgICAgICAgICAgICAgICAgZnJvbnRtYXR0ZXJTdGFydCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIGluRnJvbnRtYXR0ZXIgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoIWZyb250bWF0dGVyRW5kKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb250bWF0dGVyRW5kID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgaW5Gcm9udG1hdHRlciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoaW5Gcm9udG1hdHRlcikge1xuICAgICAgICAgICAgICAgIHNlbGVjdEVsLmFkZE9wdGlvbihgZnJvbnRtYXR0ZXJfJHtsaW5lTnVtYmVyfWAsIGAke2xpbmUuc3Vic3RyaW5nKDAsIDMwKX0ke2xpbmUubGVuZ3RoID4gMzAgPyBcIi4uLlwiIDogXCJcIn1gKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc2VsZWN0RWwuYWRkT3B0aW9uKGBib2R5XyR7bGluZU51bWJlcn1gLCBgJHtsaW5lLnN1YnN0cmluZygwLCAzMCl9JHtsaW5lLmxlbmd0aCA+IDMwID8gXCIuLi5cIiA6IFwiXCJ9YCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICB9KTtcbiAgICAgICAgc2VsZWN0RWwub25DaGFuZ2UoKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgdmFsdWVBcnJheSA9IHNlbGVjdEVsLmdldFZhbHVlKCkubWF0Y2goLyhcXHcrKV8oXFxkKykvKTtcbiAgICAgICAgICAgIGNvbnN0IHBvc2l0aW9uID0gdmFsdWVBcnJheSAmJiB2YWx1ZUFycmF5Lmxlbmd0aCA+IDAgPyB2YWx1ZUFycmF5WzFdIDogMDtcbiAgICAgICAgICAgIGNvbnN0IGxpbmVOdW1iZXIgPSBOdW1iZXIodmFsdWVBcnJheSAmJiB2YWx1ZUFycmF5Lmxlbmd0aCA+IDEgPyB2YWx1ZUFycmF5WzJdIDogMCk7XG4gICAgICAgICAgICBjb25zdCBpbkZyb250bWF0dGVyID0gcG9zaXRpb24gPT0gXCJmcm9udG1hdHRlclwiID8gdHJ1ZSA6IGZhbHNlO1xuICAgICAgICAgICAgY29uc3QgdG9wID0gcG9zaXRpb24gPT0gXCJ0b3BcIiA/IHRydWUgOiBmYWxzZTtcbiAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IGZpZWxkU2VsZWN0TW9kYWwodGhpcy5wbHVnaW4sIHRoaXMuZmlsZSwgbGluZU51bWJlciwgcmVzdWx0LnNwbGl0KCdcXG4nKVtsaW5lTnVtYmVyXSwgaW5Gcm9udG1hdHRlciwgdG9wLCB0aGlzLmZpbGVDbGFzcyk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgIH0pO1xuICAgIH07XG59OyIsICJpbXBvcnQgeyBNb2RhbCwgRHJvcGRvd25Db21wb25lbnQsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgYWRkTmV3RmllbGRNb2RhbCBmcm9tIFwiLi9hZGROZXdGaWVsZE1vZGFsXCI7XG5pbXBvcnQgdmFsdWVUZXh0SW5wdXRNb2RhbCBmcm9tIFwiLi92YWx1ZVRleHRJbnB1dE1vZGFsXCI7XG5pbXBvcnQgdmFsdWVTZWxlY3RNb2RhbCBmcm9tIFwiLi92YWx1ZVNlbGVjdE1vZGFsXCI7XG5pbXBvcnQgdmFsdWVUb2dnbGVNb2RhbCBmcm9tIFwiLi92YWx1ZVRvZ2dsZU1vZGFsXCI7XG5pbXBvcnQgdmFsdWVNdWx0aVNlbGVjdE1vZGFsIGZyb20gXCIuL3ZhbHVlTXVsdGlTZWxlY3RNb2RhbFwiO1xuaW1wb3J0IHsgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgRmllbGQgZnJvbSBcInNyYy9GaWVsZFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBmaWVsZFNlbGVjdE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBsaW5lOiBzdHJpbmc7XG4gICAgcHJpdmF0ZSBwbHVnaW46IE1ldGFkYXRhTWVudTtcbiAgICBwcml2YXRlIGZpbGU6IFRGaWxlO1xuICAgIHByaXZhdGUgaW5Gcm9udG1hdHRlcjogYm9vbGVhbjtcbiAgICBwcml2YXRlIHRvcDogYm9vbGVhbjtcbiAgICBwcml2YXRlIGZpbGVDbGFzcz86IEZpbGVDbGFzc1xuXG4gICAgY29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBsaW5lTnVtYmVyOiBudW1iZXIsIGxpbmU6IHN0cmluZywgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiwgdG9wOiBib29sZWFuLCBmaWxlQ2xhc3M/OiBGaWxlQ2xhc3MpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMubGluZSA9IGxpbmU7XG4gICAgICAgIHRoaXMubGluZU51bWJlciA9IGxpbmVOdW1iZXI7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBpbkZyb250bWF0dGVyO1xuICAgICAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3MgPSBmaWxlQ2xhc3NcbiAgICB9O1xuXG4gICAgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgSW5zZXJ0IGZpZWxkIGFmdGVyID4gJHt0aGlzLmxpbmUuc3Vic3RyaW5nKDAsIDIwKX0ke3RoaXMubGluZS5sZW5ndGggPiAyMCA/IFwiLi4uXCIgOiBcIlwifWApO1xuICAgICAgICBjb25zdCBjb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6IFwibWV0YWRhdGEtbWVudS1maWVsZC1zZWxlY3RcIiB9KTtcblxuICAgICAgICBjb25zdCBzZXR0aW5nc0Ryb3Bkb3duQ29udGFpbmVyID0gY29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBzZXR0aW5nc1NlbGVjdG9yID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHNldHRpbmdzRHJvcGRvd25Db250YWluZXIpO1xuICAgICAgICBzZXR0aW5nc1NlbGVjdG9yLmFkZE9wdGlvbihcIi0tLVwiLCBcIkNob29zZSBGaWVsZFwiKTtcbiAgICAgICAgc2V0dGluZ3NTZWxlY3Rvci5hZGRPcHRpb24oXCIrK05ld1wiLCBcIk5ld1wiKTtcbiAgICAgICAgaWYgKHRoaXMuZmlsZUNsYXNzKSB7XG4gICAgICAgICAgICB0aGlzLmZpbGVDbGFzcy5hdHRyaWJ1dGVzLmZvckVhY2goYXR0ciA9PiB7XG4gICAgICAgICAgICAgICAgc2V0dGluZ3NTZWxlY3Rvci5hZGRPcHRpb24oYXR0ci5uYW1lLCBhdHRyLm5hbWUpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5mb3JFYWNoKHNldHRpbmcgPT4ge1xuICAgICAgICAgICAgICAgIHNldHRpbmdzU2VsZWN0b3IuYWRkT3B0aW9uKHNldHRpbmcubmFtZSwgc2V0dGluZy5uYW1lKTtcbiAgICAgICAgICAgIH0pXG4gICAgICAgIH07XG5cbiAgICAgICAgc2V0dGluZ3NTZWxlY3Rvci5vbkNoYW5nZSh2YWx1ZSA9PiB7XG4gICAgICAgICAgICBpZiAodmFsdWUgPT0gXCIrK05ld1wiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbmV3RmllbGRNb2RhbCA9IG5ldyBhZGROZXdGaWVsZE1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuZmlsZSwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLnRvcCk7XG4gICAgICAgICAgICAgICAgbmV3RmllbGRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLmZpbGVDbGFzcykge1xuICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc0F0dHJpYnV0ZXNXaXRoTmFtZSA9IHRoaXMuZmlsZUNsYXNzLmF0dHJpYnV0ZXMuZmlsdGVyKGF0dHIgPT4gYXR0ci5uYW1lID09IHZhbHVlKTtcbiAgICAgICAgICAgICAgICBsZXQgZmllbGQ6IEZpZWxkIHwgdW5kZWZpbmVkXG4gICAgICAgICAgICAgICAgbGV0IHR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZFxuICAgICAgICAgICAgICAgIGlmIChmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWUubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGUgPSBmaWxlQ2xhc3NBdHRyaWJ1dGVzV2l0aE5hbWVbMF07XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkID0gZmlsZUNsYXNzQXR0cmlidXRlLmdldEZpZWxkKCk7XG4gICAgICAgICAgICAgICAgICAgIHR5cGUgPSBmaWxlQ2xhc3NBdHRyaWJ1dGUudHlwZVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoZmllbGQpIHtcbiAgICAgICAgICAgICAgICAgICAgc3dpdGNoICh0eXBlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiY3ljbGVcIjpcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vZmFsbC10aHJvdWdoXG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwic2VsZWN0XCI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IHZhbHVlU2VsZWN0TW9kYWwodGhpcy5hcHAsIHRoaXMuZmlsZSwgZmllbGQubmFtZSwgXCJcIiwgZmllbGQsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLnRvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNlbGVjdCB2YWx1ZSBmb3IgJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGNhc2UgXCJtdWx0aVwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyB2YWx1ZU11bHRpU2VsZWN0TW9kYWwodGhpcy5hcHAsIHRoaXMuZmlsZSwgZmllbGQubmFtZSwgXCJcIiwgZmllbGQsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLnRvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNlbGVjdCB2YWx1ZXMgZm9yICR7dmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICBjYXNlIFwiYm9vbGVhblwiOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyB2YWx1ZVRvZ2dsZU1vZGFsKHRoaXMuYXBwLCB0aGlzLmZpbGUsIGZpZWxkLm5hbWUsIGZhbHNlLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy50b3ApXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNldCB2YWx1ZSBmb3IgJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IHZhbHVlVGV4dElucHV0TW9kYWwodGhpcy5hcHAsIHRoaXMuZmlsZSwgdmFsdWUsIFwiXCIsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLnRvcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYEVudGVyIHZhbHVlIGZvciAke3ZhbHVlfWApO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIFwiYnJlYWtcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgZmllbGQgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5wcmVzZXRGaWVsZHMuZmlsdGVyKF9maWVsZCA9PiBfZmllbGQubmFtZSA9PSB2YWx1ZSlbMF07XG4gICAgICAgICAgICAgICAgaWYgKGZpZWxkLnZhbHVlc0xpc3ROb3RlUGF0aCB8fCAoZmllbGQudmFsdWVzICYmIE9iamVjdC5rZXlzKGZpZWxkLnZhbHVlcykubGVuZ3RoID4gMCkpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKGZpZWxkLmlzTXVsdGkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgdmFsdWVNdWx0aVNlbGVjdE1vZGFsKHRoaXMuYXBwLCB0aGlzLmZpbGUsIGZpZWxkLm5hbWUsIFwiXCIsIGZpZWxkLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy50b3ApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNlbGVjdCB2YWx1ZXMgZm9yICR7dmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpZWxkTW9kYWwgPSBuZXcgdmFsdWVTZWxlY3RNb2RhbCh0aGlzLmFwcCwgdGhpcy5maWxlLCBmaWVsZC5uYW1lLCBcIlwiLCBmaWVsZCwgdGhpcy5saW5lTnVtYmVyLCB0aGlzLmluRnJvbnRtYXR0ZXIsIHRoaXMudG9wKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwudGl0bGVFbC5zZXRUZXh0KGBTZWxlY3QgdmFsdWUgZm9yICR7dmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGZpZWxkLmlzQm9vbGVhbikge1xuICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWVsZE1vZGFsID0gbmV3IHZhbHVlVG9nZ2xlTW9kYWwodGhpcy5hcHAsIHRoaXMuZmlsZSwgZmllbGQubmFtZSwgZmFsc2UsIHRoaXMubGluZU51bWJlciwgdGhpcy5pbkZyb250bWF0dGVyLCB0aGlzLnRvcClcbiAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC50aXRsZUVsLnNldFRleHQoYFNldCB2YWx1ZSBmb3IgJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgZmllbGRNb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgZmllbGRNb2RhbCA9IG5ldyB2YWx1ZVRleHRJbnB1dE1vZGFsKHRoaXMuYXBwLCB0aGlzLmZpbGUsIHZhbHVlLCBcIlwiLCB0aGlzLmxpbmVOdW1iZXIsIHRoaXMuaW5Gcm9udG1hdHRlciwgdGhpcy50b3ApO1xuICAgICAgICAgICAgICAgICAgICBmaWVsZE1vZGFsLnRpdGxlRWwuc2V0VGV4dChgRW50ZXIgdmFsdWUgZm9yICR7dmFsdWV9YCk7XG4gICAgICAgICAgICAgICAgICAgIGZpZWxkTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfSk7XG4gICAgfTtcbn07IiwgImltcG9ydCB7IE1vZGFsLCBUZXh0Q29tcG9uZW50LCBCdXR0b25Db21wb25lbnQsIEV4dHJhQnV0dG9uQ29tcG9uZW50LCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBhZGROZXdGaWVsZE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSB0b3A6IGJvb2xlYW47XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgbGluZU51bWJlcjogbnVtYmVyLCBmaWxlOiBURmlsZSwgaW5Gcm9udG1hdHRlcjogYm9vbGVhbiwgdG9wOiBib29sZWFuKSB7XG4gICAgICAgIHN1cGVyKHBsdWdpbi5hcHApO1xuICAgICAgICB0aGlzLmxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyO1xuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBpbkZyb250bWF0dGVyO1xuICAgICAgICB0aGlzLmZpbGUgPSBmaWxlO1xuICAgICAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIHRoaXMudGl0bGVFbC5zZXRUZXh0KFwiSW5zZXJ0IG5ldyBmaWVsZFwiKTtcbiAgICAgICAgY29uc3QgYWRkTmV3RmllbGRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgY29uc3QgbmFtZUlucHV0Q29udGFpbmVyID0gYWRkTmV3RmllbGRDb250YWluZXIuY3JlYXRlRGl2KCk7XG4gICAgICAgIG5hbWVJbnB1dENvbnRhaW5lci5zZXRUZXh0KFwiRmllbGQgTmFtZTogXCIpO1xuICAgICAgICBjb25zdCBuYW1lSW5wdXRFbCA9IG5ldyBUZXh0Q29tcG9uZW50KG5hbWVJbnB1dENvbnRhaW5lcik7XG4gICAgICAgIG5hbWVJbnB1dEVsLnNldFBsYWNlaG9sZGVyKFwiRmllbGQgbmFtZVwiKTtcbiAgICAgICAgY29uc3QgdmFsdWVJbnB1dENvbnRhaW5lciA9IGFkZE5ld0ZpZWxkQ29udGFpbmVyLmNyZWF0ZURpdigpO1xuICAgICAgICB2YWx1ZUlucHV0Q29udGFpbmVyLnNldFRleHQoXCJGaWVsZCB2YWx1ZTogXCIpO1xuICAgICAgICBjb25zdCB2YWx1ZUlucHV0RWwgPSBuZXcgVGV4dENvbXBvbmVudCh2YWx1ZUlucHV0Q29udGFpbmVyKTtcbiAgICAgICAgdmFsdWVJbnB1dEVsLnNldFBsYWNlaG9sZGVyKFwiRmllbGQgdmFsdWVcIik7XG4gICAgICAgIGNvbnN0IGZvb3RlckJ1dHRvbnMgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoe1xuICAgICAgICAgICAgY2xzOiAnbWV0YWRhdGEtbWVudS10ZXh0YXJlYS1idXR0b25zJ1xuICAgICAgICB9KTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyQnV0dG9ucyk7XG4gICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHRoaXMuYXBwLnZhdWx0LnJlYWQodGhpcy5maWxlKVxuICAgICAgICAgICAgbGV0IG5ld0NvbnRlbnQ6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICBpZiAodGhpcy50b3ApIHtcbiAgICAgICAgICAgICAgICBuZXdDb250ZW50LnB1c2goYCR7bmFtZUlucHV0RWwuZ2V0VmFsdWUoKX0ke3RoaXMuaW5Gcm9udG1hdHRlciA/IFwiOlwiIDogXCI6OlwifSAke3ZhbHVlSW5wdXRFbC5nZXRWYWx1ZSgpfWApO1xuICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4gbmV3Q29udGVudC5wdXNoKGxpbmUpKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIF9saW5lTnVtYmVyKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChsaW5lKTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKF9saW5lTnVtYmVyID09IHRoaXMubGluZU51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGAke25hbWVJbnB1dEVsLmdldFZhbHVlKCl9JHt0aGlzLmluRnJvbnRtYXR0ZXIgPyBcIjpcIiA6IFwiOjpcIn0gJHt2YWx1ZUlucHV0RWwuZ2V0VmFsdWUoKX1gKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdGhpcy5hcHAudmF1bHQubW9kaWZ5KHRoaXMuZmlsZSwgbmV3Q29udGVudC5qb2luKCdcXG4nKSk7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgRXh0cmFCdXR0b25Db21wb25lbnQoZm9vdGVyQnV0dG9ucyk7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5zZXRJY29uKFwiY3Jvc3NcIik7XG4gICAgICAgIGNhbmNlbEJ1dHRvbi5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgfSk7XG5cblxuICAgIH07XG59OyIsICJpbXBvcnQgeyBBcHAsIE1vZGFsLCBUb2dnbGVDb21wb25lbnQsIFRGaWxlLCBCdXR0b25Db21wb25lbnQsIEV4dHJhQnV0dG9uQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcInNyYy9jb21tYW5kcy9yZXBsYWNlVmFsdWVzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIHZhbHVlVG9nZ2xlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBwcml2YXRlIGZpbGU6IFRGaWxlO1xuICAgIHByaXZhdGUgbmFtZTogc3RyaW5nO1xuICAgIHByaXZhdGUgdmFsdWU6IGJvb2xlYW47XG4gICAgcHJpdmF0ZSBsaW5lTnVtYmVyOiBudW1iZXI7XG4gICAgcHJpdmF0ZSBpbkZyb250bWF0dGVyOiBib29sZWFuO1xuICAgIHByaXZhdGUgdG9wOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIGZpbGU6IFRGaWxlLCBuYW1lOiBzdHJpbmcsIHZhbHVlOiBib29sZWFuLCBsaW5lTnVtYmVyOiBudW1iZXIgPSAtMSwgaW5Gcm9udE1hdHRlcjogYm9vbGVhbiA9IGZhbHNlLCB0b3A6IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICAgICAgdGhpcy52YWx1ZSA9IHZhbHVlO1xuICAgICAgICB0aGlzLmxpbmVOdW1iZXIgPSBsaW5lTnVtYmVyO1xuICAgICAgICB0aGlzLmluRnJvbnRtYXR0ZXIgPSBpbkZyb250TWF0dGVyO1xuICAgICAgICB0aGlzLnRvcCA9IHRvcDtcbiAgICB9O1xuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCBpbnB1dERpdiA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7XG4gICAgICAgICAgICBjbHM6IFwibWV0YWRhdGEtbWVudS10b2dnbGVyXCJcbiAgICAgICAgfSk7XG4gICAgICAgIHRoaXMuYnVpbGRUb2dnbGVFbChpbnB1dERpdik7XG4gICAgfTtcblxuICAgIHByaXZhdGUgYnVpbGRUb2dnbGVFbChpbnB1dERpdjogSFRNTERpdkVsZW1lbnQpOiB2b2lkIHtcbiAgICAgICAgY29uc3QgdG9nZ2xlRWwgPSBuZXcgVG9nZ2xlQ29tcG9uZW50KGlucHV0RGl2KTtcbiAgICAgICAgdG9nZ2xlRWwuc2V0VmFsdWUodGhpcy52YWx1ZSk7XG4gICAgICAgIHRvZ2dsZUVsLm9uQ2hhbmdlKHZhbHVlID0+IHsgdGhpcy52YWx1ZSA9IHZhbHVlIH0pXG4gICAgICAgIGNvbnN0IGZvb3RlciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLWdyaWQtZm9vdGVyXCIgfSk7XG4gICAgICAgIGNvbnN0IHNhdmVCdXR0b24gPSBuZXcgQnV0dG9uQ29tcG9uZW50KGZvb3Rlcik7XG4gICAgICAgIHNhdmVCdXR0b24uc2V0SWNvbihcImNoZWNrbWFya1wiKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5vbkNsaWNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy52YWx1ZS50b1N0cmluZygpXG4gICAgICAgICAgICBpZiAodGhpcy5saW5lTnVtYmVyID09IC0xKSB7XG4gICAgICAgICAgICAgICAgcmVwbGFjZVZhbHVlcyh0aGlzLmFwcCwgdGhpcy5maWxlLCB0aGlzLm5hbWUsIHZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdGhpcy5hcHAudmF1bHQucmVhZCh0aGlzLmZpbGUpXG4gICAgICAgICAgICAgICAgbGV0IG5ld0NvbnRlbnQ6IHN0cmluZ1tdID0gW107XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMudG9wKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHt0aGlzLm5hbWV9JHt0aGlzLmluRnJvbnRtYXR0ZXIgPyBcIjpcIiA6IFwiOjpcIn0gJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0LnNwbGl0KFwiXFxuXCIpLmZvckVhY2goKGxpbmUsIF9saW5lTnVtYmVyKSA9PiBuZXdDb250ZW50LnB1c2gobGluZSkpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdC5zcGxpdChcIlxcblwiKS5mb3JFYWNoKChsaW5lLCBfbGluZU51bWJlcikgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3Q29udGVudC5wdXNoKGxpbmUpO1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF9saW5lTnVtYmVyID09IHRoaXMubGluZU51bWJlcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld0NvbnRlbnQucHVzaChgJHt0aGlzLm5hbWV9JHt0aGlzLmluRnJvbnRtYXR0ZXIgPyBcIjpcIiA6IFwiOjpcIn0gJHt2YWx1ZX1gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC5tb2RpZnkodGhpcy5maWxlLCBuZXdDb250ZW50LmpvaW4oJ1xcbicpKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgRHJvcGRvd25Db21wb25lbnQsIE1vZGFsLCBURmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgY3JlYXRlRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGVNb2RhbCB9IGZyb20gXCJzcmMvZmlsZUNsYXNzL0ZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsIGV4dGVuZHMgTW9kYWwge1xuXG4gICAgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgZmlsZTogVEZpbGU7XG5cbiAgICBjb25zdHJ1Y3RvcihwbHVnaW46IE1ldGFkYXRhTWVudSwgZmlsZTogVEZpbGUpIHtcbiAgICAgICAgc3VwZXIocGx1Z2luLmFwcCk7XG4gICAgICAgIHRoaXMuZmlsZSA9IGZpbGU7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgIH1cblxuICAgIGFzeW5jIG9uT3BlbigpIHtcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQoYFNlbGVjdCB0aGUgZmllbGQgdG8gdXBkYXRlYCk7XG4gICAgICAgIGNvbnN0IGZpbGVDbGFzcyA9IGF3YWl0IGNyZWF0ZUZpbGVDbGFzcyh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLmJhc2VuYW1lKVxuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IHRoZSBmaWVsZCB0byB1cGRhdGUgaW4gJHtmaWxlQ2xhc3MubmFtZX1gKTtcbiAgICAgICAgY29uc3Qgc2VsZWN0Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KCk7XG4gICAgICAgIGNvbnN0IHNlbGVjdCA9IG5ldyBEcm9wZG93bkNvbXBvbmVudChzZWxlY3RDb250YWluZXIpO1xuICAgICAgICBzZWxlY3QuYWRkT3B0aW9uKFwic2VsZWN0IGFuIGF0dHJpYnV0ZVwiLCBcIi0tc2VsZWN0IGFuIGF0dHJpYnV0ZS0tXCIpO1xuICAgICAgICBmaWxlQ2xhc3MuYXR0cmlidXRlcy5mb3JFYWNoKGF0dHIgPT4ge1xuICAgICAgICAgICAgc2VsZWN0LmFkZE9wdGlvbihhdHRyLm5hbWUsIGF0dHIubmFtZSk7XG4gICAgICAgIH0pXG5cbiAgICAgICAgc2VsZWN0LmFkZE9wdGlvbihcIisrbmV3QXR0cisrXCIsIFwiKytBZGQgYSBuZXcgYXR0cmlidXRlKytcIik7XG4gICAgICAgIHNlbGVjdC5vbkNoYW5nZSgoYXR0ck5hbWUpID0+IHtcbiAgICAgICAgICAgIGlmIChhdHRyTmFtZSA9PSBcIisrbmV3QXR0clwiKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgbW9kYWwgPSBuZXcgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwodGhpcy5wbHVnaW4uYXBwLCBmaWxlQ2xhc3MpO1xuICAgICAgICAgICAgICAgIG1vZGFsLm9wZW4oKTtcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGNvbnN0IG1vZGFsID0gbmV3IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsKHRoaXMucGx1Z2luLmFwcCwgZmlsZUNsYXNzLCBmaWxlQ2xhc3MuYXR0cmlidXRlcy5maWx0ZXIoYXR0ciA9PiBhdHRyLm5hbWUgPT0gYXR0ck5hbWUpWzBdKTtcbiAgICAgICAgICAgICAgICBtb2RhbC5vcGVuKCk7XG4gICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBEcm9wZG93bkNvbXBvbmVudCwgTW9kYWwsIFRleHRDb21wb25lbnQsIEJ1dHRvbkNvbXBvbmVudCwgRXh0cmFCdXR0b25Db21wb25lbnQsIFRleHRBcmVhQ29tcG9uZW50IH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3NBdHRyaWJ1dGUsIHR5cGVzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzQXR0cmlidXRlXCI7XG5pbXBvcnQgeyBGaWxlQ2xhc3MgfSBmcm9tIFwic3JjL2ZpbGVDbGFzcy9maWxlQ2xhc3NcIjtcblxuXG5pbnRlcmZhY2UgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwge1xuICAgIGF0dHI/OiBGaWxlQ2xhc3NBdHRyaWJ1dGU7XG4gICAgZmlsZUNsYXNzOiBGaWxlQ2xhc3M7XG4gICAgdHlwZTogc3RyaW5nO1xuICAgIG9wdGlvbnM6IHN0cmluZ1tdO1xuICAgIG5hbWU6IHN0cmluZztcbn1cblxuY2xhc3MgRmlsZUNsYXNzQXR0cmlidXRlTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgZmlsZUNsYXNzOiBGaWxlQ2xhc3MsIGF0dHI/OiBGaWxlQ2xhc3NBdHRyaWJ1dGUpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hdHRyID0gYXR0cjtcbiAgICAgICAgdGhpcy5maWxlQ2xhc3MgPSBmaWxlQ2xhc3M7XG4gICAgICAgIGlmICh0aGlzLmF0dHIpIHtcbiAgICAgICAgICAgIHRoaXMudHlwZSA9IHRoaXMuYXR0ci50eXBlIHx8IFwiaW5wdXRcIjtcbiAgICAgICAgICAgIHRoaXMub3B0aW9ucyA9IHRoaXMuYXR0ci5vcHRpb25zO1xuICAgICAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5hdHRyLm5hbWU7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIC8vdGl0bGVcbiAgICAgICAgdGhpcy50aXRsZUVsLnNldFRleHQodGhpcy5hdHRyID8gYE1hbmFnZSAke3RoaXMuYXR0ci5uYW1lfWAgOiBgQ3JlYXRlIGEgbmV3IGF0dHJpYnV0ZSBmb3IgJHt0aGlzLmZpbGVDbGFzcy5uYW1lfWApO1xuXG4gICAgICAgIC8vbmFtZSBpbnB1dFxuICAgICAgICBjb25zdCBuYW1lSW5wdXRDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoKTtcbiAgICAgICAgbmFtZUlucHV0Q29udGFpbmVyLnNldFRleHQoXCJuYW1lXCIpO1xuICAgICAgICBjb25zdCBuYW1lSW5wdXQgPSBuZXcgVGV4dENvbXBvbmVudChuYW1lSW5wdXRDb250YWluZXIpO1xuICAgICAgICB0aGlzLmF0dHIgPyBuYW1lSW5wdXQuc2V0VmFsdWUodGhpcy5hdHRyLm5hbWUpIDogbmFtZUlucHV0LnNldFBsYWNlaG9sZGVyKFwiVHlwZSBhIG5hbWUgZm9yIHRoaXMgYXR0cmlidXRlXCIpO1xuXG4gICAgICAgIC8vaGVhZGVyIGZvciBzZWxlY3RcbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdEhlYWRlciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdigpO1xuICAgICAgICBjb25zdCBhdHRyTGluZSA9IHR5cGVTZWxlY3RIZWFkZXIuY3JlYXRlRWwoXCJkaXZcIik7XG4gICAgICAgIGNvbnN0IGF0dHJOYW1lID0gYXR0ckxpbmUuY3JlYXRlRWwoXCJzdHJvbmdcIik7XG4gICAgICAgIGF0dHJOYW1lLnNldFRleHQoYDwke3RoaXMubmFtZX0+YCk7XG4gICAgICAgIGF0dHJMaW5lLmFwcGVuZChcIiBmaWVsZHMgaW4gZmlsZXMgd2l0aDpcIik7XG4gICAgICAgIFN0cmluZyhgLS0tXFxuZmlsZUNsYXNzOiAke3RoaXMuZmlsZUNsYXNzLm5hbWV9XFxuLi4uXFxuLS0tYCkuc3BsaXQoJ1xcbicpLmZvckVhY2gobGluZSA9PiB7XG4gICAgICAgICAgICB0eXBlU2VsZWN0SGVhZGVyLmNyZWF0ZUVsKFwiZGl2XCIsIFwieWFtbC1tZXRhZGF0YS1tZW51LXJlZFwiKS5zZXRUZXh0KGxpbmUpO1xuICAgICAgICB9KVxuXG4gICAgICAgIC8vIHR5cGUgc2VsZWN0XG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RDb250YWluZXIgPSB0aGlzLmNvbnRlbnRFbC5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLWNvbnRhaW5lcicgfSk7XG4gICAgICAgIGNvbnN0IHR5cGVTZWxlY3RMYWJlbCA9IHR5cGVTZWxlY3RDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3Rvci1pbmxpbmUtbGFiZWwnIH0pO1xuICAgICAgICB0eXBlU2VsZWN0TGFiZWwuc2V0VGV4dChcIndpbGw6IFwiKTtcbiAgICAgICAgY29uc3QgdHlwZVNlbGVjdERyb3BEb3duID0gdHlwZVNlbGVjdENvbnRhaW5lci5jcmVhdGVEaXYoeyBjbHM6ICdtZXRhZGF0YS1tZW51LXZhbHVlLXNlbGVjdG9yLXRvZ2dsZXInIH0pO1xuICAgICAgICBjb25zdCB0eXBlU2VsZWN0ID0gbmV3IERyb3Bkb3duQ29tcG9uZW50KHR5cGVTZWxlY3REcm9wRG93bik7XG4gICAgICAgIE9iamVjdC5rZXlzKHR5cGVzKS5mb3JFYWNoKGtleSA9PiB7XG4gICAgICAgICAgICB0eXBlU2VsZWN0LmFkZE9wdGlvbihrZXksIHR5cGVzW2tleV0pO1xuICAgICAgICB9KVxuICAgICAgICBpZiAodGhpcy5hdHRyKSB7XG4gICAgICAgICAgICB0eXBlU2VsZWN0LnNldFZhbHVlKHRoaXMudHlwZSk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBvcHRpb25zIGlucHV0XG4gICAgICAgIGNvbnN0IG9wdGlvbnNJbnB1dENvbnRhaW5lciA9IHRoaXMuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogJ21ldGFkYXRhLW1lbnUtdmFsdWUtc2VsZWN0b3ItY29udGFpbmVyJyB9KTtcbiAgICAgICAgY29uc3Qgb3B0aW9uc0lucHV0TGFiZWwgPSBvcHRpb25zSW5wdXRDb250YWluZXIuY3JlYXRlRGl2KHsgY2xzOiAnbWV0YWRhdGEtbWVudS12YWx1ZS1zZWxlY3Rvci1pbmxpbmUtbGFiZWwtdG9wJyB9KTtcbiAgICAgICAgb3B0aW9uc0lucHV0TGFiZWwuc2V0VGV4dChcIlZhbHVlc1wiKTtcbiAgICAgICAgY29uc3Qgb3B0aW9uc0lucHV0ID0gbmV3IFRleHRBcmVhQ29tcG9uZW50KG9wdGlvbnNJbnB1dENvbnRhaW5lcik7XG4gICAgICAgIG9wdGlvbnNJbnB1dC5pbnB1dEVsLnJvd3MgPSAzO1xuICAgICAgICBvcHRpb25zSW5wdXQuaW5wdXRFbC5jb2xzID0gMjY7XG4gICAgICAgIHRoaXMuYXR0ciA/IG9wdGlvbnNJbnB1dC5zZXRWYWx1ZSh0aGlzLnR5cGUgPT0gXCJpbnB1dFwiIHx8IHRoaXMudHlwZSA9PSBcImJvb2xlYW5cIiA/IFwiXCIgOiB0aGlzLm9wdGlvbnMuam9pbihcIiwgXCIpKSA6IG9wdGlvbnNJbnB1dC5zZXRQbGFjZWhvbGRlcihcImluc2VydCB2YWx1ZXMsIGNvbW1hIHNlcGFyYXRlZFwiKTtcbiAgICAgICAgIXRoaXMuYXR0ciB8fCB0aGlzLnR5cGUgPT0gXCJpbnB1dFwiIHx8IHRoaXMudHlwZSA9PSBcImJvb2xlYW5cIiA/IG9wdGlvbnNJbnB1dENvbnRhaW5lci5oaWRlKCkgOiBvcHRpb25zSW5wdXRDb250YWluZXIuc2hvdygpO1xuXG4gICAgICAgIC8vIGV2ZW50IGhhbmRsZXJzXG4gICAgICAgIHR5cGVTZWxlY3Qub25DaGFuZ2UodHlwZSA9PiB7XG4gICAgICAgICAgICB0eXBlID09IFwiaW5wdXRcIiB8fCB0eXBlID09IFwiYm9vbGVhblwiID8gb3B0aW9uc0lucHV0Q29udGFpbmVyLmhpZGUoKSA6IG9wdGlvbnNJbnB1dENvbnRhaW5lci5zaG93KCk7XG4gICAgICAgICAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgICAgICB9KVxuICAgICAgICBvcHRpb25zSW5wdXQub25DaGFuZ2UodmFsdWUgPT4gdGhpcy5vcHRpb25zID0gdmFsdWUuc3BsaXQoXCIsXCIpLm1hcChpdGVtID0+IGl0ZW0udHJpbSgpKSk7XG4gICAgICAgIG5hbWVJbnB1dC5vbkNoYW5nZSh2YWx1ZSA9PiB7IHRoaXMubmFtZSA9IHZhbHVlOyBhdHRyTmFtZS5zZXRUZXh0KGA8JHt2YWx1ZX0+YCkgfSk7XG5cbiAgICAgICAgLy8gZm9vdGVyIGJ1dHRvbnNcbiAgICAgICAgY29uc3QgZm9vdGVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcIm1ldGFkYXRhLW1lbnUtdmFsdWUtZ3JpZC1mb290ZXJcIiB9KTtcbiAgICAgICAgY29uc3Qgc2F2ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgc2F2ZUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICBzYXZlQnV0dG9uLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgdGhpcy5maWxlQ2xhc3MudXBkYXRlQXR0cmlidXRlKHRoaXMudHlwZSwgdGhpcy5vcHRpb25zLCB0aGlzLm5hbWUsIHRoaXMuYXR0cik7XG4gICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgIH0pXG4gICAgICAgIGlmICh0aGlzLmF0dHIpIHtcbiAgICAgICAgICAgIGNvbnN0IHJlbW92ZUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgICAgIHJlbW92ZUJ1dHRvbi5zZXRJY29uKFwidHJhc2hcIik7XG4gICAgICAgICAgICByZW1vdmVCdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgY29uc3QgY29uZmlybU1vZGFsID0gbmV3IE1vZGFsKHRoaXMuYXBwKTtcbiAgICAgICAgICAgICAgICBjb25maXJtTW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiUGxlYXNlIGNvbmZpcm1cIik7XG4gICAgICAgICAgICAgICAgY29uZmlybU1vZGFsLmNvbnRlbnRFbC5jcmVhdGVEaXYoKS5zZXRUZXh0KGBEbyB5b3UgcmVhbGx5IHdhbnQgdG8gcmVtb3ZlICR7dGhpcy5hdHRyPy5uYW1lfSBhdHRyaWJ1dGUgZnJvbSAke3RoaXMuZmlsZUNsYXNzLm5hbWV9P2ApO1xuICAgICAgICAgICAgICAgIGNvbnN0IGNvbmZpcm1Gb290ZXIgPSBjb25maXJtTW9kYWwuY29udGVudEVsLmNyZWF0ZURpdih7IGNsczogXCJtZXRhZGF0YS1tZW51LXZhbHVlLWdyaWQtZm9vdGVyXCIgfSk7XG4gICAgICAgICAgICAgICAgY29uc3QgY29uZmlybUJ1dHRvbiA9IG5ldyBCdXR0b25Db21wb25lbnQoY29uZmlybUZvb3Rlcik7XG4gICAgICAgICAgICAgICAgY29uZmlybUJ1dHRvbi5zZXRJY29uKFwiY2hlY2ttYXJrXCIpO1xuICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b24ub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLmF0dHIpIHRoaXMuZmlsZUNsYXNzLnJlbW92ZUF0dHJpYnV0ZSh0aGlzLmF0dHIpO1xuICAgICAgICAgICAgICAgICAgICBjb25maXJtTW9kYWwuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgY29uc3QgZGlzbWlzc0J1dHRvbiA9IG5ldyBFeHRyYUJ1dHRvbkNvbXBvbmVudChjb25maXJtRm9vdGVyKTtcbiAgICAgICAgICAgICAgICBkaXNtaXNzQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgICAgICAgICBkaXNtaXNzQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICAgICAgICAgICAgICBjb25maXJtTW9kYWwub3BlbigpO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBjYW5jZWxCdXR0b24gPSBuZXcgRXh0cmFCdXR0b25Db21wb25lbnQoZm9vdGVyKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLnNldEljb24oXCJjcm9zc1wiKTtcbiAgICAgICAgY2FuY2VsQnV0dG9uLm9uQ2xpY2soKCkgPT4gdGhpcy5jbG9zZSgpKTtcbiAgICB9XG59XG5cbmV4cG9ydCB7IEZpbGVDbGFzc0F0dHJpYnV0ZU1vZGFsIH0iLCAiaW1wb3J0IE1ldGFkYXRhTWVudSBmcm9tIFwibWFpblwiO1xuaW1wb3J0IHsgQXBwLCBURmlsZSwgTWVudSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHZhbHVlTXVsdGlTZWxlY3RNb2RhbCBmcm9tIFwic3JjL29wdGlvbk1vZGFscy92YWx1ZU11bHRpU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB2YWx1ZVRleHRJbnB1dE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL3ZhbHVlVGV4dElucHV0TW9kYWxcIjtcbmltcG9ydCB2YWx1ZVNlbGVjdE1vZGFsIGZyb20gXCJzcmMvb3B0aW9uTW9kYWxzL3ZhbHVlU2VsZWN0TW9kYWxcIjtcbmltcG9ydCBGaWVsZCBmcm9tIFwic3JjL0ZpZWxkXCI7XG5pbXBvcnQgY2hvb3NlU2VjdGlvbk1vZGFsIGZyb20gXCIuLi9vcHRpb25Nb2RhbHMvY2hvb3NlU2VjdGlvbk1vZGFsXCI7XG5pbXBvcnQgU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvU2VsZWN0TW9kYWxcIjtcbmltcG9ydCB7IGNyZWF0ZUZpbGVDbGFzcywgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyByZXBsYWNlVmFsdWVzIH0gZnJvbSBcIi4uL2NvbW1hbmRzL3JlcGxhY2VWYWx1ZXNcIjtcbmltcG9ydCB7IGdldFByb3BlcnR5U2V0dGluZ3MgfSBmcm9tIFwic3JjL2NvbW1hbmRzL2dldFByb3BlcnR5U2V0dGluZ3NcIjtcbmltcG9ydCBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCBmcm9tIFwic3JjL2ZpbGVDbGFzcy9GaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbFwiO1xuaW1wb3J0IHsgZ2VuZXJpY0ZpZWxkUmVnZXggfSBmcm9tIFwiLi4vdXRpbHMvcGFyc2VyXCI7XG5cbmZ1bmN0aW9uIGlzTWVudShjYXRlZ29yeTogTWVudSB8IFNlbGVjdE1vZGFsKTogY2F0ZWdvcnkgaXMgTWVudSB7XG5cdHJldHVybiAoY2F0ZWdvcnkgYXMgTWVudSkuYWRkSXRlbSAhPT0gdW5kZWZpbmVkO1xufTtcblxuZnVuY3Rpb24gaXNTZWxlY3QoY2F0ZWdvcnk6IE1lbnUgfCBTZWxlY3RNb2RhbCk6IGNhdGVnb3J5IGlzIFNlbGVjdE1vZGFsIHtcblx0cmV0dXJuIChjYXRlZ29yeSBhcyBTZWxlY3RNb2RhbCkubW9kYWxzICE9PSB1bmRlZmluZWQ7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBPcHRpb25zTGlzdCB7XG5cdGFwcDogQXBwO1xuXHRmaWxlOiBURmlsZTtcblx0cGx1Z2luOiBNZXRhZGF0YU1lbnU7XG5cdHBhdGg6IHN0cmluZztcblx0Y2F0ZWdvcnk6IE1lbnUgfCBTZWxlY3RNb2RhbDtcblx0ZmlsZUNsYXNzOiBGaWxlQ2xhc3M7XG5cblx0Y29uc3RydWN0b3IocGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlLCBjYXRlZ29yeTogTWVudSB8IFNlbGVjdE1vZGFsKSB7XG5cdFx0dGhpcy5maWxlID0gZmlsZTtcblx0XHR0aGlzLnBsdWdpbiA9IHBsdWdpbjtcblx0XHR0aGlzLmNhdGVnb3J5ID0gY2F0ZWdvcnk7XG5cdH07XG5cblx0cHVibGljIGFzeW5jIGNyZWF0ZUV4dHJhT3B0aW9uTGlzdCgpOiBQcm9taXNlPHZvaWQ+IHtcblx0XHRjb25zdCBmcm9udG1hdHRlciA9IHRoaXMucGx1Z2luLmFwcC5tZXRhZGF0YUNhY2hlLmdldENhY2hlKHRoaXMuZmlsZS5wYXRoKT8uZnJvbnRtYXR0ZXI7XG5cdFx0aWYgKGZyb250bWF0dGVyKSB7XG5cdFx0XHRjb25zdCB7IHBvc2l0aW9uLCAuLi5hdHRyaWJ1dGVzIH0gPSBmcm9udG1hdHRlcjtcblx0XHRcdE9iamVjdC5rZXlzKGF0dHJpYnV0ZXMpLmZvckVhY2goa2V5ID0+IHtcblx0XHRcdFx0aWYgKHRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhrZXkpKSB7XG5cdFx0XHRcdFx0ZGVsZXRlIGF0dHJpYnV0ZXNba2V5XTtcblx0XHRcdFx0fTtcblx0XHRcdH0pO1xuXHRcdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkgeyB0aGlzLmNhdGVnb3J5LmFkZFNlcGFyYXRvcigpOyB9O1xuXHRcdFx0bGV0IGZpbGVDbGFzc0ZvckZpZWxkcyA9IGZhbHNlO1xuXHRcdFx0bGV0IGZpbGVDbGFzc0ZpZWxkczogc3RyaW5nW10gPSBbXTtcblx0XHRcdGNvbnN0IGZpbGVDbGFzc0FsaWFzID0gdGhpcy5wbHVnaW4uc2V0dGluZ3MuZmlsZUNsYXNzQWxpYXM7XG5cdFx0XHRpZiAoT2JqZWN0LmtleXMoYXR0cmlidXRlcykuaW5jbHVkZXMoZmlsZUNsYXNzQWxpYXMpKSB7XG5cdFx0XHRcdGNvbnN0IGZpbGVDbGFzcyA9IGF0dHJpYnV0ZXNbZmlsZUNsYXNzQWxpYXNdO1xuXHRcdFx0XHR0cnkge1xuXHRcdFx0XHRcdGNvbnN0IF9maWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIGZpbGVDbGFzcylcblx0XHRcdFx0XHR0aGlzLmZpbGVDbGFzcyA9IF9maWxlQ2xhc3M7XG5cdFx0XHRcdFx0ZmlsZUNsYXNzRmllbGRzID0gX2ZpbGVDbGFzcy5hdHRyaWJ1dGVzLm1hcChhdHRyID0+IGF0dHIubmFtZSk7XG5cdFx0XHRcdFx0ZmlsZUNsYXNzRm9yRmllbGRzID0gdHJ1ZTtcblx0XHRcdFx0XHRPYmplY3Qua2V5cyhhdHRyaWJ1dGVzKS5mb3JFYWNoKGtleSA9PiB7XG5cdFx0XHRcdFx0XHRpZiAoIWZpbGVDbGFzc0ZpZWxkcy5pbmNsdWRlcyhrZXkpICYmIGtleSAhPSBmaWxlQ2xhc3NBbGlhcykge1xuXHRcdFx0XHRcdFx0XHRkZWxldGUgYXR0cmlidXRlc1trZXldO1xuXHRcdFx0XHRcdFx0fTtcblx0XHRcdFx0XHR9KTtcblx0XHRcdFx0XHRjb25zdCBmaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCA9IG5ldyBGaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlQ2xhc3MuZ2V0Q2xhc3NGaWxlKCkpO1xuXHRcdFx0XHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdFx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkU2VwYXJhdG9yKCk7XG5cdFx0XHRcdFx0XHR0aGlzLmNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0XHRcdFx0aXRlbS5zZXRJY29uKFwiZ2VhclwiKTtcblx0XHRcdFx0XHRcdFx0aXRlbS5zZXRUaXRsZShgTWFuYWdlIDwke3RoaXMuZmlsZUNsYXNzLm5hbWV9PiBmaWVsZHNgKTtcblx0XHRcdFx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQpID0+IHtcblx0XHRcdFx0XHRcdFx0XHRmaWxlQ2xhc3NBdHRyaWJ1dGVTZWxlY3RNb2RhbC5vcGVuKCk7XG5cdFx0XHRcdFx0XHRcdH0pO1xuXHRcdFx0XHRcdFx0fSk7XG5cdFx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkT3B0aW9uKFwibWFuYWdlX2ZpbGVDbGFzc19hdHRyaWJ1dGVzXCIsIFwiTWFuYWdlIGZpbGVDbGFzcyBhdHRyaWJ1dGVzXCIpO1xuXHRcdFx0XHRcdFx0dGhpcy5jYXRlZ29yeS5tb2RhbHNbXCJhZGRfZmllbGRfYXRfc2VjdGlvblwiXSA9ICgpID0+IGZpbGVDbGFzc0F0dHJpYnV0ZVNlbGVjdE1vZGFsLm9wZW4oKTtcblx0XHRcdFx0XHR9O1xuXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5jcmVhdGVFeHRyYU9wdGlvbnNMaXN0Rm9yRnJvbnRtYXR0ZXIoYXR0cmlidXRlcywpXG5cdFx0XHRcdFx0YXdhaXQgdGhpcy5jcmVhdGVFeHRyYU9wdGlvbnNMaXN0Rm9ySW5saW5lRmllbGRzKHRoaXMuZmlsZSwgZmlsZUNsYXNzRm9yRmllbGRzLCBmaWxlQ2xhc3NGaWVsZHMpXG5cdFx0XHRcdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkgeyB0aGlzLmNhdGVnb3J5LmFkZFNlcGFyYXRvcigpIH07XG5cdFx0XHRcdFx0dGhpcy5hZGRTZWN0aW9uU2VsZWN0TW9kYWxPcHRpb24oKTtcblx0XHRcdFx0fSBjYXRjaCAoZXJyb3IpIHtcblx0XHRcdFx0XHRhd2FpdCB0aGlzLmNyZWF0ZUV4dHJhT3B0aW9uc0xpc3RGb3JGcm9udG1hdHRlcihhdHRyaWJ1dGVzKVxuXHRcdFx0XHRcdGF3YWl0IHRoaXMuY3JlYXRlRXh0cmFPcHRpb25zTGlzdEZvcklubGluZUZpZWxkcyh0aGlzLmZpbGUpXG5cdFx0XHRcdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkgeyB0aGlzLmNhdGVnb3J5LmFkZFNlcGFyYXRvcigpOyB9O1xuXHRcdFx0XHRcdHRoaXMuYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk7XG5cdFx0XHRcdH07XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHRhd2FpdCB0aGlzLmNyZWF0ZUV4dHJhT3B0aW9uc0xpc3RGb3JGcm9udG1hdHRlcihhdHRyaWJ1dGVzKVxuXHRcdFx0XHRhd2FpdCB0aGlzLmNyZWF0ZUV4dHJhT3B0aW9uc0xpc3RGb3JJbmxpbmVGaWVsZHModGhpcy5maWxlKVxuXHRcdFx0XHRpZiAoaXNNZW51KHRoaXMuY2F0ZWdvcnkpKSB7IHRoaXMuY2F0ZWdvcnkuYWRkU2VwYXJhdG9yKCk7IH07XG5cdFx0XHRcdHRoaXMuYWRkU2VjdGlvblNlbGVjdE1vZGFsT3B0aW9uKCk7XG5cdFx0XHR9O1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRhd2FpdCB0aGlzLmNyZWF0ZUV4dHJhT3B0aW9uc0xpc3RGb3JJbmxpbmVGaWVsZHModGhpcy5maWxlKVxuXHRcdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkgeyB0aGlzLmNhdGVnb3J5LmFkZFNlcGFyYXRvcigpOyB9O1xuXHRcdFx0dGhpcy5hZGRTZWN0aW9uU2VsZWN0TW9kYWxPcHRpb24oKTtcblx0XHR9O1xuXHR9O1xuXG5cdHByaXZhdGUgYXN5bmMgY3JlYXRlRXh0cmFPcHRpb25zTGlzdEZvcklubGluZUZpZWxkcyhmaWxlOiBURmlsZSwgZmlsZUNsYXNzRm9yRmllbGRzOiBib29sZWFuID0gZmFsc2UsIGZpbGVDbGFzc0ZpZWxkczogc3RyaW5nW10gPSBbXSk6IFByb21pc2U8dm9pZD4ge1xuXHRcdGxldCBhdHRyaWJ1dGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge307XG5cdFx0Y29uc3QgcmVnZXggPSBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH06OlxccyooPzx2YWx1ZXM+LispP2AsIFwidVwiKTtcblx0XHRjb25zdCByZXN1bHQgPSBhd2FpdCB0aGlzLnBsdWdpbi5hcHAudmF1bHQucmVhZChmaWxlKVxuXHRcdHJlc3VsdC5zcGxpdCgnXFxuJykubWFwKGxpbmUgPT4ge1xuXHRcdFx0Y29uc3QgcmVnZXhSZXN1bHQgPSBsaW5lLm1hdGNoKHJlZ2V4KTtcblx0XHRcdGNvbnN0IHsgYXR0cmlidXRlLCB2YWx1ZXMgfSA9IHJlZ2V4UmVzdWx0Py5ncm91cHMgfHwge31cblx0XHRcdGlmIChhdHRyaWJ1dGUgJiYgIXRoaXMucGx1Z2luLnNldHRpbmdzLmdsb2JhbGx5SWdub3JlZEZpZWxkcy5pbmNsdWRlcyhhdHRyaWJ1dGUudHJpbSgpKSkge1xuXHRcdFx0XHRpZiAoZmlsZUNsYXNzRm9yRmllbGRzKSB7XG5cdFx0XHRcdFx0aWYgKGZpbGVDbGFzc0ZpZWxkcy5pbmNsdWRlcyhhdHRyaWJ1dGUudHJpbSgpKSkge1xuXHRcdFx0XHRcdFx0YXR0cmlidXRlc1thdHRyaWJ1dGUudHJpbSgpXSA9IHZhbHVlcyA/IHZhbHVlcy50cmltKCkgOiBcIlwiO1xuXHRcdFx0XHRcdH07XG5cdFx0XHRcdH0gZWxzZSB7XG5cdFx0XHRcdFx0YXR0cmlidXRlc1thdHRyaWJ1dGUudHJpbSgpXSA9IHZhbHVlcyA/IHZhbHVlcy50cmltKCkgOiBcIlwiO1xuXHRcdFx0XHR9O1xuXHRcdFx0fTtcblx0XHR9KTtcblx0XHRpZiAoT2JqZWN0LmtleXMoYXR0cmlidXRlcykubGVuZ3RoID4gMCkge1xuXHRcdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkgeyB0aGlzLmNhdGVnb3J5LmFkZFNlcGFyYXRvcigpOyB9O1xuXHRcdFx0dGhpcy5idWlsZEV4dHJhT3B0aW9uc0xpc3QoYXR0cmlidXRlcyk7XG5cdFx0fTtcblx0fTtcblxuXHRwcml2YXRlIGFzeW5jIGNyZWF0ZUV4dHJhT3B0aW9uc0xpc3RGb3JGcm9udG1hdHRlcihhdHRyaWJ1dGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KSB7XG5cdFx0dGhpcy5idWlsZEV4dHJhT3B0aW9uc0xpc3QoYXR0cmlidXRlcywpO1xuXHR9O1xuXG5cdGJ1aWxkRXh0cmFPcHRpb25zTGlzdChhdHRyaWJ1dGVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+KSB7XG5cdFx0T2JqZWN0LmtleXMoYXR0cmlidXRlcykuZm9yRWFjaCgoa2V5OiBzdHJpbmcpID0+IHtcblx0XHRcdGNvbnN0IHZhbHVlID0gYXR0cmlidXRlc1trZXldO1xuXHRcdFx0Y29uc3QgcHJvcGVydHlTZXR0aW5ncyA9IGdldFByb3BlcnR5U2V0dGluZ3ModGhpcy5wbHVnaW4sIGtleSwgdGhpcy5maWxlQ2xhc3MpO1xuXHRcdFx0aWYgKHByb3BlcnR5U2V0dGluZ3M/LnZhbHVlcyAmJiAhcHJvcGVydHlTZXR0aW5ncz8uaXNCb29sZWFuKSB7XG5cdFx0XHRcdGlmIChwcm9wZXJ0eVNldHRpbmdzLmlzQ3ljbGUpIHtcblx0XHRcdFx0XHR0aGlzLmFkZEN5Y2xlTWVudU9wdGlvbihrZXksIHZhbHVlLCBwcm9wZXJ0eVNldHRpbmdzKTtcblx0XHRcdFx0fSBlbHNlIGlmIChwcm9wZXJ0eVNldHRpbmdzLmlzTXVsdGkpIHtcblx0XHRcdFx0XHR0aGlzLmFkZE11bHRpTWVudU9wdGlvbihrZXksIHZhbHVlLCBwcm9wZXJ0eVNldHRpbmdzKTtcblx0XHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0XHR0aGlzLmFkZFNlbGVjdE1lbnVPcHRpb24oa2V5LCB2YWx1ZSwgcHJvcGVydHlTZXR0aW5ncyk7XG5cdFx0XHRcdH07XG5cdFx0XHR9IGVsc2UgaWYgKHByb3BlcnR5U2V0dGluZ3M/LmlzQm9vbGVhbikge1xuXHRcdFx0XHRsZXQgdG9Cb29sZWFuVmFsdWU6IGJvb2xlYW4gPSBmYWxzZTtcblx0XHRcdFx0aWYgKGlzQm9vbGVhbih2YWx1ZSkpIHtcblx0XHRcdFx0XHR0b0Jvb2xlYW5WYWx1ZSA9IHZhbHVlO1xuXHRcdFx0XHR9IGVsc2UgaWYgKC90cnVlL2kudGVzdCh2YWx1ZSkpIHtcblx0XHRcdFx0XHR0b0Jvb2xlYW5WYWx1ZSA9IHRydWU7XG5cdFx0XHRcdH0gZWxzZSBpZiAoL2ZhbHNlL2kudGVzdCh2YWx1ZSkpIHtcblx0XHRcdFx0XHR0b0Jvb2xlYW5WYWx1ZSA9IGZhbHNlO1xuXHRcdFx0XHR9O1xuXHRcdFx0XHR0aGlzLmFkZFRvZ2dsZU1lbnVPcHRpb24oa2V5LCB0b0Jvb2xlYW5WYWx1ZSk7XG5cdFx0XHR9IGVsc2Uge1xuXHRcdFx0XHR0aGlzLmFkZFRleHRJbnB1dE1lbnVPcHRpb24oa2V5LCB2YWx1ZSA/IHZhbHVlLnRvU3RyaW5nKCkgOiBcIlwiKTtcblx0XHRcdH07XG5cdFx0fSk7XG5cdH07XG5cblx0cHJpdmF0ZSBhZGRTZWN0aW9uU2VsZWN0TW9kYWxPcHRpb24oKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBuZXcgY2hvb3NlU2VjdGlvbk1vZGFsKHRoaXMucGx1Z2luLCB0aGlzLmZpbGUsIHRoaXMuZmlsZUNsYXNzKTtcblx0XHRpZiAoaXNNZW51KHRoaXMuY2F0ZWdvcnkpKSB7XG5cdFx0XHR0aGlzLmNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRJY29uKFwicGVuY2lsXCIpO1xuXHRcdFx0XHRpdGVtLnNldFRpdGxlKFwiQWRkIGZpZWxkIGF0IHNlY3Rpb24uLi5cIik7XG5cdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwidGFyZ2V0LW1ldGFkYXRhXCIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChpc1NlbGVjdCh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5hZGRPcHRpb24oXCJhZGRfZmllbGRfYXRfc2VjdGlvblwiLCBcIkFkZCBmaWVsZCBhdCBzZWN0aW9uLi4uXCIpO1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5tb2RhbHNbXCJhZGRfZmllbGRfYXRfc2VjdGlvblwiXSA9ICgpID0+IG1vZGFsLm9wZW4oKTtcblx0XHR9O1xuXHR9O1xuXG5cdHByaXZhdGUgYWRkQ3ljbGVNZW51T3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgcHJvcGVydHlTZXR0aW5nczogRmllbGQpOiB2b2lkIHtcblx0XHRjb25zdCB2YWx1ZXMgPSBwcm9wZXJ0eVNldHRpbmdzLnZhbHVlcztcblx0XHRjb25zdCBrZXlzID0gT2JqZWN0LmtleXModmFsdWVzKTtcblx0XHRjb25zdCBrZXlGb3JWYWx1ZSA9IGtleXMuZmluZChrZXkgPT4gdmFsdWVzW2tleV0gPT09IHZhbHVlKTtcblx0XHRsZXQgbmV4dFZhbHVlOiBzdHJpbmc7XG5cdFx0aWYgKGtleUZvclZhbHVlKSB7XG5cdFx0XHRjb25zdCBuZXh0S2V5ID0ga2V5c1soa2V5cy5pbmRleE9mKGtleUZvclZhbHVlKSArIDEpICUga2V5cy5sZW5ndGhdO1xuXHRcdFx0bmV4dFZhbHVlID0gdmFsdWVzW25leHRLZXldO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRuZXh0VmFsdWUgPSB2YWx1ZXNbT2JqZWN0LmtleXModmFsdWVzKVswXV07XG5cdFx0fTtcblx0XHRpZiAoaXNNZW51KHRoaXMuY2F0ZWdvcnkpKSB7XG5cdFx0XHR0aGlzLmNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRUaXRsZShgJHtuYW1lfSA6ICR7dmFsdWV9IFx1MjVCNyAke25leHRWYWx1ZX1gKTtcblx0XHRcdFx0aXRlbS5zZXRJY29uKCdzd2l0Y2gnKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHtcblx0XHRcdFx0XHRyZXBsYWNlVmFsdWVzKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5maWxlLCBuYW1lLCBuZXh0VmFsdWUpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwidGFyZ2V0LW1ldGFkYXRhXCIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChpc1NlbGVjdCh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5hZGRPcHRpb24oYCR7bmFtZX1fJHt2YWx1ZX1fJHtuZXh0VmFsdWV9YCwgYCR7bmFtZX0gOiAke3ZhbHVlfSBcdTI1QjcgJHtuZXh0VmFsdWV9YCk7XG5cdFx0XHR0aGlzLmNhdGVnb3J5Lm1vZGFsc1tgJHtuYW1lfV8ke3ZhbHVlfV8ke25leHRWYWx1ZX1gXSA9ICgpID0+XG5cdFx0XHRcdHJlcGxhY2VWYWx1ZXModGhpcy5wbHVnaW4uYXBwLCB0aGlzLmZpbGUsIG5hbWUsIG5leHRWYWx1ZSk7XG5cdFx0fTtcblx0fTtcblxuXHRwcml2YXRlIGFkZE11bHRpTWVudU9wdGlvbihuYW1lOiBzdHJpbmcsIHZhbHVlOiBzdHJpbmcsIHByb3BlcnR5U2V0dGluZ3M6IEZpZWxkKTogdm9pZCB7XG5cdFx0Y29uc3QgbW9kYWwgPSBuZXcgdmFsdWVNdWx0aVNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5maWxlLCBuYW1lLCB2YWx1ZSwgcHJvcGVydHlTZXR0aW5ncyk7XG5cdFx0bW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlc1wiKTtcblx0XHRpZiAoaXNNZW51KHRoaXMuY2F0ZWdvcnkpKSB7XG5cdFx0XHR0aGlzLmNhdGVnb3J5LmFkZEl0ZW0oKGl0ZW0pID0+IHtcblx0XHRcdFx0aXRlbS5zZXRUaXRsZShgVXBkYXRlIDwke25hbWV9PmApO1xuXHRcdFx0XHRpdGVtLnNldEljb24oJ2J1bGxldC1saXN0Jyk7XG5cdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiB7XG5cdFx0XHRcdFx0bW9kYWwub3BlbigpO1xuXHRcdFx0XHR9KTtcblx0XHRcdFx0aXRlbS5zZXRTZWN0aW9uKFwidGFyZ2V0LW1ldGFkYXRhXCIpO1xuXHRcdFx0fSk7XG5cdFx0fSBlbHNlIGlmIChpc1NlbGVjdCh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5hZGRPcHRpb24oYHVwZGF0ZV8ke25hbWV9YCwgYFVwZGF0ZSA8JHtuYW1lfT5gKTtcblx0XHRcdHRoaXMuY2F0ZWdvcnkubW9kYWxzW2B1cGRhdGVfJHtuYW1lfWBdID0gKCkgPT4gbW9kYWwub3BlbigpO1xuXHRcdH07XG5cdH07XG5cblx0cHJpdmF0ZSBhZGRTZWxlY3RNZW51T3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZywgcHJvcGVydHlTZXR0aW5nczogRmllbGQpOiB2b2lkIHtcblx0XHRjb25zdCBtb2RhbCA9IG5ldyB2YWx1ZVNlbGVjdE1vZGFsKHRoaXMucGx1Z2luLmFwcCwgdGhpcy5maWxlLCBuYW1lLCB2YWx1ZSwgcHJvcGVydHlTZXR0aW5ncyk7XG5cdFx0bW9kYWwudGl0bGVFbC5zZXRUZXh0KFwiU2VsZWN0IHZhbHVlXCIpO1xuXHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRpdGVtLnNldFRpdGxlKGBVcGRhdGUgJHtuYW1lfWApO1xuXHRcdFx0XHRpdGVtLnNldEljb24oJ3JpZ2h0LXRyaWFuZ2xlJyk7XG5cdFx0XHRcdGl0ZW0ub25DbGljaygoZXZ0OiBNb3VzZUV2ZW50KSA9PiBtb2RhbC5vcGVuKCkpO1xuXHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJ0YXJnZXQtbWV0YWRhdGFcIik7XG5cdFx0XHR9KTtcblx0XHR9IGVsc2UgaWYgKGlzU2VsZWN0KHRoaXMuY2F0ZWdvcnkpKSB7XG5cdFx0XHR0aGlzLmNhdGVnb3J5LmFkZE9wdGlvbihgdXBkYXRlXyR7bmFtZX1gLCBgVXBkYXRlIDwke25hbWV9PmApO1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5tb2RhbHNbYHVwZGF0ZV8ke25hbWV9YF0gPSAoKSA9PiBtb2RhbC5vcGVuKCk7XG5cdFx0fTtcblx0fTtcblxuXHRwcml2YXRlIGFkZFRvZ2dsZU1lbnVPcHRpb24obmFtZTogc3RyaW5nLCB2YWx1ZTogYm9vbGVhbik6IHZvaWQge1xuXHRcdGlmIChpc01lbnUodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkSXRlbSgoaXRlbSkgPT4ge1xuXHRcdFx0XHRpdGVtLnNldFRpdGxlKGA8JHtuYW1lfT4gJHt2YWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIn1gKTtcblx0XHRcdFx0aXRlbS5zZXRJY29uKCdjaGVja21hcmsnKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IHsgcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbi5hcHAsIHRoaXMuZmlsZSwgbmFtZSwgKCF2YWx1ZSkudG9TdHJpbmcoKSk7IH0pO1xuXHRcdFx0XHRpdGVtLnNldFNlY3Rpb24oXCJ0YXJnZXQtbWV0YWRhdGFcIik7XG5cdFx0XHR9KVxuXHRcdH0gZWxzZSBpZiAoaXNTZWxlY3QodGhpcy5jYXRlZ29yeSkpIHtcblx0XHRcdHRoaXMuY2F0ZWdvcnkuYWRkT3B0aW9uKGB1cGRhdGVfJHtuYW1lfWAsIGA8JHtuYW1lfT4gJHt2YWx1ZSA/IFwiXHUyNzA1IFx1MjVCNyBcdTI3NENcIiA6IFwiXHUyNzRDIFx1MjVCNyBcdTI3MDVcIn1gKTtcblx0XHRcdHRoaXMuY2F0ZWdvcnkubW9kYWxzW2B1cGRhdGVfJHtuYW1lfWBdID0gKCkgPT4gcmVwbGFjZVZhbHVlcyh0aGlzLnBsdWdpbi5hcHAsIHRoaXMuZmlsZSwgbmFtZSwgKCF2YWx1ZSkudG9TdHJpbmcoKSk7O1xuXHRcdH07XG5cdH07XG5cblx0cHJpdmF0ZSBhZGRUZXh0SW5wdXRNZW51T3B0aW9uKG5hbWU6IHN0cmluZywgdmFsdWU6IHN0cmluZyk6IHZvaWQge1xuXHRcdGNvbnN0IG1vZGFsID0gbmV3IHZhbHVlVGV4dElucHV0TW9kYWwodGhpcy5wbHVnaW4uYXBwLCB0aGlzLmZpbGUsIG5hbWUsIHZhbHVlKTtcblx0XHRtb2RhbC50aXRsZUVsLnNldFRleHQoYENoYW5nZSBWYWx1ZSBmb3IgPCR7bmFtZX0+YCk7XG5cdFx0aWYgKGlzTWVudSh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5hZGRJdGVtKChpdGVtKSA9PiB7XG5cdFx0XHRcdGl0ZW0uc2V0VGl0bGUoYFVwZGF0ZSA8JHtuYW1lfT5gKTtcblx0XHRcdFx0aXRlbS5zZXRJY29uKCdwZW5jaWwnKTtcblx0XHRcdFx0aXRlbS5vbkNsaWNrKChldnQ6IE1vdXNlRXZlbnQpID0+IG1vZGFsLm9wZW4oKSk7XG5cdFx0XHRcdGl0ZW0uc2V0U2VjdGlvbihcInRhcmdldC1tZXRhZGF0YVwiKTtcblx0XHRcdH0pXG5cdFx0fSBlbHNlIGlmIChpc1NlbGVjdCh0aGlzLmNhdGVnb3J5KSkge1xuXHRcdFx0dGhpcy5jYXRlZ29yeS5hZGRPcHRpb24oYHVwZGF0ZV8ke25hbWV9YCwgYFVwZGF0ZSA8JHtuYW1lfT5gKTtcblx0XHRcdHRoaXMuY2F0ZWdvcnkubW9kYWxzW2B1cGRhdGVfJHtuYW1lfWBdID0gKCkgPT4gbW9kYWwub3BlbigpO1xuXHRcdH07XG5cdH07XG59O1xuIiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIFRGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgTWV0YWRhdGFNZW51IGZyb20gXCJtYWluXCI7XG5pbXBvcnQgT3B0aW9uc0xpc3QgZnJvbSBcInNyYy9vcHRpb25zL09wdGlvbnNMaXN0XCI7XG5pbXBvcnQgU2VsZWN0TW9kYWwgZnJvbSBcInNyYy9vcHRpb25Nb2RhbHMvU2VsZWN0TW9kYWxcIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTm90ZUZpZWxkc0NvbW1hbmRzTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgcHVibGljIGFwcDogQXBwO1xuICAgIHByaXZhdGUgcGx1Z2luOiBNZXRhZGF0YU1lbnU7XG4gICAgcHJpdmF0ZSBmaWxlOiBURmlsZTtcbiAgICBwcml2YXRlIHNlbGVjdDogU2VsZWN0TW9kYWw7XG4gICAgcHJpdmF0ZSBvcHRpb25zTGlzdDogT3B0aW9uc0xpc3Q7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUsIGZpbGU6IFRGaWxlKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMuYXBwID0gYXBwO1xuICAgICAgICB0aGlzLnBsdWdpbiA9IHBsdWdpbjtcbiAgICAgICAgdGhpcy5maWxlID0gZmlsZTtcbiAgICB9O1xuXG4gICAgYXN5bmMgb25PcGVuKCkge1xuICAgICAgICB0aGlzLnRpdGxlRWwuc2V0VGV4dChgU2VsZWN0IHRoZSBmaWVsZCB0byBtYW5hZ2VgKTtcbiAgICAgICAgdGhpcy5jb250YWluZXJFbC5hZGRDbGFzcyhcIm1ldGFkYXRhLW1lbnVcIik7XG4gICAgICAgIGNvbnN0IG9wdGlvbnNMaXN0Q29udGFpbmVyID0gdGhpcy5jb250ZW50RWwuY3JlYXRlRGl2KHsgY2xzOiBcImZpZWxkLW9wdGlvbnNcIn0pO1xuXG4gICAgICAgIHRoaXMuc2VsZWN0ID0gbmV3IFNlbGVjdE1vZGFsKG9wdGlvbnNMaXN0Q29udGFpbmVyKTtcbiAgICAgICAgdGhpcy5zZWxlY3QuYWRkT3B0aW9uKFwiLS0tXCIsIFwiQ2hvb3NlIEZpZWxkXCIpO1xuICAgICAgICBcbiAgICAgICAgdGhpcy5vcHRpb25zTGlzdCA9IG5ldyBPcHRpb25zTGlzdCh0aGlzLnBsdWdpbiwgdGhpcy5maWxlLCB0aGlzLnNlbGVjdCk7XG4gICAgICAgIGF3YWl0IHRoaXMub3B0aW9uc0xpc3QuY3JlYXRlRXh0cmFPcHRpb25MaXN0KCk7XG4gICAgICAgIHRoaXMuc2VsZWN0Lm9uQ2hhbmdlKCh2YWx1ZSkgPT4ge1xuICAgICAgICAgICAgdGhpcy5zZWxlY3QubW9kYWxzW3ZhbHVlXSgpO1xuICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICB9KTtcbiAgICAgICAgdGhpcy5zZWxlY3Quc2VsZWN0RWwuZm9jdXMoKTtcbiAgICB9O1xufTsiLCAiaW1wb3J0IHsgRHJvcGRvd25Db21wb25lbnQgfSBmcm9tIFwib2JzaWRpYW5cIjtcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2VsZWN0TW9kYWwgZXh0ZW5kcyBEcm9wZG93bkNvbXBvbmVudCB7XG4gICAgcHVibGljIG1vZGFsczogUmVjb3JkPHN0cmluZywgYW55PjtcblxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lckVsOiBIVE1MRWxlbWVudCkge1xuICAgICAgICBzdXBlcihjb250YWluZXJFbCk7XG4gICAgICAgIHRoaXMubW9kYWxzID0ge307XG4gICAgfTtcbn07IiwgImltcG9ydCBNZXRhZGF0YU1lbnUgZnJvbSBcIm1haW5cIjtcbmltcG9ydCB7XG4gICAgQXBwLFxuICAgIEVkaXRvcixcbiAgICBFZGl0b3JQb3NpdGlvbixcbiAgICBFZGl0b3JTdWdnZXN0LFxuICAgIEVkaXRvclN1Z2dlc3RDb250ZXh0LFxuICAgIEVkaXRvclN1Z2dlc3RUcmlnZ2VySW5mbyxcbiAgICBNYXJrZG93blZpZXcsXG4gICAgVEZpbGUsXG4gICAgcGFyc2VZYW1sLFxuICAgIE5vdGljZVxufSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IGNyZWF0ZUZpbGVDbGFzcywgRmlsZUNsYXNzIH0gZnJvbSBcInNyYy9maWxlQ2xhc3MvZmlsZUNsYXNzXCI7XG5pbXBvcnQgeyBnZW5lcmljRmllbGRSZWdleCB9IGZyb20gXCIuLi91dGlscy9wYXJzZXJcIjtcblxuaW50ZXJmYWNlIElWYWx1ZUNvbXBsZXRpb24ge1xuICAgIHZhbHVlOiBzdHJpbmc7XG59O1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBWYWx1ZVN1Z2dlc3QgZXh0ZW5kcyBFZGl0b3JTdWdnZXN0PElWYWx1ZUNvbXBsZXRpb24+IHtcbiAgICBwcml2YXRlIHBsdWdpbjogTWV0YWRhdGFNZW51O1xuICAgIHByaXZhdGUgYXBwOiBBcHA7XG4gICAgcHJpdmF0ZSBmaWxlQ2xhc3M6IEZpbGVDbGFzcztcbiAgICBwcml2YXRlIGluRnJvbnRtYXR0ZXI6IGJvb2xlYW4gPSBmYWxzZTtcbiAgICBwcml2YXRlIGRpZFNlbGVjdDogYm9vbGVhbiA9IGZhbHNlXG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcGx1Z2luOiBNZXRhZGF0YU1lbnUpIHtcbiAgICAgICAgc3VwZXIoYXBwKTtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgICAgIHRoaXMucGx1Z2luID0gcGx1Z2luO1xuICAgICAgICB0aGlzLnNldEluc3RydWN0aW9ucyhbeyBjb21tYW5kOiBcIlNoaWZ0XCIsIHB1cnBvc2U6IFwicHV0IGEgc3BhY2UgYWZ0ZXI6OlwiIH1dKTtcblxuICAgICAgICAvLyBAdHMtaWdub3JlXG4gICAgICAgIHRoaXMuc2NvcGUucmVnaXN0ZXIoW1wiU2hpZnRcIl0sIFwiRW50ZXJcIiwgKGV2dDogS2V5Ym9hcmRFdmVudCkgPT4ge1xuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxuICAgICAgICAgICAgdGhpcy5zdWdnZXN0aW9ucy51c2VTZWxlY3RlZEl0ZW0oZXZ0KTtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfSk7XG4gICAgfTtcblxuICAgIG9uVHJpZ2dlcihcbiAgICAgICAgY3Vyc29yOiBFZGl0b3JQb3NpdGlvbixcbiAgICAgICAgZWRpdG9yOiBFZGl0b3IsXG4gICAgICAgIGZpbGU6IFRGaWxlXG4gICAgKTogRWRpdG9yU3VnZ2VzdFRyaWdnZXJJbmZvIHwgbnVsbCB7XG4gICAgICAgIGlmICh0aGlzLmRpZFNlbGVjdCkge1xuICAgICAgICAgICAgdGhpcy5kaWRTZWxlY3QgPSBmYWxzZVxuICAgICAgICAgICAgcmV0dXJuIG51bGxcbiAgICAgICAgfVxuICAgICAgICBpZiAoIXRoaXMucGx1Z2luLnNldHRpbmdzLmlzQXV0b3N1Z2dlc3RFbmFibGVkKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfTtcbiAgICAgICAgLy9AdHMtaWdub3JlXG4gICAgICAgIGNvbnN0IGZyb250bWF0dGVyID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0RmlsZUNhY2hlKGZpbGUpLmZyb250bWF0dGVyO1xuXG4gICAgICAgIHRoaXMuaW5Gcm9udG1hdHRlciA9IGZyb250bWF0dGVyICE9PSB1bmRlZmluZWQgJiYgZnJvbnRtYXR0ZXIucG9zaXRpb24uc3RhcnQubGluZSA8IGN1cnNvci5saW5lICYmIGN1cnNvci5saW5lIDwgZnJvbnRtYXR0ZXIucG9zaXRpb24uZW5kLmxpbmVcbiAgICAgICAgY29uc3QgcmVnZXggPSB0aGlzLmluRnJvbnRtYXR0ZXIgPyBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH06KD88dmFsdWVzPi4qKWAsIFwidVwiKSA6IG5ldyBSZWdFeHAoYF4ke2dlbmVyaWNGaWVsZFJlZ2V4fTo6KD88dmFsdWVzPi4qKWAsIFwidVwiKVxuICAgICAgICBjb25zdCBmdWxsTGluZSA9IGVkaXRvci5nZXRMaW5lKGVkaXRvci5nZXRDdXJzb3IoKS5saW5lKVxuICAgICAgICBpZiAoIXJlZ2V4LnRlc3QoZnVsbExpbmUpKSB7XG4gICAgICAgICAgICByZXR1cm4gbnVsbFxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBzdGFydDogY3Vyc29yLFxuICAgICAgICAgICAgZW5kOiBjdXJzb3IsXG4gICAgICAgICAgICBxdWVyeTogZWRpdG9yLmdldExpbmUoY3Vyc29yLmxpbmUpLFxuICAgICAgICB9O1xuICAgIH07XG5cbiAgICBwcml2YXRlIGZpbHRlck9wdGlvbiA9IChmaXJzdFZhbHVlczogc3RyaW5nW10gfCB1bmRlZmluZWQsIGxhc3RWYWx1ZTogc3RyaW5nIHwgdW5kZWZpbmVkLCBvcHRpb246IHN0cmluZyk6IGJvb2xlYW4gPT4ge1xuICAgICAgICByZXR1cm4gIWZpcnN0VmFsdWVzIHx8ICFmaXJzdFZhbHVlcz8uY29udGFpbnMob3B0aW9uKSAmJiAoIWxhc3RWYWx1ZSB8fCAhIWxhc3RWYWx1ZSAmJiBvcHRpb24uY29udGFpbnMobGFzdFZhbHVlKSlcbiAgICB9XG5cbiAgICBhc3luYyBnZXRTdWdnZXN0aW9ucyhjb250ZXh0OiBFZGl0b3JTdWdnZXN0Q29udGV4dCk6IFByb21pc2U8SVZhbHVlQ29tcGxldGlvbltdPiB7XG4gICAgICAgIGNvbnN0IHN1Z2dlc3Rpb25zID0gYXdhaXQgdGhpcy5nZXRWYWx1ZVN1Z2dlc3Rpb25zKGNvbnRleHQpO1xuICAgICAgICBpZiAoc3VnZ2VzdGlvbnMubGVuZ3RoKSB7XG4gICAgICAgICAgICByZXR1cm4gc3VnZ2VzdGlvbnM7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG5cbiAgICBhc3luYyBnZXRWYWx1ZVN1Z2dlc3Rpb25zKGNvbnRleHQ6IEVkaXRvclN1Z2dlc3RDb250ZXh0KTogUHJvbWlzZTxJVmFsdWVDb21wbGV0aW9uW10+IHtcbiAgICAgICAgY29uc3QgbGluZSA9IGNvbnRleHQuc3RhcnQubGluZTtcbiAgICAgICAgbGV0IHJlZ2V4O1xuICAgICAgICBpZiAoIXRoaXMuaW5Gcm9udG1hdHRlcikge1xuICAgICAgICAgICAgcmVnZXggPSBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH06Oig/PHZhbHVlcz4uKyk/YCwgXCJ1XCIpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVnZXggPSBuZXcgUmVnRXhwKGBeJHtnZW5lcmljRmllbGRSZWdleH06KD88dmFsdWVzPi4rKT9gLCBcInVcIik7XG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IHJlZ2V4UmVzdWx0ID0gY29udGV4dC5lZGl0b3IuZ2V0UmFuZ2UoeyBsaW5lOiBsaW5lLCBjaDogMCB9LCBjb250ZXh0LmVuZCkubWF0Y2gocmVnZXgpO1xuXG4gICAgICAgIGlmIChyZWdleFJlc3VsdCAmJiByZWdleFJlc3VsdC5ncm91cHM/LmF0dHJpYnV0ZSkge1xuICAgICAgICAgICAgY29uc3QgZmllbGROYW1lID0gcmVnZXhSZXN1bHQuZ3JvdXBzLmF0dHJpYnV0ZTtcbiAgICAgICAgICAgIGNvbnN0IHZhbHVlc0xpc3QgPSByZWdleFJlc3VsdC5ncm91cHMudmFsdWVzPy5yZXBsYWNlKC9eXFxbfF5cXHNcXFsvLCAnJykucmVwbGFjZSgvXFxdJC8sICcnKS5zcGxpdChcIixcIikubWFwKG8gPT4gby50cmltKCkpXG4gICAgICAgICAgICBjb25zdCBsYXN0VmFsdWUgPSB2YWx1ZXNMaXN0Py5sYXN0KClcbiAgICAgICAgICAgIGNvbnN0IGZpcnN0VmFsdWVzID0gdmFsdWVzTGlzdD8uc2xpY2UoMCwgLTEpXG4gICAgICAgICAgICAvL3RhZ3Mgc3BlY2lmaWMgY2FzXG4gICAgICAgICAgICBpZiAoZmllbGROYW1lID09PSBcInRhZ3NcIiAmJiB0aGlzLmluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgICAgICAvL0B0cy1pZ25vcmVcbiAgICAgICAgICAgICAgICByZXR1cm4gT2JqZWN0LmtleXModGhpcy5hcHAubWV0YWRhdGFDYWNoZS5nZXRUYWdzKCkpXG4gICAgICAgICAgICAgICAgICAgIC5maWx0ZXIodCA9PiBsYXN0VmFsdWUgPyB0LmNvbnRhaW5zKGxhc3RWYWx1ZSkgOiB0KVxuICAgICAgICAgICAgICAgICAgICAuc29ydCgpXG4gICAgICAgICAgICAgICAgICAgIC5tYXAodGFnID0+IE9iamVjdCh7IHZhbHVlOiB0YWcucmVwbGFjZSgvXiMvLCBcIlwiKSB9KSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vaWYgdGhpcyBub3RlIGhhcyBhIGZpbGVDbGFzcywgY2hlY2sgaWYgZmllbGQgdmFsdWVzIGFyZSBkZWZpbmVkIGluIHRoZSBGaWxlQ2xhc3NcbiAgICAgICAgICAgIGNvbnN0IGNhY2hlID0gdGhpcy5wbHVnaW4uYXBwLm1ldGFkYXRhQ2FjaGUuZ2V0Q2FjaGUoY29udGV4dC5maWxlLnBhdGgpO1xuICAgICAgICAgICAgbGV0IHRyeVdpdGhQcmVzZXRGaWVsZCA9ICFjYWNoZT8uZnJvbnRtYXR0ZXI7XG4gICAgICAgICAgICBpZiAoY2FjaGU/LmZyb250bWF0dGVyKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgeyBwb3NpdGlvbiwgLi4uYXR0cmlidXRlcyB9ID0gY2FjaGUuZnJvbnRtYXR0ZXI7XG4gICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQWxpYXMgPSB0aGlzLnBsdWdpbi5zZXR0aW5ncy5maWxlQ2xhc3NBbGlhcztcbiAgICAgICAgICAgICAgICBpZiAoT2JqZWN0LmtleXMoYXR0cmlidXRlcykuY29udGFpbnMoZmlsZUNsYXNzQWxpYXMpKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGZpbGVDbGFzc1ZhbHVlID0gYXR0cmlidXRlc1tmaWxlQ2xhc3NBbGlhc107XG4gICAgICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBmaWxlQ2xhc3MgPSBhd2FpdCBjcmVhdGVGaWxlQ2xhc3ModGhpcy5wbHVnaW4sIGZpbGVDbGFzc1ZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZmlsZUNsYXNzID0gZmlsZUNsYXNzO1xuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgZmlsZUNsYXNzQXR0cmlidXRlcyA9IHRoaXMuZmlsZUNsYXNzLmF0dHJpYnV0ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmlsZUNsYXNzQXR0cmlidXRlcy5tYXAoYXR0ciA9PiBhdHRyLm5hbWUpLmNvbnRhaW5zKGZpZWxkTmFtZSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBvcHRpb25zID0gZmlsZUNsYXNzQXR0cmlidXRlc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKGF0dHIgPT4gYXR0ci5uYW1lID09IGZpZWxkTmFtZSlbMF1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLm9wdGlvbnNcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmZpbHRlcihvcHRpb24gPT4gdGhpcy5maWx0ZXJPcHRpb24oZmlyc3RWYWx1ZXMsIGxhc3RWYWx1ZSwgb3B0aW9uKSlcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gb3B0aW9uc1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKG9wdGlvbiA9PiBPYmplY3QoeyB2YWx1ZTogb3B0aW9uIH0pKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRyeVdpdGhQcmVzZXRGaWVsZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5V2l0aFByZXNldEZpZWxkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIGlmICh0cnlXaXRoUHJlc2V0RmllbGQpIHtcbiAgICAgICAgICAgICAgICAvL2Vsc2UgY2hlY2sgaWYgdGhlcmUgYXJlIGdsb2JhbCBwcmVzZXQgdmFsdWVzXG4gICAgICAgICAgICAgICAgY29uc3QgcHJlc2V0RmllbGRNYXRjaCA9IHRoaXMucGx1Z2luLnNldHRpbmdzLnByZXNldEZpZWxkcy5maWx0ZXIoZmllbGQgPT4gZmllbGQubmFtZSA9PSBmaWVsZE5hbWUpO1xuICAgICAgICAgICAgICAgIGlmIChwcmVzZXRGaWVsZE1hdGNoLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcHJlc2V0RmllbGQgPSBwcmVzZXRGaWVsZE1hdGNoWzBdO1xuXG4gICAgICAgICAgICAgICAgICAgIGlmIChwcmVzZXRGaWVsZC52YWx1ZXNMaXN0Tm90ZVBhdGgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vb3ZlcnJpZGUgcHJlc2V0VmFsdWVzIGlmIHRoZXJlIGlzIGEgdmFsdWVzTGlzdFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzRmlsZSA9IHRoaXMucGx1Z2luLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgocHJlc2V0RmllbGQudmFsdWVzTGlzdE5vdGVQYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWx1ZXNGaWxlIGluc3RhbmNlb2YgVEZpbGUgJiYgdmFsdWVzRmlsZS5leHRlbnNpb24gPT0gXCJtZFwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgdmFsdWVzOiB7IHZhbHVlOiBzdHJpbmcgfVtdID0gYXdhaXQgKGF3YWl0IHRoaXMucGx1Z2luLmFwcC52YXVsdC5yZWFkKHZhbHVlc0ZpbGUpKS5zcGxpdChcIlxcblwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG9wdGlvbiA9PiB0aGlzLmZpbHRlck9wdGlvbihmaXJzdFZhbHVlcywgbGFzdFZhbHVlLCBvcHRpb24pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAubWFwKF92YWx1ZSA9PiBPYmplY3QoeyB2YWx1ZTogX3ZhbHVlIH0pKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB2YWx1ZXM7XG4gICAgICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBPYmplY3QuZW50cmllcyhwcmVzZXRGaWVsZE1hdGNoWzBdLnZhbHVlcykubWFwKG9wdGlvbiA9PiBvcHRpb25bMV0pXG4gICAgICAgICAgICAgICAgICAgICAgICAuZmlsdGVyKG9wdGlvbiA9PiB0aGlzLmZpbHRlck9wdGlvbihmaXJzdFZhbHVlcywgbGFzdFZhbHVlLCBvcHRpb24pKVxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWVzXG4gICAgICAgICAgICAgICAgICAgICAgICAubWFwKF92YWx1ZSA9PiBPYmplY3QoeyB2YWx1ZTogX3ZhbHVlIH0pKVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcblxuICAgIHJlbmRlclN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogSVZhbHVlQ29tcGxldGlvbiwgZWw6IEhUTUxFbGVtZW50KTogdm9pZCB7XG4gICAgICAgIGVsLnNldFRleHQoc3VnZ2VzdGlvbi52YWx1ZSk7XG4gICAgfTtcblxuICAgIHNlbGVjdFN1Z2dlc3Rpb24oc3VnZ2VzdGlvbjogSVZhbHVlQ29tcGxldGlvbiwgZXZlbnQ6IEtleWJvYXJkRXZlbnQgfCBNb3VzZUV2ZW50KTogdm9pZCB7XG4gICAgICAgIGNvbnN0IGFjdGl2ZVZpZXcgPSB0aGlzLmFwcC53b3Jrc3BhY2UuZ2V0QWN0aXZlVmlld09mVHlwZShNYXJrZG93blZpZXcpO1xuICAgICAgICBpZiAoIWFjdGl2ZVZpZXcpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgZWRpdG9yID0gYWN0aXZlVmlldy5lZGl0b3I7XG4gICAgICAgIGNvbnN0IGFjdGl2ZUxpbmUgPSBlZGl0b3IuZ2V0TGluZSh0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUpO1xuXG4gICAgICAgIGlmICh0aGlzLmluRnJvbnRtYXR0ZXIpIHtcbiAgICAgICAgICAgIC8vZm9ybWF0IGxpc3QgaWYgaW4gZnJvbnRtYXR0ZXJcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgbGV0IHBhcnNlZEZpZWxkOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmcgfCBzdHJpbmdbXSB8IG51bGw+ID0gcGFyc2VZYW1sKGFjdGl2ZUxpbmUpXG4gICAgICAgICAgICAgICAgbGV0IFthdHRyLCBwYXN0VmFsdWVzXSA9IE9iamVjdC5lbnRyaWVzKHBhcnNlZEZpZWxkKVswXVxuICAgICAgICAgICAgICAgIGxldCBuZXdGaWVsZDogc3RyaW5nXG4gICAgICAgICAgICAgICAgaWYgKCFwYXN0VmFsdWVzKSB7XG4gICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBcIiArIHN1Z2dlc3Rpb24udmFsdWU7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgcGFzdFZhbHVlcyA9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIXBhc3RWYWx1ZXMuY29udGFpbnMoXCIsXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogXCIgKyBzdWdnZXN0aW9uLnZhbHVlO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIHBhc3RWYWx1ZXMuc3BsaXQoXCIsXCIpLm1hcChvID0+IG8udHJpbSgpKS5zbGljZSgwLCAtMSkuam9pbignLCAnKSArIFwiLCBcIiArIHN1Z2dlc3Rpb24udmFsdWUgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShwYXN0VmFsdWVzKSkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoYWN0aXZlTGluZS5lbmRzV2l0aChcIixdXCIpIHx8IGFjdGl2ZUxpbmUuZW5kc1dpdGgoXCIsIF1cIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vdmFsdWUgY2FuIGJlIGRpcmVjdGx5IGFkZGVkIHNpbmNlIHBhcnNlWWFtbCB3b250IGNyZWF0ZSBhbiBlbXB0eSBsYXN0IGl0ZW0gaW4gcGFzdFZhbHVlc1xuICAgICAgICAgICAgICAgICAgICAgICAgbmV3RmllbGQgPSBhdHRyICsgXCI6IFtcIiArIFsuLi5wYXN0VmFsdWVzLCBzdWdnZXN0aW9uLnZhbHVlXS5qb2luKFwiLCBcIikgKyBcIl1cIjtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vd2UgaGF2ZSB0eXBlZCBzb21ldGhpbmcgdGhhdCB3ZSBhaHZlIHRvIHJlbW92ZSB0byByZXBsYWNlIHdpdGggc2VsZWN0ZWQgdmFsdWVcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ld0ZpZWxkID0gYXR0ciArIFwiOiBbXCIgKyBbLi4ucGFzdFZhbHVlcy5zbGljZSgwLCAtMSksIHN1Z2dlc3Rpb24udmFsdWVdLmpvaW4oXCIsIFwiKSArIFwiXVwiO1xuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBuZXdGaWVsZCA9IGF0dHIgKyBcIjogW1wiICsgWy4uLnBhc3RWYWx1ZXNdLmpvaW4oXCIsIFwiKSArIFwiXVwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBlZGl0b3IucmVwbGFjZVJhbmdlKG5ld0ZpZWxkLCB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IDAgfSwgeyBsaW5lOiB0aGlzLmNvbnRleHQhLnN0YXJ0LmxpbmUsIGNoOiBhY3RpdmVMaW5lLmxlbmd0aCB9KTtcbiAgICAgICAgICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwYXN0VmFsdWVzKSB8fCB0eXBlb2YgcGFzdFZhbHVlcyA9PT0gJ3N0cmluZycgJiYgcGFzdFZhbHVlcy5jb250YWlucyhcIixcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgZWRpdG9yLnNldEN1cnNvcih7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IG5ld0ZpZWxkLmxlbmd0aCAtIDEgfSlcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBlZGl0b3Iuc2V0Q3Vyc29yKHsgbGluZTogdGhpcy5jb250ZXh0IS5zdGFydC5saW5lLCBjaDogbmV3RmllbGQubGVuZ3RoIH0pXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiRnJvbnRtYXR0ZXIgd3JvbmdseSBmb3JtYXR0ZWRcIiwgMjAwMClcbiAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKClcbiAgICAgICAgICAgICAgICByZXR1cm5cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vY2xlYW4gbGluZSBieSByZW1vdmluZyBldmVyeXRoaW5nIGFmdGVyICwgb3IgOjpcbiAgICAgICAgICAgIGxldCBjbGVhbmVkTGluZSA9IGFjdGl2ZUxpbmVcbiAgICAgICAgICAgIHdoaWxlICghWycsJywgJzonXS5jb250YWlucyhjbGVhbmVkTGluZS5jaGFyQXQoY2xlYW5lZExpbmUubGVuZ3RoIC0gMSkpKSB7XG4gICAgICAgICAgICAgICAgY2xlYW5lZExpbmUgPSBjbGVhbmVkTGluZS5zbGljZSgwLCAtMSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVkaXRvci5yZXBsYWNlUmFuZ2UoYCR7Y2xlYW5lZExpbmV9JHtldmVudC5zaGlmdEtleSA/IFwiIFwiIDogXCJcIn1gICsgc3VnZ2VzdGlvbi52YWx1ZSxcbiAgICAgICAgICAgICAgICB7IGxpbmU6IHRoaXMuY29udGV4dCEuc3RhcnQubGluZSwgY2g6IDAgfSwgdGhpcy5jb250ZXh0IS5lbmQpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuZGlkU2VsZWN0ID0gdHJ1ZVxuICAgICAgICB0aGlzLmNsb3NlKClcbiAgICB9O1xufTsiXSwKICAibWFwcGluZ3MiOiAiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBLHdCQUFxQzs7O0FDQXJDLHVCQUF3Rjs7O0FDQXhGLHVCQUFtSDs7O0FDVW5ILElBQU0sUUFBTixNQUFZO0FBQUEsRUFFUixZQUFZLE9BQWUsSUFDdkIsU0FBaUMsQ0FBQyxHQUNsQyxLQUFhLElBQ2IsVUFBbUIsT0FDbkIsVUFBbUIsT0FDbkIsYUFBcUIsT0FDckIscUJBQTZCLElBQUk7QUFDakMsU0FBSyxPQUFPO0FBQ1osU0FBSyxTQUFTO0FBQ2QsU0FBSyxLQUFLO0FBQ1YsU0FBSyxZQUFZO0FBQ2pCLFNBQUssVUFBVTtBQUNmLFNBQUssVUFBVTtBQUNmLFNBQUsscUJBQXFCO0FBQzFCLFNBQUssZUFBZSxLQUFLLElBQUk7QUFBQSxFQUNqQztBQUFBLEVBRUEsQUFBYSxlQUFlLE9BQWdDO0FBQUE7QUFDeEQsVUFBSSxTQUFTO0FBQ2IsYUFBTyxLQUFLLEtBQUssTUFBTSxFQUFFLFFBQVEsU0FBTztBQUNwQyxZQUFJLFNBQVMsR0FBRyxLQUFLLFNBQVMsR0FBRyxLQUFLLFFBQVE7QUFDMUMsbUJBQVMsU0FBUyxHQUFHLElBQUk7QUFBQSxRQUM3QjtBQUFDO0FBQUEsTUFDTCxDQUFDO0FBQ0QsV0FBSyxPQUFPLE9BQU8sU0FBUyxL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
