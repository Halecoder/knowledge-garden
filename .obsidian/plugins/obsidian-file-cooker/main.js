/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var __create = Object.create;
var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __getProtoOf = Object.getPrototypeOf;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __markAsModule = (target) => __defProp(target, "__esModule", { value: true });
var __commonJS = (cb, mod) => function __require() {
  return mod || (0, cb[Object.keys(cb)[0]])((mod = { exports: {} }).exports, mod), mod.exports;
};
var __export = (target, all) => {
  __markAsModule(target);
  for (var name in all)
    __defProp(target, name, { get: all[name], enumerable: true });
};
var __reExport = (target, module2, desc) => {
  if (module2 && typeof module2 === "object" || typeof module2 === "function") {
    for (let key of __getOwnPropNames(module2))
      if (!__hasOwnProp.call(target, key) && key !== "default")
        __defProp(target, key, { get: () => module2[key], enumerable: !(desc = __getOwnPropDesc(module2, key)) || desc.enumerable });
  }
  return target;
};
var __toModule = (module2) => {
  return __reExport(__markAsModule(__defProp(module2 != null ? __create(__getProtoOf(module2)) : {}, "default", module2 && module2.__esModule && "default" in module2 ? { get: () => module2.default, enumerable: true } : { value: module2, enumerable: true })), module2);
};
var __async = (__this, __arguments, generator) => {
  return new Promise((resolve, reject) => {
    var fulfilled = (value) => {
      try {
        step(generator.next(value));
      } catch (e) {
        reject(e);
      }
    };
    var rejected = (value) => {
      try {
        step(generator.throw(value));
      } catch (e) {
        reject(e);
      }
    };
    var step = (x) => x.done ? resolve(x.value) : Promise.resolve(x.value).then(fulfilled, rejected);
    step((generator = generator.apply(__this, __arguments)).next());
  });
};

// node_modules/obsidian-dataview/lib/index.js
var require_lib = __commonJS({
  "node_modules/obsidian-dataview/lib/index.js"(exports) {
    "use strict";
    Object.defineProperty(exports, "__esModule", { value: true });
    require("obsidian");
    var getAPI3 = (app) => {
      var _a;
      if (app)
        return (_a = app.plugins.plugins.dataview) === null || _a === void 0 ? void 0 : _a.api;
      else
        return window.DataviewAPI;
    };
    var isPluginEnabled = (app) => app.plugins.enabledPlugins.has("dataview");
    exports.getAPI = getAPI3;
    exports.isPluginEnabled = isPluginEnabled;
  }
});

// main.ts
__export(exports, {
  default: () => FileCookerPlugin
});
var import_obsidian12 = __toModule(require("obsidian"));

// src/modal/move-modal.ts
var import_obsidian3 = __toModule(require("obsidian"));

// src/action/move-action.ts
var import_obsidian2 = __toModule(require("obsidian"));

// src/modal/confirm-modal.ts
var import_obsidian = __toModule(require("obsidian"));
var ConfirmModal = class extends import_obsidian.Modal {
  constructor(app, moveInfos) {
    super(app);
    this.moveInfos = moveInfos;
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h1", { text: "Confirm Move/Copy?" });
    this.moveInfos.forEach((info) => {
      contentEl.createEl("div", { text: info.sourceFile.path + " -> " + info.targetDir + "/" + info.sourceFile.name });
    });
    new import_obsidian.Setting(contentEl).addToggle((toggle) => {
      toggle.setTooltip("Copy instead!");
      toggle.onChange((val) => {
        this.copyFlag = val;
      });
    });
    new import_obsidian.Setting(contentEl).addButton((btn) => btn.setButtonText("Confirm").setCta().onClick(() => __async(this, null, function* () {
      this.close();
      if (this.copyFlag) {
        for (const key in this.moveInfos) {
          let info = this.moveInfos[key];
          yield this.app.vault.copy(info.sourceFile, info.targetDir + "/" + info.sourceFile.name);
        }
        new import_obsidian.Notice("Copy Success!");
      } else {
        for (const key in this.moveInfos) {
          let info = this.moveInfos[key];
          yield this.app.fileManager.renameFile(info.sourceFile, info.targetDir + "/" + info.sourceFile.name);
        }
        new import_obsidian.Notice("Move Success!");
      }
    }))).addButton((btn) => btn.setButtonText("Cancel").setCta().onClick(() => {
      this.close();
      new import_obsidian.Notice("Move Canceled!");
    }));
  }
};

// src/action/move-action.ts
var MoveAction = class {
  constructor(app, targetPath) {
    this.app = app;
    this.targetPath = targetPath;
  }
  act(resultArr) {
    const moveInfos = [];
    if (resultArr.length > 0) {
      resultArr.forEach((ff) => {
        moveInfos.push({
          sourceFile: ff,
          targetDir: this.targetPath
        });
      });
      new ConfirmModal(this.app, moveInfos).open();
    } else {
      new import_obsidian2.Notice("No Files Found!");
    }
  }
};

// src/modal/move-modal.ts
var MoveModal = class extends import_obsidian3.SuggestModal {
  constructor(app, readable) {
    super(app);
    this.readable = readable;
  }
  getSuggestions(query) {
    const abstractFiles = this.app.vault.getAllLoadedFiles();
    const folders = [];
    const lowerCaseInputStr = query.toLowerCase();
    abstractFiles.forEach((folder) => {
      if (folder instanceof import_obsidian3.TFolder && folder.path.toLowerCase().contains(lowerCaseInputStr)) {
        folders.push(folder);
      }
    });
    return folders;
  }
  renderSuggestion(folder, el) {
    el.createEl("div", { text: folder.path });
  }
  onChooseSuggestion(folder, evt) {
    let action = new MoveAction(this.app, folder.path);
    this.readable.read(action);
  }
};

// src/reader/clipboard-reader.ts
var import_obsidian4 = __toModule(require("obsidian"));

// src/reader/read-info.ts
var ReadInfo = class {
  constructor(limit = 300) {
    this.limit = limit;
    this.resultArr = [];
  }
  add(file) {
    if (this.resultArr.length >= this.limit) {
      throw new Error("Load more than " + this.limit + " files!");
    }
    this.resultArr.push(file);
  }
  getFiles() {
    return this.resultArr;
  }
};

// src/reader/clipboard-reader.ts
var ClipboardReader = class {
  constructor(app) {
    this.app = app;
  }
  read(action) {
    let readInfo = new ReadInfo();
    let promiseStr = navigator.clipboard.readText();
    promiseStr.then((str) => {
      let lines = str.split("\n");
      try {
        lines.forEach((line) => {
          let f = line;
          if (f.startsWith("[[")) {
            f = f.substring(2, f.length);
          }
          if (f.endsWith("]]")) {
            f = f.substring(0, f.length - 2);
          }
          if (!f.endsWith(".md") && !f.endsWith(".MD") && !f.endsWith(".Md") && !f.endsWith(".mD")) {
            f = f + ".md";
          }
          console.log("f = " + f);
          let ff = this.app.vault.getAbstractFileByPath(f);
          if (ff != null) {
            readInfo.add(ff);
          }
        });
        action.act(readInfo.getFiles());
      } catch (e) {
        new import_obsidian4.Notice(e.message);
      }
    }).catch((e) => {
      new import_obsidian4.Notice("Clipboard Content Error!" + e);
    });
  }
};

// src/action/delete-action.ts
var import_obsidian6 = __toModule(require("obsidian"));

// src/modal/delete-confirm-modal.ts
var import_obsidian5 = __toModule(require("obsidian"));
var DeleteConfirmModal = class extends import_obsidian5.Modal {
  constructor(app, resultArr) {
    super(app);
    this.resultArr = resultArr;
  }
  onOpen() {
    return __async(this, null, function* () {
      const { contentEl } = this;
      contentEl.createEl("h1", { text: "Confirm Delete?" });
      if (this.resultArr.length == 0) {
        contentEl.createEl("div", { text: "No files found!" });
        new import_obsidian5.Setting(contentEl).addButton((btn) => btn.setButtonText("Close").setCta().onClick(() => {
          this.close();
        }));
      } else {
        this.resultArr.forEach((info) => {
          contentEl.createEl("div", { text: info.path });
        });
        new import_obsidian5.Setting(contentEl).addButton((btn) => btn.setButtonText("Confirm").setCta().onClick(() => {
          this.close();
          this.resultArr.forEach((info) => {
            this.app.vault.trash(info, true);
          });
          new import_obsidian5.Notice("Delete Success!");
        })).addButton((btn) => btn.setButtonText("Cancel").setCta().onClick(() => {
          this.close();
          new import_obsidian5.Notice("Delete Canceled!");
        }));
      }
    });
  }
};

// src/action/delete-action.ts
var DeleteAction = class {
  constructor(app) {
    this.app = app;
  }
  act(resultArr) {
    if (resultArr.length > 0) {
      new DeleteConfirmModal(this.app, resultArr).open();
    } else {
      new import_obsidian6.Notice("No Files Found!");
    }
  }
};

// src/reader/current-file-reader.ts
var import_obsidian7 = __toModule(require("obsidian"));
var CurrentFileReader = class {
  constructor(app) {
    this.app = app;
  }
  read(action) {
    let readInfo = new ReadInfo();
    let currentFile = this.app.workspace.getActiveFile();
    if (currentFile == null) {
      new import_obsidian7.Notice("No active file!");
      return;
    }
    let currentFilePath = currentFile.path;
    let linkObj = this.app.metadataCache.resolvedLinks[currentFilePath];
    try {
      for (let key in linkObj) {
        let ff = this.app.vault.getAbstractFileByPath(key);
        if (ff != null) {
          readInfo.add(ff);
        }
      }
      action.act(readInfo.getFiles());
    } catch (e) {
      new import_obsidian7.Notice(e.message);
    }
  }
};

// src/reader/dataview-reader.ts
var import_obsidian8 = __toModule(require("obsidian"));
var import_obsidian_dataview = __toModule(require_lib());
var DataviewReader = class {
  constructor(app, queryStr) {
    this.app = app;
    this.queryStr = queryStr;
  }
  read(action) {
    let readInfo = new ReadInfo();
    let api = (0, import_obsidian_dataview.getAPI)();
    let qStr = formatStr(this.queryStr);
    api.query(qStr).then((res) => {
      if (res.successful) {
        let filePaths = [];
        if (res.value.type == "list") {
          res.value.values.forEach((it) => {
            filePaths.push(it.path);
          });
        } else if (res.value.type == "table") {
          filePaths = res.value.values;
          res.value.values.forEach((it) => {
            it.forEach((innerIt) => {
              if (innerIt && innerIt.path) {
                filePaths.push(innerIt.path);
                return;
              }
            });
          });
        } else {
          res.value.values.forEach((it) => {
            filePaths.push(it.link.path);
          });
        }
        try {
          filePaths.forEach((filePath) => {
            let ff = this.app.vault.getAbstractFileByPath(filePath.toString());
            if (ff != null) {
              readInfo.add(ff);
            }
          });
          action.act(readInfo.getFiles());
        } catch (e) {
          new import_obsidian8.Notice(e.message);
        }
      } else {
        new import_obsidian8.Notice("Query string error![" + this.queryStr + "]");
      }
    });
  }
};
function formatStr(queryStr) {
  let str = queryStr.trimStart();
  let commandStr = str.substring(0, 4);
  if (commandStr.toUpperCase() == "LIST") {
    return "LIST" + str.substring(4, str.length);
  }
  if (commandStr.toUpperCase() == "TABL") {
    return "TABLE" + str.substring(5, str.length);
  }
  if (commandStr.toUpperCase() == "TASK") {
    return "TASK" + str.substring(4, str.length);
  }
  return queryStr;
}

// src/action/copy-action.ts
var import_obsidian9 = __toModule(require("obsidian"));
var CopyAction = class {
  constructor(app) {
    this.app = app;
  }
  act(resultArr) {
    if (resultArr.length > 0) {
      let str = "";
      resultArr.forEach((ff) => {
        let name = ff.name;
        if (name.endsWith(".md")) {
          name = name.substring(0, name.lastIndexOf("."));
        }
        str += "[[" + ff.path + "|" + name + "]]\n";
      });
      navigator.clipboard.writeText(str);
      new import_obsidian9.Notice("Copy links success!");
    } else {
      new import_obsidian9.Notice("No Files Found!");
    }
  }
};

// main.ts
var import_obsidian_dataview2 = __toModule(require_lib());

// src/action/edit-front-matter-action.ts
var import_obsidian11 = __toModule(require("obsidian"));

// src/modal/edit-front-matter-modal.ts
var import_obsidian10 = __toModule(require("obsidian"));
var EditFrontMatterModal = class extends import_obsidian10.Modal {
  constructor(app, resultArr) {
    super(app);
    this.resultArr = resultArr;
    let tmpFlag = localStorage.getItem("overrideFlag");
    if (tmpFlag && tmpFlag == "true") {
      this.overrideFlag = true;
    }
  }
  onOpen() {
    const { contentEl } = this;
    contentEl.createEl("h1", { text: "Edit Front Matter" });
    if (this.resultArr.length == 0) {
      contentEl.createEl("div", { text: "No files found!" });
      new import_obsidian10.Setting(contentEl).addButton((btn) => btn.setButtonText("Close").setCta().onClick(() => {
        this.close();
      }));
    } else {
      this.resultArr.forEach((info) => {
        contentEl.createEl("div", { text: info.path });
      });
      new import_obsidian10.Setting(contentEl).addText((txt) => txt.setPlaceholder("Front Matter Key").onChange((val) => {
        this.key = val;
      })).addText((txt) => txt.setPlaceholder("Front Matter Value").onChange((val) => {
        this.val = val;
      })).addToggle((toggle) => {
        toggle.setValue(this.overrideFlag);
        toggle.setTooltip("Override if exists!");
        toggle.onChange((val) => {
          localStorage.setItem("overrideFlag", val + "");
          this.overrideFlag = val;
        });
      });
      new import_obsidian10.Setting(contentEl).addButton((btn) => btn.setButtonText("Confirm").setCta().onClick(() => __async(this, null, function* () {
        if (this.key == null || this.key.trim() == "") {
          new import_obsidian10.Notice("Key could not be empty!");
          return;
        }
        if (this.val == null || this.val.trim() == "") {
          new import_obsidian10.Notice("Value could not be empty!");
          return;
        }
        this.close();
        let api = this.app.plugins.plugins["metaedit"].api;
        let c_num = 0;
        let u_num = 0;
        for (let i = 0; i < this.resultArr.length; i++) {
          let info = this.resultArr[i];
          let val = yield api.getPropertyValue(this.key, info);
          if (val == null) {
            api.createYamlProperty(this.key, this.val, info);
            c_num += 1;
          } else if (this.overrideFlag || val.trim() == "") {
            api.update(this.key, this.val, info);
            u_num += 1;
          }
        }
        new import_obsidian10.Notice("Edit Success!");
        new import_obsidian10.Notice("Add " + c_num + " !");
        new import_obsidian10.Notice("Update " + u_num + " !");
      }))).addButton((btn) => btn.setButtonText("Cancel").setCta().onClick(() => {
        this.close();
        new import_obsidian10.Notice("Edit Canceled!");
      }));
    }
  }
};

// src/action/edit-front-matter-action.ts
var EditFrontMatterAction = class {
  constructor(app) {
    this.app = app;
  }
  act(resultArr) {
    if (resultArr.length > 0) {
      new EditFrontMatterModal(this.app, resultArr).open();
    } else {
      new import_obsidian11.Notice("No Files Found!");
    }
  }
};

// main.ts
var FileCookerPlugin = class extends import_obsidian12.Plugin {
  onload() {
    return __async(this, null, function* () {
      let dataviewApi = (0, import_obsidian_dataview2.getAPI)();
      this.addCommand({
        id: "move-files-to",
        name: "Move files to ...",
        callback: () => {
          new MoveModal(this.app, new ClipboardReader(this.app)).open();
        }
      });
      this.addCommand({
        id: "move-links-to",
        name: "Move links in current file to ...",
        callback: () => {
          new MoveModal(this.app, new CurrentFileReader(this.app)).open();
        }
      });
      this.addCommand({
        id: "move-dataview-results-to",
        name: "Move dataview query results to ...",
        editorCheckCallback: (checking, editor, view) => {
          if (!checking) {
            new MoveModal(this.app, new DataviewReader(this.app, editor.getSelection())).open();
          }
          return dataviewApi != null;
        }
      });
      this.addCommand({
        id: "delete-files-in-clipboard",
        name: "Delete files in clipboard!",
        callback: () => {
          new ClipboardReader(this.app).read(new DeleteAction(this.app));
        }
      });
      this.addCommand({
        id: "delete-links-in-current-file",
        name: "Delete link-files in current file!",
        callback: () => {
          new CurrentFileReader(this.app).read(new DeleteAction(this.app));
        }
      });
      this.addCommand({
        id: "delete-dataview-results",
        name: "Delete dataview query results!",
        editorCheckCallback: (checking, editor, view) => {
          if (!checking) {
            new DataviewReader(this.app, editor.getSelection()).read(new DeleteAction(this.app));
          }
          return dataviewApi != null;
        }
      });
      this.addCommand({
        id: "copy-dataview-result-links",
        name: "Copy dataview result links!",
        editorCheckCallback: (checking, editor, view) => {
          if (!checking) {
            new DataviewReader(this.app, editor.getSelection()).read(new CopyAction(this.app));
          }
          return dataviewApi != null;
        }
      });
      let metaedit = this.app.plugins.plugins["metaedit"];
      this.addCommand({
        id: "edit-front-matter-in-clipboard-files",
        name: "Edit Front Matter in clipboard files ...",
        checkCallback: (checking) => {
          if (!checking) {
            new ClipboardReader(this.app).read(new EditFrontMatterAction(this.app));
          }
          return dataviewApi != null && metaedit != null;
        }
      });
      this.addCommand({
        id: "edit-front-matter-in-current-file-links",
        name: "Edit Front Matter in current file links ...",
        checkCallback: (checking) => {
          if (!checking) {
            new CurrentFileReader(this.app).read(new EditFrontMatterAction(this.app));
          }
          return dataviewApi != null && metaedit != null;
        }
      });
      this.addCommand({
        id: "edit-front-matter-in-dataview-results",
        name: "Edit Front Matter in dataview results ...",
        editorCheckCallback: (checking, editor, view) => {
          if (!checking) {
            new DataviewReader(this.app, editor.getSelection()).read(new EditFrontMatterAction(this.app));
          }
          return dataviewApi != null && metaedit != null;
        }
      });
    });
  }
  onunload() {
  }
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsibm9kZV9tb2R1bGVzL29ic2lkaWFuLWRhdGF2aWV3L3NyYy9pbmRleC50cyIsICJtYWluLnRzIiwgInNyYy9tb2RhbC9tb3ZlLW1vZGFsLnRzIiwgInNyYy9hY3Rpb24vbW92ZS1hY3Rpb24udHMiLCAic3JjL21vZGFsL2NvbmZpcm0tbW9kYWwudHMiLCAic3JjL3JlYWRlci9jbGlwYm9hcmQtcmVhZGVyLnRzIiwgInNyYy9yZWFkZXIvcmVhZC1pbmZvLnRzIiwgInNyYy9hY3Rpb24vZGVsZXRlLWFjdGlvbi50cyIsICJzcmMvbW9kYWwvZGVsZXRlLWNvbmZpcm0tbW9kYWwudHMiLCAic3JjL3JlYWRlci9jdXJyZW50LWZpbGUtcmVhZGVyLnRzIiwgInNyYy9yZWFkZXIvZGF0YXZpZXctcmVhZGVyLnRzIiwgInNyYy9hY3Rpb24vY29weS1hY3Rpb24udHMiLCAic3JjL2FjdGlvbi9lZGl0LWZyb250LW1hdHRlci1hY3Rpb24udHMiLCAic3JjL21vZGFsL2VkaXQtZnJvbnQtbWF0dGVyLW1vZGFsLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyIvLyBCYXNpYyBBUEkgdHlwZS5cbmV4cG9ydCB0eXBlIHsgRGF0YXZpZXdBcGkgfSBmcm9tIFwiYXBpL3BsdWdpbi1hcGlcIjtcblxuLy8gQ29yZSBEYXRhdmlldyB0eXBlcy5cbmV4cG9ydCB0eXBlIHsgRGF0ZVRpbWUsIER1cmF0aW9uIH0gZnJvbSBcImx1eG9uXCI7XG5leHBvcnQgdHlwZSB7XG4gICAgTGluayxcbiAgICBEYXRhT2JqZWN0LFxuICAgIExpdGVyYWxUeXBlLFxuICAgIExpdGVyYWwsXG4gICAgTGl0ZXJhbFJlcHIsXG4gICAgV3JhcHBlZExpdGVyYWwsXG4gICAgTGl0ZXJhbFdyYXBwZXIsXG4gICAgV2lkZ2V0LFxufSBmcm9tIFwiZGF0YS1tb2RlbC92YWx1ZVwiO1xuXG5leHBvcnQgdHlwZSB7IFJlc3VsdCwgU3VjY2VzcywgRmFpbHVyZSB9IGZyb20gXCJhcGkvcmVzdWx0XCI7XG5leHBvcnQgdHlwZSB7IERhdGFBcnJheSB9IGZyb20gXCJhcGkvZGF0YS1hcnJheVwiO1xuXG4vLyBEYXRhdmlldyBJbmRleC5cbmV4cG9ydCB0eXBlIHsgTGlzdEl0ZW0sIFBhZ2VNZXRhZGF0YSB9IGZyb20gXCJkYXRhLW1vZGVsL21hcmtkb3duXCI7XG5leHBvcnQgdHlwZSB7IEZ1bGxJbmRleCwgUHJlZml4SW5kZXgsIEluZGV4TWFwIH0gZnJvbSBcImRhdGEtaW5kZXgvaW5kZXhcIjtcblxuLy8gU2VyaWFsaXplZCB0eXBlcyB3aGljaCBkZXNjcmliZSBhbGwgb3V0cHV0cyBvZiBzZXJpYWxpemF0aW9uLlxuZXhwb3J0IHR5cGUgeyBTTWFya2Rvd25QYWdlLCBTTGlzdEVudHJ5LCBTVGFzayB9IGZyb20gXCJkYXRhLW1vZGVsL3NlcmlhbGl6ZWQvbWFya2Rvd25cIjtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vIEltcGxlbWVudGF0aW9uIC8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG5pbXBvcnQgdHlwZSB7IERhdGF2aWV3QXBpIH0gZnJvbSBcImFwaS9wbHVnaW4tYXBpXCI7XG5cbmltcG9ydCBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgdHlwZSB7IEFwcCB9IGZyb20gXCJvYnNpZGlhblwiO1xuXG4vLyBVdGlsaXR5IGZ1bmN0aW9ucy5cbi8qKlxuICogR2V0IHRoZSBjdXJyZW50IERhdGF2aWV3IEFQSSBmcm9tIHRoZSBhcHAgaWYgcHJvdmlkZWQ7IGlmIG5vdCwgaXQgaXMgaW5mZXJyZWQgZnJvbSB0aGUgZ2xvYmFsIEFQSSBvYmplY3QgaW5zdGFsbGVkXG4gKiBvbiB0aGUgd2luZG93LlxuICovXG5leHBvcnQgY29uc3QgZ2V0QVBJID0gKGFwcD86IEFwcCk6IERhdGF2aWV3QXBpIHwgdW5kZWZpbmVkID0+IHtcbiAgICBpZiAoYXBwKSByZXR1cm4gYXBwLnBsdWdpbnMucGx1Z2lucy5kYXRhdmlldz8uYXBpO1xuICAgIGVsc2UgcmV0dXJuIHdpbmRvdy5EYXRhdmlld0FQSTtcbn07XG5cbi8qKiBEZXRlcm1pbmUgaWYgRGF0YXZpZXcgaXMgZW5hYmxlZCBpbiB0aGUgZ2l2ZW4gYXBwbGljYXRpb24uICovXG5leHBvcnQgY29uc3QgaXNQbHVnaW5FbmFibGVkID0gKGFwcDogQXBwKSA9PiBhcHAucGx1Z2lucy5lbmFibGVkUGx1Z2lucy5oYXMoXCJkYXRhdmlld1wiKTtcbiIsICJpbXBvcnQgeyBQbHVnaW4sIEVkaXRvciwgTWFya2Rvd25WaWV3IH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTW92ZU1vZGFsIH0gZnJvbSAnc3JjL21vZGFsL21vdmUtbW9kYWwnO1xuaW1wb3J0IHsgQ2xpcGJvYXJkUmVhZGVyIH0gZnJvbSAnc3JjL3JlYWRlci9jbGlwYm9hcmQtcmVhZGVyJztcbmltcG9ydCB7IERlbGV0ZUFjdGlvbiB9IGZyb20gJ3NyYy9hY3Rpb24vZGVsZXRlLWFjdGlvbic7XG5pbXBvcnQgeyBDdXJyZW50RmlsZVJlYWRlciB9IGZyb20gJ3NyYy9yZWFkZXIvY3VycmVudC1maWxlLXJlYWRlcic7XG5pbXBvcnQgeyBEYXRhdmlld1JlYWRlciB9IGZyb20gJ3NyYy9yZWFkZXIvZGF0YXZpZXctcmVhZGVyJztcbmltcG9ydCB7IENvcHlBY3Rpb24gfSBmcm9tICdzcmMvYWN0aW9uL2NvcHktYWN0aW9uJztcbmltcG9ydCB7IGdldEFQSSB9IGZyb20gXCJvYnNpZGlhbi1kYXRhdmlld1wiO1xuaW1wb3J0IHsgRWRpdEZyb250TWF0dGVyQWN0aW9uIH0gZnJvbSAnc3JjL2FjdGlvbi9lZGl0LWZyb250LW1hdHRlci1hY3Rpb24nO1xuXG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEZpbGVDb29rZXJQbHVnaW4gZXh0ZW5kcyBQbHVnaW4ge1xuXG5cdGFzeW5jIG9ubG9hZCgpIHtcblx0XHQvLyBjb25zdCByaWJib25JY29uRWwgPSB0aGlzLmFkZFJpYmJvbkljb24oJ2NsaXBib2FyZC1saXN0JywgJ01vdmUgZmlsZXMgdG8gLi4uJywgKGV2dDogTW91c2VFdmVudCkgPT4ge1xuXHRcdC8vIFx0bmV3IE1vdmVNb2RhbCh0aGlzLmFwcCwgRlJPTV9DTElQQk9BUkQpLm9wZW4oKTtcblx0XHQvLyB9KTtcblx0XHQvLyByaWJib25JY29uRWwuYWRkQ2xhc3MoJ215LXBsdWdpbi1yaWJib24tY2xhc3MnKTtcblxuXHRcdGxldCBkYXRhdmlld0FwaSA9IGdldEFQSSgpO1xuXG5cdFx0Ly8gTW92ZSBGaWxlc1xuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ21vdmUtZmlsZXMtdG8nLFxuXHRcdFx0bmFtZTogJ01vdmUgZmlsZXMgdG8gLi4uJyxcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdG5ldyBNb3ZlTW9kYWwodGhpcy5hcHAsIG5ldyBDbGlwYm9hcmRSZWFkZXIodGhpcy5hcHApKS5vcGVuKCk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwibW92ZS1saW5rcy10b1wiLFxuXHRcdFx0bmFtZTogXCJNb3ZlIGxpbmtzIGluIGN1cnJlbnQgZmlsZSB0byAuLi5cIixcblx0XHRcdGNhbGxiYWNrOiAoKSA9PiB7XG5cdFx0XHRcdG5ldyBNb3ZlTW9kYWwodGhpcy5hcHAsIG5ldyBDdXJyZW50RmlsZVJlYWRlcih0aGlzLmFwcCkpLm9wZW4oKTtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ21vdmUtZGF0YXZpZXctcmVzdWx0cy10bycsXG5cdFx0XHRuYW1lOiAnTW92ZSBkYXRhdmlldyBxdWVyeSByZXN1bHRzIHRvIC4uLicsXG5cdFx0XHRlZGl0b3JDaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4sIGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcblx0XHRcdFx0aWYgKCFjaGVja2luZykge1xuXHRcdFx0XHRcdG5ldyBNb3ZlTW9kYWwodGhpcy5hcHAsIG5ldyBEYXRhdmlld1JlYWRlcih0aGlzLmFwcCwgZWRpdG9yLmdldFNlbGVjdGlvbigpKSkub3BlbigpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBkYXRhdmlld0FwaSAhPSBudWxsO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gRGVsZXRlIEZpbGVzXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnZGVsZXRlLWZpbGVzLWluLWNsaXBib2FyZCcsXG5cdFx0XHRuYW1lOiAnRGVsZXRlIGZpbGVzIGluIGNsaXBib2FyZCEnLFxuXHRcdFx0Y2FsbGJhY2s6ICgpID0+IHtcblx0XHRcdFx0bmV3IENsaXBib2FyZFJlYWRlcih0aGlzLmFwcCkucmVhZChuZXcgRGVsZXRlQWN0aW9uKHRoaXMuYXBwKSk7XG5cdFx0XHR9XG5cdFx0fSk7XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6IFwiZGVsZXRlLWxpbmtzLWluLWN1cnJlbnQtZmlsZVwiLFxuXHRcdFx0bmFtZTogXCJEZWxldGUgbGluay1maWxlcyBpbiBjdXJyZW50IGZpbGUhXCIsXG5cdFx0XHRjYWxsYmFjazogKCkgPT4ge1xuXHRcdFx0XHRuZXcgQ3VycmVudEZpbGVSZWFkZXIodGhpcy5hcHApLnJlYWQobmV3IERlbGV0ZUFjdGlvbih0aGlzLmFwcCkpO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiAnZGVsZXRlLWRhdGF2aWV3LXJlc3VsdHMnLFxuXHRcdFx0bmFtZTogJ0RlbGV0ZSBkYXRhdmlldyBxdWVyeSByZXN1bHRzIScsXG5cdFx0XHRlZGl0b3JDaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4sIGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcblx0XHRcdFx0aWYgKCFjaGVja2luZykge1xuXHRcdFx0XHRcdG5ldyBEYXRhdmlld1JlYWRlcih0aGlzLmFwcCwgZWRpdG9yLmdldFNlbGVjdGlvbigpKS5yZWFkKG5ldyBEZWxldGVBY3Rpb24odGhpcy5hcHApKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZGF0YXZpZXdBcGkgIT0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdC8vIGNvcHkgZmlsZSBsaW5rc1xuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogJ2NvcHktZGF0YXZpZXctcmVzdWx0LWxpbmtzJyxcblx0XHRcdG5hbWU6ICdDb3B5IGRhdGF2aWV3IHJlc3VsdCBsaW5rcyEnLFxuXHRcdFx0ZWRpdG9yQ2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuLCBlZGl0b3I6IEVkaXRvciwgdmlldzogTWFya2Rvd25WaWV3KSA9PiB7XG5cdFx0XHRcdGlmICghY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRuZXcgRGF0YXZpZXdSZWFkZXIodGhpcy5hcHAsIGVkaXRvci5nZXRTZWxlY3Rpb24oKSkucmVhZChuZXcgQ29weUFjdGlvbih0aGlzLmFwcCkpO1xuXHRcdFx0XHR9XG5cdFx0XHRcdHJldHVybiBkYXRhdmlld0FwaSAhPSBudWxsO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gRWRpdCBGcm9udCBNYXR0ZXIgXG5cdFx0Ly8gaHR0cHM6Ly9naXRodWIuY29tL2xpanl6ZS9vYnNpZGlhbi1zdGF0ZS1zd2l0Y2hlci9ibG9iL2QwYTgwMDgxYjBmY2MxYjg5OWVlZDJlM2Q3ZTgzNGMyZDU3MDM4NzUvc3JjL3V0aWwudHMjTDQyXG5cdFx0bGV0IG1ldGFlZGl0ID0gdGhpcy5hcHAucGx1Z2lucy5wbHVnaW5zW1wibWV0YWVkaXRcIl07XG5cblx0XHR0aGlzLmFkZENvbW1hbmQoe1xuXHRcdFx0aWQ6ICdlZGl0LWZyb250LW1hdHRlci1pbi1jbGlwYm9hcmQtZmlsZXMnLFxuXHRcdFx0bmFtZTogJ0VkaXQgRnJvbnQgTWF0dGVyIGluIGNsaXBib2FyZCBmaWxlcyAuLi4nLFxuXHRcdFx0Y2hlY2tDYWxsYmFjazogKGNoZWNraW5nOiBib29sZWFuKSA9PiB7XG5cdFx0XHRcdGlmICghY2hlY2tpbmcpIHtcblx0XHRcdFx0XHRuZXcgQ2xpcGJvYXJkUmVhZGVyKHRoaXMuYXBwKS5yZWFkKG5ldyBFZGl0RnJvbnRNYXR0ZXJBY3Rpb24odGhpcy5hcHApKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZGF0YXZpZXdBcGkgIT0gbnVsbCAmJiBtZXRhZWRpdCAhPSBudWxsO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0dGhpcy5hZGRDb21tYW5kKHtcblx0XHRcdGlkOiBcImVkaXQtZnJvbnQtbWF0dGVyLWluLWN1cnJlbnQtZmlsZS1saW5rc1wiLFxuXHRcdFx0bmFtZTogXCJFZGl0IEZyb250IE1hdHRlciBpbiBjdXJyZW50IGZpbGUgbGlua3MgLi4uXCIsXG5cdFx0XHRjaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4pID0+IHtcblx0XHRcdFx0aWYgKCFjaGVja2luZykge1xuXHRcdFx0XHRcdG5ldyBDdXJyZW50RmlsZVJlYWRlcih0aGlzLmFwcCkucmVhZChuZXcgRWRpdEZyb250TWF0dGVyQWN0aW9uKHRoaXMuYXBwKSk7XG5cdFx0XHRcdH1cblx0XHRcdFx0cmV0dXJuIGRhdGF2aWV3QXBpICE9IG51bGwgJiYgbWV0YWVkaXQgIT0gbnVsbDtcblx0XHRcdH1cblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkQ29tbWFuZCh7XG5cdFx0XHRpZDogXCJlZGl0LWZyb250LW1hdHRlci1pbi1kYXRhdmlldy1yZXN1bHRzXCIsXG5cdFx0XHRuYW1lOiBcIkVkaXQgRnJvbnQgTWF0dGVyIGluIGRhdGF2aWV3IHJlc3VsdHMgLi4uXCIsXG5cdFx0XHRlZGl0b3JDaGVja0NhbGxiYWNrOiAoY2hlY2tpbmc6IGJvb2xlYW4sIGVkaXRvcjogRWRpdG9yLCB2aWV3OiBNYXJrZG93blZpZXcpID0+IHtcblx0XHRcdFx0aWYgKCFjaGVja2luZykge1xuXHRcdFx0XHRcdG5ldyBEYXRhdmlld1JlYWRlcih0aGlzLmFwcCwgZWRpdG9yLmdldFNlbGVjdGlvbigpKS5yZWFkKG5ldyBFZGl0RnJvbnRNYXR0ZXJBY3Rpb24odGhpcy5hcHApKTtcblx0XHRcdFx0fVxuXHRcdFx0XHRyZXR1cm4gZGF0YXZpZXdBcGkgIT0gbnVsbCAmJiBtZXRhZWRpdCAhPSBudWxsO1xuXHRcdFx0fVxuXHRcdH0pO1xuXG5cdFx0Ly8gdG9kbyBtZXJnZSBtdWx0aSBmaWxlXG5cdFx0Ly8gdG9kbyBkZWFsIHRhZ3Ncblx0XHQvLyB0b2RvIGRlYWwgeWFtbFxuXHRcdC8vIGNvbnNvbGUubG9nKHRoaXMuYXBwLnBsdWdpbnMucGx1Z2luc1tcIm1ldGFlZGl0XCJdLmFwaSk7XG5cdH1cblxuXHRvbnVubG9hZCgpIHtcblx0fVxufVxuIiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBTdWdnZXN0TW9kYWwsIFRBYnN0cmFjdEZpbGUsIFRGb2xkZXIgfSBmcm9tICdvYnNpZGlhbic7XG5pbXBvcnQgeyBGUk9NX0NMSVBCT0FSRCwgRlJPTV9DVVJSRU5UX0ZJTEUgfSBmcm9tICdzcmMvbW9kYWwvbW92ZS1pbmZvJztcbmltcG9ydCB7IENsaXBib2FyZFJlYWRlciB9IGZyb20gJ3NyYy9yZWFkZXIvY2xpcGJvYXJkLXJlYWRlcic7XG5pbXBvcnQgeyBNb3ZlQWN0aW9uIH0gZnJvbSAnc3JjL2FjdGlvbi9tb3ZlLWFjdGlvbic7XG5pbXBvcnQgeyBDdXJyZW50RmlsZVJlYWRlciB9IGZyb20gJ3NyYy9yZWFkZXIvY3VycmVudC1maWxlLXJlYWRlcic7XG5pbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3NyYy9yZWFkZXIvcmVhZGFibGUnO1xuXG4vKipcbiAqIFx1OTAwOVx1NjJFOVx1NzZFRVx1NUY1NVx1NUYzOVx1N0E5N1xuICovXG5leHBvcnQgY2xhc3MgTW92ZU1vZGFsIGV4dGVuZHMgU3VnZ2VzdE1vZGFsPFRBYnN0cmFjdEZpbGU+IHtcblxuXHR0eXBlOiBzdHJpbmc7XG5cdHJlYWRhYmxlOiBSZWFkYWJsZTtcblxuXHRjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcmVhZGFibGU6IFJlYWRhYmxlKSB7XG5cdFx0c3VwZXIoYXBwKTtcblx0XHR0aGlzLnJlYWRhYmxlID0gcmVhZGFibGU7XG5cdH1cblxuXHQvLyBSZXR1cm5zIGFsbCBhdmFpbGFibGUgc3VnZ2VzdGlvbnMuXG5cdGdldFN1Z2dlc3Rpb25zKHF1ZXJ5OiBzdHJpbmcpOiBUQWJzdHJhY3RGaWxlW10ge1xuXHRcdGNvbnN0IGFic3RyYWN0RmlsZXMgPSB0aGlzLmFwcC52YXVsdC5nZXRBbGxMb2FkZWRGaWxlcygpO1xuXHRcdGNvbnN0IGZvbGRlcnM6IFRBYnN0cmFjdEZpbGVbXSA9IFtdO1xuXHRcdGNvbnN0IGxvd2VyQ2FzZUlucHV0U3RyID0gcXVlcnkudG9Mb3dlckNhc2UoKTtcblx0XHRhYnN0cmFjdEZpbGVzLmZvckVhY2goKGZvbGRlcikgPT4ge1xuXHRcdFx0aWYgKGZvbGRlciBpbnN0YW5jZW9mIFRGb2xkZXIgJiYgZm9sZGVyLnBhdGgudG9Mb3dlckNhc2UoKS5jb250YWlucyhsb3dlckNhc2VJbnB1dFN0cikpIHtcblx0XHRcdFx0Zm9sZGVycy5wdXNoKGZvbGRlcik7XG5cdFx0XHR9XG5cdFx0fSk7XG5cdFx0cmV0dXJuIGZvbGRlcnM7XG5cdH1cblxuXHQvLyBSZW5kZXJzIGVhY2ggc3VnZ2VzdGlvbiBpdGVtLlxuXHRyZW5kZXJTdWdnZXN0aW9uKGZvbGRlcjogVEFic3RyYWN0RmlsZSwgZWw6IEhUTUxFbGVtZW50KSB7XG5cdFx0ZWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBmb2xkZXIucGF0aCB9KTtcblx0XHQvLyBlbC5jcmVhdGVFbChcInNtYWxsXCIsIHsgdGV4dDogZm9sZGVyLnBhdGggfSk7XG5cdH1cblxuXHQvLyBQZXJmb3JtIGFjdGlvbiBvbiB0aGUgc2VsZWN0ZWQgc3VnZ2VzdGlvbi5cblx0b25DaG9vc2VTdWdnZXN0aW9uKGZvbGRlcjogVEFic3RyYWN0RmlsZSwgZXZ0OiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudCkge1xuXHRcdGxldCBhY3Rpb24gPSBuZXcgTW92ZUFjdGlvbih0aGlzLmFwcCwgZm9sZGVyLnBhdGgpO1xuXHRcdHRoaXMucmVhZGFibGUucmVhZChhY3Rpb24pO1xuXHR9XG59IiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBUQWJzdHJhY3RGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBDb25maXJtTW9kYWwgfSBmcm9tIFwiLi4vbW9kYWwvY29uZmlybS1tb2RhbFwiO1xuaW1wb3J0IHsgTW92ZUluZm8gfSBmcm9tIFwiLi4vbW9kYWwvbW92ZS1pbmZvXCI7XG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tIFwiLi9hY3Rpb25cIjtcblxuZXhwb3J0IGNsYXNzIE1vdmVBY3Rpb24gaW1wbGVtZW50cyBBY3Rpb24ge1xuXG4gICAgYXBwOiBBcHA7XG4gICAgdGFyZ2V0UGF0aDogc3RyaW5nO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHRhcmdldFBhdGg6IHN0cmluZykge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy50YXJnZXRQYXRoID0gdGFyZ2V0UGF0aDtcbiAgICB9XG5cbiAgICBhY3QocmVzdWx0QXJyOiBUQWJzdHJhY3RGaWxlW10pIHtcblxuICAgICAgICBjb25zdCBtb3ZlSW5mb3M6IE1vdmVJbmZvW10gPSBbXTtcblxuICAgICAgICBpZiAocmVzdWx0QXJyLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIHJlc3VsdEFyci5mb3JFYWNoKGZmID0+IHtcbiAgICAgICAgICAgICAgICBtb3ZlSW5mb3MucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIHNvdXJjZUZpbGU6IGZmLFxuICAgICAgICAgICAgICAgICAgICB0YXJnZXREaXI6IHRoaXMudGFyZ2V0UGF0aFxuICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgbmV3IENvbmZpcm1Nb2RhbCh0aGlzLmFwcCwgbW92ZUluZm9zKS5vcGVuKCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiTm8gRmlsZXMgRm91bmQhXCIpO1xuICAgICAgICB9XG4gICAgfVxuXG59IiwgImltcG9ydCB7IEFwcCwgRmlsZU1hbmFnZXIsIE1vZGFsLCBOb3RpY2UsIFNldHRpbmcsIFRGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuaW1wb3J0IHsgTW92ZUluZm8gfSBmcm9tICdzcmMvbW9kYWwvbW92ZS1pbmZvJztcblxuLyoqXG4gKiBcdTAwQTBcdTVGMzlcdTdBOTdcdTc4NkVcdThCQTRcdTg5ODFcdTc5RkJcdTUyQTgvXHU2MkY3XHU4RDFEXHU3Njg0XHU2NTg3XHU0RUY2XG4gKi9cbmV4cG9ydCBjbGFzcyBDb25maXJtTW9kYWwgZXh0ZW5kcyBNb2RhbCB7XG4gICAgbW92ZUluZm9zOiBNb3ZlSW5mb1tdO1xuICAgIGNvcHlGbGFnOiBib29sZWFuO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIG1vdmVJbmZvczogTW92ZUluZm9bXSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLm1vdmVJbmZvcyA9IG1vdmVJbmZvcztcbiAgICB9XG5cbiAgICBvbk9wZW4oKSB7XG4gICAgICAgIGNvbnN0IHsgY29udGVudEVsIH0gPSB0aGlzO1xuXG4gICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImgxXCIsIHsgdGV4dDogXCJDb25maXJtIE1vdmUvQ29weT9cIiB9KTtcblxuICAgICAgICB0aGlzLm1vdmVJbmZvcy5mb3JFYWNoKGluZm8gPT4ge1xuICAgICAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogaW5mby5zb3VyY2VGaWxlLnBhdGggKyBcIiAtPiBcIiArIGluZm8udGFyZ2V0RGlyICsgXCIvXCIgKyBpbmZvLnNvdXJjZUZpbGUubmFtZSB9KTtcbiAgICAgICAgfSlcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuYWRkVG9nZ2xlKCh0b2dnbGUpID0+IHtcbiAgICAgICAgICAgICAgICB0b2dnbGUuc2V0VG9vbHRpcChcIkNvcHkgaW5zdGVhZCFcIik7XG4gICAgICAgICAgICAgICAgdG9nZ2xlLm9uQ2hhbmdlKCh2YWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5jb3B5RmxhZyA9IHZhbDtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgfSlcblxuICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgICAgICAgICAgYnRuLnNldEJ1dHRvblRleHQoXCJDb25maXJtXCIpXG4gICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5jb3B5RmxhZykge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMubW92ZUluZm9zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmZvID0gdGhpcy5tb3ZlSW5mb3Nba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAudmF1bHQuY29weSgoaW5mby5zb3VyY2VGaWxlIGFzIFRGaWxlKSwgaW5mby50YXJnZXREaXIgKyBcIi9cIiArIGluZm8uc291cmNlRmlsZS5uYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkNvcHkgU3VjY2VzcyFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAoY29uc3Qga2V5IGluIHRoaXMubW92ZUluZm9zKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmZvID0gdGhpcy5tb3ZlSW5mb3Nba2V5XTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5hcHAuZmlsZU1hbmFnZXIucmVuYW1lRmlsZShpbmZvLnNvdXJjZUZpbGUsIGluZm8udGFyZ2V0RGlyICsgXCIvXCIgKyBpbmZvLnNvdXJjZUZpbGUubmFtZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJNb3ZlIFN1Y2Nlc3MhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT5cbiAgICAgICAgICAgICAgICBidG5cbiAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJDYW5jZWxcIilcbiAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJNb3ZlIENhbmNlbGVkIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgIH1cbn0iLCAiaW1wb3J0IHsgQXBwLCBOb3RpY2UsIFRBYnN0cmFjdEZpbGUgfSBmcm9tIFwib2JzaWRpYW5cIjtcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gXCJzcmMvYWN0aW9uL2FjdGlvblwiO1xuaW1wb3J0IHsgUmVhZEluZm8gfSBmcm9tIFwiLi9yZWFkLWluZm9cIjtcbmltcG9ydCB7IFJlYWRhYmxlIH0gZnJvbSBcIi4vcmVhZGFibGVcIjtcblxuXG5leHBvcnQgY2xhc3MgQ2xpcGJvYXJkUmVhZGVyIGltcGxlbWVudHMgUmVhZGFibGUge1xuXG4gICAgYXBwOiBBcHA7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICB9XG5cbiAgICByZWFkKGFjdGlvbjogQWN0aW9uKTogdm9pZCB7XG4gICAgICAgIGxldCByZWFkSW5mbyA9IG5ldyBSZWFkSW5mbygpO1xuXG4gICAgICAgIGxldCBwcm9taXNlU3RyID0gbmF2aWdhdG9yLmNsaXBib2FyZC5yZWFkVGV4dCgpO1xuXG4gICAgICAgIHByb21pc2VTdHIudGhlbihzdHIgPT4ge1xuICAgICAgICAgICAgbGV0IGxpbmVzID0gc3RyLnNwbGl0KFwiXFxuXCIpO1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICBsaW5lcy5mb3JFYWNoKGxpbmUgPT4ge1xuICAgICAgICAgICAgICAgICAgICBsZXQgZiA9IGxpbmU7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmLnN0YXJ0c1dpdGgoXCJbW1wiKSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZiA9IGYuc3Vic3RyaW5nKDIsIGYubGVuZ3RoKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoZi5lbmRzV2l0aChcIl1dXCIpKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBmID0gZi5zdWJzdHJpbmcoMCwgZi5sZW5ndGggLSAyKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBpZiAoIWYuZW5kc1dpdGgoXCIubWRcIikgJiYgIWYuZW5kc1dpdGgoXCIuTURcIikgJiYgIWYuZW5kc1dpdGgoXCIuTWRcIikgJiYgIWYuZW5kc1dpdGgoXCIubURcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGYgPSBmICsgXCIubWRcIjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhcImYgPSBcIiArIGYpO1xuICAgICAgICAgICAgICAgICAgICBsZXQgZmYgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZik7XG4gICAgICAgICAgICAgICAgICAgIGlmIChmZiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZWFkSW5mby5hZGQoZmYpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgYWN0aW9uLmFjdChyZWFkSW5mby5nZXRGaWxlcygpKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGUubWVzc2FnZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pLmNhdGNoKGUgPT4ge1xuICAgICAgICAgICAgbmV3IE5vdGljZShcIkNsaXBib2FyZCBDb250ZW50IEVycm9yIVwiICsgZSk7XG4gICAgICAgIH0pO1xuICAgIH1cblxufSIsICJpbXBvcnQgeyBUQWJzdHJhY3RGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgKiBhcyBpbnRlcm5hbCBmcm9tIFwic3RyZWFtXCI7XG5cblxuLyoqXG4gKiBcdThCRkJcdTUzRDZcdTc2ODRcdTRGRTFcdTYwNkZcbiAqL1xuZXhwb3J0IGNsYXNzIFJlYWRJbmZvIHtcblxuICAgIGxpbWl0OiBudW1iZXI7XG4gICAgcmVzdWx0QXJyOiBUQWJzdHJhY3RGaWxlW107XG5cbiAgICBjb25zdHJ1Y3RvcihsaW1pdDogbnVtYmVyID0gMzAwKSB7XG4gICAgICAgIHRoaXMubGltaXQgPSBsaW1pdDtcbiAgICAgICAgdGhpcy5yZXN1bHRBcnIgPSBbXTtcbiAgICB9XG5cbiAgICBhZGQoZmlsZTogVEFic3RyYWN0RmlsZSkge1xuICAgICAgICBpZiAodGhpcy5yZXN1bHRBcnIubGVuZ3RoID49IHRoaXMubGltaXQpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIkxvYWQgbW9yZSB0aGFuIFwiICsgdGhpcy5saW1pdCArIFwiIGZpbGVzIVwiKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnJlc3VsdEFyci5wdXNoKGZpbGUpO1xuICAgIH1cblxuICAgIGdldEZpbGVzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy5yZXN1bHRBcnI7XG4gICAgfVxufSIsICJpbXBvcnQgeyBBcHAsIE5vdGljZSwgVEFic3RyYWN0RmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgRGVsZXRlQ29uZmlybU1vZGFsIH0gZnJvbSBcInNyYy9tb2RhbC9kZWxldGUtY29uZmlybS1tb2RhbFwiO1xuaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSBcIi4vYWN0aW9uXCI7XG5cbmV4cG9ydCBjbGFzcyBEZWxldGVBY3Rpb24gaW1wbGVtZW50cyBBY3Rpb24ge1xuXG4gICAgYXBwOiBBcHA7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICB9XG5cbiAgICBhY3QocmVzdWx0QXJyOiBUQWJzdHJhY3RGaWxlW10pIHtcbiAgICAgICAgaWYgKHJlc3VsdEFyci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBuZXcgRGVsZXRlQ29uZmlybU1vZGFsKHRoaXMuYXBwLCByZXN1bHRBcnIpLm9wZW4oKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyBGaWxlcyBGb3VuZCFcIik7XG4gICAgICAgIH1cbiAgICB9XG5cbn0iLCAiaW1wb3J0IHsgQXBwLCBNb2RhbCwgTm90aWNlLCBTZXR0aW5nLCBUQWJzdHJhY3RGaWxlIH0gZnJvbSAnb2JzaWRpYW4nO1xuXG4vKipcbiAqIFx1MDBBMFx1NUYzOVx1N0E5N1x1Nzg2RVx1OEJBNFx1ODk4MVx1NTIyMFx1OTY2NFx1NzY4NFx1NjU4N1x1NEVGNlxuICovXG5leHBvcnQgY2xhc3MgRGVsZXRlQ29uZmlybU1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHJlc3VsdEFycjogVEFic3RyYWN0RmlsZVtdO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHAsIHJlc3VsdEFycjogVEFic3RyYWN0RmlsZVtdKSB7XG4gICAgICAgIHN1cGVyKGFwcCk7XG4gICAgICAgIHRoaXMucmVzdWx0QXJyPSByZXN1bHRBcnI7XG4gICAgfVxuXG4gICAgYXN5bmMgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoMVwiLCB7IHRleHQ6IFwiQ29uZmlybSBEZWxldGU/XCIgfSk7XG5cbiAgICAgICAgaWYgKHRoaXMucmVzdWx0QXJyLmxlbmd0aCA9PSAwKSB7XG4gICAgICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBcIk5vIGZpbGVzIGZvdW5kIVwiIH0pO1xuXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PlxuICAgICAgICAgICAgICAgICAgICBidG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiQ2xvc2VcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMucmVzdWx0QXJyLmZvckVhY2goaW5mbyA9PiB7XG4gICAgICAgICAgICAgICAgY29udGVudEVsLmNyZWF0ZUVsKFwiZGl2XCIsIHsgdGV4dDogaW5mby5wYXRoIH0pO1xuICAgICAgICAgICAgfSlcblxuICAgICAgICAgICAgbmV3IFNldHRpbmcoY29udGVudEVsKVxuICAgICAgICAgICAgICAgIC5hZGRCdXR0b24oKGJ0bikgPT5cbiAgICAgICAgICAgICAgICAgICAgYnRuXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0QnV0dG9uVGV4dChcIkNvbmZpcm1cIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlc3VsdEFyci5mb3JFYWNoKGluZm8gPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmFwcC52YXVsdC50cmFzaChpbmZvLCB0cnVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJEZWxldGUgU3VjY2VzcyFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSlcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgICAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJDYW5jZWxcIilcbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRDdGEoKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2xpY2soKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiRGVsZXRlIENhbmNlbGVkIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIG9uQ2xvc2UoKSB7XG4gICAgLy8gICAgIGxldCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcbiAgICAvLyAgICAgY29udGVudEVsLmVtcHR5KCk7XG4gICAgLy8gfVxufVxuIiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBUQWJzdHJhY3RGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBBY3Rpb24gfSBmcm9tIFwic3JjL2FjdGlvbi9hY3Rpb25cIjtcbmltcG9ydCB7IFJlYWRJbmZvIH0gZnJvbSBcIi4vcmVhZC1pbmZvXCI7XG5pbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gXCIuL3JlYWRhYmxlXCI7XG5cblxuZXhwb3J0IGNsYXNzIEN1cnJlbnRGaWxlUmVhZGVyIGltcGxlbWVudHMgUmVhZGFibGUge1xuXG4gICAgYXBwOiBBcHA7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCkge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICB9XG5cbiAgICByZWFkKGFjdGlvbjogQWN0aW9uKTogdm9pZCB7XG4gICAgICAgIGxldCByZWFkSW5mbyA9IG5ldyBSZWFkSW5mbygpO1xuXG4gICAgICAgIGxldCBjdXJyZW50RmlsZSA9IHRoaXMuYXBwLndvcmtzcGFjZS5nZXRBY3RpdmVGaWxlKCk7XG5cbiAgICAgICAgaWYgKGN1cnJlbnRGaWxlID09IG51bGwpIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyBhY3RpdmUgZmlsZSFcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICBsZXQgY3VycmVudEZpbGVQYXRoID0gY3VycmVudEZpbGUucGF0aDtcblxuICAgICAgICBsZXQgbGlua09iaiA9IHRoaXMuYXBwLm1ldGFkYXRhQ2FjaGUucmVzb2x2ZWRMaW5rc1tjdXJyZW50RmlsZVBhdGhdO1xuXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICBmb3IgKGxldCBrZXkgaW4gbGlua09iaikge1xuICAgICAgICAgICAgICAgIGxldCBmZiA9IHRoaXMuYXBwLnZhdWx0LmdldEFic3RyYWN0RmlsZUJ5UGF0aChrZXkpO1xuICAgICAgICAgICAgICAgIGlmIChmZiAhPSBudWxsKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlYWRJbmZvLmFkZChmZik7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWN0aW9uLmFjdChyZWFkSW5mby5nZXRGaWxlcygpKTtcbiAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgbmV3IE5vdGljZShlLm1lc3NhZ2UpO1xuICAgICAgICB9XG4gICAgfVxufSIsICJpbXBvcnQgeyBBcHAsIE5vdGljZSwgVEFic3RyYWN0RmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSBcInNyYy9hY3Rpb24vYWN0aW9uXCI7XG5pbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gXCIuL3JlYWRhYmxlXCI7XG5pbXBvcnQgeyBnZXRBUEkgfSBmcm9tIFwib2JzaWRpYW4tZGF0YXZpZXdcIjtcbmltcG9ydCB7IFJlYWRJbmZvIH0gZnJvbSBcIi4vcmVhZC1pbmZvXCI7XG5cbmV4cG9ydCBjbGFzcyBEYXRhdmlld1JlYWRlciBpbXBsZW1lbnRzIFJlYWRhYmxlIHtcblxuICAgIGFwcDogQXBwO1xuICAgIHF1ZXJ5U3RyOiBzdHJpbmc7XG5cbiAgICBjb25zdHJ1Y3RvcihhcHA6IEFwcCwgcXVlcnlTdHI6IHN0cmluZykge1xuICAgICAgICB0aGlzLmFwcCA9IGFwcDtcbiAgICAgICAgdGhpcy5xdWVyeVN0ciA9IHF1ZXJ5U3RyO1xuICAgIH1cblxuICAgIHJlYWQoYWN0aW9uOiBBY3Rpb24pOiB2b2lkIHtcbiAgICAgICAgbGV0IHJlYWRJbmZvID0gbmV3IFJlYWRJbmZvKCk7XG5cbiAgICAgICAgbGV0IGFwaSA9IGdldEFQSSgpO1xuXG4gICAgICAgIGxldCBxU3RyID0gZm9ybWF0U3RyKHRoaXMucXVlcnlTdHIpO1xuXG4gICAgICAgIGFwaS5xdWVyeShxU3RyKS50aGVuKHJlcyA9PiB7XG4gICAgICAgICAgICBpZiAocmVzLnN1Y2Nlc3NmdWwpIHtcbiAgICAgICAgICAgICAgICBsZXQgZmlsZVBhdGhzOiBhbnkgPSBbXTtcbiAgICAgICAgICAgICAgICBpZiAocmVzLnZhbHVlLnR5cGUgPT0gXCJsaXN0XCIpIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gTElTVFxuICAgICAgICAgICAgICAgICAgICByZXMudmFsdWUudmFsdWVzLmZvckVhY2goaXQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVBhdGhzLnB1c2goaXQucGF0aCk7XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAocmVzLnZhbHVlLnR5cGUgPT0gXCJ0YWJsZVwiKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFRBQkxFXG4gICAgICAgICAgICAgICAgICAgIGZpbGVQYXRocyA9IHJlcy52YWx1ZS52YWx1ZXM7XG4gICAgICAgICAgICAgICAgICAgIHJlcy52YWx1ZS52YWx1ZXMuZm9yRWFjaChpdCA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpdC5mb3JFYWNoKGlubmVySXQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpbm5lckl0ICYmIGlubmVySXQucGF0aCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlUGF0aHMucHVzaChpbm5lckl0LnBhdGgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gVEFTS1xuICAgICAgICAgICAgICAgICAgICByZXMudmFsdWUudmFsdWVzLmZvckVhY2goaXQgPT4ge1xuICAgICAgICAgICAgICAgICAgICAgICAgZmlsZVBhdGhzLnB1c2goaXQubGluay5wYXRoKTtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIGZpbGVQYXRocy5mb3JFYWNoKChmaWxlUGF0aDogeyB0b1N0cmluZzogKCkgPT4gc3RyaW5nOyB9KSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZXQgZmYgPSB0aGlzLmFwcC52YXVsdC5nZXRBYnN0cmFjdEZpbGVCeVBhdGgoZmlsZVBhdGgudG9TdHJpbmcoKSk7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZmYgIT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRJbmZvLmFkZChmZik7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbi5hY3QocmVhZEluZm8uZ2V0RmlsZXMoKSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKGUubWVzc2FnZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiUXVlcnkgc3RyaW5nIGVycm9yIVtcIiArIHRoaXMucXVlcnlTdHIgKyBcIl1cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pXG4gICAgfVxufVxuXG4vKipcbiAqIFx1NTkyN1x1NTE5OVx1NTQ3RFx1NEVFNFxuICovXG5mdW5jdGlvbiBmb3JtYXRTdHIocXVlcnlTdHI6IHN0cmluZyk6IHN0cmluZyB7XG4gICAgbGV0IHN0ciA9IHF1ZXJ5U3RyLnRyaW1TdGFydCgpO1xuXG4gICAgbGV0IGNvbW1hbmRTdHIgPSBzdHIuc3Vic3RyaW5nKDAsIDQpO1xuXG4gICAgaWYgKGNvbW1hbmRTdHIudG9VcHBlckNhc2UoKSA9PSBcIkxJU1RcIikge1xuICAgICAgICByZXR1cm4gXCJMSVNUXCIgKyBzdHIuc3Vic3RyaW5nKDQsIHN0ci5sZW5ndGgpO1xuICAgIH1cblxuICAgIGlmIChjb21tYW5kU3RyLnRvVXBwZXJDYXNlKCkgPT0gXCJUQUJMXCIpIHtcbiAgICAgICAgcmV0dXJuIFwiVEFCTEVcIiArIHN0ci5zdWJzdHJpbmcoNSwgc3RyLmxlbmd0aCk7XG4gICAgfVxuXG4gICAgaWYgKGNvbW1hbmRTdHIudG9VcHBlckNhc2UoKSA9PSBcIlRBU0tcIikge1xuICAgICAgICByZXR1cm4gXCJUQVNLXCIgKyBzdHIuc3Vic3RyaW5nKDQsIHN0ci5sZW5ndGgpO1xuICAgIH1cblxuICAgIHJldHVybiBxdWVyeVN0cjtcbn1cbiIsICJpbXBvcnQgeyBBcHAsIE5vdGljZSwgVEFic3RyYWN0RmlsZSB9IGZyb20gXCJvYnNpZGlhblwiO1xuaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSBcIi4vYWN0aW9uXCI7XG5cbmV4cG9ydCBjbGFzcyBDb3B5QWN0aW9uIGltcGxlbWVudHMgQWN0aW9uIHtcblxuICAgIGFwcDogQXBwO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgfVxuXG4gICAgYWN0KHJlc3VsdEFycjogVEFic3RyYWN0RmlsZVtdKSB7XG5cbiAgICAgICAgaWYgKHJlc3VsdEFyci5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgICBsZXQgc3RyID0gXCJcIjtcbiAgICAgICAgICAgIHJlc3VsdEFyci5mb3JFYWNoKGZmID0+IHtcbiAgICAgICAgICAgICAgICBsZXQgbmFtZSA9IGZmLm5hbWU7XG4gICAgICAgICAgICAgICAgaWYgKG5hbWUuZW5kc1dpdGgoXCIubWRcIikpIHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IG5hbWUuc3Vic3RyaW5nKDAsIG5hbWUubGFzdEluZGV4T2YoXCIuXCIpKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgc3RyICs9IFwiW1tcIiArIGZmLnBhdGggKyBcInxcIiArIG5hbWUgKyBcIl1dXFxuXCI7XG4gICAgICAgICAgICB9KVxuICAgICAgICAgICAgbmF2aWdhdG9yLmNsaXBib2FyZC53cml0ZVRleHQoc3RyKTtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJDb3B5IGxpbmtzIHN1Y2Nlc3MhXCIpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBuZXcgTm90aWNlKFwiTm8gRmlsZXMgRm91bmQhXCIpO1xuICAgICAgICB9XG4gICAgfVxuXG59IiwgImltcG9ydCB7IEFwcCwgTm90aWNlLCBUQWJzdHJhY3RGaWxlIH0gZnJvbSBcIm9ic2lkaWFuXCI7XG5pbXBvcnQgeyBFZGl0RnJvbnRNYXR0ZXJNb2RhbCB9IGZyb20gXCJzcmMvbW9kYWwvZWRpdC1mcm9udC1tYXR0ZXItbW9kYWxcIjtcbmltcG9ydCB7IEFjdGlvbiB9IGZyb20gXCIuL2FjdGlvblwiO1xuXG5leHBvcnQgY2xhc3MgRWRpdEZyb250TWF0dGVyQWN0aW9uIGltcGxlbWVudHMgQWN0aW9uIHtcblxuICAgIGFwcDogQXBwO1xuXG4gICAgY29uc3RydWN0b3IoYXBwOiBBcHApIHtcbiAgICAgICAgdGhpcy5hcHAgPSBhcHA7XG4gICAgfVxuXG4gICAgYWN0KHJlc3VsdEFycjogVEFic3RyYWN0RmlsZVtdKSB7XG4gICAgICAgIGlmIChyZXN1bHRBcnIubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgbmV3IEVkaXRGcm9udE1hdHRlck1vZGFsKHRoaXMuYXBwLCByZXN1bHRBcnIpLm9wZW4oKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJObyBGaWxlcyBGb3VuZCFcIik7XG4gICAgICAgIH1cbiAgICB9XG59IiwgImltcG9ydCB7IEFwcCwgTW9kYWwsIE5vdGljZSwgU2V0dGluZywgVEFic3RyYWN0RmlsZSB9IGZyb20gJ29ic2lkaWFuJztcbmltcG9ydCB7IHRleHQgfSBmcm9tICdzdHJlYW0vY29uc3VtZXJzJztcblxuLyoqXG4gKiBcdTAwQTBcdTVGMzlcdTdBOTdcdTdGMTZcdThGOTFGcm9udCBNYXR0ZXJcdTVDNUVcdTYwMjdcbiAqL1xuZXhwb3J0IGNsYXNzIEVkaXRGcm9udE1hdHRlck1vZGFsIGV4dGVuZHMgTW9kYWwge1xuICAgIHJlc3VsdEFycjogVEFic3RyYWN0RmlsZVtdO1xuICAgIGtleTogU3RyaW5nO1xuICAgIHZhbDogU3RyaW5nO1xuICAgIG92ZXJyaWRlRmxhZzogYm9vbGVhbjtcblxuICAgIGNvbnN0cnVjdG9yKGFwcDogQXBwLCByZXN1bHRBcnI6IFRBYnN0cmFjdEZpbGVbXSkge1xuICAgICAgICBzdXBlcihhcHApO1xuICAgICAgICB0aGlzLnJlc3VsdEFyciA9IHJlc3VsdEFycjtcbiAgICAgICAgbGV0IHRtcEZsYWcgPSBsb2NhbFN0b3JhZ2UuZ2V0SXRlbShcIm92ZXJyaWRlRmxhZ1wiKTtcbiAgICAgICAgaWYgKHRtcEZsYWcgJiYgXCJ0cnVlXCIgPT0gdG1wRmxhZykge1xuICAgICAgICAgICAgdGhpcy5vdmVycmlkZUZsYWcgPSB0cnVlO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25PcGVuKCkge1xuICAgICAgICBjb25zdCB7IGNvbnRlbnRFbCB9ID0gdGhpcztcblxuICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJoMVwiLCB7IHRleHQ6IFwiRWRpdCBGcm9udCBNYXR0ZXJcIiB9KTtcblxuICAgICAgICBpZiAodGhpcy5yZXN1bHRBcnIubGVuZ3RoID09IDApIHtcbiAgICAgICAgICAgIGNvbnRlbnRFbC5jcmVhdGVFbChcImRpdlwiLCB7IHRleHQ6IFwiTm8gZmlsZXMgZm91bmQhXCIgfSk7XG5cbiAgICAgICAgICAgIG5ldyBTZXR0aW5nKGNvbnRlbnRFbClcbiAgICAgICAgICAgICAgICAuYWRkQnV0dG9uKChidG4pID0+XG4gICAgICAgICAgICAgICAgICAgIGJ0blxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEJ1dHRvblRleHQoXCJDbG9zZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DbGljaygoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdGhpcy5yZXN1bHRBcnIuZm9yRWFjaChpbmZvID0+IHtcbiAgICAgICAgICAgICAgICBjb250ZW50RWwuY3JlYXRlRWwoXCJkaXZcIiwgeyB0ZXh0OiBpbmZvLnBhdGggfSk7XG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAgICAgLmFkZFRleHQoKHR4dCkgPT5cbiAgICAgICAgICAgICAgICAgICAgdHh0LnNldFBsYWNlaG9sZGVyKFwiRnJvbnQgTWF0dGVyIEtleVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKCh2YWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmtleSA9IHZhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKS5hZGRUZXh0KCh0eHQpID0+XG4gICAgICAgICAgICAgICAgICAgIHR4dC5zZXRQbGFjZWhvbGRlcihcIkZyb250IE1hdHRlciBWYWx1ZVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLm9uQ2hhbmdlKCh2YWwpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnZhbCA9IHZhbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgKS5hZGRUb2dnbGUoKHRvZ2dsZSkgPT4ge1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGUuc2V0VmFsdWUodGhpcy5vdmVycmlkZUZsYWcpO1xuICAgICAgICAgICAgICAgICAgICB0b2dnbGUuc2V0VG9vbHRpcChcIk92ZXJyaWRlIGlmIGV4aXN0cyFcIik7XG4gICAgICAgICAgICAgICAgICAgIHRvZ2dsZS5vbkNoYW5nZSgodmFsKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbShcIm92ZXJyaWRlRmxhZ1wiLCB2YWwgKyBcIlwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMub3ZlcnJpZGVGbGFnID0gdmFsO1xuICAgICAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBuZXcgU2V0dGluZyhjb250ZW50RWwpXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PlxuICAgICAgICAgICAgICAgICAgICBidG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiQ29uZmlybVwiKVxuICAgICAgICAgICAgICAgICAgICAgICAgLnNldEN0YSgpXG4gICAgICAgICAgICAgICAgICAgICAgICAub25DbGljayhhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMua2V5ID09IG51bGwgfHwgdGhpcy5rZXkudHJpbSgpID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIktleSBjb3VsZCBub3QgYmUgZW1wdHkhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLnZhbCA9PSBudWxsIHx8IHRoaXMudmFsLnRyaW0oKSA9PSBcIlwiKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBOb3RpY2UoXCJWYWx1ZSBjb3VsZCBub3QgYmUgZW1wdHkhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsZXQgYXBpID0gdGhpcy5hcHAucGx1Z2lucy5wbHVnaW5zW1wibWV0YWVkaXRcIl0uYXBpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBjX251bSA9IDA7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbGV0IHVfbnVtID0gMDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMucmVzdWx0QXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCBpbmZvID0gdGhpcy5yZXN1bHRBcnJbaV07XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxldCB2YWwgPSBhd2FpdCBhcGkuZ2V0UHJvcGVydHlWYWx1ZSh0aGlzLmtleSwgaW5mbyk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh2YWwgPT0gbnVsbCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYXBpLmNyZWF0ZVlhbWxQcm9wZXJ0eSh0aGlzLmtleSwgdGhpcy52YWwsIGluZm8pO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY19udW0gKz0gMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIGlmICh0aGlzLm92ZXJyaWRlRmxhZyB8fCB2YWwudHJpbSgpID09IFwiXCIpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFwaS51cGRhdGUodGhpcy5rZXksIHRoaXMudmFsLCBpbmZvKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHVfbnVtICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkVkaXQgU3VjY2VzcyFcIik7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkFkZCBcIiArIGNfbnVtICsgXCIgIVwiKTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgTm90aWNlKFwiVXBkYXRlIFwiICsgdV9udW0gKyBcIiAhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkpXG4gICAgICAgICAgICAgICAgLmFkZEJ1dHRvbigoYnRuKSA9PlxuICAgICAgICAgICAgICAgICAgICBidG5cbiAgICAgICAgICAgICAgICAgICAgICAgIC5zZXRCdXR0b25UZXh0KFwiQ2FuY2VsXCIpXG4gICAgICAgICAgICAgICAgICAgICAgICAuc2V0Q3RhKClcbiAgICAgICAgICAgICAgICAgICAgICAgIC5vbkNsaWNrKCgpID0+IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IE5vdGljZShcIkVkaXQgQ2FuY2VsZWQhXCIpO1xuICAgICAgICAgICAgICAgICAgICAgICAgfSkpO1xuICAgICAgICB9XG4gICAgfVxufSJdLAogICJtYXBwaW5ncyI6ICI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF3Q2EsUUFBQSxVQUFTLENBQUMsUUFBc0M7O0FBQ3pELFVBQUk7QUFBSyxlQUFPLE1BQUEsSUFBSSxRQUFRLFFBQVEsY0FBVSxRQUFBLE9BQUEsU0FBQSxTQUFBLEdBQUE7O0FBQ3pDLGVBQU8sT0FBTzs7QUFJVixRQUFBLGtCQUFrQixDQUFDLFFBQWEsSUFBSSxRQUFRLGVBQWUsSUFBSTs7Ozs7OztBQzlDNUU7QUFBQTtBQUFBO0FBQUEsd0JBQTZDOzs7QUNBN0MsdUJBQWtFOzs7QUNBbEUsdUJBQTJDOzs7QUNBM0Msc0JBQWdFO0FBTXpELGlDQUEyQixzQkFBTTtBQUFBLEVBSXBDLFlBQVksS0FBVSxXQUF1QjtBQUN6QyxVQUFNO0FBQ04s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
